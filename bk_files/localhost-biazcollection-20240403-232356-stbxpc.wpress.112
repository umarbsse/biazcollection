6.64 16.3211C206.795 16.6525 206.904 17.0201 206.966 17.424C207.038 17.8175 207.075 18.2525 207.075 18.7289V28.5776H205.055L204.791 26.9465ZM204.667 22.0998C204.222 21.9756 203.693 21.8565 203.082 21.7425C202.471 21.6286 201.798 21.5665 201.063 21.5561C200.038 21.5561 199.235 21.7736 198.655 22.2086C198.075 22.6435 197.785 23.3115 197.785 24.2125C197.785 24.6682 197.858 25.0669 198.003 25.4086C198.148 25.7504 198.344 26.0352 198.593 26.263C198.852 26.4805 199.152 26.6462 199.494 26.7601C199.846 26.8637 200.219 26.9155 200.612 26.9155C201.13 26.9155 201.612 26.843 202.057 26.698C202.502 26.5426 202.896 26.3614 203.238 26.1543C203.59 25.9472 203.885 25.74 204.123 25.5329C204.372 25.3258 204.553 25.1653 204.667 25.0514V22.0998Z",fill:"black"}),l().createElement("path",{d:"M219.367 15.7774H219.18C218.611 15.7774 218.051 15.8291 217.503 15.9327C216.954 16.0363 216.436 16.1968 215.949 16.4143C215.473 16.6214 215.038 16.8803 214.644 17.191C214.261 17.5017 213.94 17.8693 213.681 18.2939V28.5776H211.273V13.82H213.137L213.603 16.1657H213.65C213.888 15.7825 214.178 15.4252 214.52 15.0938C214.872 14.7624 215.266 14.4725 215.701 14.2239C216.136 13.9754 216.612 13.7838 217.13 13.6491C217.648 13.5042 218.191 13.4317 218.761 13.4317C218.864 13.4317 218.968 13.4368 219.072 13.4472C219.185 13.4472 219.284 13.4524 219.367 13.4627V15.7774Z",fill:"black"}),l().createElement("path",{d:"M227.791 13.4317C228.505 13.4317 229.189 13.5093 229.841 13.6647C230.494 13.8097 231.053 14.0168 231.519 14.2861V16.29C230.866 16.0414 230.266 15.855 229.717 15.7307C229.168 15.6065 228.609 15.5443 228.039 15.5443C227.439 15.5443 226.843 15.6427 226.253 15.8395C225.662 16.0363 225.134 16.3625 224.668 16.8182C224.202 17.2635 223.824 17.859 223.534 18.6046C223.255 19.3399 223.115 20.2564 223.115 21.3542C223.115 22.1516 223.218 22.8869 223.426 23.5601C223.643 24.2332 223.959 24.8183 224.373 25.3154C224.798 25.8022 225.326 26.1854 225.958 26.465C226.589 26.7342 227.319 26.8689 228.148 26.8689C228.749 26.8689 229.354 26.8067 229.965 26.6825C230.577 26.5478 231.172 26.3614 231.752 26.1232V28.1271C231.576 28.2307 231.343 28.3343 231.053 28.4378C230.773 28.5414 230.463 28.6294 230.121 28.7019C229.779 28.7848 229.417 28.8469 229.033 28.8883C228.65 28.9401 228.267 28.966 227.884 28.966C226.89 28.966 225.947 28.8158 225.057 28.5155C224.176 28.2152 223.405 27.7543 222.742 27.133C222.079 26.5116 221.556 25.7245 221.173 24.7717C220.79 23.819 220.598 22.6901 220.598 21.3852C220.598 20.4118 220.697 19.5367 220.893 18.7599C221.101 17.9832 221.38 17.2997 221.732 16.7094C222.084 16.1191 222.493 15.6168 222.96 15.2026C223.436 14.7883 223.938 14.4518 224.466 14.1928C225.005 13.9236 225.559 13.732 226.129 13.6181C226.698 13.4938 227.252 13.4317 227.791 13.4317Z",fill:"black"}),l().createElement("path",{d:"M237.488 15.8395H237.535C237.804 15.4977 238.105 15.1819 238.436 14.8919C238.767 14.5916 239.135 14.3378 239.539 14.1307C239.943 13.9132 240.378 13.7424 240.844 13.6181C241.31 13.4938 241.812 13.4317 242.351 13.4317C242.91 13.4317 243.469 13.5093 244.028 13.6647C244.588 13.8097 245.105 14.0738 245.582 14.4569C246.058 14.8401 246.447 15.3735 246.747 16.057C247.047 16.7405 247.197 17.6208 247.197 18.6978V28.5776H244.79V19.0862C244.79 17.8952 244.562 16.9994 244.106 16.3987C243.661 15.7981 242.925 15.4977 241.9 15.4977C241.051 15.4977 240.243 15.7307 239.477 16.1968C238.71 16.6525 238.048 17.2842 237.488 18.092V28.5776H235.081V6.08392H237.488V15.8395Z",fill:"black"})),l().createElement("path",{d:"M21.0008 42C32.5991 42 42.0016 32.5975 42.0016 20.9992C42.0016 9.40089 32.5991 0 21.0008 0C9.40245 0 0 9.40245 0 21.0008C0 32.5991 9.40245 42 21.0008 42Z",fill:e}),l().createElement("path",{d:"M22.0427 17.4737V37.8322L32.5431 17.4737H22.0427V17.4737Z",fill:"white"}),l().createElement("path",{d:"M19.9185 24.4874V4.16779L9.4585 24.4874H19.9185Z",fill:"white"}),l().createElement("path",{d:"M54.2236 34.8665C53.6218 33.9443 53.0619 33.0237 52.5005 32.1419C55.4662 30.3379 56.4677 28.8963 56.4677 26.1701V10.4195H52.981V7.41498H60.396V25.3692C60.396 29.9383 59.0741 32.5027 54.2236 34.8665Z",fill:"black"}),l().createElement("path",{d:"M85.2846 24.1266C85.2846 25.6491 86.367 25.8093 87.0885 25.8093C87.8101 25.8093 88.8521 25.5683 89.653 25.3288V28.1343C88.5302 28.4951 87.3685 28.775 85.7651 28.775C83.8414 28.775 81.5973 28.0534 81.5973 24.6865V16.4302H79.5538V13.5843H81.5973V9.37756H85.2846V13.5858H89.9329V16.4317H85.2846V24.1266Z",fill:"black"}),l().createElement("path",{d:"M92.9795 36.2693V13.5454H96.5066V14.9077C97.9093 13.8253 99.4723 13.1442 101.396 13.1442C104.722 13.1442 107.368 15.4691 107.368 20.4783C107.368 25.4485 104.483 28.7346 99.7133 28.7346C98.5516 28.7346 97.6294 28.5744 96.6668 28.3738V36.2288H92.9795V36.2693V36.2693ZM100.433 16.1907C99.351 16.1907 97.9886 16.7117 96.7056 17.8345V25.5698C97.5065 25.73 98.3494 25.8498 99.4707 25.8498C102.076 25.8498 103.559 24.206 103.559 20.7597C103.559 17.5935 102.477 16.1907 100.433 16.1907Z",fill:"black"}),l().createElement("path",{d:"M121.874 28.4142H118.428V26.7704H118.347C117.145 27.6926 115.661 28.6941 113.458 28.6941C111.534 28.6941 109.45 27.2914 109.45 24.4454C109.45 20.6384 112.696 19.9168 114.98 19.5965L118.226 19.1564V18.7162C118.226 16.7117 117.425 16.0709 115.54 16.0709C114.618 16.0709 112.455 16.3509 110.691 17.0725L110.371 14.1068C111.974 13.5454 114.178 13.1457 116.022 13.1457C119.629 13.1457 121.954 14.5889 121.954 18.8764V28.4142H121.874V28.4142ZM118.187 21.4813L115.14 21.9619C114.218 22.0816 113.257 22.643 113.257 24.0053C113.257 25.2075 113.938 25.8886 114.94 25.8886C116.022 25.8886 117.184 25.2479 118.185 24.5263V21.4813H118.187Z",fill:"black"}),l().createElement("path",{d:"M137.104 27.9336C135.581 28.4546 134.219 28.775 132.494 28.775C126.964 28.775 124.759 25.6087 124.759 21.0008C124.759 16.1518 127.805 13.1457 132.734 13.1457C134.577 13.1457 135.699 13.4661 136.942 13.8673V16.9931C135.86 16.5919 134.297 16.1518 132.774 16.1518C130.53 16.1518 128.606 17.3539 128.606 20.8002C128.606 24.6072 130.53 25.7704 132.975 25.7704C134.136 25.7704 135.419 25.5294 137.143 24.8482V27.9336H137.104Z",fill:"black"}),l().createElement("path",{d:"M144.077 19.9588C144.398 19.598 144.639 19.2372 149.287 13.5858H154.096L148.083 20.64L154.655 28.4546H149.847L144.116 21.4005V28.4546H140.43V7.41498H144.118V19.9588H144.077Z",fill:"black"}),l().createElement("path",{d:"M76.7873 27.9337C74.8636 28.5355 73.2198 28.775 71.2961 28.775C66.5668 28.775 63.6416 26.4112 63.6416 20.8795C63.6416 16.8314 66.1267 13.1442 70.8948 13.1442C75.6241 13.1442 77.2678 16.4302 77.2678 19.5561C77.2678 20.598 77.187 21.1594 77.1481 21.7597H67.6103C67.6912 25.0053 69.5341 25.7673 72.2991 25.7673C73.8216 25.7673 75.1839 25.4065 76.7484 24.8451V27.9306H76.7873V27.9337ZM73.422 19.3166C73.422 17.5126 72.8201 15.9497 70.8575 15.9497C69.0147 15.9497 67.8918 17.2715 67.6508 19.3166H73.422V19.3166Z",fill:"black"}))},3846:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r(5235),a=r.n(n),c=r(9196),s=r(3080);const o=Number(s.Z.smCols),i=Number(s.Z.mdCols),l=Number(s.Z.lgCols),p=e=>{const{children:t,tagName:r="div",className:n}=e,p=Math.min(o,"number"==typeof e.sm?e.sm:o),u=Math.min(o,"object"==typeof e.sm?e.sm.start:0),d=Math.min(o,"object"==typeof e.sm?e.sm.end:0),m=Math.min(i,"number"==typeof e.md?e.md:i),g=Math.min(i,"object"==typeof e.md?e.md.start:0),h=Math.min(i,"object"==typeof e.md?e.md.end:0),f=Math.min(l,"number"==typeof e.lg?e.lg:l),v=Math.min(l,"object"==typeof e.lg?e.lg.start:0),b=Math.min(l,"object"==typeof e.lg?e.lg.end:0),y=a()(n,{[s.Z[`col-sm-${p}`]]:!(u&&d),[s.Z[`col-sm-${u}-start`]]:u>0,[s.Z[`col-sm-${d}-end`]]:d>0,[s.Z[`col-md-${m}`]]:!(g&&h),[s.Z[`col-md-${g}-start`]]:g>0,[s.Z[`col-md-${h}-end`]]:h>0,[s.Z[`col-lg-${f}`]]:!(v&&b),[s.Z[`col-lg-${v}-start`]]:v>0,[s.Z[`col-lg-${b}-end`]]:b>0});return(0,c.createElement)(r,{className:y},t)}},3363:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(5235),a=r.n(n),c=r(9196),s=r(8730);const o=({children:e,fluid:t=!1,tagName:r="div",className:n,horizontalGap:o=1,horizontalSpacing:i=1})=>{const l=(0,c.useMemo)((()=>{const e=`calc( var(--horizontal-spacing) * ${i} )`;return{paddingTop:e,paddingBottom:e,rowGap:`calc( var(--horizontal-spacing) * ${o} )`}}),[o,i]),p=a()(n,s.Z.container,{[s.Z.fluid]:t});return(0,c.createElement)(r,{className:p,style:l},e)}},2054:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(4333),a=r(3247);const c=["sm","md","lg"],s=(e,t)=>{const r=Array.isArray(e)?e:[e],s=Array.isArray(t)?t:[t],[o,i,l]=c,p={sm:(0,n.useMediaQuery)(a.Z[o]),md:(0,n.useMediaQuery)(a.Z[i]),lg:(0,n.useMediaQuery)(a.Z[l])};return r.map(((e,t)=>{const r=s[t];return r?((e,t,r)=>{const n=c.indexOf(e),a=n+1,s=t.includes("=");let o=[];return t.startsWith("<")&&(o=c.slice(0,s?a:n)),t.startsWith(">")&&(o=c.slice(s?n:a)),o?.length?o.some((e=>r[e])):r[e]})(e,r,p):p[e]}))}},2947:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(8709);const a=(e,t={})=>{const r=(0,n.X)();return new Intl.NumberFormat(r,t).format(e)}},4432:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(8899),a=r(5609),c=r(5736),s=r(7325);r(9478);const __=c.__,o=e=>-1===e.fraction.indexOf("00"),i=({currencyCode:e="USD",priceDetails:t=__("/month, paid yearly","jetpack-search-pkg"),...r})=>{const i=(0,n.LR)(r.priceBefore,e),l=(0,n.LR)(r.priceAfter,e);return React.createElement("div",{className:"jp-components__pricing-card"},r.icon&&React.createElement("div",{className:"jp-components__pricing-card__icon"},"string"==typeof r.icon?React.createElement("img",{src:r.icon,alt:(0,c.sprintf)(/* translators: placeholder is a product name */
__("Icon for the product %s","jetpack-search-pkg"),r.title)}):r.icon),React.createElement("h1",{className:"jp-components__pricing-card__title"},r.title),React.createElement("div",{className:"jp-components__pricing-card__pricing"},r.priceBefore!==r.priceAfter&&React.createElement("div",{className:"jp-components__pricing-card__price-before"},React.createElement("span",{className:"jp-components__pricing-card__currency"},i.symbol),React.createElement("span",{className:"jp-components__pricing-card__price"},i.integer),o(i)&&React.createElement("span",{className:"jp-components__pricing-card__price-decimal"}," ",i.fraction),React.createElement("div",{className:"jp-components__pricing-card__price-strikethrough"})),React.createElement("div",{className:"jp-components__pricing-card__price-after"},React.createElement("span",{className:"jp-components__pricing-card__currency"},l.symbol),React.createElement("span",{className:"jp-components__pricing-card__price"},l.integer),o(l)&&React.createElement("span",{className:"jp-components__pricing-card__price-decimal"},l.fraction)),React.createElement("span",{className:"jp-components__pricing-card__price-details"},t)),r.children&&React.createElement("div",{className:"jp-components__pricing-card__extra-content-wrapper"},r.children),r.tosText&&React.createElement("div",{className:"jp-components__pricing-card__tos"},r.tosText),r.ctaText&&React.createElement(React.Fragment,null,!r.tosText&&React.createElement("div",{className:"jp-components__pricing-card__tos"},React.createElement(s.Z,{agreeButtonLabel:r.ctaText})),React.createElement("div",{className:"jp-components__pricing-card__cta"},React.createElement(a.Button,{className:"jp-components__pricing-card__button",label:r.ctaText,onClick:r.onCtaClick},r.ctaText))),r.infoText&&React.createElement("div",{className:"jp-components__pricing-card__info"},r.infoText))}},9608:(e,t,r)=>{"use strict";r.d(t,{NE:()=>E,ZP:()=>_,kF:()=>k,oK:()=>C});var n=r(5736),a=r(1074),c=r(9201),s=r(6163),o=r(5235),i=r.n(o),l=r(9196),p=r.n(l),u=r(9665),d=r(2054),m=r(7325),g=r(5106),h=r(9929);const __=n.__,f=__("Included","jetpack-search-pkg"),v=__("Not included","jetpack-search-pkg"),b=__("Coming soon","jetpack-search-pkg"),y=(0,l.createContext)(void 0),k=({isIncluded:e=!1,isComingSoon:t=!1,index:r=0,label:o=null,tooltipInfo:m,tooltipTitle:k,tooltipClassName:E=""})=>{const[C]=(0,d.Z)("lg"),_=(0,l.useContext)(y)[r],j=t||e,S=_.name,w=_.tooltipInfo,N=_.tooltipTitle,x=m||!C&&w,P=((e,t,r)=>e?{lg:b,
// translators: Name of the current feature
default:(0,n.sprintf)(__("%s coming soon","jetpack-search-pkg"),r)}:{lg:t?f:v,default:t?r:(0,n.sprintf)(/* translators: Name of the current feature */
__("%s not included","jetpack-search-pkg"),r)})(t,e,S),Z=C?P.lg:P.default;return p().createElement("div",{className:i()(h.Z.item,h.Z.value)},p().createElement(a.Z,{className:i()(h.Z.icon,j?h.Z["icon-check"]:h.Z["icon-cross"]),size:32,icon:j?c.Z:s.Z}),p().createElement(g.ZP,{variant:"body-small"},o||Z),x&&p().createElement(u.Z,{title:k||N,iconClassName:h.Z["popover-icon"],className:i()(h.Z.popover,E),placement:"bottom-end",iconSize:14,offset:4,wide:Boolean(k&&m)},p().createElement(g.ZP,{variant:"body-small",component:"div"},m||w)))},E=({children:e})=>p().createElement("div",{className:h.Z.header},e),C=({primary:e=!1,children:t})=>{let r=0;return p().createElement("div",{className:i()(h.Z.card,{[h.Z["is-primary"]]:e})},l.Children.map(t,(e=>{const t=e;return t.type===k?(r++,(0,l.cloneElement)(t,{index:r-1})):t})))},_=({title:e,items:t,children:r,showIntroOfferDisclaimer:n=!1})=>{const[a]=(0,d.Z)("lg");return p().createElement(y.Provider,{value:t},p().createElement("div",{className:i()(h.Z.container,{[h.Z["is-viewport-large"]]:a}),style:{"--rows":t.length+1,"--columns":l.Children.toArray(r).length+1}},p().createElement("div",{className:h.Z.table},p().createElement(g.ZP,{variant:"headline-small"},e),a&&t.map(((e,r)=>p().createElement("div",{className:i()(h.Z.item,{[h.Z["last-feature"]]:r===t.length-1}),key:r},p().createElement(g.ZP,{variant:"body-small"},p().createElement("strong",null,e.name)),e.tooltipInfo&&p().createElement(u.Z,{title:e.tooltipTitle,iconClassName:h.Z["popover-icon"],className:h.Z.popover,placement:e.tooltipPlacement?e.tooltipPlacement:"bottom-end",iconSize:14,offset:4,wide:Boolean(e.tooltipTitle&&e.tooltipInfo)},p().createElement(g.ZP,{variant:"body-small"},e.tooltipInfo))))),r)),p().createElement("div",{className:h.Z["tos-container"]},p().createElement("div",{className:h.Z.tos},n&&p().createElement(g.ZP,{variant:"body-small"},__("Reduced pricing is a limited offer for the first year and renews at regular price.","jetpack-search-pkg")),p().createElement(m.Z,{multipleButtons:!0}))))}},5347:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(5736),a=r(5235),c=r.n(a),s=r(5106),o=r(3789),i=r(5170);const __=n.__,l=({price:e,offPrice:t,currency:r="",showNotOffPrice:n=!0,hideDiscountLabel:a=!0,promoLabel:l="",legend:p=__("/month, paid yearly","jetpack-search-pkg"),isNotConvenientPrice:u=!1,hidePriceFraction:d=!1,children:m})=>{if(null==e&&null==t||!r)return null;n=n&&null!=t;const g="number"==typeof e&&"number"==typeof t?Math.floor((e-t)/e*100):0,h=!a&&g&&g>0?g+__("% off","jetpack-search-pkg"):null;return React.createElement(React.Fragment,null,React.createElement("div",{className:i.Z.container},React.createElement("div",{className:c()(i.Z["price-container"],"product-price_container")},React.createElement(o.t,{value:t??e,currency:r,isOff:!u,hidePriceFraction:d}),n&&React.createElement(o.t,{value:e,currency:r,isOff:!1,hidePriceFraction:d}),h&&React.createElement(s.ZP,{className:c()(i.Z["promo-label"],"product-price_promo_label")},h))),React.createElement("div",{className:i.Z.footer},m||React.createElement(s.ZP,{className:c()(i.Z.legend,"product-price_legend")},p),l&&React.createElement(s.ZP,{className:c()(i.Z["promo-label"],"product-price_promo_label")},l)))}},3789:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});var n=r(8899),a=r(5235),c=r.n(a),s=r(5106),o=r(5170);const i=({value:e,currency:t,isOff:r,hidePriceFraction:a})=>{const i=c()(o.Z.price,"product-price_price",{[o.Z["is-not-off-price"]]:!r}),{symbol:l,integer:p,fraction:u}=(0,n.LR)(e,t),d=!a||!u.endsWith("00");return React.createElement(s.ZP,{className:i,variant:"headline-medium",component:"p"},React.createElement(s.ZP,{className:o.Z.symbol,component:"sup",variant:"title-medium"},l),p,d&&React.createElement(s.ZP,{component:"sup",variant:"body-small","data-testid":"PriceFraction"},React.createElement("strong",null,u)))}},3521:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(5736),a=r(5235),c=r.n(a),s=r(9196),o=r.n(s),i=r(2947);r(2687);const __=n.__,l=({totalCount:e,items:t=[],showLegendLabelBeforeCount:r=!1,sortByCount:n,className:a,tableCaption:l,legendTitle:p,recordTypeLabel:u,recordCountLabel:d})=>{const m=(0,s.useMemo)((()=>e||t.reduce(((e,{count:t})=>e+t),0)),[t,e]),g=(0,s.useMemo)((()=>n?[...t].sort(((e,t)=>"ascending"===n?e.count-t.count:t.count-e.count)):t),[t,n]);return o().createElement("div",{className:c()("record-meter-bar",a)},o().createElement("div",{className:"record-meter-bar__items","aria-hidden":"true"},g.map((({count:e,label:t,backgroundColor:r})=>{const n=(e/m*100).toPrecision(2);return o().createElement("div",{key:t,style:{backgroundColor:r,flexBasis:`${n}%`}})}))),o().createElement("div",{className:"record-meter-bar__legend","aria-hidden":"true"},p&&o().createElement("div",{className:"record-meter-bar__legend--title"},p),o().createElement("ul",{className:"record-meter-bar__legend--items"},g.map((({count:e,label:t,backgroundColor:n})=>{const a=(0,i.Z)(e);return o().createElement("li",{key:t,className:"record-meter-bar__legend--item"},o().createElement("div",{className:"record-meter-bar__legend--item-circle",style:{backgroundColor:n}}),!r&&o().createElement("span",null,o().createElement("span",{className:"record-meter-bar__legend--item-count"},a),o().createElement("span",{className:"record-meter-bar__legend--item-label"},t)),r&&o().createElement("span",null,o().createElement("span",{className:"record-meter-bar__legend--item-label record-meter-bar__legend--item-label-first"},t),o().createElement("span",{className:"record-meter-bar__legend--item-count"},"(",a,")")))})))),o().createElement("table",{className:"screen-reader-text"},o().createElement("caption",null,l||__("Summary of the records","jetpack-search-pkg")),o().createElement("tbody",null,o().createElement("tr",null,o().createElement("th",{scope:"col"},u||__("Record type","jetpack-search-pkg")),o().createElement("th",{scope:"col"},d||__("Record count","jetpack-search-pkg"))),g.map((({label:e,count:t})=>o().createElement("tr",{key:e},o().createElement("td",null,e),o().createElement("td",null,t)))))))}},5033:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(5162),a=r.n(n),c=r(9196),s=r.n(c);r(1683);const o=e=>{const t=e.className+" jp-components-spinner",r={width:e.size,height:e.size,fontSize:e.size,borderTopColor:e.color},n={borderTopColor:e.color,borderRightColor:e.color};return s().createElement("div",{className:t},s().createElement("div",{className:"jp-components-spinner__outer",style:r},s().createElement("div",{className:"jp-components-spinner__inner",style:n})))};o.propTypes={color:a().string,className:a().string,size:a().number},o.defaultProps={color:"#FFFFFF",className:"",size:20};const i=o},7325:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(9307),a=r(5736),c=r(5235),s=r.n(c),o=r(6895),i=r(5106);r(7920);const __=a.__,l=()=>(0,n.createInterpolateElement)(__("By clicking the buttons above, you agree to our <tosLink>Terms of Service</tosLink> and to <shareDetailsLink>share details</shareDetailsLink> with WordPress.com.","jetpack-search-pkg"),{tosLink:React.createElement(u,{slug:"wpcom-tos"}),shareDetailsLink:React.createElement(u,{slug:"jetpack-support-what-data-does-jetpack-sync"})}),p=({agreeButtonLabel:e})=>(0,n.createInterpolateElement)((0,a.sprintf)(/* translators: %s is a button label */
__("By clicking the <strong>%s</strong> button, you agree to our <tosLink>Terms of Service</tosLink> and to <shareDetailsLink>share details</shareDetailsLink> with WordPress.com.","jetpack-search-pkg"),e),{strong:React.createElement("strong",null),tosLink:React.createElement(u,{slug:"wpcom-tos"}),shareDetailsLink:React.createElement(u,{slug:"jetpack-support-what-data-does-jetpack-sync"})}),u=({slug:e,children:t})=>React.createElement("a",{className:"terms-of-service__link",href:(0,o.Z)(e),rel:"noopener noreferrer",target:"_blank"},t),d=({className:e,multipleButtons:t,agreeButtonLabel:r})=>React.createElement(i.ZP,{className:s()(e,"terms-of-service")},t?React.createElement(l,null):React.createElement(p,{agreeButtonLabel:r}))},6017:(e,t,r)=>{"use strict";r.d(t,{h:()=>n,s:()=>a});const n={"headline-medium":"h1","headline-small":"h2","headline-small-regular":"h2","title-medium":"h3","title-medium-semi-bold":"h3","title-small":"h4",body:"p","body-small":"p","body-extra-small":"p","body-extra-small-bold":"p",label:"p"},a=["mt","mr","mb","ml","mx","my","m","pt","pr","pb","pl","px","py","p"]},5106:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>d});var n=r(2674),a=r.n(n),c=r(5235),s=r.n(c),o=r(9196),i=r.n(o),l=r(6017),p=r(3280);const u=(0,o.forwardRef)((({variant:e="body",children:t,component:r,className:n,...c},u)=>{const d=r||l.h[e]||"span",m=(0,o.useMemo)((()=>l.s.reduce(((e,t)=>(void 0!==c[t]&&(e+=p.Z[`${t}-${c[t]}`]+" ",delete c[t]),e)),"")),[c]);return c.ref=u,i().createElement(d,a()({className:s()(p.Z.reset,p.Z[e],n,m)},c),t)}));u.displayName="Text";const d=u},8275:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>d});var n=r(9196),a=r.n(n),c=r(3591);const s={"--font-headline-medium":"48px","--font-headline-small":"36px","--font-title-medium":"24px","--font-title-small":"20px","--font-body":"16px","--font-body-small":"14px","--font-body-extra-small":"12px","--font-title-large":"var(--font-headline-small)","--font-label":"var(--font-body-extra-small)"},o={"--jp-black":"#000000","--jp-black-80":"#2c3338","--jp-white":"#ffffff","--jp-white-off":"#f9f9f6","--jp-gray":"#dcdcde","--jp-gray-0":"#F6F7F7","--jp-gray-10":"#C3C4C7","--jp-gray-20":"#A7AAAD","--jp-gray-40":"#787C82","--jp-gray-50":"#646970","--jp-gray-60":"#50575E","--jp-gray-70":"#3C434A","--jp-gray-80":"#2C3338","--jp-gray-90":"#1d2327","--jp-gray-off":"#e2e2df","--jp-red-0":"#F7EBEC","--jp-red-5":"#FACFD2","--jp-red-40":"#E65054","--jp-red-50":"#D63638","--jp-red-60":"#B32D2E","--jp-red-70":"#8A2424","--jp-red-80":"#691C1C","--jp-red":"#d63639","--jp-yellow-5":"#F5E6B3","--jp-yellow-10":"#F2CF75","--jp-yellow-20":"#F0C930","--jp-yellow-30":"#DEB100","--jp-yellow-40":"#C08C00","--jp-yellow-50":"#9D6E00","--jp-yellow-60":"#7D5600","--jp-blue-20":"#68B3E8","--jp-blue-40":"#1689DB","--jp-pink":"#C9356E","--jp-green-0":"#f0f2eb","--jp-green-5":"#d0e6b8","--jp-green-10":"#9dd977","--jp-green-20":"#64ca43","--jp-green-30":"#2fb41f","--jp-green-40":"#069e08","--jp-green-50":"#008710","--jp-green-60":"#007117","--jp-green-70":"#005b18","--jp-green-80":"#004515","--jp-green-90":"#003010","--jp-green-100":"#001c09","--jp-green":"#069e08","--jp-green-primary":"var( --jp-green-40 )","--jp-green-secondary":"var( --jp-green-30 )"},i={"--jp-border-radius":"4px","--jp-menu-border-height":"1px","--jp-underline-thickness":"2px"},l={"--spacing-base":"8px"},p={},u=(e,t,r)=>{const n={...s,...o,...i,...l};for(const t in n)e.style.setProperty(t,n[t]);r&&e.classList.add(c.Z.global),t&&(p[t]={provided:!0,root:e})},d=({children:e=null,targetDom:t,id:r,withGlobalStyles:c=!0})=>{const s=(0,n.useRef)(),o=p?.[r]?.provided;return(0,n.useLayoutEffect)((()=>{if(!o)return t?u(t,r,c):void(s?.current&&u(s.current,r,c))}),[t,s,o,r,c]),t?a().createElement(a().Fragment,null,e):a().createElement("div",{ref:s},e)}},8709:(e,t,r)=>{"use strict";r.d(t,{X:()=>a});var n=r(9771);const a=()=>{const{l10n:{locale:e}}=(0,n.getSettings)();if(e)return(e=>{const t=e.match(/^([a-z]{2,3})(_[a-z]{2}|_[a-z][a-z0-9]{4,7})?(?:_.*)?$/i);return t?`${t[1]}${t[2]?t[2]:""}`.replace("_","-"):"en-US"})(e);return window?.window?.navigator?.language??"en-US"}},4153:(e,t,r)=>{"use strict";function n(e,t,r,n){const a=new URL("https://wordpress.com/checkout/"),c=new URL(`${a}${t}/${e}`);return c.searchParams.set("redirect_to",r),n||c.searchParams.set("unlinked","1"),c.searchParams.set("site",t),c.toString()}r.d(t,{Z:()=>n})},2497:(e,t,r)=>{"use strict";function n(){return window.Initial_State?.adminUrl||window.Jetpack_Editor_Initial_State?.adminUrl||window?.myJetpackInitialState?.adminUrl||null}r.d(t,{Z:()=>n})},6895:(e,t,r)=>{"use strict";function n(e,t={}){const r={};let n;if("undefined"!=typeof window&&(n=window?.JP_CONNECTION_INITIAL_STATE?.calypsoEnv),0===e.search("https://")){const t=new URL(e);e=`https://${t.host}${t.pathname}`,r.url=encodeURIComponent(e)}else r.source=encodeURIComponent(e);for(const e in t)r[e]=encodeURIComponent(t[e]);!Object.keys(r).includes("site")&&"undefined"!=typeof jetpack_redirects&&jetpack_redirects.hasOwnProperty("currentSiteRawUrl")&&(r.site=jetpack_redirects.currentBlogID??jetpack_redirects.currentSiteRawUrl),n&&(r.calypso_env=n);return"https://jetpack.com/redirect/?"+Object.keys(r).map((e=>e+"="+r[e])).join("&")}r.d(t,{Z:()=>n})},1132:(e,t,r)=>{let n={};try{n=r(8420)}catch{console.error("jetpackConfig is missing in your webpack config file. See @automattic/jetpack-config"),n={missingConfig:!0}}const a=e=>n.hasOwnProperty(e);e.exports={jetpackConfigHas:a,jetpackConfigGet:e=>{if(!a(e))throw'This app requires the "'+e+'" Jetpack Config to be defined in your webpack configuration file. See details in @automattic/jetpack-config package docs.';return n[e]}}},2458:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(5162),a=r.n(n),c=r(9196),s=r.n(c);const o=e=>{const{images:t,assetBaseUrl:r}=e;if(!t.length)return null;const n=t.map(((e,t)=>s().createElement(s().Fragment,{key:t},s().createElement("img",{src:r+e,alt:""}))));return s().createElement("div",{className:"jp-connection__connect-screen__image-slider"},n)};o.propTypes={images:a().arrayOf(a().string).isRequired,assetBaseUrl:a().string},o.defaultProps={assetBaseUrl:""};const i=o},8524:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(8868),a=r(5235),c=r.n(a),s=r(5162),o=r.n(s),i=r(9196),l=r.n(i),p=r(2458);r(9610);const u=e=>{const{title:t,children:r,className:a,assetBaseUrl:s,images:o,logo:i,rna:u=!1}=e,d=o?.length;return l().createElement("div",{className:c()("jp-connection__connect-screen-layout",d?"jp-connection__connect-screen-layout__two-columns":"",a?" "+a:"")},u&&l().createElement("div",{className:"jp-connection__connect-screen-layout__color-blobs"},l().createElement("div",{className:"jp-connection__connect-screen-layout__color-blobs__green"}),l().createElement("div",{className:"jp-connection__connect-screen-layout__color-blobs__yellow"}),l().createElement("div",{className:"jp-connection__connect-screen-layout__color-blobs__blue"})),l().createElement("div",{className:"jp-connection__connect-screen-layout__left"},i||l().createElement(n.Z,null),l().createElement("h2",null,t),r),d?l().createElement("div",{className:"jp-connection__connect-screen-layout__right"},l().createElement(p.Z,{images:o,assetBaseUrl:s})):null)};u.propTypes={title:o().string,className:o().string,images:o().arrayOf(o().string),assetBaseUrl:o().string,logo:o().element};const d=u},7710:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(5736),a=r(5162),c=r.n(a),s=r(9196),o=r.n(s),i=r(8258),l=r(1294),p=r(4082);const __=n.__,u=e=>{const{title:t,autoTrigger:r,buttonLabel:n,apiRoot:a,apiNonce:c,registrationNonce:s,from:u,redirectUri:d,children:m,priceBefore:g,priceAfter:h,pricingIcon:f,pricingTitle:v,pricingCurrencyCode:b,wpcomProductSlug:y,siteProductAvailabilityHandler:k,logo:E,rna:C=!1}=e,{handleRegisterSite:_,siteIsRegistering:j,userIsConnecting:S,registrationError:w,isOfflineMode:N}=(0,l.Z)({registrationNonce:s,redirectUri:d,apiRoot:a,apiNonce:c,autoTrigger:r,from:u}),x=y||"",{run:P,hasCheckoutStarted:Z}=(0,i.Z)({productSlug:x,redirectUrl:d,siteProductAvailabilityHandler:k,from:u}),R=Boolean(w),I=j||S||Z,O=x?P:_;return o().createElement(p.Z,{title:t,buttonLabel:n,priceBefore:g,priceAfter:h,pricingIcon:f,pricingTitle:v,pricingCurrencyCode:b,handleButtonClick:O,displayButtonError:R,buttonIsLoading:I,logo:E,isOfflineMode:N,rna:C},m)};u.propTypes={title:c().string,buttonLabel:c().string,apiRoot:c().string.isRequired,apiNonce:c().string.isRequired,registrationNonce:c().string.isRequired,from:c().string,redirectUri:c().string.isRequired,autoTrigger:c().bool,pricingTitle:c().string.isRequired,pricingIcon:c().oneOfType([c().string,c().element]),priceBefore:c().number.isRequired,priceAfter:c().number.isRequired,pricingCurrencyCode:c().string,wpcomProductSlug:c().string,checkSiteHasWpcomProduct:c().func,logo:c().element},u.defaultProps={title:__("Over 5 million WordPress sites are faster and more secure","jetpack-search-pkg"),buttonLabel:__("Set up Jetpack","jetpack-search-pkg"),pricingCurrencyCode:"USD",autoTrigger:!1};const d=u},4082:(e,t,r)=>{"use strict";r.d(t,{Z:()=>k});var n=r(7121),a=r(6895),c=r(4432),s=r(7325),o=r(9307),i=r(5736),l=r(5235),p=r.n(l),u=r(951),d=r.n(u),m=r(5162),g=r.n(m),h=r(9196),f=r.n(h),v=r(8524);r(2917);const __=i.__,b=d()("jetpack:connection:ConnectScreenRequiredPlanVisual"),y=e=>{const{title:t,buttonLabel:r,children:i,priceBefore:l,priceAfter:u,pricingIcon:d,pricingTitle:m,pricingCurrencyCode:g,isLoading:h,handleButtonClick:y,displayButtonError:k,buttonIsLoading:E,logo:C,isOfflineMode:_,rna:j=!1}=e;b("props are %o",e);const S=(0,o.createInterpolateElement)(__("Already have a subscription? <connectButton/>","jetpack-search-pkg"),{connectButton:f().createElement(n.Z,{label:__("Log in to get started","jetpack-search-pkg"),onClick:y,isLoading:E})}),w=_?(0,o.createInterpolateElement)(__("Unavailable in <a>Offline Mode</a>","jetpack-search-pkg"),{a:f().createElement("a",{href:(0,a.Z)("jetpack-support-development-mode"),target:"_blank",rel:"noopener noreferrer"})}):void 0;return f().createElement(v.Z,{title:t,className:p()("jp-connection__connect-screen-required-plan",h?"jp-connection__connect-screen-required-plan__loading":"",j?"rna":""),logo:C,rna:j},f().createElement("div",{className:"jp-connection__connect-screen-required-plan__content"},i,f().createElement("div",{className:"jp-connection__connect-screen-required-plan__pricing-card"},f().createElement(c.Z,{title:m,icon:d,priceBefore:l,currencyCode:g,priceAfter:u},f().createElement(s.Z,{agreeButtonLabel:r}),f().createElement(n.Z,{label:r,onClick:y,displayError:k||_,errorMessage:w,isLoading:E,isDisabled:_}))),!_&&f().createElement("div",{className:"jp-connection__connect-screen-required-plan__with-subscription"},S)))};y.propTypes={pricingTitle:g().string.isRequired,priceBefore:g().number.isRequired,priceAfter:g().number.isRequired,pricingCurrencyCode:g().string,title:g().string,buttonLabel:g().string,pricingIcon:g().oneOfType([g().string,g().element]),isLoading:g().bool,handleButtonClick:g().func,displayButtonError:g().bool,buttonIsLoading:g().bool,logo:g().element,isOfflineMode:g().bool},y.defaultProps={pricingCurrencyCode:"USD",isLoading:!1,buttonIsLoading:!1,displayButtonError:!1,handleButtonClick:()=>{}};const k=y},6186:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var n=r(2054),a=r(5033),c=r(5609),s=r(5736),o=r(5162),i=r.n(o),l=r(9196),p=r.n(l),u=r(9836);const __=s.__,d=e=>{const{message:t,isRestoringConnection:r,restoreConnectionCallback:o,restoreConnectionError:i}=e,[l]=(0,n.Z)(["md"],[">"]),d=u.Z.notice+(l?" "+u.Z["bigger-than-medium"]:""),m=p().createElement(c.Icon,{icon:p().createElement(c.SVG,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p().createElement(c.Path,{d:"M11.7815 4.93772C11.8767 4.76626 12.1233 4.76626 12.2185 4.93772L20.519 19.8786C20.6116 20.0452 20.4911 20.25 20.3005 20.25H3.69951C3.50889 20.25 3.3884 20.0452 3.48098 19.8786L11.7815 4.93772Z",stroke:"#D63638",strokeWidth:"1.5"}),p().createElement(c.Path,{d:"M13 10H11V15H13V10Z",fill:"#D63638"}),p().createElement(c.Path,{d:"M13 16H11V18H13V16Z",fill:"#D63638"}))});if(!t)return null;if(r)return p().createElement(c.Notice,{status:"error",isDismissible:!1,className:d},p().createElement("div",{className:u.Z.message},p().createElement(a.Z,{color:"#B32D2E",size:24}),__("Reconnecting Jetpack","jetpack-search-pkg")));const g=i?p().createElement(c.Notice,{status:"error",isDismissible:!1,className:d+" "+u.Z.error},p().createElement("div",{className:u.Z.message},m,(0,s.sprintf)(/* translators: placeholder is the error. */
__("There was an error reconnecting Jetpack. Error: %s","jetpack-search-pkg"),i))):null;return p().createElement(p().Fragment,null,g,p().createElement(c.Notice,{status:"error",isDismissible:!1,className:d},p().createElement("div",{className:u.Z.message},m,t),o&&p().createElement("a",{onClick:o,onKeyDown:o,className:u.Z.button,href:"#"},__("Restore Connection","jetpack-search-pkg"))))};d.propTypes={message:i().string.isRequired,restoreConnectionCallback:i().func,isRestoringConnection:i().bool,restoreConnectionError:i().string};const m=d},1294:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(4743),a=r(9818),c=r(9196),s=r(428);const o=window?.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},i=({registrationNonce:e=o.registrationNonce,apiRoot:t=o.apiRoot,apiNonce:r=o.apiNonce,redirectUri:i,autoTrigger:l,from:p,skipUserConnection:u}={})=>{const{registerSite:d,connectUser:m,refreshConnectedPlugins:g}=(0,a.useDispatch)(s.t),h=(0,a.useSelect)((e=>e(s.t).getRegistrationError())),{siteIsRegistering:f,userIsConnecting:v,userConnectionData:b,connectedPlugins:y,connectionErrors:k,isRegistered:E,isUserConnected:C,hasConnectedOwner:_,isOfflineMode:j}=(0,a.useSelect)((e=>({siteIsRegistering:e(s.t).getSiteIsRegistering(),userIsConnecting:e(s.t).getUserIsConnecting(),userConnectionData:e(s.t).getUserConnectionData(),connectedPlugins:e(s.t).getConnectedPlugins(),connectionErrors:e(s.t).getConnectionErrors(),isOfflineMode:e(s.t).getIsOfflineMode(),...e(s.t).getConnectionStatus()}))),S=()=>u?i?(window.location=i,Promise.resolve(i)):Promise.resolve():m({from:p,redirectUri:i}),w=t=>(t&&t.preventDefault(),E?S():d({registrationNonce:e,redirectUri:i}).then((()=>S())));return(0,c.useEffect)((()=>{n.ZP.setApiRoot(t),n.ZP.setApiNonce(r)}),[t,r]),(0,c.useEffect)((()=>{!l||f||v||w()}),[]),{handleRegisterSite:w,handleConnectUser:S,refreshConnectedPlugins:g,isRegistered:E,isUserConnected:C,siteIsRegistering:f,userIsConnecting:v,registrationError:h,userConnectionData:b,hasConnectedOwner:_,connectedPlugins:y,connectionErrors:k,isOfflineMode:j}}},7711:(e,t,r)=>{"use strict";function n(){switch("undefined"!=typeof window&&window?.JP_CONNECTION_INITIAL_STATE?.calypsoEnv){case"development":return"http://calypso.localhost:3000/";case"wpcalypso":return"https://wpcalypso.wordpress.com/";case"horizon":return"https://horizon.wordpress.com/";default:return"https://wordpress.com/"}}r.d(t,{Z:()=>n})},3329:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s,h:()=>o});var n=r(6186),a=r(1294),c=r(1045);function s(){const{connectionErrors:e}=(0,a.Z)({}),t=Object.values(e).shift(),r=t&&Object.values(t).length&&Object.values(t).shift().error_message;return{hasConnectionError:Boolean(r),connectionErrorMessage:r}}const o=()=>{const{hasConnectionError:e,connectionErrorMessage:t}=s(),{restoreConnection:r,isRestoringConnection:a,restoreConnectionError:o}=(0,c.Z)();return e?React.createElement(n.Z,{isRestoringConnection:a,restoreConnectionError:o,restoreConnectionCallback:r,message:t}):null}},8258:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});var n=r(4743),a=r(7711),c=r(9818),s=r(951),o=r.n(s),i=r(9196),l=r(1294),p=r(428);const u=o()("jetpack:connection:useProductCheckoutWorkflow"),{registrationNonce:d,apiRoot:m,apiNonce:g,siteSuffix:h}=window?.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},f="undefined"!=typeof window?window?.myJetpackInitialState?.adminUrl:null;function v({productSlug:e,redirectUrl:t,siteSuffix:r=h,adminUrl:s=f,connectAfterCheckout:o=!1,siteProductAvailabilityHandler:v=null,quantity:b=null,from:y,useBlogIdSuffix:k=!1}={}){u("productSlug is %s",e),u("redirectUrl is %s",t),u("siteSuffix is %s",r),u("from is %s",y);const[E,C]=(0,i.useState)(!1),{registerSite:_}=(0,c.useDispatch)(p.t),j=(0,c.useSelect)((e=>e(p.t).getBlogId()),[p.t]);u("blogID is %s",j??"undefined"),k=k&&!!j;const{isUserConnected:S,isRegistered:w,handleConnectUser:N}=(0,l.Z)({redirectUri:t,from:y}),x=(0,i.useMemo)((()=>{const n=(0,a.Z)(),c=(!w||!S)&&o,i=c?"checkout/jetpack/":`checkout/${k?j.toString():r}/`,l=new URL(`${n}${i}${e}${null!=b?`:-q-${b}`:""}`);return c?(l.searchParams.set("connect_after_checkout",!0),l.searchParams.set("admin_url",s),l.searchParams.set("from_site_slug",r)):l.searchParams.set("site",r),l.searchParams.set("source",y),l.searchParams.set("redirect_to",t),S||l.searchParams.set("unlinked","1"),l}),[w,S,o,r,b,e,y,t,s,k,j]);u("isRegistered is %s",w),u("isUserConnected is %s",S),u("connectAfterCheckout is %s",o),u("checkoutUrl is %s",x);const P=(e=null)=>Promise.resolve(v&&v()).then((t=>{if(e&&x.searchParams.set("redirect_to",e),t)return u("handleAfterRegistration: Site has a product associated"),N();u("handleAfterRegistration: Site does not have a product associated. Redirecting to checkout %s",x),window.location.href=x}));return(0,i.useEffect)((()=>{n.ZP.setApiRoot(m),n.ZP.setApiNonce(g)}),[]),{run:(e,r=null)=>(e&&e.preventDefault(),C(!0),o?((e=null)=>{e&&x.searchParams.set("redirect_to",e),u("Redirecting to connectAfterCheckout flow: %s",x),window.location.href=x})(r):w?P(r):void _({registrationNonce:d,redirectUri:t}).then(P)),isRegistered:w,hasCheckoutStarted:E}}},1045:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(4743),a=r(9818),c=r(9196),s=r(428);const{apiRoot:o,apiNonce:i}=window?.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{};function l(){const[e,t]=(0,c.useState)(!1),[r,l]=(0,c.useState)(null),{disconnectUserSuccess:p,setConnectionErrors:u}=(0,a.useDispatch)(s.t);return(0,c.useEffect)((()=>{n.ZP.setApiRoot(o),n.ZP.setApiNonce(i)}),[]),{restoreConnection:(e=!0)=>(t(!0),l(null),n.ZP.reconnect().then((t=>("in_progress"===t.status?(p(),u({}),e&&(window.location.href="/wp-admin/admin.php?page=my-jetpack#/connection")):window.location.reload(),t))).catch((e=>{throw l(e),t(!1),e}))),isRestoringConnection:e,restoreConnectionError:r}}},7523:(e,t,r)=>{"use strict";r.d(t,{LI:()=>c,N4:()=>o,Qo:()=>u,T1:()=>l,TS:()=>p,ZP:()=>C,b5:()=>m,i6:()=>a,qJ:()=>g,qV:()=>i,r7:()=>s,wQ:()=>d});var n=r(4743);const a="SET_CONNECTION_STATUS",c="SET_CONNECTION_STATUS_IS_FETCHING",s="SET_SITE_IS_REGISTERING",o="SET_USER_IS_CONNECTING",i="SET_REGISTRATION_ERROR",l="CLEAR_REGISTRATION_ERROR",p="SET_AUTHORIZATION_URL",u="DISCONNECT_USER_SUCCESS",d="SET_CONNECTED_PLUGINS",m="SET_CONNECTION_ERRORS",g="SET_IS_OFFLINE_MODE",h=e=>({type:a,connectionStatus:e}),f=e=>({type:s,isRegistering:e}),v=e=>({type:o,isConnecting:e}),b=e=>({type:i,registrationError:e}),y=()=>({type:l}),k=e=>({type:p,authorizationUrl:e}),E=e=>({type:d,connectedPlugins:e});const C={setConnectionStatus:h,setConnectionStatusIsFetching:e=>({type:c,isFetching:e}),fetchConnectionStatus:()=>({type:"FETCH_CONNECTION_STATUS"}),fetchAuthorizationUrl:e=>({type:"FETCH_AUTHORIZATION_URL",redirectUri:e}),setSiteIsRegistering:f,setUserIsConnecting:v,setRegistrationError:b,clearRegistrationError:y,setAuthorizationUrl:k,registerSite:function*({registrationNonce:e,redirectUri:t}){yield y(),yield f(!0);try{const r=yield{type:"REGISTER_SITE",registrationNonce:e,redirectUri:t};return yield h({isRegistered:!0}),yield k(r.authorizeUrl),yield f(!1),Promise.resolve(r)}catch(e){return yield b(e),yield f(!1),Promise.reject(e)}},connectUser:function*({from:e,redirectFunc:t,redirectUri:r}={}){yield v(!0),yield{type:"CONNECT_USER",from:e,redirectFunc:t,redirectUri:r}},disconnectUserSuccess:()=>({type:u}),setConnectedPlugins:E,refreshConnectedPlugins:()=>async({dispatch:e})=>await new Promise((t=>n.ZP.fetchConnectedPlugins().then((r=>{e(E(r)),t(r)})))),setConnectionErrors:e=>({type:m,connectionErrors:e}),setIsOfflineMode:e=>({type:g,isOfflineMode:e})}},1432:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(4743),a=r(9818),c=r(7057);const s={FETCH_AUTHORIZATION_URL:({redirectUri:e})=>n.ZP.fetchAuthorizationUrl(e),REGISTER_SITE:({registrationNonce:e,redirectUri:t})=>n.ZP.registerSite(e,t),CONNECT_USER:(0,a.createRegistryControl)((({resolveSelect:e})=>({from:t,redirectFunc:r,redirectUri:n}={})=>new Promise(((a,s)=>{e(c.Z).getAuthorizationUrl(n).then((e=>{const n=r||(e=>window.location.assign(e)),c=new URL(e);t&&c.searchParams.set("from",encodeURIComponent(t));const s=c.toString();n(s),a(s)})).catch((e=>{s(e)}))}))))}},1479:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(9818),a=r(7523);const c=(0,n.combineReducers)({connectionStatus:(e={},t)=>{switch(t.type){case a.i6:return{...e,...t.connectionStatus};case a.Qo:return{...e,isUserConnected:!1}}return e},connectionStatusIsFetching:(e=!1,t)=>t.type===a.LI?t.isFetching:e,siteIsRegistering:(e=!1,t)=>t.type===a.r7?t.isRegistering:e,userIsConnecting:(e=!1,t)=>t.type===a.N4?t.isConnecting:e,registrationError:(e,t)=>{switch(t.type){case a.T1:return!1;case a.qV:return t.registrationError;default:return e}},authorizationUrl:(e,t)=>t.type===a.TS?t.authorizationUrl:e,userConnectionData:(e,t)=>(t.type,e),connectedPlugins:(e={},t)=>t.type===a.wQ?t.connectedPlugins:e,connectionErrors:(e={},t)=>t.type===a.b5?t.connectionErrors:e,isOfflineMode:(e=!1,t)=>t.type===a.qJ?t.isConnecting:e})},7728:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(9818),a=r(7523),c=r(7057);const s={...{getAuthorizationUrl:{isFulfilled:(e,...t)=>{const r=Boolean(e.authorizationUrl),a=(0,n.select)(c.Z).hasFinishedResolution("getAuthorizationUrl",t);return r&&!a&&(0,n.dispatch)(c.Z).finishResolution("getAuthorizationUrl",t),r},*fulfill(e){const t=yield a.ZP.fetchAuthorizationUrl(e);yield a.ZP.setAuthorizationUrl(t.authorizeUrl)}}}}},2725:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={...{getConnectionStatus:e=>e.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:e=>e.siteIsRegistering||!1,getUserIsConnecting:e=>e.userIsConnecting||!1,getRegistrationError:e=>e.registrationError||!1,getAuthorizationUrl:e=>e.authorizationUrl||!1,getUserConnectionData:e=>e.userConnectionData||!1,getConnectedPlugins:e=>e.connectedPlugins||[],getConnectionErrors:e=>e.connectionErrors||[],getIsOfflineMode:e=>e.isOfflineMode||!1,getWpcomUser:e=>e?.userConnectionData?.currentUser?.wpcomUser,getBlogId:e=>e?.userConnectionData?.currentUser?.blogId}}},3535:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(9818);class a{static store=null;static mayBeInit(e,t){null===a.store&&(a.store=(0,n.createReduxStore)(e,t),(0,n.register)(a.store))}}const c=a},7057:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n="jetpack-connection"},428:(e,t,r)=>{"use strict";r.d(t,{t:()=>l.Z});var n=r(7523),a=r(1432),c=r(1479),s=r(7728),o=r(2725),i=r(3535),l=r(7057);const p=window.JP_CONNECTION_INITIAL_STATE;p||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),i.Z.mayBeInit(l.Z,{__experimentalUseThunks:!0,reducer:c.Z,actions:n.ZP,selectors:o.Z,resolvers:s.Z,controls:a.Z,initialState:p||{}})},4855:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(5235),a=r.n(n),c=r(6697),s=r.n(c),o=r(5844),i=r.n(o),l=r(9196),p=r.n(l);class u extends p().Component{static displayName="Button";static propTypes={disabled:i().bool,compact:i().bool,primary:i().bool,scary:i().bool,type:i().string,href:i().string,onClick:i().func,borderless:i().bool,className:i().string};static defaultProps={disabled:!1,type:"button",onClick:s(),borderless:!1};render(){const e=this.props.href?"a":"button",{primary:t,compact:r,scary:n,borderless:c,className:s,...o}=this.props,i=a()({"dops-button":!0,"is-compact":r,"is-primary":t,"is-scary":n,"is-borderless":c});return o.className=a()(s,i),p().createElement(e,o,this.props.children)}}},8195:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});r(2753);var n=r(7172),a=r(5235),c=r.n(a),s=r(2515),o=r.n(s),i=r(8520),l=r.n(i),p=r(5844),u=r.n(p),d=r(9196),m=r.n(d);class g extends m().Component{static propTypes={title:u().any,vertical:u().any,style:u().object,className:u().string,device:u().oneOf(["desktop","tablet","phone"])};static defaultProps={vertical:null};render(){return m().createElement("div",{className:c()("dops-card-section",this.props.className),style:this.props.style},this.props.title?this._renderWithTitle():this.props.children)}_renderWithTitle=()=>{const e="dops-card-section-orient-"+(this.props.vertical?"vertical":"horizontal");return m().createElement("div",{className:e},m().createElement("h4",{ref:"label",className:"dops-card-section-label"},this.props.title),m().createElement("div",{ref:"content",className:"dops-card-section-content"},this.props.children))}}class h extends m().Component{render(){return m().createElement("div",{className:"dops-card-footer"},this.props.children)}}class f extends m().Component{static propTypes={meta:u().any,icon:u().string,iconLabel:u().any,iconColor:u().string,style:u().object,className:u().string,href:u().string,onClick:u().func,title:u().string,tagName:u().string,target:u().string,compact:u().bool,children:u().node};static defaultProps={iconColor:"#787878",className:"",tagName:"div",onClick:()=>{}};render(){const e=c()("dops-card",this.props.className,{"is-card-link":!!this.props.href,"is-compact":this.props.compact}),t=["compact","tagName","meta","iconColor"];let r,a;return this.props.href?r=m().createElement(n.Z,{className:"dops-card__link-indicator",icon:this.props.target?"external":"chevron-right"}):t.push("href","target"),this.props.title&&(a=m().createElement("h2",{className:"dops-card-title"},this.props.title,this.props.meta&&m().createElement("span",{className:"dops-card-meta"},this.props.meta),(this.props.icon||this.props.iconLabel)&&this._renderIcon())),m().createElement(this.props.href?"a":this.props.tagName,o()(l()(this.props,t),{className:e}),r,a,this.props.children)}_renderIcon=()=>m().createElement("span",{className:"dops-card-icon",style:{color:this.props.iconColor}},this.props.icon&&m().createElement(n.Z,{icon:this.props.icon,style:{backgroundColor:this.props.iconColor}}),this.props.iconLabel)}f.Section=g,f.Footer=h;const v=f},2341:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var n=r(6975),a=r(4743),c=r(9818),s=r(8625),o=r(1164),i=r(3546),l=r(7011),p=r(9196),u=r.n(p),d=r(2897);function m(){const{isFullyConnected:e}=(0,l.Z)(),t=(0,c.useSelect)((e=>e(d.t).isNewPricing202208()),[]);return(0,p.useMemo)((()=>{const e=(0,c.select)(d.t).getAPIRootUrl(),t=(0,c.select)(d.t).getWpcomOriginApiUrl(),r=(0,c.select)(d.t).getAPINonce();e&&a.ZP.setApiRoot(e),t&&a.ZP.setWpcomOriginApiUrl(t),r&&a.ZP.setApiNonce(r),(()=>{const e=(0,c.select)(d.t).getWpcomUser(),t=(0,c.select)(d.t).getBlogId();e&&n.Z.initialize(e.ID,e.login,{blog_id:t})})(),n.Z.tracks.recordEvent("jetpack_search_admin_page_view",{current_version:(0,c.select)(d.t).getVersion()})}),[]),u().createElement(u().Fragment,null,!e&&!t&&u().createElement(s.Z,null),(e||t)&&u().createElement(g,null))}function g(){const{isFullyConnected:e}=(0,l.Z)();return u().createElement(u().Fragment,null,e&&u().createElement(h,null),!e&&u().createElement(i.Z,null))}function h(){(0,c.useSelect)((e=>e(d.t).getSearchPlanInfo()),[]);const e=(0,c.useSelect)((e=>e(d.t).supportsSearch())),t=(0,c.useSelect)((e=>e(d.t).isResolving("getSearchPlanInfo")||!e(d.t).hasStartedResolution("getSearchPlanInfo")));return u().createElement(u().Fragment,null,e&&u().createElement(o.Z,{isLoading:t}),!e&&u().createElement(i.Z,{isLoading:t}))}},6800:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v,u:()=>m});var n=r(2947),a=r(8275),c=r(3265),s=r(9665),o=r(526),i=r(7172),l=r(5736),p=r(9196),u=r.n(p);const __=l.__,d=__("Unlimited","jetpack-search-pkg"),m=e=>e>1e18?d:(0,n.Z)(e),g=(e,t)=>{e.preventDefault(),t()},h=({localizedMessage:e,iconClickedCallback:t})=>{const r="function"==typeof t;return u().createElement("div",{className:"donut-info-primary"},e," ",r&&u().createElement("a",{href:"#",className:"info-icon-wrapper",onClick:e=>{g(e,t)}},u().createElement(i.Z,{className:"",icon:"info-outline",size:16})))},f=({localizedMessage:e,linkClickedCallback:t})=>{const r="function"==typeof t;return u().createElement("div",{className:"donut-info-secondary"},e," ",r&&u().createElement("a",{href:"#",className:"info-link",onClick:e=>{g(e,t)}},__("View details","jetpack-search-pkg")))},v=({current:e=0,limit:t=1,title:r,tooltip:n,iconClickedCallback:i,linkClickedCallback:l})=>{const p=t>1e18,g=p?1:e,v=p?1:t,b=((e,t)=>t>1e18?0===e?d:`${m(e)} / ${d}`:`${m(e)} / ${m(t)}`)(e,t),y={popoverAnchorStyle:"wrapper",title:n.title,placement:"top",forceShow:n.forceShow};return u().createElement(a.ZP,null,u().createElement("div",{className:"donut-meter-container"},u().createElement("div",{className:"donut-meter-wrapper"},u().createElement(c.Z,{segmentCount:g,totalCount:v,useAdaptiveColors:!p}),u().createElement("div",{className:"upgrade-tooltip-shadow-anchor"},u().createElement(s.Z,y,u().createElement(u().Fragment,null,u().createElement("div",null,n.content),u().createElement("div",{className:"upgrade-tooltip-actions"},u().createElement("span",null,n.section),u().createElement(o.Z,{onClick:n.goToNext},n.next)))))),u().createElement("div",{className:"donut-info-wrapper"},u().createElement(h,{localizedMessage:r,iconClickedCallback:i}),u().createElement(f,{localizedMessage:b,linkClickedCallback:l}))))}},2668:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(2674),a=r.n(n),c=r(5235),s=r.n(c),o=r(6450),i=r(8520),l=r.n(i),p=r(9196),u=r.n(p);class d extends u().Component{static displayName="CompactFormToggle";render(){return u().createElement(o.Z,a()({},l()(this.props,"className"),{className:s()(this.props.className,"is-compact")}),this.props.children)}}},6450:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(5235),a=r.n(n),c=r(5844),s=r.n(c),o=r(9196),i=r.n(o);class l extends o.Component{static propTypes={onChange:s().func,onKeyDown:s().func,checked:s().bool,disabled:s().bool,id:s().string,className:s().string,toggling:s().bool,"aria-label":s().string,children:s().node,disabledReason:s().node,switchClassNames:s().string,labelClassNames:s().string};static defaultProps={checked:!1,disabled:!1,onKeyDown:()=>{},onChange:()=>{},disabledReason:""};state={};static idNum=0;constructor(){super(...arguments),this.onKeyDown=this.onKeyDown.bind(this),this.onClick=this.onClick.bind(this),this.onLabelClick=this.onLabelClick.bind(this)}UNSAFE_componentWillMount(){this.id=this.constructor.idNum++}onKeyDown(e){this.props.disabled||("Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.props.onChange()),this.props.onKeyDown(e))}onClick(){this.props.disabled||this.props.onChange()}onLabelClick(e){if(this.props.disabled)return;const t=e.target.nodeName.toLowerCase();"a"!==t&&"input"!==t&&"select"!==t&&(e.preventDefault(),this.props.onChange())}render(){const e=this.props.id||"toggle-"+this.id,t=a()("form-toggle",this.props.className,{"is-toggling":this.props.toggling});return i().createElement(o.Fragment,null,i().createElement("div",{className:a()("form-toggle__switch-container",this.props.switchClassNames)},i().createElement("input",{className:t,type:"checkbox",checked:this.props.checked,readOnly:!0,disabled:this.props.disabled}),i().createElement("span",{className:a()("form-toggle__switch",this.props.switchClassNames),disabled:this.props.disabled,id:e,onClick:this.onClick,onKeyDown:this.onKeyDown,role:"checkbox","aria-checked":this.props.checked,"aria-label":this.props["aria-label"],tabIndex:this.props.disabled?-1:0,ref:"toggleSwitch"})),i().createElement("label",{className:a()("form-toggle__label",this.props.labelClassNames),htmlFor:e},i().createElement("span",{className:a()("form-toggle__label-content",this.props.labelClassNames),onClick:this.onLabelClick},this.props.children)))}}},9268:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(4034),a=r(8448),c=r(9196),s=r.n(c);function o(e={handleLocalNoticeDismissClick:null,notices:Object.freeze([])}){const t=e.notices.map((function(t){const r=t=>()=>{t&&e.handleLocalNoticeDismissClick(t.id)};return s().createElement(n.Z,{key:"notice-"+t.id,status:t.status,duration:t.duration||null,text:t.text,isCompact:t.isCompact,onDismissClick:r(t),showDismiss:t.showDismiss},t.button&&s().createElement(a.Z,{href:t.href,onClick:r(t)},t.button))}));return t.length?s().createElement("div",{id:e.id,className:"global-notices"},t):null}},3459:(e,t,r)=>{"use strict";r.d(t,{Iz:()=>m,MQ:()=>g,RT:()=>p,ZP:()=>h,b3:()=>s,mF:()=>o,tF:()=>u});var n=r(5736),a=r(5348),c=r.n(a);const __=n.__,s="CREATE_NOTICE",o="REMOVE_NOTICE";function i(e,t,r={}){const n={id:r.id||c()(),duration:r.duration??2e3,showDismiss:"boolean"!=typeof r.showDismiss||r.showDismiss,isPersistent:r.isPersistent||!1,displayOnNextPage:r.displayOnNextPage||!1,status:e,text:t};return{type:s,notice:n}}function l(e){return{type:o,notice:{id:e}}}const p=i.bind(null,"is-success"),u=i.bind(null,"is-error"),d=(i.bind(null,"is-info"),i.bind(null,"is-warning")),m=(e=__("Updating settings","jetpack-search-pkg"))=>i("is-info",e,{duration:3e4,id:"search-updating-settings"}),g=()=>l("search-updating-settings"),h={createNotice:i,removeNotice:l,successNotice:p,errorNotice:u,warningNotice:d,updatingNotice:m,removeUpdatingNotice:g}},2963:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(3459);const a=(e={notices:[]},t)=>{switch(t.type){case n.b3:return{...e,notices:[...e.notices,t.notice]};case n.mF:return{...e,notices:e.notices.filter((e=>e.id!==t.notice.id))}}return e}},5260:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={getNotices:e=>e.notices.notices??[]}},7430:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5033),a=r(9196),c=r.n(a);function s(){return c().createElement(n.Z,{className:"jp-search-dashboard-page-loading-spinner",color:"#000",size:32})}},943:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(9196),a=r.n(n),c=r(7387),s=r(24);function o({supportsInstantSearch:e=!0,supportsOnlyClassicSearch:t=!1}){const r=t&&!e;return a().createElement(n.Fragment,null,r&&a().createElement(s.Z,null),!r&&a().createElement(c.Z,null))}},7387:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(7172),a=r(5736),c=r(9196),s=r.n(c),o=r(6332);const __=a.__;function i(){return s().createElement("div",{className:"jp-mocked-instant-search","aria-hidden":"true"},s().createElement("div",{className:"jp-mocked-instant-search__search-controls"},s().createElement("div",{className:"jp-mocked-instant-search__search-icon"},s().createElement(n.Z,{icon:"search",size:24})),s().createElement("div",{className:"jp-mocked-instant-search__search-mock-input"},s().createElement(o.Z,{style:{height:"50px",width:"80%",maxWidth:"212px"}})),s().createElement("div",{className:"jp-mocked-instant-search__close-button"},s().createElement(n.Z,{icon:"cross",size:24}))),s().createElement("div",{className:"jp-mocked-instant-search__search-results"},s().createElement("div",{className:"jp-mocked-instant-search__search-results-primary"},s().createElement("div",{className:"jp-mocked-instant-search__search-results-header"},s().createElement("div",{className:"jp-mocked-instant-search__result-statistics"},/* translators: %s is replaced with the number of search results */ /* translators: %s is replaced with the number of search results */
(0,a.sprintf)(__("Found %s results","jetpack-search-pkg"),"27")),s().createElement("div",{className:"jp-mocked-instant-search__result-sort-list"},s().createElement("span",{className:"jp-mocked-instant-search__result-sort-selected"},__("Relevance","jetpack-search-pkg")),s().createElement("span",null,""),s().createElement("span",null,__("Newest","jetpack-search-pkg")),s().createElement("span",null,""),s().createElement("span",null,__("Oldest","jetpack-search-pkg")))),s().createElement("div",{className:"jp-mocked-instant-search__search-results-content"},s().createElement(p,null),s().createElement(p,null),s().createElement(p,null))),s().createElement("div",{className:"jp-mocked-instant-search__search-results-secondary"},s().createElement("div",{className:"jp-mocked-instant-search__search-filter-header"},__("Filter options","jetpack-search-pkg")),s().createElement("div",{className:"jp-mocked-instant-search__search-filter-list"},s().createElement(l,null),s().createElement(l,null)))))}const l=()=>s().createElement("div",{className:"jp-mocked-instant-search__search-filter"},s().createElement("label",null,s().createElement("input",{type:"checkbox",disabled:"disabled"})," ",s().createElement(o.Z,{style:{width:"30%"}}))),p=()=>s().createElement("div",{className:"jp-mocked-instant-search__search-result"},s().createElement(o.Z,{style:{height:"2.5em",width:"50%",maxWidth:"200px",margin:"0.1em 0.1em 1em 0.1em"}}),s().createElement(o.Z,{style:{height:"1em",width:"90%",margin:"0.1em"}}),s().createElement(o.Z,{style:{height:"1em",width:"70%",margin:"0.1em"}}))},24:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(7172),a=r(9196),c=r.n(a),s=r(6332);function o(){return c().createElement("div",{className:"jp-mocked-legacy-search","aria-hidden":"true"},c().createElement("div",{className:"jp-mocked-legacy-search__search-controls"},c().createElement("div",{className:"jp-mocked-legacy-search__search-icon"},c().createElement(n.Z,{icon:"search",size:24})),c().createElement("div",{className:"jp-mocked-legacy-search__search-input"},c().createElement(s.Z,{style:{height:"50px",width:"80%",maxWidth:"212px"}}))))}},6332:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(9196),a=r.n(n);const c=e=>a().createElement("div",{className:"jp-search-dashboard__text-row-placeholder",style:{display:"inline-block",borderRadius:"10px",maxHeight:"1.5em",width:"100%",height:"1em",backgroundColor:"#E9EFF3",...e.style}})},2794:(e,t,r)=>{"use strict";r.d(t,{Z:()=>E});var n=r(6975),a=r(4153),c=r(1294),s=r(9818),o=r(9307),i=r(5736),l=r(5235),p=r.n(l),u=r(4855),d=r(8195),m=r(2668),g=r(7436),h=r(9196),f=r.n(h),v=r(2897);const __=i.__,b=__("Jetpack Search is an incredibly powerful and customizable replacement for the search capability built into WordPress that helps your visitors find the right content.","jetpack-search-pkg"),y=__("Instant search uses a dynamic overlay for lightning-fast searching, sorting, and filtering without reloading the page.","jetpack-search-pkg"),k="admin.php?page=jetpack-search";function E({siteAdminUrl:e,updateOptions:t,domain:r,isDisabledFromOverLimit:o,isSavingEitherOption:i,isModuleEnabled:l,isInstantSearchEnabled:u,isInstantSearchPromotionActive:m,supportsOnlyClassicSearch:g,supportsSearch:b,supportsInstantSearch:y,isTogglingModule:E,isTogglingInstantSearch:_}){const{isUserConnected:S}=(0,c.Z)({redirectUri:"admin.php?page=jetpack-search",from:"jetpack-search"}),w=(0,s.useSelect)((e=>e(v.t).isWpcom()),[]),N=(0,a.Z)("jetpack_search_free",r,"admin.php?page=jetpack-search",S||w),x=(0,h.useCallback)((()=>{if(o)return;const e={module_active:!l};u!==!l&&(e.instant_search_enabled=!l&&y),t(e),n.Z.tracks.recordEvent("jetpack_search_module_toggle",e)}),[y,l,t,u,o]),P=(0,h.useCallback)((()=>{if(o)return;const e={instant_search_enabled:y&&!u};e.instant_search_enabled&&(e.module_active=!0),t(e),n.Z.tracks.recordEvent("jetpack_search_instant_toggle",e)}),[y,u,t,o]);return f().createElement("div",{className:p()({"jp-form-settings-group jp-form-search-settings-group":!0,"jp-form-search-settings-group--disabled":o})},f().createElement(d.Z,{className:p()({"jp-form-has-child":!0})},f().createElement("div",{className:"jp-form-search-settings-group-inside"},f().createElement(j,{isModuleEnabled:l,isSavingEitherOption:i,isTogglingModule:E,supportsSearch:b,toggleSearchModule:x,isDisabledFromOverLimit:o}),f().createElement(C,{isInstantSearchEnabled:u,isInstantSearchPromotionActive:m,isModuleEnabled:l,isSavingEitherOption:i,isTogglingInstantSearch:_,returnUrl:e+k,supportsInstantSearch:y,supportsOnlyClassicSearch:g,toggleInstantSearch:P,upgradeUrl:N,isDisabledFromOverLimit:o}))))}const C=({isInstantSearchEnabled:e,isInstantSearchPromotionActive:t,isSavingEitherOption:r,isModuleEnabled:n,isTogglingInstantSearch:a,returnUrl:c,supportsInstantSearch:s,supportsOnlyClassicSearch:i,toggleInstantSearch:l,upgradeUrl:p,isDisabledFromOverLimit:u})=>{const d=n&&e&&s&&!u,v=r||!s||u,b=r||!n||!e||!s||u,k=r||!n||u;return f().createElement("div",{className:"jp-form-search-settings-group__toggle is-instant-search jp-search-dashboard-wrap"},f().createElement("div",{className:"jp-search-dashboard-row"},f().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"}),f().createElement(m.Z,{checked:d,disabled:v,onChange:l,toggling:a,className:"is-search-admin",switchClassNames:"lg-col-span-1 md-col-span-1 sm-col-span-1",labelClassNames:" lg-col-span-7 md-col-span-5 sm-col-span-3","aria-label":__("Enable instant search experience (recommended)","jetpack-search-pkg")},(0,o.createInterpolateElement)(__("Enable instant search experience <span>(recommended)</span>","jetpack-search-pkg"),{span:f().createElement("span",null)}))),f().createElement("div",{className:"jp-search-dashboard-row"},f().createElement("div",{className:"lg-col-span-3 md-col-span-2 sm-col-span-1"}),f().createElement("div",{className:"jp-form-search-settings-group__toggle-description lg-col-span-7 md-col-span-5 sm-col-span-3"},s&&f().createElement(h.Fragment,null,f().createElement("p",{className:"jp-form-search-settings-group__toggle-explanation"},y)),!s&&t&&f().createElement(g.Z,{href:p,upgrade:i})),f().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"})),s&&f().createElement(_,{isInstantSearchCustomizeButtonDisabled:b,isWidgetsEditorButtonDisabled:k,returnUrl:c}))},_=({isInstantSearchCustomizeButtonDisabled:e,isWidgetsEditorButtonDisabled:t,returnUrl:r})=>f().createElement("div",{className:"jp-form-search-settings-group-buttons jp-search-dashboard-row"},f().createElement("div",{className:"lg-col-span-3 md-col-span-2 sm-col-span-1"}),f().createElement(u.Z,{className:"jp-form-search-settings-group-buttons__button is-customize-search lg-col-span-4 md-col-span-5 sm-col-span-3",href:e?void 0:(0,i.sprintf)("admin.php?page=jetpack-search-configure",encodeURIComponent(r)),disabled:e},f().createElement("span",null,__("Customize search results","jetpack-search-pkg"))),f().createElement("div",{className:"lg-col-span-0 md-col-span-1 sm-col-span-0"}),f().createElement("div",{className:"lg-col-span-0 md-col-span-2 sm-col-span-1"}),f().createElement(u.Z,{className:"jp-form-search-settings-group-buttons__button is-widgets-editor lg-col-span-3 md-col-span-5 sm-col-span-3",href:t?void 0:(0,i.sprintf)("widgets.php",encodeURIComponent(r)),disabled:t},f().createElement("span",null,__("Edit sidebar widgets","jetpack-search-pkg"))),f().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"})),j=({isModuleEnabled:e,isSavingEitherOption:t,isTogglingModule:r,supportsSearch:n,toggleSearchModule:a,isDisabledFromOverLimit:c})=>{const s=e&&n&&!c,o=t||!n||c;return f().createElement("div",{className:"jp-form-search-settings-group__toggle is-search jp-search-dashboard-wrap"},f().createElement("div",{className:"jp-search-dashboard-row"},f().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"}),f().createElement(m.Z,{checked:s,disabled:o,onChange:a,toggling:r,className:"is-search-admin",switchClassNames:"lg-col-span-1 md-col-span-1 sm-col-span-1",labelClassNames:" lg-col-span-7 md-col-span-5 sm-col-span-3","aria-label":__("Enable Jetpack Search","jetpack-search-pkg")},__("Enable Jetpack Search","jetpack-search-pkg")),f().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"})),f().createElement("div",{className:"jp-search-dashboard-row"},f().createElement("div",{className:"lg-col-span-3 md-col-span-2 sm-col-span-1"}),f().createElement("div",{className:"jp-form-search-settings-group__toggle-description lg-col-span-7 md-col-span-5 sm-col-span-3"},f().createElement("p",{className:"jp-form-search-settings-group__toggle-explanation"},b)),f().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"})))}},4034:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(7172),a=r(5235),c=r.n(a),s=r(6697),o=r.n(s),i=r(5844),l=r.n(i),p=r(9196),u=r.n(p);class d extends u().Component{static displayName="SimpleNotice";static defaultProps={duration:0,status:null,showDismiss:!0,className:"",onDismissClick:o()};static propTypes={status:l().string,showDismiss:l().bool,isCompact:l().bool,duration:l().number,text:l().oneOfType([l().oneOfType([l().string,l().node]),l().arrayOf(l().oneOfType([l().string,l().node]))]),icon:l().string,onDismissClick:l().func,className:l().string};dismissTimeout=null;componentDidMount(){this.props.duration>0&&(this.dismissTimeout=setTimeout(this.props.onDismissClick,this.props.duration))}componentWillUnmount(){this.dismissTimeout&&clearTimeout(this.dismissTimeout)}getIcon=()=>{let e;switch(this.props.status){case"is-info":default:e="info";break;case"is-success":e="checkmark";break;case"is-error":case"is-warning":e="notice"}return e};clearText=e=>"string"==typeof e?e.replace(/(<([^>]+)>)/gi,""):e;onKeyDownCallback=e=>t=>{13!==t.which&&32!==t.which||e&&e(t)};render(){const{children:e,className:t,icon:r,isCompact:a,onDismissClick:s,showDismiss:o=!a,status:i,text:l,dismissText:p}=this.props,d=c()("dops-notice",i,t,{"is-compact":a,"is-dismissable":o});return u().createElement("div",{className:d},u().createElement("span",{className:"dops-notice__icon-wrapper"},u().createElement(n.Z,{className:"dops-notice__icon",icon:r||this.getIcon(),size:24})),u().createElement("span",{className:"dops-notice__content"},u().createElement("span",{className:"dops-notice__text"},l?this.clearText(l):e)),l?e:null,o&&u().createElement("span",{role:"button",onKeyDown:this.onKeyDownCallback(s),tabIndex:"0",className:"dops-notice__dismiss",onClick:s},u().createElement(n.Z,{icon:"cross",size:24}),u().createElement("span",{className:"dops-notice__screen-reader-text screen-reader-text"},p)))}}},8448:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(7172),a=r(5844),c=r.n(a),s=r(9196),o=r.n(s);class i extends o().Component{static displayName="NoticeAction";static propTypes={href:c().string,onClick:c().func,external:c().bool,icon:c().string};static defaultProps={external:!1};render(){const e={className:"dops-notice__action",href:this.props.href,onClick:this.props.onClick};return this.props.external&&(e.target="_blank"),o().createElement("a",e,o().createElement("span",null,this.props.children),this.props.icon&&o().createElement(n.Z,{icon:this.props.icon,size:24}),this.props.external&&o().createElement(n.Z,{icon:"external",size:24}))}}},8625:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(216),a=r(3363),c=r(3846),s=r(6895),o=r(7710),i=r(9818),l=r(5736),p=r(7430),u=r(6204),d=r(9196),m=r.n(d),g=r(2897);const __=l.__;function h({isLoading:e=!1}){(0,i.useSelect)((e=>e(g.t).getSearchPricing()),[]);const t=(0,i.useSelect)((t=>t(g.t).isResolving("getSearchPricing")||!t(g.t).hasStartedResolution("getSearchPricing")||e),[e]);return m().createElement(m().Fragment,null,t&&m().createElement(p.Z,null),!t&&m().createElement("div",{className:"jp-search-dashboard-connection-screen"},m().createElement(n.Z,null,m().createElement(a.Z,{horizontalSpacing:3,horizontalGap:3},m().createElement(c.Z,{lg:12,md:8,sm:4},m().createElement(v,null)),m().createElement(c.Z,{lg:12,md:8,sm:4},m().createElement(f,null))))))}const f=()=>m().createElement("div",{className:"jp-search-dashboard-connection-footer"},m().createElement("p",{className:"jp-search-dashboard-connection-footer__text"},__("Special introductory pricing, all renewals are at full price. 14 day money back guarantee.","jetpack-search-pkg")),m().createElement("p",{className:"jp-search-dashboard-connection-footer__text"},"*"," ",__("Pricing will automatically adjust based on the number of records in your search index.","jetpack-search-pkg")," ",m().createElement("a",{href:(0,s.Z)("search-product-pricing"),className:"jp-search-dashboard-connection-footer__link"},__("Learn more","jetpack-search-pkg")))),v=()=>{const e=(0,i.useSelect)((e=>e(g.t).getAPINonce()),[]),t=(0,i.useSelect)((e=>e(g.t).getAPIRootUrl()),[]),r=(0,i.useSelect)((e=>e(g.t).getPriceBefore()),[]),n=(0,i.useSelect)((e=>e(g.t).getPriceAfter()),[]),a=(0,i.useSelect)((e=>e(g.t).getPriceCurrencyCode()),[]),c=(0,i.useSelect)((e=>e(g.t).getRegistrationNonce()),[]),{fetchSearchPlanInfo:s}=(0,i.useDispatch)(g.t),l=(0,d.useCallback)((()=>s().then((e=>e?.supports_search))),[s]);return m().createElement(o.Z,{buttonLabel:__("Get Jetpack Search","jetpack-search-pkg"),priceAfter:n/12,priceBefore:r/12,pricingCurrencyCode:a,pricingIcon:"data:image/svg+xml,%3Csvg width='32' height='32' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M21 19l-5.154-5.154C16.574 12.742 17 11.42 17 10c0-3.866-3.134-7-7-7s-7 3.134-7 7 3.134 7 7 7c1.42 0 2.742-.426 3.846-1.154L19 21l2-2zM5 10c0-2.757 2.243-5 5-5s5 2.243 5 5-2.243 5-5 5-5-2.243-5-5z' fill='%23000'/%3E%3C/svg%3E",pricingTitle:__("Jetpack Search","jetpack-search-pkg"),title:__("The best WordPress search experience","jetpack-search-pkg"),apiRoot:t,apiNonce:e,registrationNonce:c,from:"jetpack-search",redirectUri:"admin.php?page=jetpack-search",wpcomProductSlug:"jetpack_search",siteProductAvailabilityHandler:l},m().createElement(u.Z,null))}},1164:(e,t,r)=>{"use strict";r.d(t,{Z:()=>C});var n=r(4153),a=r(3363),c=r(3846),s=r(8237),o=r(9344),i=r(526),l=r(3329),p=r(9818),u=r(5736),d=r(9268),m=r(7430),g=r(943),h=r(2794),f=r(8904),v=r(9196),b=r.n(v),y=r(2897),k=r(2891),E=r(1324);const __=u.__;function C({isLoading:e=!1}){(0,p.useSelect)((e=>e(y.t).getSearchPlanInfo()),[]),(0,p.useSelect)((e=>e(y.t).getSearchModuleStatus()),[]),(0,p.useSelect)((e=>e(y.t).getSearchStats()),[]);const t=(0,p.useSelect)((e=>e(y.t).getCalypsoSlug())),r=(0,p.useSelect)((e=>e(y.t).getBlogId())),s=(0,p.useSelect)((e=>e(y.t).getSiteAdminUrl())),{hasConnectionError:o}=(0,l.Z)(),i=()=>{const e=(0,n.Z)("jetpack_search",r??t,"admin.php?page=jetpack-search&just_upgraded=1",!0);window.location.href=e},u=(0,p.useSelect)((t=>t(y.t).isResolving("getSearchModuleStatus")||!t(y.t).hasStartedResolution("getSearchModuleStatus")||t(y.t).isResolving("getSearchStats")||!t(y.t).hasStartedResolution("getSearchStats")||t(y.t).isResolving("getSearchPlanInfo")||!t(y.t).hasStartedResolution("getSearchPlanInfo")||e),[e]),g=(0,p.useSelect)((e=>e(y.t).isNewPricing202208()),[]),v=(0,p.useSelect)((e=>e(y.t).isFreePlan())),k=(0,p.useSelect)((e=>e(y.t).isOverLimit())),E=(0,p.useDispatch)(y.t).updateJetpackSettings,C=(0,p.useSelect)((e=>e(y.t).isInstantSearchPromotionActive())),N=(0,p.useSelect)((e=>e(y.t).supportsOnlyClassicSearch())),x=(0,p.useSelect)((e=>e(y.t).supportsSearch())),P=(0,p.useSelect)((e=>e(y.t).supportsInstantSearch())),Z=(0,p.useSelect)((e=>e(y.t).isModuleEnabled())),R=(0,p.useSelect)((e=>e(y.t).isInstantSearchEnabled())),I=(0,p.useSelect)((e=>e(y.t).isUpdatingJetpackSettings())),O=(0,p.useSelect)((e=>e(y.t).isTogglingModule())),T=(0,p.useSelect)((e=>e(y.t).isTogglingInstantSearch())),M=(0,p.useSelect)((e=>e(y.t).getTierMaximumRecords())),A=(0,p.useSelect)((e=>e(y.t).getPostCount())),U=(0,p.useSelect)((e=>e(y.t).getPostTypeBreakdown())),D=(0,p.useSelect)((e=>e(y.t).getLastIndexedDate())),L=(0,p.useSelect)((e=>e(y.t).getPostTypes())),z=(0,p.useDispatch)(y.t).removeNotice,F=(0,p.useSelect)((e=>e(y.t).getNotices()),[]),B={lastIndexedDate:D,postCount:A,postTypeBreakdown:U,postTypes:L,tierMaximumRecords:M};return b().createElement(b().Fragment,null,b().createElement(a.Z,{horizontalSpacing:0},b().createElement(c.Z,null,b().createElement("div",{id:"jp-admin-notices",className:"jetpack-search-jitm-card"}))),u&&b().createElement(m.Z,null),!u&&b().createElement("div",{className:"jp-search-dashboard-page"},b().createElement(w,{isUpgradable:g&&v||!P,sendPaidPlanToCart:i}),o&&b().createElement(a.Z,{horizontalSpacing:3,horizontalGap:3},b().createElement(c.Z,{lg:12,md:12,sm:12},b().createElement(l.h,null))),b().createElement(j,{supportsInstantSearch:P,supportsOnlyClassicSearch:N}),g&&P&&b().createElement(_,{hasIndex:0!==A,recordMeterInfo:B,isFreePlan:v,sendPaidPlanToCart:i}),!g&&P&&b().createElement(f.Z,{postCount:A,postTypeBreakdown:U,tierMaximumRecords:M,lastIndexedDate:D,postTypes:L}),b().createElement("div",{className:"jp-search-dashboard-bottom"},b().createElement(h.Z,{siteAdminUrl:s,updateOptions:E,domain:t,isDisabledFromOverLimit:k,isInstantSearchPromotionActive:C,supportsOnlyClassicSearch:N,supportsSearch:x,supportsInstantSearch:P,isModuleEnabled:Z,isInstantSearchEnabled:R,isSavingEitherOption:I,isTogglingModule:O,isTogglingInstantSearch:T})),b().createElement(S,null),b().createElement(d.Z,{notices:F,handleLocalNoticeDismissClick:z})))}const _=({hasIndex:e,recordMeterInfo:t,isFreePlan:r,sendPaidPlanToCart:n})=>{const a=(0,p.useSelect)((e=>e(y.t).getSiteTitle()))||"your site",c={currentPlan:(0,p.useSelect)((e=>e(y.t).getCurrentPlan())),currentUsage:(0,p.useSelect)((e=>e(y.t).getCurrentUsage())),latestMonthRequests:(0,p.useSelect)((e=>e(y.t).getLatestMonthRequests())),isFreePlan:r},s=(0,p.useSelect)((e=>e(y.t).isPlanJustUpgraded()),[]);return b().createElement(b().Fragment,null,!e&&b().createElement(k.Z,{siteTitle:a,planInfo:c}),e&&b().createElement(b().Fragment,null,b().createElement(E.Z,{isFreePlan:r,isPlanJustUpgraded:s,planInfo:c,sendPaidPlanToCart:n}),b().createElement(f.Z,{postCount:t.postCount,postTypeBreakdown:t.postTypeBreakdown,tierMaximumRecords:t.tierMaximumRecords,lastIndexedDate:t.lastIndexedDate,postTypes:t.postTypes})))},j=({supportsInstantSearch:e,supportsOnlyClassicSearch:t})=>b().createElement("div",{className:"jp-search-dashboard-top jp-search-dashboard-wrap"},b().createElement("div",{className:"jp-search-dashboard-row"},b().createElement("div",{className:"jp-search-dashboard-top__title lg-col-span-6 md-col-span-7 sm-col-span-4"},b().createElement("h1",null,__("Help your visitors find exactly what they're looking for, fast","jetpack-search-pkg"))),b().createElement("div",{className:" lg-col-span-6 md-col-span-1 sm-col-span-0"})),b().createElement("div",{className:"jp-search-dashboard-row","aria-hidden":"true"},b().createElement("div",{className:"lg-col-span-1 md-col-span-1 sm-col-span-0"}),b().createElement("div",{className:"jp-search-dashboard-top__mocked-search-interface lg-col-span-10 md-col-span-6 sm-col-span-4"},b().createElement(g.Z,{supportsInstantSearch:e,supportsOnlyClassicSearch:t})),b().createElement("div",{className:"lg-col-span-1 md-col-span-1 sm-col-span-0"}))),S=()=>b().createElement("div",{className:"jp-search-dashboard-footer jp-search-dashboard-wrap"},b().createElement("div",{className:"jp-search-dashboard-row"},b().createElement(s.Z,{moduleName:__("Jetpack Search","jetpack-search-pkg"),className:"lg-col-span-12 md-col-span-8 sm-col-span-4"}))),w=({isUpgradable:e,sendPaidPlanToCart:t})=>{const r={children:__("Upgrade Jetpack Search","jetpack-search-pkg"),variant:"link",onClick:t};return b().createElement("div",{className:"jp-search-dashboard-header jp-search-dashboard-wrap"},b().createElement("div",{className:"jp-search-dashboard-row"},b().createElement("div",{className:"lg-col-span-12 md-col-span-8 sm-col-span-4"},b().createElement("div",{className:"jp-search-dashboard-header__logo-container"},b().createElement(o.Z,{className:"jp-search-dashboard-header__masthead"}),e&&b().createElement(i.Z,r)))))}},2891:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(8275),a=r(9184),c=r(5736),s=r(4034),o=r(9196),i=r.n(o),l=r(8137);const __=c.__,p=({siteTitle:e})=>i().createElement("div",null,i().createElement("h3",null,(0,c.sprintf)(
// translators: %1$s: site name (not translated)
__("Indexing %1$s","jetpack-search-pkg"),e)),i().createElement(n.ZP,null,i().createElement(a.Z,null))),u=()=>{const e=__("We're gathering your usage data.","jetpack-search-pkg"),t=__("If you have recently set up Search, please allow a little time for indexing to complete.","jetpack-search-pkg");return i().createElement(s.Z,{isCompact:!1,status:"is-info",className:"jp-search-notice-box",icon:"info-outline",showDismiss:!1},i().createElement("h3",{className:"dops-notice__header"},e),i().createElement("span",{className:"dops-notice__body"},t))},d=({planInfo:e,siteTitle:t})=>i().createElement("div",{className:"jp-search-dashboard-wrap jp-search-dashboard-meter-wrap"},i().createElement("div",{className:"jp-search-dashboard-row"},i().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"}),i().createElement("div",{className:"jp-search-dashboard-meter-wrap__content lg-col-span-8 md-col-span-6 sm-col-span-4"},i().createElement(l.Z,{planInfo:e}),i().createElement(p,{siteTitle:t}),i().createElement(u,null)),i().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"})))},8137:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5736),a=r(9196),c=r.n(a);const __=n.__,s=({isFreePlan:e,planInfo:t})=>c().createElement("h2",null,
// translators: Header for section showing search records and requests usage.
__("Your usage","jetpack-search-pkg")," ",c().createElement("span",null,(e=>{const t=new Date(e.latestMonthRequests.start_date),r=new Date(e.latestMonthRequests.end_date),n={month:"short",day:"2-digit"};return`${t.toLocaleDateString(void 0,n)} - ${r.toLocaleDateString(void 0,n)}`})(t)," (",(e=>{const t=__("Upgraded","jetpack-search-pkg"),r=__("Free plan","jetpack-search-pkg");return e?r:t})(e),")"))},1324:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(8275),a=r(857),c=r(5609),s=r(9307),o=r(5736),i=r(9196),l=r.n(i),p=r(6800),u=r(8137);const __=o.__,d=e=>{if(e.currentUsage.must_upgrade)return{description:__("Youve exceeded the limits available for your search plan.","jetpack-search-pkg"),cta:__("Upgrade now to restore Jetpack Search functionality.","jetpack-search-pkg")};if(!e.currentUsage.should_upgrade)return null;let t=(e=>{if(!e.currentUsage.upgrade_reason.records||!e.currentUsage.upgrade_reason.requests)return null;const t=__("Youre close to exceeding the number of site records and search requests available for the free plan.","jetpack-search-pkg");let r=__("Youve exceeded the number of site records and search requests available for the free plan.","jetpack-search-pkg");return 0===e.currentUsage.months_over_plan_records_limit&&(r=t),{description:r,cta:__("Upgrade now to increase your limits and avoid interruption!","jetpack-search-pkg")}})(e);return t||(t=(e=>{if(!e.currentUsage.upgrade_reason.records||e.currentUsage.upgrade_reason.requests)return null;const t=__("Youre close to exceeding the number of site records available on the free plan.","jetpack-search-pkg"),r=__("Youve exceeded the number of site records available on the free plan.","jetpack-search-pkg"),n=__("Youve exceeded the number of site records available on the free plan for two consecutive months.","jetpack-search-pkg"),a=__("Youve exceeded the number of site records available on the free plan for three consecutive months.","jetpack-search-pkg");let c=e.currentUsage.months_over_plan_records_limit;c<0?c=0:c>3&&(c=3);const s=[t,r,n,a][c],o=__("Upgrade now to increase your monthly record limit and avoid interruption!","jetpack-search-pkg"),i=__("Upgrade now to continue using Jetpack Search.","jetpack-search-pkg");let l=o;return e.currentUsage.months_over_plan_records_limit>=3&&(l=i),{description:s,cta:l}})(e),t||(t=(e=>{if(e.currentUsage.upgrade_reason.records||!e.currentUsage.upgrade_reason.requests)return null;const t=__("Youre close to exceeding the number of search requests available on the free plan.","jetpack-search-pkg"),r=__("Youre close to exceeding the number of search requests available on the free plan for two consecutive months.","jetpack-search-pkg"),n=__("Youre close to exceeding the number of search requests available on the free plan for three consecutive months.","jetpack-search-pkg"),a=__("Youve exceeded the number of search requests available on the free plan.","jetpack-search-pkg"),c=__("Youve exceeded the number of search requests available on the free plan for two consecutive months.","jetpack-search-pkg"),s=__("Youve exceeded the number of search requests available on the free plan for three consecutive months.","jetpack-search-pkg");let o=e.currentUsage.months_over_plan_requests_limit;o<0?o=0:o>3&&(o=3);const i=[t,a,c,s,r,n][o],l=__("Upgrade now to increase your monthly request limit and avoid interruption.","jetpack-search-pkg"),p=__("Upgrade now to continue using Jetpack Search.","jetpack-search-pkg");let u=l;return e.currentUsage.months_over_plan_requests_limit>=3&&(u=p),{description:i,cta:u}})(e),t||{description:__("Do you want to increase your site records and search requests?.","jetpack-search-pkg"),cta:__("Upgrade now and avoid any future interruption!","jetpack-search-pkg")}))},m=({upgradeMessage:e,ctaCallback:t})=>{const r=e&&{...e,onClick:t};return l().createElement(l().Fragment,null,r&&l().createElement(n.ZP,null,l().createElement(a.Z,r)))},g=({usageInfo:e,isPlanJustUpgraded:t})=>{const[r,n]=(0,i.useState)(0),a=window.localStorage;(0,i.useMemo)((()=>n(a.getItem("upgrade_tooltip_finished")?0:+t)),[n,a,t]);const c=(0,i.useCallback)((()=>a.setItem("upgrade_tooltip_finished",1)),[a]),s=(0,i.useCallback)((()=>{n((e=>(e>=2&&c(),e+1)))}),[n,c]),u={record:{index:1,title:__("Site records increased","jetpack-search-pkg"),content:(0,o.sprintf)(
// translators: %1$s: records limit
__("Thank you for upgrading! Now your visitors can search up to %1$s records.","jetpack-search-pkg"),(0,p.u)(e.recordMax)),section:__("1 of 2","jetpack-search-pkg"),next:__("Next","jetpack-search-pkg"),forceShow:1===r,goToNext:s},request:{index:2,title:__("More search requests","jetpack-search-pkg"),content:(0,o.sprintf)(
// translators: %1$s: requests limit
__("Your search plugin now supports up to %1$s search requests per month.","jetpack-search-pkg"),(0,p.u)(e.requestMax)),section:__("2 of 2","jetpack-search-pkg"),next:__("Finish","jetpack-search-pkg"),forceShow:2===r,goToNext:s}};return l().createElement("div",{className:"usage-meter-group"},l().createElement(p.Z,{title:__("Site records","jetpack-search-pkg"),current:e.recordCount,limit:e.recordMax,tooltip:u.record}),l().createElement(p.Z,{title:__("Search requests","jetpack-search-pkg"),current:e.requestCount,limit:e.requestMax,tooltip:u.request}))},h=()=>l().createElement("div",{className:"usage-meter-about"},(0,s.createInterpolateElement)(__("Tell me more about <jpPlanLimits>record indexing and request limits</jpPlanLimits>","jetpack-search-pkg"),{jpPlanLimits:l().createElement(c.ExternalLink,{href:"https://jetpack.com/support/search/",rel:"noopener noreferrer",target:"_blank",className:"support-link"})})),f=({isFreePlan:e,planInfo:t,sendPaidPlanToCart:r,isPlanJustUpgraded:n})=>{const a=e||t.currentUsage.must_upgrade?d(t):null,c=(s=t,{recordCount:s?.currentUsage?.num_records||0,recordMax:s?.currentPlan?.record_limit||0,requestCount:s?.latestMonthRequests?.num_requests||0,requestMax:s?.currentPlan.monthly_search_request_limit||0});var s;return l().createElement("div",{className:"jp-search-dashboard-wrap jp-search-dashboard-meter-wrap"},l().createElement("div",{className:"jp-search-dashboard-row"},l().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"}),l().createElement("div",{className:"jp-search-dashboard-meter-wrap__content lg-col-span-8 md-col-span-6 sm-col-span-4"},l().createElement(u.Z,{isFreePlan:e,planInfo:t}),l().createElement(g,{usageInfo:c,isPlanJustUpgraded:n}),l().createElement(m,{upgradeMessage:a,ctaCallback:r}),l().createElement(h,null)),l().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"})))}},8746:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(9344),a=r(9818),c=r(9307),s=r(5736),o=r(2897);const __=s.__,i=()=>{const e=(0,a.useSelect)((e=>`${e(o.t).getSiteAdminUrl()}admin.php?page=my-jetpack#/add-license`));return React.createElement("div",{className:"jp-search-dashboard-upsell-page__header"},React.createElement("span",{className:"jp-search-dashboard-upsell-page__logo"},React.createElement(n.Z,null)),React.createElement("p",null,(0,c.createInterpolateElement)(__("Already have an existing plan or license key? <a>Click here to get started</a>","jetpack-search-pkg"),{a:React.createElement("a",{href:e})})))}},3546:(e,t,r)=>{"use strict";r.d(t,{Z:()=>w});var n=r(9105),a=r(216),c=r(3363),s=r(3846),o=r(4432),i=r(8275),l=r(9608),p=r(5347),u=r(9665),d=r(526),m=r(3329),g=r(9818),h=r(9307),f=r(5736),v=r(7430),b=r(8821),y=r(6204),k=r(9567),E=r(9196),C=r.n(E),_=r(2897),j=r(8746);const __=f.__,S="https://jetpack.com/upgrade/search";function w({isLoading:e=!1}){const t=(0,g.useSelect)((e=>e(_.t).isNewPricing202208()),[]);(0,g.useSelect)((e=>e(_.t).getSearchPricing()),[]);const r=(0,g.useSelect)((e=>e(_.t).getCalypsoSlug()),[]),c=(0,g.useSelect)((e=>e(_.t).getBlogId()),[]),s=(0,g.useSelect)((e=>e(_.t).getSiteAdminUrl()),[]),o=(0,g.useSelect)((e=>e(_.t).isWpcom()),[]),{fetchSearchPlanInfo:i}=(0,g.useDispatch)(_.t),l=(0,E.useCallback)((()=>i().then((e=>e?.supports_search))),[i]),{run:p,hasCheckoutStarted:u}=(0,k.Z)({productSlug:"jetpack_search",adminUrl:s,redirectUri:"admin.php?page=jetpack-search&just_upgraded=1",siteProductAvailabilityHandler:l,from:"jetpack-search",siteSuffix:r,blogID:c,isWpcom:o}),{run:d,hasCheckoutStarted:m}=(0,k.Z)({productSlug:"jetpack_search_free",adminUrl:s,redirectUri:"admin.php?page=jetpack-search",siteProductAvailabilityHandler:l,from:"jetpack-search",siteSuffix:r,blogID:c,isWpcom:o}),h=(0,g.useSelect)((t=>t(_.t).isResolving("getSearchPricing")||!t(_.t).hasStartedResolution("getSearchPricing")||u||m||e),[e,u,m]);return C().createElement(C().Fragment,null,h&&C().createElement(v.Z,null),!h&&C().createElement("div",{className:"jp-search-dashboard-upsell-page"},C().createElement(n.Z,{moduleName:__("Jetpack Search","jetpack-search-pkg"),header:C().createElement(j.Z,null),moduleNameHref:S},C().createElement(a.Z,null,t?C().createElement(x,{sendToCartPaid:p,sendToCartFree:d}):C().createElement(N,{sendToCart:p})))))}const N=({sendToCart:e})=>{const t=(0,g.useSelect)((e=>e(_.t).getPriceBefore()/12),[]),r=(0,g.useSelect)((e=>e(_.t).getPriceAfter()/12),[]),n=(0,g.useSelect)((e=>e(_.t).getPriceCurrencyCode()),[]),a=__("14 day money back guarantee.","jetpack-search-pkg"),i=__("Special introductory pricing, all renewals are at full price. 14 day money back guarantee.","jetpack-search-pkg"),{hasConnectionError:l}=(0,m.Z)();return C().createElement(c.Z,{horizontalSpacing:3,horizontalGap:3},l&&C().createElement(s.Z,{lg:12,md:12,sm:12},C().createElement(m.h,null)),C().createElement(s.Z,{lg:6,md:6,sm:4},C().createElement("h1",null,__("The best WordPress search experience","jetpack-search-pkg")),C().createElement(y.Z,null)),C().createElement(s.Z,{lg:1,md:1,sm:0}),C().createElement(s.Z,{lg:5,md:6,sm:4},C().createElement(o.Z,{ctaText:__("Get Jetpack Search","jetpack-search-pkg"),icon:"data:image/svg+xml,%3Csvg width='32' height='32' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M21 19l-5.154-5.154C16.574 12.742 17 11.42 17 10c0-3.866-3.134-7-7-7s-7 3.134-7 7 3.134 7 7 7c1.42 0 2.742-.426 3.846-1.154L19 21l2-2zM5 10c0-2.757 2.243-5 5-5s5 2.243 5 5-2.243 5-5 5-5-2.243-5-5z' fill='%23000'/%3E%3C/svg%3E",infoText:r===t?a:i,onCtaClick:e,priceAfter:r,priceBefore:t,currencyCode:n,title:__("Jetpack Search","jetpack-search-pkg")})))},x=({sendToCartPaid:e,sendToCartFree:t})=>{const r=(0,g.useSelect)((e=>e(_.t).getCalypsoSlug()),[]),n=(0,g.useSelect)((e=>e(_.t).getPriceBefore()/12),[]),a=(0,g.useSelect)((e=>e(_.t).getPriceAfter()/12),[]),o=(0,g.useSelect)((e=>e(_.t).getPriceCurrencyCode()),[]),v=(0,g.useSelect)((e=>e(_.t).getPricingDiscountPercentage()),[]),{hasConnectionError:y}=(0,m.Z)(),k=(0,g.useSelect)((e=>e(_.t).getPaidRecordsLimit()),[]),E=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}).format(k),j=(0,g.useSelect)((e=>e(_.t).getPaidRequestsLimit()),[]),S=j>1e18,w=__("Unlimited","jetpack-search-pkg"),N=S?w:new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}).format(j),x=(0,g.useSelect)((e=>e(_.t).getAdditionalUnitPrice()),[]),Z=(0,g.useSelect)((e=>e(_.t).getAdditionalUnitQuantity()),[]),R=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}).format(Z);return C().createElement(c.Z,{horizontalSpacing:8},y&&C().createElement(s.Z,{lg:12,md:12,sm:12},C().createElement(m.h,null)),C().createElement(s.Z,{lg:12,md:12,sm:12},C().createElement(i.ZP,null,C().createElement(l.ZP,P,C().createElement(l.oK,{primary:!0},C().createElement(l.NE,null,C().createElement(p.Z,{price:n,offPrice:v>0?a:null,currency:o,legend:"",promoLabel:v>0&&(0,f.sprintf)(
// translators: Discount percentage (e.g. 50%).
__("%s off","jetpack-search-pkg"),`${v}%`)},C().createElement("div",{className:"price-tip"},C().createElement("span",{className:"price-tip-text"},__("Starting price per month, billed yearly","jetpack-search-pkg")),C().createElement(u.Z,{placement:"bottom-end",iconSize:14,iconClassName:"price-tip-icon",offset:4},(0,h.createInterpolateElement)((0,f.sprintf)(
// translators: %1$s: site domain
__("Starting price based on the number of records for <b>%1$s</b>.","jetpack-search-pkg"),r),{b:C().createElement("b",null)})," ",!S&&(0,h.createInterpolateElement)((0,f.sprintf)(
// translators: %1$s: Records or requests count, <Price>: Additional charge.
__("For every additional %1$s records or requests, an additional <Price></Price> per month will be charged.","jetpack-search-pkg"),R),{Price:C().createElement(b.Z,{amount:x,currency:o})})))),C().createElement(d.Z,{onClick:e,fullWidth:!0},__("Get Search","jetpack-search-pkg"))),C().createElement(l.kF,{isIncluded:!0,label:C().createElement("strong",null,(0,f.sprintf)(
// translators: %1$s: Number of records allowed before being charged extra.
__("%1$s records","jetpack-search-pkg"),E))}),C().createElement(l.kF,{isIncluded:!0,label:C().createElement("strong",null,(0,f.sprintf)(
// translators: %1$s: Number of requests allowed before being charged extra.
__("%1$s requests","jetpack-search-pkg"),N))}),C().createElement(l.kF,{isIncluded:!0,label:__("Branding removed","jetpack-search-pkg")}),C().createElement(l.kF,{isIncluded:!0}),C().createElement(l.kF,{isIncluded:!0}),C().createElement(l.kF,{isIncluded:!0}),C().createElement(l.kF,{isIncluded:!0}),C().createElement(l.kF,{isIncluded:!0})),C().createElement(l.oK,null,C().createElement(l.NE,null,C().createElement(p.Z,{price:0,legend:"",currency:o,hidePriceFraction:!0}),C().createElement(d.Z,{onClick:t,variant:"secondary",fullWidth:!0},__("Start for free","jetpack-search-pkg"))),C().createElement(l.kF,{isIncluded:!0,label:C().createElement("strong",null,
// translators: Record count for calculating Jetpack Search tier
__("5k records","jetpack-search-pkg")),tooltipInfo:C().createElement(C().Fragment,null,__("In the free plan, you can continue using the plugin even if you have more than 5k records for three months.","jetpack-search-pkg")," ",C().createElement("a",{href:"https://jetpack.com/search/",rel:"external noopener noreferrer nofollow",target:"_blank"},__("More about indexing and query limits","jetpack-search-pkg")))}),C().createElement(l.kF,{isIncluded:!0,label:C().createElement("strong",null,
// translators: Request count for calculating Jetpack Search tier
__("500 requests","jetpack-search-pkg")),tooltipInfo:C().createElement(C().Fragment,null,__("In the free plan, you can continue using the plugin even if you have more than 500 requests for three consecutive months.","jetpack-search-pkg")," ",C().createElement("a",{href:"https://jetpack.com/search/",rel:"external noopener noreferrer nofollow",target:"_blank"},__("More about indexing and query limits","jetpack-search-pkg")))}),C().createElement(l.kF,{isIncluded:!1,label:__("Shows Jetpack logo","jetpack-search-pkg")}),C().createElement(l.kF,{isIncluded:!1}),C().createElement(l.kF,{isIncluded:!0}),C().createElement(l.kF,{isIncluded:!0}),C().createElement(l.kF,{isIncluded:!0}),C().createElement(l.kF,{isIncluded:!0}))))))},P={title:__("The best WordPress search experience","jetpack-search-pkg"),items:[{name:__("Number of records","jetpack-search-pkg"),tooltipInfo:__("Records are all posts, pages, custom post types and other types of content indexed by Jetpack Search.","jetpack-search-pkg")},{name:__("Monthly requests","jetpack-search-pkg"),tooltipInfo:__("A search request is when someone visiting your site searches for something.","jetpack-search-pkg")},{name:__("Unbranded search","jetpack-search-pkg"),tooltipInfo:__("Paid customers can remove branding from the search tool.","jetpack-search-pkg")},{name:__("Priority support","jetpack-search-pkg"),tooltipInfo:C().createElement(C().Fragment,null,__("Paid customers get dedicated email support from our world-class Happiness Engineers to help with any issue.","jetpack-search-pkg"),C().createElement("br",null),C().createElement("br",null),__("All other questions are handled by our team as quickly as we are able to through the WordPress support forum.","jetpack-search-pkg"))},{name:__("Instant search and indexing","jetpack-search-pkg"),tooltipInfo:C().createElement(C().Fragment,null,__("Instant search and filtering without reloading the page.","jetpack-search-pkg"),C().createElement("br",null),C().createElement("br",null),__("Real-time indexing, so your search index will update within minutes of changes to your site.","jetpack-search-pkg"))},{name:__("Powerful filtering","jetpack-search-pkg"),tooltipInfo:__("Filtered and faceted searches by tags, categories, dates, custom taxonomies, and post types.","jetpack-search-pkg")},{name:__("Supports 38 languages","jetpack-search-pkg"),tooltipInfo:C().createElement(C().Fragment,null,__("Language support for English, Spanish, French, Portuguese, Hindi, Japanese, among others.","jetpack-search-pkg")," ",C().createElement("a",{href:"https://jetpack.com/support/search/jetpack-search-plugin/#faq",rel:"external noopener noreferrer nofollow",target:"_blank"},__("See all supported languanges","jetpack-search-pkg")))},{name:__("Spelling correction","jetpack-search-pkg"),tooltipInfo:__("Quick and accurate spelling correction for when your site visitors mistype their search.","jetpack-search-pkg")}]}},8821:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(8899),a=r(5106),c=r(9196),s=r.n(c);const o=({amount:e,currency:t,hidePriceFraction:r,tag:c="span"})=>{const{symbol:o,integer:i,fraction:l}=(0,n.LR)(e,t),p=!r||!l.endsWith("00");return s().createElement(a.ZP,{component:c},o,i,p&&l)}},8904:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r(3521),a=r(5736),c=r(9196),s=r.n(c),o=r(439),i=r(1307),l=r(1299);const __=a.__;function p({postCount:e,postTypeBreakdown:t,tierMaximumRecords:r,lastIndexedDate:a,postTypes:c}){const p=(0,o.ZP)(e,t,a,c);return s().createElement("div",{className:"jp-search-record-meter jp-search-dashboard-wrap","data-testid":"record-meter"},s().createElement("div",{className:"jp-search-dashboard-row"},s().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"}),s().createElement("div",{className:"jp-search-record-meter__content lg-col-span-8 md-col-span-6 sm-col-span-4"},s().createElement("h2",null,
/* translators: 'Your search index' is a breakdown of the site's indexed post type content,
  such as the number of indexed posts, pages etc. */
__("Your search index","jetpack-search-pkg")),s().createElement("div",null,s().createElement(l.D,{recordCount:p.recordCount,tierMaximumRecords:r}),s().createElement(n.Z,{items:p.data,showLegendLabelBeforeCount:!0,totalCount:r}),s().createElement(i.f,{recordCount:p.recordCount,tierMaximumRecords:r,hasBeenIndexed:p.hasBeenIndexed,hasValidData:p.hasValidData,hasItems:p.hasItems}))),s().createElement("div",{className:"lg-col-span-2 md-col-span-1 sm-col-span-0"})))}},439:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>c});r(2753);var n=r(5736);const __=n.__,a=r(550);function c(e,t,r,n){const c=[],o=[];let i=0,l=!0,p=!0,u=!0;"object"!=typeof t&&(l=!1),"number"!=typeof e&&(p=!1);const d=l&&p?Object.keys(t).length:0;0===d&&(u=!1);const m=[a.colors["Blue 30"],a.colors["Orange 30"],a.colors["WooCommerce Purple 30"],a.colors["Green 30"],a.colors["Yellow 30"]];if(d>0&&l&&p){const e=function(e,t){const r=e.map((e=>{const r=t[e.slug],n=r?r.label:e.slug;return{...e,label:n}}));return r}(t,n);for(let t=0;t<d;t++){const r=Object.values(e)[t],{count:n,label:a}=r;o.push({data:s(n,m[t],a)}),i+=n}const r=function(e,t,r){const n=r<=t?r:t;return{includedItems:e.slice(0,n),otherItems:e.slice(n,t)}}(o,d,5);for(const e in r.includedItems)c.push(s(r.includedItems[e].data.count,m[e],r.includedItems[e].data.label));r.otherItems.length>0&&c.push(s(function(e){let t=0;for(const r in e)t=e[r].data.count+t;return t}(r.otherItems),a.colors["Gray 30"],__("other","jetpack-search-pkg")))}return{data:c,recordCount:i,hasBeenIndexed:p,hasValidData:l,hasItems:u,isValid:p&&l&&u}}function s(e,t,r){return{count:e,label:r,backgroundColor:t}}},1307:(e,t,r)=>{"use strict";r.d(t,{f:()=>u});r(2753);var n=r(2947),a=r(5736),c=r(4034),s=r(8448),o=r(9196),i=r.n(o);const __=a.__,l=.8,p=(e=null)=>{const t="number"==typeof e?(0,n.Z)(e):e;return{1:{id:1,header:__("We were unable to index your content","jetpack-search-pkg"),message:__("Jetpack's servers ran into a problem when trying to communicate with your site.","jetpack-search-pkg"),isImportant:!0},2:{id:2,header:__("We're gathering your usage data","jetpack-search-pkg"),message:__("If you have recently set up Jetpack Search, please allow a little time for indexing to complete.","jetpack-search-pkg")},3:{id:3,header:__("You're close to the maximum records for this billing tier","jetpack-search-pkg"),message:(0,a.sprintf)(
// translators: %s: site's current plan record limit
__("Once you hit %s indexed records, you'll be upgraded to the next tier. You won't be charged for the new tier until your next billing date.","jetpack-search-pkg"),t),link:{text:__("Learn more","jetpack-search-pkg"),url:"https://jetpack.com/support/search/product-pricing/"}}}};function u(e){const t=[],r=p(e.tierMaximumRecords);if(!1===e.hasValidData&&t.push("1"),!1===e.hasBeenIndexed&&t.push("2"),!1===e.hasItems&&t.push("2"),"number"==typeof e.tierMaximumRecords&&e.recordCount>e.tierMaximumRecords*l&&e.recordCount<e.tierMaximumRecords&&t.push("3"),t.length<1)return null;const n=r[t[0]],a=n.isImportant?"jp-search-notice-box jp-search-notice-box__important":"jp-search-notice-box";return i().createElement(c.Z,{isCompact:!1,status:"is-info",className:a,icon:"info-outline",showDismiss:!1},n.header&&i().createElement("h3",{className:"dops-notice__header"},n.header),n.message&&i().createElement("span",{className:"dops-notice__body"},n.message),n.link&&i().createElement(s.Z,{href:n.link.url,external:!0},n.link.text))}},1299:(e,t,r)=>{"use strict";r.d(t,{D:()=>p});var n=r(2947),a=r(7172),c=r(9307),s=r(5736),o=r(9196),i=r.n(o);const __=s.__,l="https://jetpack.com/support/search/jetpack-search-record-meter/";function p(e){if(!e.recordCount)return null;const t="number"==typeof e.recordCount?(0,n.Z)(e.recordCount):e.recordCount,r="number"==typeof e.tierMaximumRecords?(0,n.Z)(e.tierMaximumRecords):e.tierMaximumRecords;let o;return o=r?(0,c.createInterpolateElement)((0,s.sprintf)(
// translators: %1$s: site's current record count, %2$s: record limit of the current plan
__("<s>%1$s</s> records indexed out of the <s>%2$s</s> allotted for your current plan","jetpack-search-pkg"),t,r),{s:i().createElement("strong",null)}):(0,c.createInterpolateElement)((0,s.sprintf)(
// translators: %1$s: site's current record count, %2$s: record limit of the current plan
__("<s>%1$s</s> records indexed","jetpack-search-pkg"),t),{s:i().createElement("strong",null)}),i().createElement("div",{"data-testid":"record-count",className:"jp-search-record-count"},i().createElement("p",{className:"jp-search-record-count__message"},o,l&&i().createElement("a",{href:l,className:"jp-search-record-count__info",title:__("More info","jetpack-search-pkg")},i().createElement(a.Z,{className:"jp-search-record-count__info-icon",icon:"info-outline",size:18}),i().createElement("span",{className:"screen-reader-text"},__("More info","jetpack-search-pkg")))))}},6204:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5736),a=r(9196),c=r.n(a);const __=n.__;function s(){return c().createElement("div",{className:"jp-search-dashboard-promotion"},c().createElement("h3",null,__("Allow viewers to search through your site's records, lightning fast.","jetpack-search-pkg")),c().createElement("ul",{className:"jp-product-promote"},c().createElement("li",null,__("Customizable filtering","jetpack-search-pkg")),c().createElement("li",null,__("Support for 38 languages","jetpack-search-pkg")),c().createElement("li",null,__("Content displayed within results is updated in real-time","jetpack-search-pkg")),c().createElement("li",null,__("If you grow into a new pricing tier, we'll let you know before your next billing cycle","jetpack-search-pkg")),c().createElement("li",null,__("Best-in-class support","jetpack-search-pkg"))))}},7436:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5736),a=r(9196),c=r.n(a);const __=n.__;function s(e={upgrade:!0}){return c().createElement("a",{className:"jp-instant-search-upsell-nudge jp-search-dashboard-cut",href:e.href},c().createElement("span",null,__("Offer instant search results to your visitors as soon as they start typing. ","jetpack-search-pkg")),c().createElement("span",null,c().createElement("b",null,__("Try Jetpack Instant Search for free now","jetpack-search-pkg"))))}},7011:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(428),a=r(9818),c=r(2897);function s(){const e=(0,a.useSelect)((e=>({siteIsRegistering:e(n.t).getSiteIsRegistering(),userIsConnecting:e(n.t).getUserIsConnecting(),userConnectionData:e(n.t).getUserConnectionData(),connectedPlugins:e(n.t).getConnectedPlugins(),connectionErrors:e(n.t).getConnectionErrors(),...e(n.t).getConnectionStatus()}))),t=(0,a.useSelect)((e=>e(c.t).isWpcom()),[]);return{connectionStatus:e,isFullyConnected:Object.keys(e).length&&e.hasConnectedOwner&&e.isRegistered||t,isSiteConnected:Object.keys(e).length&&e.isRegistered||t}}},9567:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(6975),a=r(4743),c=r(4153),s=r(428),o=r(1294),i=r(9818),l=r(9196),p=r(2897);const{registrationNonce:u,apiRoot:d,apiNonce:m,siteSuffix:g}=window?.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{};function h({productSlug:e,redirectUri:t,siteSuffix:r=g,blogID:h=null,siteProductAvailabilityHandler:f=null,from:v,isWpcom:b=!1}={}){const[y,k]=(0,l.useState)(!1),{registerSite:E}=(0,i.useDispatch)(s.t),{isUserConnected:C,isRegistered:_,handleConnectUser:j}=(0,o.Z)({redirectUri:t,from:v}),S=(0,c.Z)(e,h??r,t,C||b),w=()=>Promise.resolve(f&&f()).then((e=>{if(e)return j();window.location.href=S}));return(0,l.useEffect)((()=>{a.ZP.setApiRoot(d),a.ZP.setApiNonce(m)}),[]),{run:r=>{if(r&&r.preventDefault(),k(!0),(()=>{const e=(0,i.select)(p.t).getWpcomUser(),t=(0,i.select)(p.t).getBlogId();e&&n.Z.initialize(e.ID,e.login,{blog_id:t})})(),n.Z.tracks.recordEvent(e+"_purchase_button_click",{isWpcom:b,current_version:(0,i.select)(p.t).getVersion()}),_||b)return w();E({registrationNonce:u,redirectUri:t}).then(w)},isRegistered:_||b,hasCheckoutStarted:y}}},8210:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(3459),a=r(1862),c=r(8552),s=r(8385),o=r(5867);const i={...a.ZP,...s.ZP,...o.ZP,...n.ZP,...c.ZP}},1862:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>d,dz:()=>p,ff:()=>u});var n=r(9818),a=r(5736),c=r(3459),s=r(1962),o=r.n(s),i=r(2897),l=r(7029);const __=a.__,p="SET_JETPACK_SETTINGS";function u(e){return{type:p,options:e}}const d={updateJetpackSettings:function*(e){try{yield(0,c.Iz)(),yield u({is_updating:!0}),yield u(e),yield(0,l.RF)(e);const t=yield(0,l.es)();return yield u(t),(0,c.RT)(__("Updated settings.","jetpack-search-pkg"))}catch(e){const t=o()((0,n.select)(i.t).getSearchModuleStatus(),["module_active","instant_search_enabled"]);return yield u(t),(0,c.tF)(__("Error Update settings","jetpack-search-pkg"))}finally{yield(0,c.MQ)(),yield u({is_updating:!1})}},setJetpackSettings:u}},8552:(e,t,r)=>{"use strict";r.d(t,{Hb:()=>n,ZP:()=>c,l0:()=>a});const n="SET_SEARCH_PRICING";function a(e){return{type:"SET_SEARCH_PRICING",options:e}}const c={setSearchPricing:a}},8385:(e,t,r)=>{"use strict";r.d(t,{$w:()=>a,ZP:()=>s,og:()=>c});var n=r(7029);const a="SET_SEARCH_PLAN_INFO";function c(e){return{type:"SET_SEARCH_PLAN_INFO",options:e}}const s={setSearchPlanInfo:c,fetchSearchPlanInfo:n.FZ}},5867:(e,t,r)=>{"use strict";r.d(t,{Em:()=>n,XV:()=>a,ZP:()=>c});const n="SET_SEARCH_STATS";function a(e){return{type:"SET_SEARCH_STATS",options:e}}const c={setSearchStats:a}},7029:(e,t,r)=>{"use strict";r.d(t,{FZ:()=>u,RF:()=>p,UP:()=>m,Yt:()=>d,ZP:()=>g,es:()=>l});var n=r(4743);const a="FETCH_JETPACK_SETTINGS",c="UPDATE_JETPACK_SETTINGS",s="FETCH_SEARCH_PLAN_INFO",o="FETCH_SEARCH_STATS",i="FETCH_SEARCH_PRICING",l=()=>({type:a}),p=e=>({type:c,settings:e});function*u(){return yield{type:s}}const d=()=>({type:o}),m=()=>({type:i}),g={[a]:function(){return n.ZP.fetchSearchSettings()},[c]:function(e){return n.ZP.updateSearchSettings(e.settings)},[s]:function(){return n.ZP.fetchSearchPlanInfo()},[o]:function(){return n.ZP.fetchSearchStats()},[i]:function(){return n.ZP.fetchSearchPricing()}}},2897:(e,t,r)=>{"use strict";r.d(t,{i:()=>l,t:()=>i});var n=r(8210),a=r(7029),c=r(7529),s=r(5440),o=r(8869);const i="jetpack-search-plugin",l={reducer:c.Z,actions:n.Z,selectors:o.Z,resolvers:s.ZP,controls:a.ZP,initialState:window.JETPACK_SEARCH_DASHBOARD_INITIAL_STATE||{}}},3326:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=(e=[])=>e},7529:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(9818),a=r(2963),c=r(3326),s=r(3784),o=r(4628),i=r(5934),l=r(8006),p=r(460),u=r(6819);const d=(0,n.combineReducers)({siteData:i.Z,jetpackSettings:s.Z,sitePlan:l.Z,siteStats:p.Z,userData:u.Z,features:c.Z,notices:a.Z,searchPricing:o.Z})},3784:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(1862);const a=(e={},t)=>t.type===n.dz?{...e,...t.options,is_toggling_module:e.module_active!==t.options.module_active&&!!t.options.is_updating,is_toggling_instant_search:e.instant_search_enabled!==t.options.instant_search_enabled&&!!t.options.is_updating}:e},4628:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(8552);const a=(e={},t)=>t.type===n.Hb?{...e,...t.options}:e},5934:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=(e={})=>e},8006:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(8385);const a=(e={},t)=>t.type===n.$w?{...e,...t.options}:e},460:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(5867);const a=(e={},t)=>t.type===n.Em?{...e,...t.options}:e},6819:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=(e={})=>e},5440:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>p});var n=r(5736),a=r(3459),c=r(1862),s=r(8552),o=r(8385),i=r(5867),l=r(7029);const __=n.__;const p={getSearchModuleStatus:function*(){try{const e=yield(0,l.es)();if(e)return(0,c.ff)(e)}catch(e){return(0,a.tF)(__("Error fetching settings","jetpack-search-pkg"))}},getSearchPlanInfo:function*(){try{const e=yield(0,l.FZ)();if(e)return(0,o.og)(e)}catch(e){return(0,a.tF)(__("Error fetching search plan","jetpack-search-pkg"))}},getSearchStats:function*(){try{const e=yield(0,l.Yt)();if(e)return(0,i.XV)(e)}catch(e){return(0,a.tF)(__("Error fetching search stats","jetpack-search-pkg"))}},getSearchPricing:function*(){try{const e=yield(0,l.UP)();if(e)return(0,s.l0)(e)}catch(e){}}}},6770:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={isFeatureEnabled:(e,t)=>Array.isArray(e.features)&&e.features.includes(t)}},8869:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(5260),a=r(6770),c=r(362),s=r(741),o=r(5101),i=r(1957),l=r(4220),p=r(5614);const u={...o.Z,...c.Z,...i.Z,...p.Z,...n.Z,...a.Z,...l.Z,...s.Z}},362:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={getSearchModuleStatus:e=>e.jetpackSettings,isModuleEnabled:e=>e.jetpackSettings.module_active,isInstantSearchEnabled:e=>e.jetpackSettings.instant_search_enabled,isUpdatingJetpackSettings:e=>e.jetpackSettings.is_updating,isTogglingModule:e=>e.jetpackSettings.is_toggling_module,isTogglingInstantSearch:e=>e.jetpackSettings.is_toggling_instant_search}},741:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});const n=e=>e.searchPricing.full_price??0,a=e=>Number.isFinite(e.searchPricing.discount_price)?e.searchPricing.discount_price:n(e),c={getSearchPricing:e=>e.searchPricing,getPriceBefore:n,getPriceAfter:a,getPricingDiscountPercentage:e=>{const t=n(e),r=a(e);return t<=r?0:Math.round((t-r)/t*100)},getPriceCurrencyCode:e=>e.searchPricing.currency_code??"USD",isNewPricing202208:e=>e.searchPricing.pricing_version>="202208",getPaidRequestsLimit:e=>e.searchPricing.monthly_search_request_limit??1e4,getPaidRecordsLimit:e=>e.searchPricing.record_limit??1e4,getAdditionalUnitQuantity:e=>e.searchPricing.quantity_per_unit,getAdditionalUnitPrice:e=>Number.isFinite(+e.searchPricing.per_unit_fee)?+e.searchPricing.per_unit_fee/12:null}},5101:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={getAPIRootUrl:e=>e.siteData?.WP_API_root??null,getWpcomOriginApiUrl:e=>e.siteData?.wpcomOriginApiUrl??null,getAPINonce:e=>e.siteData?.WP_API_nonce??null,getRegistrationNonce:e=>e.siteData?.registrationNonce??null,getSiteAdminUrl:e=>e.siteData?.adminUrl??null,isInstantSearchPromotionActive:e=>e.siteData?.showPromotions??!0,getBlogId:e=>e.siteData?.blogId??0,getVersion:e=>e.siteData?.version??"development",getCalypsoSlug:e=>e.siteData?.calypsoSlug,getPostTypes:e=>e.siteData?.postTypes,getSiteTitle:e=>e.siteData?.title||"",isWpcom:e=>e.siteData?.isWpcom??!1,isPlanJustUpgraded:e=>e.siteData?.isPlanJustUpgraded??!1}},1957:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={getSearchPlanInfo:e=>e.sitePlan,hasBusinessPlan:e=>e.sitePlan.supports_only_classic_search,isOverLimit:e=>e.sitePlan.plan_usage?.must_upgrade,supportsInstantSearch:e=>e.sitePlan.supports_instant_search,supportsOnlyClassicSearch:e=>e.sitePlan.supports_only_classic_search,getUpgradeBillPeriod:e=>e.sitePlan?.default_upgrade_bill_period,supportsSearch:e=>e.sitePlan.supports_instant_search||e.sitePlan.supports_only_classic_search,getTierMaximumRecords:e=>e.sitePlan.tier_maximum_records,isFreePlan:e=>"jetpack_search_free"===e.sitePlan.effective_subscription?.product_slug,getLatestMonthRequests:e=>e.sitePlan.plan_usage?.num_requests_3m[0],getCurrentPlan:e=>e.sitePlan.plan_current,getCurrentUsage:e=>e.sitePlan.plan_usage}},4220:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={getSearchStats:e=>e.siteStats,getPostCount:e=>e.siteStats?.post_count,getPostTypeBreakdown:e=>e.siteStats?.post_type_breakdown,getLastIndexedDate:e=>e.siteStats?.last_indexed_date}},5614:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={getWpcomUser:e=>e.userData?.currentUser?.wpcomUser}},8420:e=>{"use strict";if(void 0==={consumer_slug:"jetpack-search"}){var t=new Error('Cannot find module \'{"consumer_slug":"jetpack-search"}\'');throw t.code="MODULE_NOT_FOUND",t}e.exports={consumer_slug:"jetpack-search"}},9196:e=>{"use strict";e.exports=window.React},5609:e=>{"use strict";e.exports=window.wp.components},4333:e=>{"use strict";e.exports=window.wp.compose},9818:e=>{"use strict";e.exports=window.wp.data},9771:e=>{"use strict";e.exports=window.wp.date},9307:e=>{"use strict";e.exports=window.wp.element},5736:e=>{"use strict";e.exports=window.wp.i18n},444:e=>{"use strict";e.exports=window.wp.primitives},6483:e=>{"use strict";e.exports=window.wp.url},2674:e=>{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(this,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},550:e=>{"use strict";e.exports=JSON.parse('{"version":"2.5.0","colors":{"White":"#fff","Black":"#000","Gray":"#646970","Gray 0":"#f6f7f7","Gray 5":"#dcdcde","Gray 10":"#c3c4c7","Gray 20":"#a7aaad","Gray 30":"#8c8f94","Gray 40":"#787c82","Gray 50":"#646970","Gray 60":"#50575e","Gray 70":"#3c434a","Gray 80":"#2c3338","Gray 90":"#1d2327","Gray 100":"#101517","Blue":"#0675c4","Blue 0":"#e9f0f5","Blue 5":"#bbe0fa","Blue 10":"#91caf2","Blue 20":"#68b3e8","Blue 30":"#399ce3","Blue 40":"#1689db","Blue 50":"#0675c4","Blue 60":"#055d9c","Blue 70":"#044b7a","Blue 80":"#02395c","Blue 90":"#01283d","Blue 100":"#001621","Purple":"#984a9c","Purple 0":"#f2e9ed","Purple 5":"#ebcee0","Purple 10":"#e3afd5","Purple 20":"#d48fc8","Purple 30":"#c475bd","Purple 40":"#b35eb1","Purple 50":"#984a9c","Purple 60":"#7c3982","Purple 70":"#662c6e","Purple 80":"#4d2054","Purple 90":"#35163b","Purple 100":"#1e0c21","Pink":"#c9356e","Pink 0":"#f5e9ed","Pink 5":"#f2ceda","Pink 10":"#f7a8c3","Pink 20":"#f283aa","Pink 30":"#eb6594","Pink 40":"#e34c84","Pink 50":"#c9356e","Pink 60":"#ab235a","Pink 70":"#8c1749","Pink 80":"#700f3b","Pink 90":"#4f092a","Pink 100":"#260415","Red":"#d63638","Red 0":"#f7ebec","Red 5":"#facfd2","Red 10":"#ffabaf","Red 20":"#ff8085","Red 30":"#f86368","Red 40":"#e65054","Red 50":"#d63638","Red 60":"#b32d2e","Red 70":"#8a2424","Red 80":"#691c1c","Red 90":"#451313","Red 100":"#240a0a","Orange":"#b26200","Orange 0":"#f5ece6","Orange 5":"#f7dcc6","Orange 10":"#ffbf86","Orange 20":"#faa754","Orange 30":"#e68b28","Orange 40":"#d67709","Orange 50":"#b26200","Orange 60":"#8a4d00","Orange 70":"#704000","Orange 80":"#543100","Orange 90":"#361f00","Orange 100":"#1f1200","Yellow":"#9d6e00","Yellow 0":"#f5f1e1","Yellow 5":"#f5e6b3","Yellow 10":"#f2d76b","Yellow 20":"#f0c930","Yellow 30":"#deb100","Yellow 40":"#c08c00","Yellow 50":"#9d6e00","Yellow 60":"#7d5600","Yellow 70":"#674600","Yellow 80":"#4f3500","Yellow 90":"#320","Yellow 100":"#1c1300","Green":"#008a20","Green 0":"#e6f2e8","Green 5":"#b8e6bf","Green 10":"#68de86","Green 20":"#1ed15a","Green 30":"#00ba37","Green 40":"#00a32a","Green 50":"#008a20","Green 60":"#007017","Green 70":"#005c12","Green 80":"#00450c","Green 90":"#003008","Green 100":"#001c05","Celadon":"#008763","Celadon 0":"#e4f2ed","Celadon 5":"#a7e8d3","Celadon 10":"#66deb9","Celadon 20":"#31cc9f","Celadon 30":"#09b585","Celadon 40":"#009e73","Celadon 50":"#008763","Celadon 60":"#007053","Celadon 70":"#005c44","Celadon 80":"#004533","Celadon 90":"#003024","Celadon 100":"#001c15","WordPress Blue":"#006088","WordPress Blue 0":"#e6f1f5","WordPress Blue 5":"#bedae6","WordPress Blue 10":"#98c6d9","WordPress Blue 20":"#6ab3d0","WordPress Blue 30":"#3895ba","WordPress Blue 40":"#187aa2","WordPress Blue 50":"#006088","WordPress Blue 60":"#004e6e","WordPress Blue 70":"#003c56","WordPress Blue 80":"#002c40","WordPress Blue 90":"#001d2d","WordPress Blue 100":"#00101c","Simplenote Blue":"#3361cc","Simplenote Blue 0":"#e9ecf5","Simplenote Blue 5":"#ced9f2","Simplenote Blue 10":"#abc1f5","Simplenote Blue 20":"#84a4f0","Simplenote Blue 30":"#618df2","Simplenote Blue 40":"#4678eb","Simplenote Blue 50":"#3361cc","Simplenote Blue 60":"#1d4fc4","Simplenote Blue 70":"#113ead","Simplenote Blue 80":"#0d2f85","Simplenote Blue 90":"#09205c","Simplenote Blue 100":"#05102e","WooCommerce Purple":"#7f54b3","WooCommerce Purple 0":"#f7edf7","WooCommerce Purple 5":"#e5cfe8","WooCommerce Purple 10":"#d6b4e0","WooCommerce Purple 20":"#c792e0","WooCommerce Purple 30":"#af7dd1","WooCommerce Purple 40":"#9a69c7","WooCommerce Purple 50":"#7f54b3","WooCommerce Purple 60":"#674399","WooCommerce Purple 70":"#533582","WooCommerce Purple 80":"#3c2861","WooCommerce Purple 90":"#271b3d","WooCommerce Purple 100":"#140e1f","Jetpack Green":"#069e08","Jetpack Green 0":"#f0f2eb","Jetpack Green 5":"#d0e6b8","Jetpack Green 10":"#9dd977","Jetpack Green 20":"#64ca43","Jetpack Green 30":"#2fb41f","Jetpack Green 40":"#069e08","Jetpack Green 50":"#008710","Jetpack Green 60":"#007117","Jetpack Green 70":"#005b18","Jetpack Green 80":"#004515","Jetpack Green 90":"#003010","Jetpack Green 100":"#001c09"}}')}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var c=t[n]={id:n,loaded:!1,exports:{}};return e[n](c,c.exports,r),c.loaded=!0,c.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e=r(9818),t=r(9307),n=r(9196),a=r.n(n),c=r(2341),s=r(2897);const o=(0,e.createReduxStore)(s.t,s.i);function i(){const e=document.getElementById("jp-search-dashboard");null!==e&&t.createRoot(e).render(a().createElement(c.Z,null))}(0,e.register)(o),"loading"!==document.readyState?i():document.addEventListener("DOMContentLoaded",i)})()})();jp-search-dashboard.js.LICENSE.txt                                                                                                                                                                                                                             427           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/build/dashboard                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /*
 * Exposes number format capability
 *
 * @copyright Copyright (c) 2013 Kevin van Zonneveld (http://kvz.io) and Contributors (http://phpjs.org/authors).
 * @license See CREDITS.md
 * @see https://github.com/kvz/phpjs/blob/ffe1356af23a6f2512c84c954dd4e828e92579fa/functions/strings/number_format.js
 */

/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/
jp-search-dashboard.rtl.css                                                                                                                                                                                                                                    73359         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/build/dashboard                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        .jp-search-dashboard-page-loading-spinner{position:absolute;right:50%;top:50%;transform:translate(50%,-50%)}@keyframes rotate-spinner{to{transform:rotate(-1turn)}}.jp-components-spinner{align-items:center;display:flex}.jp-components-spinner__inner,.jp-components-spinner__outer{animation:3s linear infinite;animation-name:rotate-spinner;border:.1em solid transparent;border-radius:50%;box-sizing:border-box;margin:auto}.jp-components-spinner__outer{border-top-color:#fff}.jp-components-spinner__inner{border-left-color:#fff;border-top-color:#fff;height:100%;opacity:.4;width:100%}.jp-search-dashboard-promotion h1{font-size:var(--font-title-large);font-weight:600;line-height:1.2}.jp-search-dashboard-promotion ul.jp-product-promote li{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAANlBMVEVHcEwFnwUInggGnggGnggHnAcAnwUFnQcAnwcGnwkFnQgGnQgFnwcGnQYFnQcFnAcGnQkDnwdhiL0pAAAAEnRSTlMAMF//f2Aw7yBQ3+9gcIBgcED+HDbkAAAAZklEQVR4Ae3LNwICARDDQC0+cv7/Y8mwV9odSfWIcf/+VegnGkIvDaGXKvTTn/Gz+Uf5xTL0K1XotS7fs5H6GHvvaO8d7c3j7rdgHne/A/PYt/cO+R42oYdN6OEQetiFHo4A//6dAXqtBEkmtWutAAAAAElFTkSuQmCC) no-repeat;background-size:24px;color:var(--jp-black);margin-bottom:9px;padding-right:30px}.jp-search-dashboard-connection-screen{align-items:center;background:var(--jp-white-off);display:flex;width:100%}.jp-search-dashboard-connection-screen>div{width:100%}.jp-search-dashboard-connection-screen .jp-components__pricing-card .components-spinner{margin:0}.jp-search-dashboard-connection-screen .jp-search-dashboard-connection-footer__text{color:#3c434a;font-size:10.5px;font-weight:400;letter-spacing:-.02em;margin:0;text-align:center}.jp-search-dashboard-connection-screen .jp-search-dashboard-connection-footer__link{color:#3c434a}.vMa4i_Dza2t5Zi_Bw9Nf{background:var(--jp-white-off)}.SqdhUZkXCRuIpErj1B3z{--max-container-width:1128px;--vertical-gutter:24px;--horizontal-spacing:8px;column-gap:var(--vertical-gutter);display:grid;margin:0 auto;max-width:var(--max-container-width);width:100%}@media(max-width:599px){.SqdhUZkXCRuIpErj1B3z{grid-template-columns:repeat(4,minmax(0,1fr));padding:0 16px}}@media(min-width:600px)and (max-width:959px){.SqdhUZkXCRuIpErj1B3z{grid-template-columns:repeat(8,minmax(0,1fr));padding:0 18px}}@media(min-width:960px){.SqdhUZkXCRuIpErj1B3z{grid-template-columns:repeat(12,minmax(0,1fr));padding:0 24px}}.SqdhUZkXCRuIpErj1B3z.OZC_9a1LhpWF9dv15Gdh{max-width:none;padding:unset}@media(max-width:599px){.RuVLl3q4lxTQa3wbhBJB{grid-column-end:span 1}.f9LZTRG4MMK42rS89afW{grid-column-start:1}.bHe_zKxjjpUwHw_MdYE1{grid-column-end:2}.QZbNrOqE2aNSn50xVhpU{grid-column-end:span 2}.ev7W3z7zVYPeHAlYqZjf{grid-column-start:2}.NJWd1m_e7lOiPYru2ZMP{grid-column-end:3}.Xc6nt1Qc1DI0Z2A3gt1r{grid-column-end:span 3}.UIcN_GXiPRoIsin8Kohg{grid-column-start:3}.GRKCyqb5LufCSCgykKFc{grid-column-end:4}.i_qTq8gqhhC3vIUepVRB{grid-column-end:span 4}.G3qaZ3Jpbvam_1XvGxgc{grid-column-start:4}.VRCNYKZtO9zukEwmgP1y{grid-column-end:5}}@media(min-width:600px)and (max-width:959px){.tRm008K_WJL79WoNZTNL{grid-column-end:span 1}.l5T2P_bgKts4tdaRkS1d{grid-column-start:1}.zOCxfLZpF6BlgC7a_Yq1{grid-column-end:2}.F80DdgVn0m5OpvtSQWka{grid-column-end:span 2}.oI1c7JYfiJtMQHbhngtU{grid-column-start:2}.pMQtA_4jh1_1lVknqEP5{grid-column-end:3}.VenqMpdgyKQVUNNQcfqd{grid-column-end:span 3}.seNYL99uoczf9V4MxBxT{grid-column-start:3}.YKfF1HFhI9KygA5l3b2J{grid-column-end:4}.yAi0Cv1xDWkoqsaUhvhR{grid-column-end:span 4}.ubhnyZOnkgxNhh6XtVWv{grid-column-start:4}.RGOPGQbWMJ9Ei5oFxS7X{grid-column-end:5}.Sz1E2aWbX483ijdi6yge{grid-column-end:span 5}.tku6_bRYrX9tMbgYGmIl{grid-column-start:5}.b5JHttOhSEcI1WBlqAjk{grid-column-end:6}.FboSx5MoKTAWbxXyYlCw{grid-column-end:span 6}.Jhs8yEEmodG30edbJvag{grid-column-start:6}.IpzbbKVqEqPcfIGkXkwt{grid-column-end:7}.mhCPwfAZ4Kmm_empzJAq{grid-column-end:span 7}.x034ilrJF7rO9UJB2rI1{grid-column-start:7}.Wt8t2e16viRrOJ1lLA5v{grid-column-end:8}.S6pIrEy9AMLKx9bgh_Ae{grid-column-end:span 8}.kEfI4tGyuWfHTlRnvIab{grid-column-start:8}.PUzX4RRsKq1dnsz3gebS{grid-column-end:9}}@media(min-width:960px){.X_pdcLJikd8LS_YAdJlB{grid-column-end:span 1}.tl936d14Huby4khYp05X{grid-column-start:1}.hnge0LnR69d3NXEtEE1t{grid-column-end:2}.fj0NUMuyZQcPNgKcjp5Z{grid-column-end:span 2}.R2ncBX7a2NigdYCcV1OX{grid-column-start:2}.t8vMSDVYno9k9itRwnXb{grid-column-end:3}.wsDuEN2GqHx6qzo8dUdk{grid-column-end:span 3}.cIEVPUweWtLBy3xaXnMx{grid-column-start:3}.fajUWBwu1m2B479j3jmz{grid-column-end:4}.YR0c7fQTgMkDdWzwSyLp{grid-column-end:span 4}.xlwp8BmplxkKNMI7gamo{grid-column-start:4}._C4O1w9DUqx1m3gPf8aA{grid-column-end:5}.Z54F1hAErckAIrKlxnXW{grid-column-end:span 5}.ezSDWkRHmKSxDJXxuiOH{grid-column-start:5}.T0ChoeAjGJjkkNrYhD4g{grid-column-end:6}.qtMoMPF6yHvGJnWHSsde{grid-column-end:span 6}.gdoywN5VPiWERfIBqkph{grid-column-start:6}.wUev_VH5uf_pwFFlbnAU{grid-column-end:7}.egIPDFJsOpownTClq9XP{grid-column-end:span 7}.yGhp9yoAW7k0kQik9AB7{grid-column-start:7}.SJ43U9mR5wUg5V2qBeQA{grid-column-end:8}.cTuyHfMwSUJxN_HdIEgd{grid-column-end:span 8}.smCr8DaIagcumdvdldiK{grid-column-start:8}.T03NHzQJvzwL6wAfIiTL{grid-column-end:9}.pMvxM3RJGjqyNdf9qg1Y{grid-column-end:span 9}.iIVpNRwEnQ_JI5gpp9EN{grid-column-start:9}.ZbQ4u4vGSX5rJOje4uGL{grid-column-end:10}.gKb5wuIDAlKGbrjK2vxy{grid-column-end:span 10}.Z7pINdImE2WJiYnZBTqm{grid-column-start:10}.ZTxp6qpvwurMdOnLLSz1{grid-column-end:11}.NnQTlbfnxPDR6cQ7rygg{grid-column-end:span 11}.O137wZd6Yl0olSA9PsXR{grid-column-start:11}.zf2OJtQ2MPz6SDoh6CB0{grid-column-end:12}.U3H6UHW6HqRt9hdzVg3O{grid-column-end:span 12}.zynnNeS_ZBTxABcVpUQH{grid-column-start:12}.vI8tltFZtFUNAy9Iag9s{grid-column-end:13}}@media(min-width:1080px){.jp-connection__connect-screen-layout__left{width:calc(100% - 384px - var(--spacing-base)*4)}.jp-connection__connect-screen-required-plan{background:linear-gradient(270deg,#fff 70%,#f9f9f6 0);position:relative}}.jp-connection__connect-screen-required-plan__loading{display:none}.jp-connection__connect-screen-required-plan ul.jp-product-promote{margin-block-end:calc(var(--spacing-base)*4);margin-block-start:calc(var(--spacing-base)*3)}@media(min-width:1080px){.jp-connection__connect-screen-required-plan__pricing-card{left:calc(var(--spacing-base)*12);position:absolute;top:calc(var(--spacing-base)*8)}}.jp-connection__connect-screen-required-plan__pricing-card .jp-action-button--button.components-button{align-items:center;background:var(--jp-black)!important;border-radius:var(--jp-border-radius);color:var(--jp-white)!important;font-size:18px;font-weight:500;height:auto;justify-content:center;margin:24px 0 32px;padding:14px 24px;width:100%}.jp-connection__connect-screen-required-plan__pricing-card .jp-action-button--button.components-button:disabled{background:var(--jp-gray)!important;color:var(--jp-gray-20)!important}.jp-connection__connect-screen-required-plan__pricing-card .terms-of-service{margin-bottom:var(--spacing-base);margin-top:calc(var(--spacing-base)*4)}.jp-connection__connect-screen-required-plan__with-subscription{display:flex;flex-wrap:wrap;gap:1ch;justify-content:flex-start;line-height:1;margin-top:calc(var(--spacing-base)*4)}.jp-connection__connect-screen-required-plan__with-subscription .jp-action-button--button.components-button.is-primary{background:inherit!important;color:var(--jp-black)!important;display:inline;font-size:var(--font-title-small);height:auto;line-height:20px;font:inherit;min-width:0;padding:0;text-decoration:underline;width:auto}.jp-connection__connect-screen-required-plan__with-subscription .jp-action-button--button.components-button.is-primary:hover{background:inherit;text-decoration-thickness:var(--jp-underline-thickness)}.jp-connection__connect-screen-required-plan__with-subscription .jp-action-button--button.components-button.is-primary:focus{background:inherit;box-shadow:none!important}.jp-connection__connect-screen-required-plan__with-subscription .jp-components-spinner__inner,.jp-connection__connect-screen-required-plan__with-subscription .jp-components-spinner__outer{border-left-color:var(--jp-black);border-top-color:var(--jp-black)}.TcCZnGE6mad8Dvz9pCZi{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0ibm9uZSI+PHBhdGggc3Ryb2tlPSIjRDYzNjM5IiBzdHJva2Utd2lkdGg9IjEuNSIgZD0iTTEyIDIwYTggOCAwIDEgMCAwLTE2IDggOCAwIDAgMCAwIDE2WiIvPjxwYXRoIGZpbGw9IiNENjM2MzkiIGQ9Ik0xMyA3aC0ydjZoMnpNMTMgMTVoLTJ2MmgyeiIvPjwvc3ZnPg==) no-repeat 100% 0;color:var(--jp-red);line-height:25px;padding-right:25px}._mn6o2Dtm5pfFWc8_A1K{--spacing-base:8px;min-width:264px}.zI5tJ_qhWE6Oe6Lk75GY{--wp-admin-theme-color:var(--jp-black);--wp-admin-theme-color-darker-10:var(--jp-black-80);--wp-admin-theme-color-darker-20:var(--jp-black-80);--wp-admin-border-width-focus:1.51px;border-radius:var(--jp-border-radius);font-weight:600;justify-content:center}.zI5tJ_qhWE6Oe6Lk75GY.tuBt2DLqimiImoqVzPqo{height:calc(var(--spacing-base)*5);padding:var(--spacing-base);width:calc(var(--spacing-base)*5)}.zI5tJ_qhWE6Oe6Lk75GY.tuBt2DLqimiImoqVzPqo>svg:first-child{margin:0;padding:0}.zI5tJ_qhWE6Oe6Lk75GY.tuBt2DLqimiImoqVzPqo.Na39I683LAaSA99REg14{height:calc(var(--spacing-base)*4);min-width:calc(var(--spacing-base)*4);padding:calc(var(--spacing-base)/2);width:calc(var(--spacing-base)*4)}.zI5tJ_qhWE6Oe6Lk75GY.ipS7tKy9GntCS4R3vekF:not(.tuBt2DLqimiImoqVzPqo){font-size:var(--font-body);height:auto;line-height:24px;padding:var(--spacing-base) calc(var(--spacing-base)*3)}.zI5tJ_qhWE6Oe6Lk75GY.ipS7tKy9GntCS4R3vekF:not(.tuBt2DLqimiImoqVzPqo).paGLQwtPEaJmtArCcmyK{padding:var(--spacing-base) calc(var(--spacing-base)*2)}.zI5tJ_qhWE6Oe6Lk75GY.Na39I683LAaSA99REg14:not(.tuBt2DLqimiImoqVzPqo){font-size:var(--font-body-extra-small);height:auto;line-height:20px;padding:calc(var(--spacing-base)/2) var(--spacing-base)}.zI5tJ_qhWE6Oe6Lk75GY.Na39I683LAaSA99REg14:not(.tuBt2DLqimiImoqVzPqo).paGLQwtPEaJmtArCcmyK>svg:first-child{margin-left:calc(var(--spacing-base)/2)}.zI5tJ_qhWE6Oe6Lk75GY.Na39I683LAaSA99REg14:not(.tuBt2DLqimiImoqVzPqo)>.components-spinner{height:20px}.zI5tJ_qhWE6Oe6Lk75GY.lZAo6_oGfclXOO9CC6Rd{font-weight:400}.zI5tJ_qhWE6Oe6Lk75GY.xJDOiJxTt0R_wSl8Ipz_{min-width:100%}.zI5tJ_qhWE6Oe6Lk75GY.is-primary:disabled,.zI5tJ_qhWE6Oe6Lk75GY.is-secondary:disabled{background:var(--jp-gray);color:var(--jp-gray-20)}.zI5tJ_qhWE6Oe6Lk75GY.is-secondary{background:var(--jp-white);box-shadow:inset 0 0 0 1.51px var(--jp-black)}.zI5tJ_qhWE6Oe6Lk75GY.is-secondary:active:not(:disabled),.zI5tJ_qhWE6Oe6Lk75GY.is-secondary:hover:not(:disabled){background:var(--jp-gray-0)}.zI5tJ_qhWE6Oe6Lk75GY.is-link.Na39I683LAaSA99REg14,.zI5tJ_qhWE6Oe6Lk75GY.is-link.ipS7tKy9GntCS4R3vekF{padding:0}.zI5tJ_qhWE6Oe6Lk75GY.is-link:hover:not(:disabled){text-decoration-thickness:3px}.zI5tJ_qhWE6Oe6Lk75GY.is-link:focus:not(:disabled){text-decoration-line:none}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-primary{box-shadow:none}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-primary:not(:disabled){background:var(--jp-red-50);box-shadow:inset 0 0 0 1px var(--jp-red-50);color:var(--jp-white)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-primary:hover:not(:disabled){background:var(--jp-red-60);box-shadow:inset 0 0 0 1px var(--jp-red-60)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-primary:focus:not(:disabled){background:var(--jp-red-70);box-shadow:inset 0 0 0 1px var(--jp-white),0 0 0 var(--wp-admin-border-width-focus) var(--jp-red-70);color:var(--jp-white)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-primary:active:not(:disabled){background:var(--jp-red-50)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-secondary{box-shadow:none}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-secondary:not(:disabled){background:var(--jp-white);box-shadow:inset 0 0 0 1.5px var(--jp-red-50);color:var(--jp-red-50)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-secondary:hover:not(:disabled){background:var(--jp-red-0);box-shadow:inset 0 0 0 1.5px var(--jp-red-60);color:var(--jp-red-60)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-secondary:focus:not(:disabled){box-shadow:inset 0 0 0 1px var(--jp-white),0 0 0 var(--wp-admin-border-width-focus) var(--jp-red-70);color:var(--jp-red-70)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-secondary:active:not(:disabled){background:var(--jp-gray-0)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-link:not(:disabled){color:var(--jp-red-50)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-link:hover:not(:disabled){box-shadow:none;color:var(--jp-red-60)}.zI5tJ_qhWE6Oe6Lk75GY.is-destructive.is-link:focus:not(:disabled){box-shadow:inset 0 0 0 1px var(--jp-white),0 0 0 var(--wp-admin-border-width-focus) var(--jp-red-70);color:var(--jp-red-70)}.zI5tJ_qhWE6Oe6Lk75GY.q_tVWqMjl39RcY6WtQA6{position:relative}.zI5tJ_qhWE6Oe6Lk75GY.q_tVWqMjl39RcY6WtQA6.has-icon{justify-content:center}.zI5tJ_qhWE6Oe6Lk75GY.q_tVWqMjl39RcY6WtQA6>:not(.components-spinner){visibility:hidden}.zI5tJ_qhWE6Oe6Lk75GY.q_tVWqMjl39RcY6WtQA6>.components-spinner{margin:0;position:absolute}.CDuBjJp_8jxzx5j6Nept{margin-right:calc(var(--spacing-base)/2)}.jp-connection__connect-screen-layout{background:var(--jp-white);border-radius:4px;box-shadow:0 0 40px rgba(0,0,0,.08)}.jp-connection__connect-screen-layout__loading{display:none}.jp-connection__connect-screen-layout__left,.jp-connection__connect-screen-layout__right{box-sizing:border-box}.jp-connection__connect-screen-layout__left{padding:calc(var(--spacing-base)*3)}@media(min-width:600px){.jp-connection__connect-screen-layout__left{padding:64px 96px}}.jp-connection__connect-screen-layout__left .jetpack-logo{margin-bottom:24px}.jp-connection__connect-screen-layout__left h2{color:var(--jp-black);font-size:36px;font-style:normal;font-weight:700;line-height:40px;margin-bottom:0;margin-top:32px}.jp-connection__connect-screen-layout__left h3{color:var(--jp-black);font-size:24px;font-style:normal;font-weight:500;line-height:32px;margin-bottom:0;margin-top:32px}.jp-connection__connect-screen-layout__left li,.jp-connection__connect-screen-layout__left p{font-size:16px;font-style:normal;font-weight:400;line-height:24px}.jp-connection__connect-screen-layout__left p{color:#101517;margin:16px 0}.jp-connection__connect-screen-layout__left a{color:var(--jp-black);font-size:var(--font-body);font:inherit;height:auto;padding:0;text-decoration:underline}.jp-connection__connect-screen-layout__left a:hover{color:var(--jp-black);text-decoration-thickness:var(--jp-underline-thickness)}.jp-connection__connect-screen-layout__left a:focus{box-shadow:none!important;color:var(--jp-black)}.jp-connection__connect-screen-layout__left ul{list-style-type:none;padding:0}.jp-connection__connect-screen-layout__left ul li{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAANlBMVEVHcEwFnwUInggGnggGnggHnAcAnwUFnQcAnwcGnwkFnQgGnQgFnwcGnQYFnQcFnAcGnQkDnwdhiL0pAAAAEnRSTlMAMF//f2Aw7yBQ3+9gcIBgcED+HDbkAAAAZklEQVR4Ae3LNwICARDDQC0+cv7/Y8mwV9odSfWIcf/+VegnGkIvDaGXKvTTn/Gz+Uf5xTL0K1XotS7fs5H6GHvvaO8d7c3j7rdgHne/A/PYt/cO+R42oYdN6OEQetiFHo4A//6dAXqtBEkmtWutAAAAAElFTkSuQmCC) no-repeat;background-size:24px;color:var(--jp-black);margin-bottom:9px;padding-right:30px}.jp-connection__connect-screen-layout__right{padding:64px 0}.jp-connection__connect-screen-layout__right img{max-width:100%}.jp-connection__connect-screen-layout__two-columns{display:flex;flex-wrap:wrap}.jp-connection__connect-screen-layout__two-columns .jp-connection__connect-screen-layout__left{flex-basis:100%;flex-grow:1}@media(min-width:1080px){.jp-connection__connect-screen-layout__two-columns .jp-connection__connect-screen-layout__left{flex-basis:52%}}.jp-connection__connect-screen-layout__two-columns .jp-connection__connect-screen-layout__right{background:#f9f9f6;display:none;flex-basis:47%;flex-grow:1}@media(min-width:1080px){.jp-connection__connect-screen-layout__two-columns .jp-connection__connect-screen-layout__right{display:block}}.rna{overflow:hidden}.rna .jp-connection__connect-screen-layout__left{position:relative;z-index:2}.rna .jp-connection__connect-screen-layout__left h2{font-weight:700;margin-top:0}.rna .jp-connection__connect-screen-layout__left h3{margin-top:24px}@media(min-width:600px){.rna .jp-connection__connect-screen-layout__left{padding:4rem 4rem 4rem 6rem}}@media(min-width:1080px){.rna .jp-connection__connect-screen-required-plan__pricing-card{left:calc(var(--spacing-base)*-45);position:absolute;top:calc(var(--spacing-base)*9.25)}}.rna .jp-connection__connect-screen-required-plan__pricing-card .jp-components__pricing-card{border-radius:var(--jp-border-radius-rna);max-width:100%;width:425px}.rna .jp-connection__connect-screen-required-plan__pricing-card .jp-components__pricing-card__title{margin-top:.625rem}@media(min-width:960px){.rna .jp-connection__connect-screen-required-plan__pricing-card .jp-components__pricing-card{padding:3rem}}.rna .jp-connection__connect-screen-required-plan__pricing-card .components-button{margin-bottom:0}.rna .jp-backup-dashboard-promotion ul.jp-product-promote li{margin-bottom:.75rem}.rna .jp-connection__connect-screen-layout__color-blobs{clip-path:polygon(100% 0,100% 100%,0 0,0 0);display:none;height:677px;left:0;position:absolute;top:0;width:363px;z-index:1}.rna .jp-connection__connect-screen-layout__color-blobs__blue,.rna .jp-connection__connect-screen-layout__color-blobs__green,.rna .jp-connection__connect-screen-layout__color-blobs__yellow{border-radius:50%;filter:blur(50px);position:absolute}.rna .jp-connection__connect-screen-layout__color-blobs__blue{background-color:var(--jp-blue-5);height:400px;left:-100px;top:-275px;width:400px;z-index:3}.rna .jp-connection__connect-screen-layout__color-blobs__yellow{background-color:var(--jp-yellow-5);height:250px;left:-25px;top:10px;width:250px;z-index:2}.rna .jp-connection__connect-screen-layout__color-blobs__green{background-color:var(--jp-green-5);height:300px;left:0;top:175px;width:300px;z-index:1}@media(min-width:1080px){.rna .jp-connection__connect-screen-layout__color-blobs{display:initial}}.jp-components__pricing-card{background:var(--jp-white);border-radius:var(--jp-border-radius);box-shadow:0 10px 40px rgba(0,0,0,.08);max-width:384px;padding:24px 24px 32px;width:-moz-fit-content;width:fit-content}@media screen and (min-width:600px){.jp-components__pricing-card{padding:32px 32px 44px}}.jp-components__pricing-card__icon img{height:32px;width:32px}.jp-components__pricing-card__title{color:#101517;font-size:32px;line-height:38px;margin:16px 0 24px}.jp-components__pricing-card__pricing{display:flex;flex-wrap:wrap}.jp-components__pricing-card__price-after,.jp-components__pricing-card__price-before{display:inline-block;font-size:54px;font-weight:700;line-height:40px;margin-bottom:8px;padding:0 2px}.jp-components__pricing-card__price-before{color:var(--jp-gray-20);margin-left:16px;position:relative}.jp-components__pricing-card__price-strikethrough{background:var(--jp-pink);border-radius:1.5px;height:3px;position:absolute;right:0;top:20px;width:100%}.jp-components__pricing-card__price-after{color:var(--jp-black)}.jp-components__pricing-card__currency{font-size:var(--font-title-small);font-weight:400;line-height:20px;vertical-align:super}.jp-components__pricing-card__price-details{align-self:flex-end;color:var(--jp-gray-50);font-size:14px;font-weight:400;letter-spacing:-.02em;line-height:17px;margin-bottom:8px}.jp-components__pricing-card__price-decimal{font-size:var(--font-label);line-height:14px;vertical-align:top}.jp-components__pricing-card__button{align-items:center;background:var(--jp-black);border-radius:var(--jp-border-radius);color:var(--jp-white)!important;font-size:18px;height:auto;justify-content:center;margin:24px 0 32px;padding:14px 24px;width:100%}.jp-components__pricing-card__info,.jp-components__pricing-card__tos{color:var(--jp-gray-60);font-size:var(--font-label);letter-spacing:-.02em;line-height:20px}.jp-components__pricing-card__tos{margin-top:24px}.terms-of-service{color:var(--jp-black);font-size:var(--font-body)}.terms-of-service .terms-of-service__link{color:var(--jp-green-50);text-decoration:underline;white-space:nowrap}.WQVtrU6q0L1Igcj7wCrQ{margin:0;padding:0}.UujoBFTnQNY2cWU2SIsH{font-size:var(--font-headline-medium);font-weight:700;line-height:52px}.TeGO5V_thHw5lDAm1_2M{font-weight:700}.TeGO5V_thHw5lDAm1_2M,.WolQzb2MsSgiNmLtc7_j{font-size:var(--font-headline-small);line-height:40px}.WolQzb2MsSgiNmLtc7_j{font-weight:400}.hUB0JT8p1T2Hw28N6qC8{font-weight:500}.gKZWDv5chz3_O3Syp74H,.hUB0JT8p1T2Hw28N6qC8{font-size:var(--font-title-medium);line-height:32px}.gKZWDv5chz3_O3Syp74H{font-weight:600}.zY2No8Ga4b8shbOQGhnv{font-size:var(--font-title-small);font-weight:500;line-height:30px}.tIj0D1t8Cc892ikmgFPZ{font-size:var(--font-body);font-weight:400;line-height:24px}.KdcN0BnOaVeVhyLRKqhS{font-size:var(--font-body-small);font-weight:400;line-height:24px}.dso3Rh3tl3Xv1GumBktz{font-weight:400}.dso3Rh3tl3Xv1GumBktz,.mQ1UlbN9u4Mg9byO8m7v{font-size:var(--font-body-extra-small);line-height:20px}.mQ1UlbN9u4Mg9byO8m7v{font-weight:700}.PItlW5vRExLnTj4a8eLE{font-size:var(--font-body-extra-small);font-weight:600;line-height:16px}.TwRpPlktzxhmFVeua7P5{margin:calc(var( --spacing-base )*0)}.zVfqx7gyb3o9mxfGynn1{margin-left:calc(var( --spacing-base )*0);margin-right:calc(var( --spacing-base )*0)}.iSHVzNiB9iVleGljaQxy{margin-bottom:calc(var( --spacing-base )*0)}.iSHVzNiB9iVleGljaQxy,.xqDIp6cNVr_E6RXaiPyD{margin-top:calc(var( --spacing-base )*0)}.S8EwaXk1kyPizt6x4WH2{margin-left:calc(var( --spacing-base )*0)}.ODX5Vr1TARoLFkDDFooD{margin-bottom:calc(var( --spacing-base )*0)}.cphJ8dCpfimnky7P2FHg{margin-right:calc(var( --spacing-base )*0)}.PFgIhNxIyiSuNvQjAIYj{margin:calc(var( --spacing-base )*1)}.M2jKmUzDxvJjjVEPU3zn{margin-left:calc(var( --spacing-base )*1);margin-right:calc(var( --spacing-base )*1)}.io15gAh8tMTNbSEfwJKk{margin-bottom:calc(var( --spacing-base )*1)}.io15gAh8tMTNbSEfwJKk,.rcTN5uw9xIEeMEGL3Xi_{margin-top:calc(var( --spacing-base )*1)}.CQSkybjq2TcRM1Xo9COV{margin-left:calc(var( --spacing-base )*1)}.hfqOWgq6_MEGdFE82eOY{margin-bottom:calc(var( --spacing-base )*1)}.I8MxZQYTbuu595yfesWA{margin-right:calc(var( --spacing-base )*1)}.kQkc6rmdpvLKPkyoJtVQ{margin:calc(var( --spacing-base )*2)}.j6vFPxWuu4Jan2ldoxpp{margin-left:calc(var( --spacing-base )*2);margin-right:calc(var( --spacing-base )*2)}.hqr39dC4H_AbactPAkCG{margin-bottom:calc(var( --spacing-base )*2)}.c3dQnMi16C6J6Ecy4283,.hqr39dC4H_AbactPAkCG{margin-top:calc(var( --spacing-base )*2)}.YNZmHOuRo6hU7zzKfPdP{margin-left:calc(var( --spacing-base )*2)}.Db8lbak1_wunpPk8NwKU{margin-bottom:calc(var( --spacing-base )*2)}.ftsYE5J9hLzquQ0tA5dY{margin-right:calc(var( --spacing-base )*2)}.Det4MHzLUW7EeDnafPzq{margin:calc(var( --spacing-base )*3)}.h_8EEAztC29Vve1datb5{margin-left:calc(var( --spacing-base )*3);margin-right:calc(var( --spacing-base )*3)}.YXIXJ0h1k47u6hzK8KcM{margin-bottom:calc(var( --spacing-base )*3)}.YXIXJ0h1k47u6hzK8KcM,.soADBBkcIKCBXzCTuV9_{margin-top:calc(var( --spacing-base )*3)}.zSX59ziEaEWGjnpZa4uV{margin-left:calc(var( --spacing-base )*3)}.yrVTnq_WBMbejg89c2ZQ{margin-bottom:calc(var( --spacing-base )*3)}.UKtHPJnI2cXBWtPDm5hM{margin-right:calc(var( --spacing-base )*3)}.guexok_Tqd5Tf52hRlbT{margin:calc(var( --spacing-base )*4)}.oS1E2KfTBZkJ3F0tN7T6{margin-left:calc(var( --spacing-base )*4);margin-right:calc(var( --spacing-base )*4)}.DN1OhhXi6AoBgEdDSbGd{margin-bottom:calc(var( --spacing-base )*4)}.DN1OhhXi6AoBgEdDSbGd,.ot2kkMcYHv53hLZ4LSn0{margin-top:calc(var( --spacing-base )*4)}.A1krOZZhlQ6Sp8Cy4bly{margin-left:calc(var( --spacing-base )*4)}.pkDbXXXL32237M0hokEh{margin-bottom:calc(var( --spacing-base )*4)}.XXv4kDTGvEnQeuGKOPU3{margin-right:calc(var( --spacing-base )*4)}.yGqHk1a57gaISwkXwXe6{margin:calc(var( --spacing-base )*5)}.X8cghM358X3DkXLc9aNK{margin-left:calc(var( --spacing-base )*5);margin-right:calc(var( --spacing-base )*5)}.GdfSmGwHlFnN2S6xBn1f{margin-bottom:calc(var( --spacing-base )*5)}.GdfSmGwHlFnN2S6xBn1f,.yqeuzwyGQ7zG0avrGqi_{margin-top:calc(var( --spacing-base )*5)}.g9emeCkuHvYhveiJbfXO{margin-left:calc(var( --spacing-base )*5)}.Lvk3dqcyHbZ07QCRlrUQ{margin-bottom:calc(var( --spacing-base )*5)}.r3yQECDQ9qX0XZzXlVAg{margin-right:calc(var( --spacing-base )*5)}.aQhlPwht2Cz1X_63Miw0{margin:calc(var( --spacing-base )*6)}.JyHb0vK3wJgpblL9s5j8{margin-left:calc(var( --spacing-base )*6);margin-right:calc(var( --spacing-base )*6)}.cY2gULL1lAv6WPNIRuf3{margin-bottom:calc(var( --spacing-base )*6)}.NBWQ9Lwhh_fnry3lg_p7,.cY2gULL1lAv6WPNIRuf3{margin-top:calc(var( --spacing-base )*6)}.yIOniNe5E40C8fWvBm5V{margin-left:calc(var( --spacing-base )*6)}.t30usboNSyqfQWIwHvT3{margin-bottom:calc(var( --spacing-base )*6)}.Nm_TyFkYCMhOoghoToKJ{margin-right:calc(var( --spacing-base )*6)}.C4qJKoBXpgKtpmrqtEKB{margin:calc(var( --spacing-base )*7)}.S93Srbu6NQ_PBr7DmTiD{margin-left:calc(var( --spacing-base )*7);margin-right:calc(var( --spacing-base )*7)}.fJj8k6gGJDks3crUZxOS{margin-bottom:calc(var( --spacing-base )*7)}.cW6D6djs7Ppm7fD7TeoV,.fJj8k6gGJDks3crUZxOS{margin-top:calc(var( --spacing-base )*7)}.DuCnqNfcxcP3Z__Yo5Ro{margin-left:calc(var( --spacing-base )*7)}.im8407m2fw5vOg7O2zsw{margin-bottom:calc(var( --spacing-base )*7)}.G0fbeBgvz2sh3uTP9gNl{margin-right:calc(var( --spacing-base )*7)}.kvW3sBCxRxUqz1jrVMJl{margin:calc(var( --spacing-base )*8)}.tOjEqjLONQdkiYx_XRnw{margin-left:calc(var( --spacing-base )*8);margin-right:calc(var( --spacing-base )*8)}.op5hFSx318zgxsoZZNLN{margin-bottom:calc(var( --spacing-base )*8)}.c9WfNHP6TFKWIfLxv52J,.op5hFSx318zgxsoZZNLN{margin-top:calc(var( --spacing-base )*8)}.sBA75QqcqRwwYSHJh2wc{margin-left:calc(var( --spacing-base )*8)}.GpL6idrXmSOM6jB8Ohsf{margin-bottom:calc(var( --spacing-base )*8)}.HbtWJoQwpgGycz8dGzeT{margin-right:calc(var( --spacing-base )*8)}.uxX3khU88VQ_Ah49Ejsa{padding:calc(var( --spacing-base )*0)}.KX0FhpBKwKzs9fOUdbNz{padding-left:calc(var( --spacing-base )*0);padding-right:calc(var( --spacing-base )*0)}.PfK8vKDyN32dnimlzYjz{padding-bottom:calc(var( --spacing-base )*0)}.PfK8vKDyN32dnimlzYjz,.emxLHRjQuJsImnPbQIzE{padding-top:calc(var( --spacing-base )*0)}.kJ8WzlpTVgdViXt8ukP9{padding-left:calc(var( --spacing-base )*0)}.tg_UIUI11VBzrTAn2AzJ{padding-bottom:calc(var( --spacing-base )*0)}.uczvl8kaz84oPQJ2DB2R{padding-right:calc(var( --spacing-base )*0)}.o7UHPcdVK3lt7q3lqV4o{padding:calc(var( --spacing-base )*1)}.IDqEOxvDoYrFYxELPmtX{padding-left:calc(var( --spacing-base )*1);padding-right:calc(var( --spacing-base )*1)}.DdywPW2qSYlu2pt8tpO2{padding-bottom:calc(var( --spacing-base )*1)}.DdywPW2qSYlu2pt8tpO2,.npy3hw4A5QSkDicb2CJJ{padding-top:calc(var( --spacing-base )*1)}.LgbptTApNY5NwLQvEFAt{padding-left:calc(var( --spacing-base )*1)}.WZQy2SZuZso59bUsXXyl{padding-bottom:calc(var( --spacing-base )*1)}.o331apInxNunbYB3SfPE{padding-right:calc(var( --spacing-base )*1)}.fMPIyD9Vqki1Lrc_yJnG{padding:calc(var( --spacing-base )*2)}.i2pMcTcdrr10IQoiSm_L{padding-left:calc(var( --spacing-base )*2);padding-right:calc(var( --spacing-base )*2)}.eA702gn32kwptiI1obXH{padding-bottom:calc(var( --spacing-base )*2)}.eA702gn32kwptiI1obXH,.o9bGieUKcYc8o0Ij9oZX{padding-top:calc(var( --spacing-base )*2)}.SwZcFez1RDqWsOFjB5iG{padding-left:calc(var( --spacing-base )*2)}.eHpLc_idmuEqeqCTvqkN{padding-bottom:calc(var( --spacing-base )*2)}.vU39i2B4P1fUTMB2l6Vo{padding-right:calc(var( --spacing-base )*2)}.JHWNzBnE29awhdu5BEh1{padding:calc(var( --spacing-base )*3)}.X72lGbb56L3KFzC2xQ9N{padding-left:calc(var( --spacing-base )*3);padding-right:calc(var( --spacing-base )*3)}.BzfNhRG8wXdCEB5ocQ6e{padding-bottom:calc(var( --spacing-base )*3)}.BzfNhRG8wXdCEB5ocQ6e,.srV0KSDC83a2fiimSMMQ{padding-top:calc(var( --spacing-base )*3)}.lUWfkmbQjCskhcNwkyCm{padding-left:calc(var( --spacing-base )*3)}.Ts0dIlc3aTSL7V4cIHis{padding-bottom:calc(var( --spacing-base )*3)}.CzlqQXXhX6MvorArFZ8B{padding-right:calc(var( --spacing-base )*3)}.TqMPkQtR_DdZuKb5vBoV{padding:calc(var( --spacing-base )*4)}.a7UrjhI69Vetlcj9ZVzz{padding-left:calc(var( --spacing-base )*4);padding-right:calc(var( --spacing-base )*4)}.StEhBzGs2Gi5dDEkjhAv{padding-bottom:calc(var( --spacing-base )*4)}.FGneZfZyvYrt1dG0zcnm,.StEhBzGs2Gi5dDEkjhAv{padding-top:calc(var( --spacing-base )*4)}.APEH216rpdlJWgD2fHc8{padding-left:calc(var( --spacing-base )*4)}.oGwXC3ohCic9XnAj6x69{padding-bottom:calc(var( --spacing-base )*4)}.U6gnT9y42ViPNOcNzBwb{padding-right:calc(var( --spacing-base )*4)}.IpdRLBwnHqbqFrixgbYC{padding:calc(var( --spacing-base )*5)}.HgNeXvkBa9o3bQ5fvFZm{padding-left:calc(var( --spacing-base )*5);padding-right:calc(var( --spacing-base )*5)}.tJtFZM3XfPG9v9TSDfN1{padding-bottom:calc(var( --spacing-base )*5)}.PdifHW45QeXYfK568uD8,.tJtFZM3XfPG9v9TSDfN1{padding-top:calc(var( --spacing-base )*5)}.mbLkWTTZ0Za_BBbFZ5b2{padding-left:calc(var( --spacing-base )*5)}.vVWpZpLlWrkTt0hMk8XU{padding-bottom:calc(var( --spacing-base )*5)}.RxfaJj5a1Nt6IavEo5Zl{padding-right:calc(var( --spacing-base )*5)}.SppJULDGdnOGcjZNCYBy{padding:calc(var( --spacing-base )*6)}.palY2nLwdoyooPUm9Hhk{padding-left:calc(var( --spacing-base )*6);padding-right:calc(var( --spacing-base )*6)}.WYw1JvZC0ppLdvSAPhr_{padding-bottom:calc(var( --spacing-base )*6)}.WYw1JvZC0ppLdvSAPhr_,.YEEJ9b90ueQaPfiU8aeN{padding-top:calc(var( --spacing-base )*6)}.QE0ssnsKvWJMqlhPbY5u{padding-left:calc(var( --spacing-base )*6)}.n8yA3jHlMRyLd5UIfoND{padding-bottom:calc(var( --spacing-base )*6)}.tXHmxYnHzbwtfxEaG51n{padding-right:calc(var( --spacing-base )*6)}.kBTsPKkO_3g_tLkj77Um{padding:calc(var( --spacing-base )*7)}.RyhrFx6Y1FGDrGAAyaxm{padding-left:calc(var( --spacing-base )*7);padding-right:calc(var( --spacing-base )*7)}.CBwRpB0bDN3iEdQPPMJO{padding-bottom:calc(var( --spacing-base )*7)}.CBwRpB0bDN3iEdQPPMJO,.vQVSq6SvWKbOMu6r4H6b{padding-top:calc(var( --spacing-base )*7)}.oBy5__aEADMsH46mrgFX{padding-left:calc(var( --spacing-base )*7)}.KVEXoJqf1s92j0JMdNmN{padding-bottom:calc(var( --spacing-base )*7)}.ZMXGNrNaKW3k_3TLz0Fq{padding-right:calc(var( --spacing-base )*7)}.tuiR9PhkHXhGyEgzRZRI{padding:calc(var( --spacing-base )*8)}.U7454qyWkQNa2iaSJziu{padding-left:calc(var( --spacing-base )*8);padding-right:calc(var( --spacing-base )*8)}.VLYIv2GVocjuN93e8HC8{padding-bottom:calc(var( --spacing-base )*8)}.VLYIv2GVocjuN93e8HC8,.X1rm9DQ1zLGLfogja5Gn{padding-top:calc(var( --spacing-base )*8)}.JS7G6kAuqJo5GIuF8S5t{padding-left:calc(var( --spacing-base )*8)}.Y8F9ga1TDCMbM1lj4gUz{padding-bottom:calc(var( --spacing-base )*8)}.AJuyNGrI63BOWql719H8{padding-right:calc(var( --spacing-base )*8)}.dops-notice{animation:appear .3s ease-in-out;background:#414141;border-radius:3px;box-sizing:border-box;color:#fff;display:flex;line-height:1.5;margin-bottom:24px;position:relative;width:100%}.dops-notice.is-success .dops-notice__icon-wrapper{background:#4ab866}.dops-notice.is-warning .dops-notice__icon-wrapper{background:#f0b849}.dops-notice.is-error .dops-notice__icon-wrapper{background:#d94f4f}.dops-notice.is-info .dops-notice__icon-wrapper{background:#3582c4}.dops-notice .dops-notice__dismiss,.dops-notice.is-error .dops-notice__dismiss,.dops-notice.is-info .dops-notice__dismiss,.dops-notice.is-success .dops-notice__dismiss,.dops-notice.is-warning .dops-notice__dismiss{overflow:hidden}.dops-notice__icon-wrapper{align-items:baseline;align-self:stretch;background:#747474;border-radius:0 3px 3px 0;color:#fff;display:flex;flex-shrink:0;justify-content:center;width:47px}.dops-notice__icon-wrapper .gridicon{margin-top:10px}@media(min-width:481px){.dops-notice__icon-wrapper .gridicon{margin-top:12px}}.dops-notice__content.dops-notice__content{flex-grow:1;font-size:12px;padding:13px}@media(min-width:481px){.dops-notice__content.dops-notice__content{font-size:14px}}.dops-notice__content.dops-notice__content a{color:#fff;text-decoration:underline}.dops-notice__content.dops-notice__content a:hover,.dops-notice__text a.dops-notice__text-no-underline{text-decoration:none}.dops-notice__text a,.dops-notice__text a:visited{color:#fff;text-decoration:underline}.dops-notice__text a:hover,.dops-notice__text a:visited:hover{color:#fff;text-decoration:none}.dops-notice__text ul{margin-bottom:0;margin-right:0}.dops-notice__text li{margin-right:2em;margin-top:.5em}.dops-notice__text p{margin-bottom:0;margin-top:.5em}.dops-notice__text p:first-child{margin-top:0}.dops-notice__button{cursor:pointer;margin-right:.428em}.dops-notice__dismiss{cursor:pointer;flex-shrink:0;padding:12px 12px 0}.dops-notice__dismiss .gridicon{height:18px;width:18px}@media(min-width:481px){.dops-notice__dismiss{padding:11px 11px 0}.dops-notice__dismiss .gridicon{height:24px;width:24px}}.dops-notice .dops-notice__dismiss{color:#bbb}.dops-notice .dops-notice__dismiss:focus,.dops-notice .dops-notice__dismiss:hover{color:#fff}a.dops-notice__action{align-items:center;color:#bbb;cursor:pointer;display:flex;font-size:12px;font-weight:400;padding:13px;text-decoration:none;white-space:nowrap}@media(min-width:481px){a.dops-notice__action{align-items:center;border-radius:0;flex-grow:0;flex-shrink:1;font-size:14px;margin:0 auto 0 0;padding:13px 16px}a.dops-notice__action .gridicon{height:24px;width:24px}}a.dops-notice__action:visited{color:#bbb}a.dops-notice__action:hover{color:#fff}a.dops-notice__action .gridicon{height:18px;margin-right:8px;opacity:.7;width:18px}.dops-notice.is-compact{border-radius:3px;display:inline-flex;flex-direction:row;flex-wrap:nowrap;line-height:1.5;margin:0;min-height:20px;padding:0;text-decoration:none;text-transform:none;vertical-align:middle;width:auto}.dops-notice.is-compact .dops-notice__content{font-size:12px;padding:6px 10px}.dops-notice.is-compact .dops-notice__icon-wrapper{width:28px}.dops-notice.is-compact .dops-notice__icon-wrapper .dops-notice__icon{height:18px;margin:0;width:18px}.dops-notice.is-compact .dops-notice__icon-wrapper .gridicon{margin-top:6px}.dops-notice.is-compact .dops-notice__dismiss{align-self:center;flex:none;margin:0 0 0 8px;padding:0;position:relative}.dops-notice.is-compact .dops-notice__dismiss .gridicon{height:18px;width:18px}.dops-notice.is-compact a.dops-notice__action{align-self:center;background:transparent;display:inline-block;font-size:12px;margin:0 16px 0 0;padding:0 10px}.dops-notice.is-compact a.dops-notice__action:active,.dops-notice.is-compact a.dops-notice__action:focus,.dops-notice.is-compact a.dops-notice__action:hover{background:transparent}.dops-notice.is-compact a.dops-notice__action .gridicon{height:14px;margin-right:8px;opacity:1;vertical-align:sub;width:14px}.gridicon{fill:currentColor;display:inline-block}.gridicon.needs-offset g{transform:translate(-1px,1px)}.gridicon.needs-offset-x g{transform:translate(-1px)}.gridicon.needs-offset-y g{transform:translateY(1px)}@keyframes appear{0%{opacity:0}to{opacity:1}}.global-notices{bottom:0;left:0;pointer-events:none;position:fixed;right:0;text-align:left;top:auto;z-index:179}@media(min-width:661px){.global-notices{bottom:auto;left:16px;max-width:calc(100% - 68px);right:auto;top:63px}}@media(min-width:961px){.global-notices{left:24px;max-width:calc(100% - 208px);top:71px}}@media(min-width:1041px){.global-notices{left:32px;max-width:calc(100% - 224px)}}.global-notices .dops-notice{border-radius:0;box-shadow:0 2px 5px rgba(0,0,0,.2),0 0 56px rgba(0,0,0,.15);flex-wrap:nowrap;margin-bottom:0;pointer-events:auto;text-align:right}.global-notices .dops-notice .dops-notice__icon-wrapper{border-radius:0}@media(min-width:661px){.global-notices .dops-notice{border-radius:3px;display:flex;margin-bottom:24px;overflow:hidden}.global-notices .dops-notice .dops-notice__icon-wrapper{border-radius:0 3px 3px 0}.global-notices .dops-notice a.dops-notice__action{font-size:14px;padding:13px 16px}}.global-notices .dops-notice__dismiss{flex-shrink:0}@media(min-width:661px){.global-notices .dops-notice__dismiss{padding:13px 16px 0}}.jp-mocked-instant-search{background:#fff;border-radius:3px;box-shadow:0 5px 25px rgba(0,0,0,.35);font-size:.75em;height:100%;margin:0 auto;overflow:hidden;user-select:none;width:100%}.jp-mocked-instant-search__search-controls{align-items:center;border-bottom:1px solid #e6f1f5;display:flex;flex-flow:row nowrap;justify-content:space-between}.jp-mocked-instant-search__search-icon{align-items:center;display:flex;height:60px;justify-content:center;width:60px}@media(max-width:660px){.jp-mocked-instant-search__search-icon{height:45px;width:45px}}.jp-mocked-instant-search__search-mock-input{width:calc(100% - 120px)}.jp-mocked-instant-search__close-button{align-items:center;background-color:transparent!important;border-right:1px solid #e6f1f5;display:flex;height:60px;justify-content:center;line-height:1;width:60px}.jp-mocked-instant-search__close-button svg.gridicon{fill:#646970}@media(max-width:660px){.jp-mocked-instant-search__close-button{height:45px;width:45px}}.jp-mocked-instant-search__search-results{display:flex;height:100%;position:relative}.jp-mocked-instant-search__search-results-primary{padding:1em 4em;width:100%}@media(min-width:661px){.jp-mocked-instant-search__search-results-primary{max-width:calc(100% - 220px)}}@media(max-width:660px){.jp-mocked-instant-search__search-results-primary{padding:2em}}.jp-mocked-instant-search__search-results-header{align-items:center;display:flex;flex-flow:row wrap;justify-content:space-between}.jp-mocked-instant-search__search-results-header .jp-mocked-instant-search__result-statistics{font-size:1em;font-weight:700}@media(max-width:480px){.jp-mocked-instant-search__search-results-header .jp-mocked-instant-search__result-statistics{width:100%}}.jp-mocked-instant-search__search-results-header .jp-mocked-instant-search__result-sort-list span{font-size:1em;margin-right:.5em}.jp-mocked-instant-search__search-results-header .jp-mocked-instant-search__result-sort-list span:first-child{margin-right:0}.jp-mocked-instant-search__search-results-header .jp-mocked-instant-search__result-sort-list .jp-mocked-instant-search__result-sort-selected{color:#069e08}@media(max-width:480px){.jp-mocked-instant-search__search-results-header .jp-mocked-instant-search__result-sort-list{width:100%}}.jp-mocked-instant-search__search-result{margin-top:1em}.jp-mocked-instant-search__search-results-secondary{background:none;border-radius:0;border-right:1px solid #e6f1f5;bottom:0;box-shadow:none;display:block;flex:none;padding-right:2em;padding-top:1em;position:static;width:220px}@media(max-width:660px){.jp-mocked-instant-search__search-results-secondary{display:none}}.jp-mocked-instant-search__search-filter-header{font-weight:700}.jp-mocked-instant-search__search-filter label{cursor:default}.jp-mocked-instant-search__search-filter label input[type=checkbox]{border:1px solid #e6e6fa;border-radius:5px;cursor:default}.jp-mocked-instant-search__search-filter span{background-color:#e6e6fa;display:inline-block;line-height:1.35;margin-right:1em;width:50em}.jp-mocked-instant-search__search-filter input[type=checkbox]{height:1em;width:1em}.jp-mocked-instant-search__search-filter-list{margin-top:1em}.jp-mocked-legacy-search{border-radius:3px;margin:0 auto;user-select:none;width:100%}.jp-mocked-legacy-search__search-controls{background:#fff;box-shadow:0 5px 25px rgba(0,0,0,.35);display:flex;flex-flow:row nowrap;width:100%}.jp-mocked-legacy-search__search-icon{align-items:center;display:flex;height:60px;justify-content:center;width:60px}.jp-mocked-legacy-search__search-input{align-items:center;display:flex;width:100%}.dops-button{-webkit-appearance:none;appearance:none;background:#f6f7f7;border:1px solid #2271b1;border-radius:3px;box-sizing:border-box;color:#2271b1;cursor:pointer;display:inline-block;font-size:.875rem;margin:0;outline:0;overflow:hidden;padding:7px 14px 9px;text-decoration:none;text-overflow:ellipsis;vertical-align:top}.dops-button:hover{background:#f0f0f1;border-color:#0a4b78;color:#0a4b78}.dops-button:disabled,.dops-button[disabled]{background:#fff;border-color:#eee;color:#eee;cursor:default}.dops-button:focus{background:#fff;border-color:#2271b1;box-shadow:0 0 0 1px #2271b1}.dops-button.is-compact{line-height:2;padding:0 10px}.dops-button.is-compact:disabled{color:#eee}.dops-button.is-compact .gridicon{margin-top:-8px;top:4px}.dops-button.is-compact .gridicons-plus-small{margin-right:-4px}.dops-button.is-compact .gridicons-plus-small:last-of-type{margin-right:0}.dops-button.is-compact .gridicons-plus-small+.gridicon{margin-right:-4px}.dops-button.hidden{display:none}.dops-button .gridicon{height:18px;margin-top:-2px;position:relative;top:4px;width:18px}.dops-button.is-primary{background:#3582c4;border-color:#3582c4;color:#fff}.dops-button.is-primary:focus,.dops-button.is-primary:hover{background:#2271b1;border-color:#2271b1;color:#fff}.dops-button.is-primary:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px #2271b1}.dops-button.is-primary:disabled,.dops-button.is-primary[disabled]{background-color:#008ec2!important;border-color:#008ec2!important;box-shadow:none!important;color:#66c6e4!important;cursor:default;text-shadow:none!important}.dops-button.is-primary.is-compact{color:#fff;white-space:nowrap}.dops-button.is-scary{color:#d94f4f}.dops-button.is-scary:focus,.dops-button.is-scary:hover{border-color:#d94f4f}.dops-button.is-scary:focus{box-shadow:0 0 0 2px #eba3a3}.dops-button.is-scary:disabled,.dops-button.is-scary[disabled]{border-color:#eee;color:#f4cdcd}.dops-button.is-primary.is-scary{background:#d94f4f;border-color:#a02222;color:#fff}.dops-button.is-primary.is-scary:focus,.dops-button.is-primary.is-scary:hover{border-color:#4c1010}.dops-button.is-primary.is-scary:disabled,.dops-button.is-primary.is-scary[disabled]{background:#eba3a3;border-color:#e48484}.dops-button.is-borderless{border:none;color:#888;padding-left:0;padding-right:0}.dops-button.is-borderless:hover{color:#414141}.dops-button.is-borderless:focus{box-shadow:none}.dops-accessible-focus .dops-button.is-borderless:focus{outline:thin dotted}.dops-button.is-borderless .gridicon{height:24px;top:6px;width:24px}.dops-button.is-borderless:disabled,.dops-button.is-borderless[disabled]{background:#fff;color:#eee;cursor:default}.dops-button.is-borderless:disabled:active,.dops-button.is-borderless[disabled]:active{border-width:0}.dops-button.is-borderless.is-scary{color:#d94f4f}.dops-button.is-borderless.is-scary:focus,.dops-button.is-borderless.is-scary:hover{color:#a02222}.dops-button.is-borderless.is-scary[disabled]{color:#f4cdcd}.dops-button.is-borderless.is-compact{background:transparent;border-radius:0}.dops-button.is-borderless.is-compact .gridicon{height:18px;top:5px;width:18px}#jp-plugin-container{min-height:100vh}.dops-card{background:#fff;box-shadow:0 0 0 1px #c3c4c7,0 1px 1px 1px rgba(0,0,0,.04);box-sizing:border-box;display:block;margin:0 auto 10px;padding:16px;position:relative}.dops-card:after{clear:both;content:".";display:block;height:0;visibility:hidden}@media(min-width:481px){.dops-card{margin-bottom:16px;padding:24px}}.dops-card.is-compact{margin-bottom:1px}@media(min-width:481px){.dops-card.is-compact{margin-bottom:1px;padding:16px 24px}}.dops-card.is-card-link{padding-left:48px}h2.dops-card-title{font-size:rem(20px)}.dops-card__link-indicator{color:#d5d5d5;display:block;height:100%;left:16px;position:absolute;top:0}a.dops-card:hover .dops-card__link-indicator{color:#bbb}a.dops-card:focus{outline:0}a.dops-card:focus .dops-card__link-indicator{color:tint(#3582c4,20%)}.form-toggle[type=checkbox]{display:none}.form-toggle__switch{border-radius:12px;box-sizing:border-box;cursor:pointer;display:inline-block;flex:none;height:24px;outline:0;padding:2px;position:relative;transition:all .4s ease,box-shadow 0s;vertical-align:middle;width:40px}.form-toggle__switch:after,.form-toggle__switch:before{content:"";display:block;height:20px;position:relative;width:20px}.form-toggle__switch:after{background:#fff;border-radius:50%;right:0;transition:all .2s ease}.form-toggle__switch:before{display:none}.dops-accessible-focus .form-toggle__switch:focus{box-shadow:0 0 0 2px #3582c4}.form-toggle__label{cursor:pointer;display:flex}.is-disabled .form-toggle__label{cursor:default}.dops-accessible-focus .form-toggle:focus+.form-toggle__label .form-toggle__switch{box-shadow:0 0 0 2px #3582c4}.dops-accessible-focus .form-toggle:focus:checked+.form-toggle__label .form-toggle__switch{box-shadow:0 0 0 2px #78dcfa}.form-toggle+.form-toggle__label .form-toggle__switch{background:#bbb}.form-toggle:not(:disabled)+.form-toggle__switch:hover{background:#d5d5d5}.form-toggle:checked+.form-toggle__label .form-toggle__switch{background:#3582c4}.form-toggle:checked+.form-toggle__label .form-toggle__switch:after{right:16px}.form-toggle:checked:not(:disabled)+.form-toggle__switch:hover{background:#78dcfa}.form-toggle:disabled+span.form-toggle__switch{cursor:default;opacity:.25}.form-toggle.is-toggling+.form-toggle__switch{background:#3582c4}.form-toggle.is-toggling:checked+.form-toggle__switch{background:#d5d5d5}.form-toggle.is-compact+.form-toggle__switch{border-radius:8px;height:16px;width:24px}.form-toggle.is-compact+.form-toggle__switch:after,.form-toggle.is-compact+.form-toggle__switch:before{height:12px;width:12px}.form-toggle.is-compact:checked+.form-toggle__switch:after{right:8px}.jp-instant-search-upsell-nudge{color:#000;cursor:pointer;font-size:1em;text-decoration:none}.jp-instant-search-upsell-nudge:hover{color:#000}.jp-form-search-settings-group{position:relative;width:100%}.jp-form-search-settings-group .dops-card{box-shadow:none;padding:4em 0 0}.jp-form-search-settings-group .form-toggle__label{margin:0}.jp-form-search-settings-group.jp-form-search-settings-group--disabled:after{background-color:hsla(0,0%,100%,.6);content:" ";height:100%;position:absolute;right:0;top:0;width:100%}.jp-form-search-settings-group__toggle.is-instant-search{margin-top:4em}.jp-form-search-settings-group__toggle .jp-form-search-settings-group__toggle-container{display:flex}@media(max-width:960px){.jp-form-search-settings-group__toggle .jp-form-search-settings-group__toggle-container{justify-content:center}}.form-toggle__label-content{font-size:1.5em;font-weight:600;line-height:1.167}.form-toggle__label-content span{font-weight:400}.jp-form-search-settings-group__toggle-description{margin-top:1em}p.jp-form-search-settings-group__toggle-explanation{font-size:1em;font-weight:400;line-height:1.5;margin-bottom:0;margin-top:0}.jp-form-search-settings-group-buttons.jp-search-dashboard-row{margin-top:1.5em}.jp-form-search-settings-group-buttons__button{align-items:center;border-color:#000;display:flex;font-size:1em;justify-content:center;min-height:2.5em;padding:.5em 1.5em;text-align:center}.jp-form-search-settings-group-buttons__button.is-customize-search{background-color:#000;color:#fff}.jp-form-search-settings-group-buttons__button:disabled,.jp-form-search-settings-group-buttons__button[disabled]{background-color:#dcdcde;border-color:#dcdcde;color:#a7aaad;cursor:not-allowed}.jp-form-search-settings-group-buttons__button.is-widgets-editor{background:transparent;color:#000}.jp-form-search-settings-group-buttons__button.is-widgets-editor:disabled,.jp-form-search-settings-group-buttons__button.is-widgets-editor[disabled]{background:transparent;color:#a7aaad}.form-toggle.is-search-admin.is-compact+.form-toggle__switch{background:#fff;border:2px solid #000;border-radius:.75em;height:1.5em;width:3em}.form-toggle.is-search-admin.is-compact+.form-toggle__switch:after,.form-toggle.is-search-admin.is-compact+.form-toggle__switch:before{background-color:#000;height:.9375em;width:.9375em}.form-toggle.is-search-admin.is-compact+.form-toggle__switch:focus{box-shadow:0 0 0 2px #3582c4}.form-toggle.is-search-admin.is-compact:checked+.form-toggle__switch{background:#069e08;border-color:#069e08}.form-toggle.is-search-admin.is-compact:checked+.form-toggle__switch:after{background-color:#fff;right:1.5em}.form-toggle.is-search-admin.is-compact.is-toggling+.form-toggle__switch:after,.form-toggle.is-search-admin.is-compact.is-toggling+.form-toggle__switch:before{right:1.5em}.form-toggle.is-search-admin.is-compact.is-toggling:checked+.form-toggle__switch:after,.form-toggle.is-search-admin.is-compact.is-toggling:checked+.form-toggle__switch:before{right:0}.jp-search-dashboard-cut{border:2px solid #069e08;border-radius:4px;display:block;margin:2em 0;padding:1em 1.5em 1em 4em;position:relative;text-decoration:none}.jp-search-dashboard-cut span{display:block}.jp-search-dashboard-cut span:last-of-type{font-weight:600}.jp-search-dashboard-cut:focus span:last-of-type,.jp-search-dashboard-cut:hover span:last-of-type{text-decoration:underline;text-decoration-thickness:2px}.jp-search-dashboard-cut:focus:after,.jp-search-dashboard-cut:hover:after{transform:translateY(-50%) translateX(-8px)}.jp-search-dashboard-cut:after{color:#069e08;content:"";font-size:1.5em;font-weight:600;left:1.5em;position:absolute;top:50%;transform:translateY(-50%);transition:transform .15s ease-out}.jp-search-dashboard-row .form-toggle__switch-container.sm-col-span-1{display:flex;justify-content:center;padding-top:4px}.jp-search-notice-box{background-color:#fff;border:.5px solid #dcdcde;border-radius:5px;color:#000;padding:24px}.jp-search-notice-box .dops-notice__content{padding:0 16px}.jp-search-notice-box .dops-notice__body{display:block;padding-bottom:4px;padding-top:16px}.jp-search-notice-box.dops-notice>span.dops-notice__icon-wrapper{background-color:hsla(0,0%,100%,0);padding:0}.jp-search-notice-box .dops-notice__text,.jp-search-notice-box .dops-notice__text .dops-notice__header{display:block;font-size:1em;margin:0}.jp-search-notice-box__important{border:.5px solid #d63638}.jp-search-notice-box__important .dops-notice__content .dops-notice__header{font-weight:700}.jp-search-notice-box .dops-notice__action{color:#000;display:block;font-weight:700;padding:0 0 6px}.jp-search-notice-box a.dops-notice__action:active,.jp-search-notice-box a.dops-notice__action:hover,.jp-search-notice-box a.dops-notice__action:link,.jp-search-notice-box a.dops-notice__action:visited{color:#000;text-decoration:underline}.jp-search-notice-box .dops-notice__icon-wrapper{color:#000;flex-grow:0;justify-content:left;padding:0;width:24px}.jp-search-notice-box__important,.jp-search-notice-box__important .dops-notice__action,.jp-search-notice-box__important .dops-notice__header,.jp-search-notice-box__important .dops-notice__icon-wrapper{color:#d63638}.jp-search-notice-box>.dops-notice__icon-wrapper>svg{margin:0}.jp-search-record-count__message{font-size:1em}.jp-search-record-count__info{margin-right:.2em;vertical-align:middle}.jp-search-record-count__info-icon{fill:inherit}.jp-search-bar-chart__container{max-height:40px}.jp-search-chart-legend__box{border-radius:100%;display:inline-block;height:15px;margin-left:5px;margin-right:0;width:15px}.jp-search-chart-legend{display:inline-block;font-size:1em;list-style:none}ul.jp-search-chart-legend{padding:0}.jp-search-chart-legend li{display:inherit;padding-bottom:18px}.jp-search-chart-legend__count{padding:0 3px 0 10px}.jp-search-record-meter .record-meter-bar__legend--item-label{max-width:125px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.jp-search-record-count p{font-size:1em}.jp-search-record-meter{border-bottom:1px solid #dcdcde;padding:64px 0}.jp-search-record-meter__content{width:100%}.jp-search-record-meter__content h2{margin-top:0}.jp-search-record-meter .record-meter-bar__items div{min-width:10px}.jp-search-record-meter__title h2{margin-top:0}.jp-search-record-meter .record-meter-bar__items{height:24px}.jp-search-record-meter .record-meter-bar__legend--items{flex-wrap:wrap;text-transform:capitalize}.jp-search-record-meter div.record-meter-bar>div.record-meter-bar__legend ul>li{padding-bottom:15px}.record-meter-bar{padding-block:1em}.record-meter-bar__items{background-color:var(--jp-gray-off);border-radius:1rem;display:flex;height:2rem;margin-bottom:2em;overflow:hidden}.record-meter-bar__legend--items{display:flex;margin:0}.record-meter-bar__legend--item{align-items:center;display:flex;margin:0;margin-inline-end:1em}.record-meter-bar__legend--item-circle{border-radius:100%;display:inline-block;height:1rem;margin-inline-end:.4em;width:1rem}.record-meter-bar__legend--item-count,.record-meter-bar__legend--item-label-first{margin-inline-end:.4em}._fUXxnSp5pagKBp9gSN7 *{box-sizing:border-box}:root{--jp-indeterminate-progress-bar__light-color:#f6f7f7;--jp-indeterminate-progress-bar__dark-color:#ededee}.lGBcNzDlFSVmny5xh3AH{background-color:transparent;background-image:linear-gradient(45deg,var(--jp-indeterminate-progress-bar__light-color) 33%,var(--jp-indeterminate-progress-bar__dark-color) 33%,var(--jp-indeterminate-progress-bar__dark-color) 71%,var(--jp-indeterminate-progress-bar__light-color) 71%);background-size:68px 100%;border-radius:calc(var(--spacing-base)*3);display:inline-block;height:24px;pointer-events:none;width:100%}@keyframes Otu8DduoZIRmZk0FB77u{0%{background-position:136px 0}}@media(prefers-reduced-motion:no-preference){.lGBcNzDlFSVmny5xh3AH{animation:Otu8DduoZIRmZk0FB77u 2s linear infinite}}.donut-meter-container{display:flex;height:fit-content;min-width:320px;width:fit-content}.donut-meter-container .donut-meter-wrapper{height:fit-content;position:relative}.donut-meter-container .donut-info-wrapper{display:flex;flex-direction:column;height:auto;justify-content:center;margin:0 8px;padding:8px 0;white-space:nowrap}.donut-meter-container .donut-info-primary{font-size:1em;font-weight:700;line-height:1em;margin:0 0 8px}.donut-meter-container .donut-info-secondary{color:#50575e;font-size:.7em;line-height:.7em;margin:0}.donut-meter-container .donut-info-secondary .info-link{color:#000;text-decoration:underline}.donut-meter-container .donut-info-secondary .info-link:not(a){cursor:default}.donut-meter-container .info-icon-wrapper{color:#000;vertical-align:middle}.upgrade-tooltip-shadow-anchor{height:64px;position:absolute;right:0;top:0;width:64px}.upgrade-tooltip-shadow-anchor .icon-tooltip-wrapper{height:100%;width:100%}.upgrade-tooltip-shadow-anchor .icon-tooltip-wrapper .icon-tooltip-title{font-size:var(--font-title-small);font-weight:500;margin-bottom:16px}.upgrade-tooltip-shadow-anchor .icon-tooltip-helper{height:100%;width:100%}.upgrade-tooltip-shadow-anchor .icon-tooltip-content{font-size:var(--font-body)}.upgrade-tooltip-shadow-anchor .upgrade-tooltip-actions{align-items:center;color:var(--jp-gray-60);display:flex;justify-content:space-between;margin-top:24px}.donut-meter .donut-meter-segment{stroke:var(--jp-green)}.donut-meter.is-warning .donut-meter-segment{stroke:var(--jp-yellow-10)}.donut-meter.is-danger .donut-meter-segment{stroke:var(--jp-red)}:root{--font-title-large:36px;--font-title-small:24px;--font-body:16px;--font-label:12px;--jp-black:#000;--jp-black-80:#2c3338;--jp-white:#fff;--jp-white-off:#f9f9f6;--jp-gray:#dcdcde;--jp-gray-0:#f6f7f7;--jp-gray-5:#dcdcde;--jp-gray-10:#c3c4c7;--jp-gray-20:#a7aaad;--jp-gray-30:#8c8f94;--jp-gray-40:#787c82;--jp-gray-50:#646970;--jp-gray-60:#50575e;--jp-gray-70:#3c434a;--jp-gray-80:#2c3338;--jp-gray-90:#1d2327;--jp-gray-100:#101517;--jp-gray-off:#e2e2df;--jp-yellow-5:#f5e6b3;--jp-yellow-10:#f2cf75;--jp-orange-20:#faa754;--jp-blue-5:#ced9f2;--jp-red-0:#f7ebec;--jp-red-50:#d63638;--jp-red-60:#b32d2e;--jp-red-80:#8a2424;--jp-red:#d63639;--jp-pink:#c9356e;--jp-green-0:#f0f2eb;--jp-green-5:#d0e6b8;--jp-green-10:#9dd977;--jp-green-20:#64ca43;--jp-green-30:#2fb41f;--jp-green-40:#069e08;--jp-green-50:#008710;--jp-green-60:#007117;--jp-green-70:#005b18;--jp-green-80:#004515;--jp-green-90:#003010;--jp-green-100:#001c09;--jp-green:#069e08;--jp-green-primary:var(--jp-green-40);--jp-green-secondary:var(--jp-green-30);--jp-border-radius:4px;--jp-border-radius-rna:8px;--jp-menu-border-height:1px;--jp-underline-thickness:2px;--jp-modal-padding-large:32px;--jp-modal-padding:24px;--jp-modal-padding-small:16px;--jp-modal-radius:8px;--jp-button-padding:8px;--jp-button-radius:4px;--jp-gap:16px;--jp-highlight:#3858e9}.jp-wrap{align-items:center;display:flex;flex-wrap:wrap;margin:0 auto;max-width:1128px}.jp-row{display:grid;grid-gap:24px;grid-template-columns:repeat(4,1fr);margin:0 16px;width:100%}@media(min-width:600px){.jp-row{grid-template-columns:repeat(8,1fr);margin:0 18px}}@media(min-width:960px){.jp-row{grid-template-columns:repeat(12,1fr);margin:0 24px;max-width:1128px}}.sm-col-span-1{grid-column-end:span 1}.sm-col-span-2{grid-column-end:span 2}.sm-col-span-3{grid-column-end:span 3}.sm-col-span-4{grid-column-end:span 4}@media(min-width:600px){.md-col-span-1{grid-column-end:span 1}.md-col-span-2{grid-column-end:span 2}.md-col-span-3{grid-column-end:span 3}.md-col-span-4{grid-column-end:span 4}.md-col-span-5{grid-column-end:span 5}.md-col-span-6{grid-column-end:span 6}.md-col-span-7{grid-column-end:span 7}.md-col-span-8{grid-column-end:span 8}}@media(min-width:960px){.lg-col-span-1{grid-column-end:span 1}.lg-col-span-2{grid-column-end:span 2}.lg-col-span-3{grid-column-end:span 3}.lg-col-span-4{grid-column-end:span 4}.lg-col-span-5{grid-column-end:span 5}.lg-col-span-6{grid-column-end:span 6}.lg-col-span-7{grid-column-end:span 7}.lg-col-span-8{grid-column-end:span 8}.lg-col-span-9{grid-column-end:span 9}.lg-col-span-10{grid-column-end:span 10}.lg-col-span-11{grid-column-end:span 11}.lg-col-span-12{grid-column-end:span 12}}@media(max-width:960px){.md-col-span-0{display:none}}@media(max-width:600px){.sm-col-span-0{display:none}}.jp-cut{border:2px solid var(--jp-green-primary);border-radius:var(--jp-border-radius);margin:32px 0;padding:16px 24px 16px 64px;position:relative;text-decoration:none}.jp-cut,.jp-cut span{display:block}.jp-cut span:last-of-type{font-weight:600}.jp-cut:focus span:last-of-type,.jp-cut:hover span:last-of-type{text-decoration:underline;text-decoration-thickness:var(--jp-underline-thickness)}.jp-cut:focus:after,.jp-cut:hover:after{transform:translateY(-50%) translateX(-8px)}.jp-cut:after{color:var(--jp-green-primary);content:"";font-size:24px;font-weight:600;left:24px;position:absolute;top:50%;transform:translateY(-50%);transition:transform .15s ease-out}.components-popover:not(.is-without-arrow):before{border-color:var(--jp-gray)}.icon-tooltip-helper .components-popover:not([data-y-axis=middle])[data-x-axis=left] .components-popover__content{margin-left:-62px}.icon-tooltip-helper .components-popover:not([data-y-axis=middle])[data-x-axis=right] .components-popover__content{margin-right:-62px}.icon-tooltip-helper .components-popover[data-y-axis=bottom] .components-popover__content{top:2px!important}.icon-tooltip-helper .components-popover:not(.is-without-arrow)[data-y-axis=bottom]:before{top:-6px!important}.icon-tooltip-helper .components-popover:not(.is-without-arrow)[data-y-axis=bottom]:after{top:-4px!important}.icon-tooltip-helper .components-popover[data-y-axis=top] .components-popover__content{bottom:10px!important}.icon-tooltip-helper .components-popover:not(.is-without-arrow)[data-y-axis=top]:before{bottom:3px}.icon-tooltip-helper .components-popover:not(.is-without-arrow)[data-y-axis=top]:after{bottom:4px}.icon-tooltip-helper.is-wide .components-popover__content{width:440px}.icon-tooltip-wrapper{color:var(--jp-black);display:inline-block;position:relative}.icon-tooltip-wrapper .components-button.is-link:focus:not(:disabled){box-shadow:none}.icon-tooltip-helper{height:18px;pointer-events:none;position:absolute;right:-53px;top:0;width:124px}.icon-tooltip-container{pointer-events:all}.icon-tooltip-container .components-popover__content{border:1px solid var(--jp-gray);border-radius:4px;margin:0 10px;max-width:90vw;outline:none;padding:24px;white-space:normal;width:304px}.icon-tooltip-title{font-size:16px;font-weight:600;line-height:19px}.icon-tooltip-title:not(:last-child){margin-bottom:8px}.icon-tooltip-content{font-size:14px;font-weight:400;line-height:24px}.icon-tooltip-content ul{list-style-type:disc;margin:0 1rem 0 0}.icon-tooltip-content ul li:last-child{margin-bottom:0}.msOlyh2T7D6uhbM6AROg{align-items:center;background:none;border:2px solid var(--jp-green-40);border-radius:var(--jp-border-radius);color:var(--jp-gray-80);display:flex;gap:calc(var(--spacing-base)*3);justify-content:space-between;padding:calc(var(--spacing-base)*2) calc(var(--spacing-base)*3);position:relative;text-align:right;width:100%}.msOlyh2T7D6uhbM6AROg a,.msOlyh2T7D6uhbM6AROg button{all:unset;color:var(--jp-gray-80);cursor:pointer}.msOlyh2T7D6uhbM6AROg a:after,.msOlyh2T7D6uhbM6AROg button:after{content:"";height:100%;position:absolute;right:0;top:0;width:100%}.msOlyh2T7D6uhbM6AROg:focus-within{border-color:var(--jp-black)}.msOlyh2T7D6uhbM6AROg:focus-within .cPN7USVqSBpxUswfDtUZ,.msOlyh2T7D6uhbM6AROg:hover .cPN7USVqSBpxUswfDtUZ{transform:translateX(calc((var(--spacing-base)*2)*-1))}.msOlyh2T7D6uhbM6AROg:focus-within .EmnJAyEzzn1QpA8HtypY,.msOlyh2T7D6uhbM6AROg:hover .EmnJAyEzzn1QpA8HtypY{text-decoration:underline;text-decoration-thickness:2px}.EmnJAyEzzn1QpA8HtypY,.msOlyh2T7D6uhbM6AROg .EmnJAyEzzn1QpA8HtypY{font-weight:700}.cPN7USVqSBpxUswfDtUZ{fill:var(--jp-green-40);pointer-events:none;transition:transform .1s ease-out}.vV7YZikAz0oHYsuvtxMq{display:inline;margin:0 calc(var(--spacing-base)/3) 0 0;vertical-align:middle}.vV7YZikAz0oHYsuvtxMq svg{position:relative;z-index:10}.T1YaMupeZmBIpXZHY9EZ{display:inline}.jp-search-dashboard-wrap{align-items:center;display:flex;flex-flow:column nowrap;justify-content:center;margin:0 auto;width:100%}.jp-search-dashboard-meter-wrap{border-bottom:1px solid #dcdcde;padding:64px 0}.jp-search-dashboard-meter-wrap__content{color:#2c3338;width:100%}.jp-search-dashboard-meter-wrap__content h2{color:#000;font-size:24px;line-height:normal;margin-top:0}.jp-search-dashboard-meter-wrap__content h2 span{color:#2c3338;font-weight:300}.jp-search-dashboard-row{display:grid;grid-gap:24px;grid-template-columns:repeat(4,1fr);margin:0 16px;width:calc(100% - 32px)}@media(min-width:600px){.jp-search-dashboard-row{grid-template-columns:repeat(8,1fr);margin:0 18px;width:calc(100% - 36px)}}@media(min-width:960px){.jp-search-dashboard-row{grid-template-columns:repeat(12,1fr);margin:0 24px;max-width:1128px;width:calc(100% - 48px)}}.jp-search-dashboard-row .sm-col-span-1{grid-column-end:span 1}.jp-search-dashboard-row .sm-col-span-2{grid-column-end:span 2}.jp-search-dashboard-row .sm-col-span-3{grid-column-end:span 3}.jp-search-dashboard-row .sm-col-span-4{grid-column-end:span 4}@media(min-width:600px){.jp-search-dashboard-row .md-col-span-1{grid-column-end:span 1}.jp-search-dashboard-row .md-col-span-2{grid-column-end:span 2}.jp-search-dashboard-row .md-col-span-3{grid-column-end:span 3}.jp-search-dashboard-row .md-col-span-4{grid-column-end:span 4}.jp-search-dashboard-row .md-col-span-5{grid-column-end:span 5}.jp-search-dashboard-row .md-col-span-6{grid-column-end:span 6}.jp-search-dashboard-row .md-col-span-7{grid-column-end:span 7}.jp-search-dashboard-row .md-col-span-8{grid-column-end:span 8}}@media(min-width:960px){.jp-search-dashboard-row .lg-col-span-1{grid-column-end:span 1}.jp-search-dashboard-row .lg-col-span-2{grid-column-end:span 2}.jp-search-dashboard-row .lg-col-span-3{grid-column-end:span 3}.jp-search-dashboard-row .lg-col-span-4{grid-column-end:span 4}.jp-search-dashboard-row .lg-col-span-5{grid-column-end:span 5}.jp-search-dashboard-row .lg-col-span-6{grid-column-end:span 6}.jp-search-dashboard-row .lg-col-span-7{grid-column-end:span 7}.jp-search-dashboard-row .lg-col-span-8{grid-column-end:span 8}.jp-search-dashboard-row .lg-col-span-9{grid-column-end:span 9}.jp-search-dashboard-row .lg-col-span-10{grid-column-end:span 10}.jp-search-dashboard-row .lg-col-span-11{grid-column-end:span 11}.jp-search-dashboard-row .lg-col-span-12{grid-column-end:span 12}.jp-search-dashboard-row .lg-col-span-0{display:none}}@media(max-width:960px){.jp-search-dashboard-row .md-col-span-0{display:none}}@media(max-width:600px){.jp-search-dashboard-row .sm-col-span-0{display:none}.jp-search-dashboard-row .sm-col-span-1{display:block}}*{box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;margin:0;min-height:100%;padding:0}#wpcontent{padding-right:0!important}#screen-meta,#screen-meta-links{display:none}#jp-search-dashboard{background-color:#fff;color:#000;font-size:16px;min-height:calc(100vh - 97px)}@media(max-width:600px){#jp-search-dashboard{font-size:14px}}#jp-search-dashboard .jp-search-dashboard-page{width:100%}#jp-search-dashboard .jp-masthead__logo-link{pointer-events:none}#jp-search-dashboard .jp-search-dashboard-top{background-color:#f9f9f6;overflow:hidden}#jp-search-dashboard .jp-search-dashboard-top__title{padding:2.5em 0}#jp-search-dashboard .jp-search-dashboard-top__title h1{font-size:2.25em;line-height:1.111;margin:0}#jp-search-dashboard .jp-search-dashboard-top__mocked-search-interface{align-items:center;display:flex;flex-flow:column;height:15.625em;justify-content:center}#jp-search-dashboard .jp-search-dashboard-bottom{background-color:#fff}#jp-search-dashboard .jp-search-dashboard-footer,#jp-search-dashboard .jp-search-dashboard-header{background-color:#fff;padding:2.5em 0}#jp-search-dashboard .jp-search-dashboard-header__logo-container{align-items:center;display:flex;justify-content:space-between}.usage-meter-group{align-items:center;display:flex;flex-wrap:wrap;margin-bottom:24px}.usage-meter-about{line-height:24px;margin-top:24px}.usage-meter-about .support-link{color:#000;cursor:pointer}.usage-meter-about .components-external-link__icon{margin:4px}#wpbody-content>.notice{display:none}.jetpack-search-jitm-card .jitm-card{margin-bottom:0;margin-left:0}.urouayitSUT8zW0V3p_0{margin-bottom:0}.iXXJlk08gFDeCvsTTlNQ{border:1px solid var(--jp-gray);border-radius:var(--jp-border-radius);border-right:6px solid var(--jp-red-50);box-shadow:0 4px 8px rgba(0,0,0,.03),0 1px 2px rgba(0,0,0,.06);box-sizing:border-box;color:var(--jp-gray-80);font-size:16px;line-height:22px;margin:0;padding:calc(var(--spacing-base)*2) calc(var(--spacing-base)*3) calc(var(--spacing-base)*2) calc(var(--spacing-base)*3)}.iXXJlk08gFDeCvsTTlNQ.is-error{background-color:var(--jp-white)}.iXXJlk08gFDeCvsTTlNQ .components-notice__content{align-items:flex-start;display:flex;flex-direction:column;margin:0;padding:12px 4px}.iXXJlk08gFDeCvsTTlNQ .is-link{color:var(--jp-black);font-size:16px;font-weight:600}.iXXJlk08gFDeCvsTTlNQ .components-notice__dismiss{align-self:center}.iXXJlk08gFDeCvsTTlNQ .MWqRqr7q6fgvLxitcWYk,.iXXJlk08gFDeCvsTTlNQ .MWqRqr7q6fgvLxitcWYk:active,.iXXJlk08gFDeCvsTTlNQ .MWqRqr7q6fgvLxitcWYk:hover,.iXXJlk08gFDeCvsTTlNQ .MWqRqr7q6fgvLxitcWYk:visited{align-items:center;background:#000;border-radius:var(--jp-border-radius);color:var(--jp-white);cursor:pointer;font-size:16px;font-weight:600;justify-content:center;letter-spacing:-.01em;line-height:24px;margin-right:calc(var(--spacing-base)*2 + 24px);margin-top:24px;padding:8px 24px;text-decoration:none}.iXXJlk08gFDeCvsTTlNQ.YLcXAoc82nypTPaKSAcd .MWqRqr7q6fgvLxitcWYk,.iXXJlk08gFDeCvsTTlNQ.YLcXAoc82nypTPaKSAcd .MWqRqr7q6fgvLxitcWYk:active,.iXXJlk08gFDeCvsTTlNQ.YLcXAoc82nypTPaKSAcd .MWqRqr7q6fgvLxitcWYk:hover,.iXXJlk08gFDeCvsTTlNQ.YLcXAoc82nypTPaKSAcd .MWqRqr7q6fgvLxitcWYk:visited{margin-right:0;margin-top:0;white-space:nowrap}.iXXJlk08gFDeCvsTTlNQ.YLcXAoc82nypTPaKSAcd .components-notice__content{align-items:center;flex-direction:row}.e6hHy8BZ7ZKPSXbIC0UG{margin-bottom:25px}.jXz8LnXNzMDdtHqkG0sZ{display:flex;flex-grow:1;margin-left:var(--spacing-base)}.jXz8LnXNzMDdtHqkG0sZ>svg{align-self:flex-start;flex-shrink:0}.jXz8LnXNzMDdtHqkG0sZ .jp-components-spinner,.jXz8LnXNzMDdtHqkG0sZ>svg{margin-left:calc(var(--spacing-base)*2)}.jp-dashboard-footer{align-items:center;color:var(--jp-black);display:flex;flex-wrap:wrap;font-size:var(--font-body-extra-small);line-height:1.333;max-width:1128px;width:100%}.jp-dashboard-footer a{text-decoration:none}.jp-dashboard-footer a:any-link,.jp-dashboard-footer a[role=button]{color:inherit}.jp-dashboard-footer a:hover{text-decoration:underline;text-decoration-thickness:1.5px}.jp-dashboard-footer a:focus{border-radius:2px;box-shadow:none;outline:1.5px solid currentColor;outline-offset:3px}.jp-dashboard-footer.is-sm>ul{gap:.125rem}.jp-dashboard-footer.is-md,.jp-dashboard-footer.is-sm>ul{align-items:flex-start;flex-direction:column}.jp-dashboard-footer>ul{align-items:center;display:flex;flex-wrap:wrap;gap:1rem;list-style:none;margin:0;padding:0;width:100%}.jp-dashboard-footer>ul>li{margin-bottom:0}.jp-dashboard-footer>ul>li>a{align-items:center;display:flex;gap:.25rem;min-height:44px}.jp-dashboard-footer__accessible-external-link{border:0;clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;overflow-wrap:normal;padding:0;position:absolute;width:1px}.jp-dashboard-footer__jp-item{font-weight:600;padding-inline-end:1rem}.jp-dashboard-footer.is-sm .jp-dashboard-footer__jp-item{padding-bottom:1rem}.jp-dashboard-footer.is-lg .jp-dashboard-footer__a8c-item{margin-inline-start:auto}.jp-dashboard-footer.is-sm .jp-dashboard-footer__a8c-item{padding-top:1rem}.jp-dashboard-footer__a8c-item>a,.jp-dashboard-footer__jp-item>a{text-decoration:none}.jp-search-dashboard-upsell-page{line-height:1.5;width:100%}.jp-search-dashboard-upsell-page h1{line-height:1.2}.jp-search-dashboard-upsell-page>div{margin-right:0}.jp-search-dashboard-upsell-page__header{display:flex;flex-wrap:wrap;gap:calc(var(--horizontal-spacing)*3);justify-content:space-between}.jp-search-dashboard-upsell-page__logo{flex-shrink:0}.price-tip{display:flex;height:20px;margin-bottom:24px}.price-tip-text{color:#787c82;font-size:14px;font-weight:400;line-height:20px;margin-left:7px}.price-tip .price-tip-icon{fill:#c3c4c7}.sexr0jUxC1jVixdKiDnC{margin-right:-20px}@media(max-width:782px){.sexr0jUxC1jVixdKiDnC{margin-right:-10px}}.sexr0jUxC1jVixdKiDnC.vKQ11sLeAM45M04P1ccj{background-color:var(--jp-white)}.p4qz2tkq0p9hxucJ6Qk2{--padding:calc(var(--spacing-base)*4);color:var(--jp-black)}.lbNDyXioOwvyvbALtCBm{--gap:calc(var(--spacing-base)*3);padding:var(--padding) 0;position:relative}.s2Lsn4kbm6BrS3DSndRB .lbNDyXioOwvyvbALtCBm{column-gap:var(--gap);display:grid;grid-auto-flow:column;grid-template-columns:repeat(var(--columns),1fr);grid-template-rows:repeat(var(--rows),minmax(min-content,max-content))}.cLaNK_XcbTGlRQ4Tp43Q{margin-top:var(--padding)}.s2Lsn4kbm6BrS3DSndRB .cLaNK_XcbTGlRQ4Tp43Q{display:contents}.cLaNK_XcbTGlRQ4Tp43Q.CYt1X0eH1icRjhtJ28jx>*{background:var(--jp-white);position:relative}.cLaNK_XcbTGlRQ4Tp43Q.CYt1X0eH1icRjhtJ28jx>:after{bottom:0;box-shadow:0 4px 24px rgba(0,0,0,.05);content:"";left:0;position:absolute;right:0;top:0;z-index:-1}.cLaNK_XcbTGlRQ4Tp43Q>:first-child{border-top-left-radius:var(--jp-border-radius);border-top-right-radius:var(--jp-border-radius);border-width:1px 1px 0}.cLaNK_XcbTGlRQ4Tp43Q>:last-child{border-bottom-left-radius:var(--jp-border-radius);border-bottom-right-radius:var(--jp-border-radius);border-width:0 1px 1px}.DAkZc1P9A3K12fjEliMg{display:flex;flex-direction:column;justify-content:space-between;padding:var(--padding)}.WUBuYABl8nymjs9NnCEL{align-items:center;display:flex;padding-bottom:calc(var(--spacing-base)*2);position:relative}.WUBuYABl8nymjs9NnCEL:not(:nth-child(2)){padding-top:calc(var(--spacing-base)*2)}.WUBuYABl8nymjs9NnCEL:not(:nth-child(2)):before{background-color:var(--jp-gray);content:"";height:1px;left:var(--padding);position:absolute;right:var(--padding);top:0;z-index:5}.s2Lsn4kbm6BrS3DSndRB .WUBuYABl8nymjs9NnCEL:not(:nth-child(2)):before{left:unset;right:0;width:calc(100% + var(--gap))}.s2Lsn4kbm6BrS3DSndRB .lbNDyXioOwvyvbALtCBm>:last-child .WUBuYABl8nymjs9NnCEL:not(:nth-child(2)):before{width:100%}.ANtCFeb41NhA8PA3H7ZN,.WUBuYABl8nymjs9NnCEL:last-of-type{padding-bottom:var(--padding)}.Ql2gy_148yW8Vw5vhaKD{padding-left:var(--padding);padding-right:var(--padding)}.EAQrAnQEW1z1BfdY5gbC{margin:0 var(--spacing-base);fill:var(--jp-gray);flex-shrink:0}.EAQrAnQEW1z1BfdY5gbC.JDSTlLoOC_4aUoH2oNM2{fill:var(--jp-green-40)}.EAQrAnQEW1z1BfdY5gbC.zNdQRJ1w7BvaQOYyqzHK{fill:var(--jp-red-50)}.lr7vbX95SKtoe7DarJcZ{margin-right:auto}.s2Lsn4kbm6BrS3DSndRB .lr7vbX95SKtoe7DarJcZ{margin:0 var(--spacing-base);top:1px}.WUBuYABl8nymjs9NnCEL .KRrGp2xdkeBOxLZeuQ6X{fill:var(--jp-gray-20);flex-shrink:0}.H_ZJiRVJg0LiMXPGOcmt{text-align:center;width:fit-content}.H_ZJiRVJg0LiMXPGOcmt>a{color:#000}.s2Lsn4kbm6BrS3DSndRB .H_ZJiRVJg0LiMXPGOcmt{grid-column:2;overflow:hidden;padding-left:var(--padding);padding-right:var(--padding);white-space:nowrap}.x21z_DixObRDsDaWotP1{align-items:right;display:flex;justify-content:right;margin:0 calc(var(--spacing-base)*4)}.dovianZYLKhnbnh9I06o{align-items:flex-start;display:flex;flex-wrap:wrap;justify-content:flex-end}.lljtQMhW7lq5tE5SDJEf{align-items:flex-start;display:flex;flex-basis:0;flex-grow:2}.lljtQMhW7lq5tE5SDJEf .NubApIV1vQCRUNprfm6b{margin-right:auto}.dhFQXpZfMwVI8vuYHnwC{align-items:flex-start;display:inline-flex;flex:0 0 auto;position:relative}.dhFQXpZfMwVI8vuYHnwC:first-child{margin-left:calc(var(--spacing-base)*2)}.dhFQXpZfMwVI8vuYHnwC.eD7hzxFmdtG_MgmBtl_k{color:var(--jp-gray-20)}.dhFQXpZfMwVI8vuYHnwC.eD7hzxFmdtG_MgmBtl_k:after{background:var(--jp-red);border-radius:var(--jp-border-radius);content:" ";display:block;height:3px;margin-top:-2px;pointer-events:none;position:absolute;top:50%;width:100%}.C64ZjjUAqJC1T2Sa7apS{align-items:flex-start;display:flex;flex-wrap:wrap;justify-content:flex-start;margin-bottom:calc(var(--spacing-base)*3)}.UpZDGew6Ay1hPoP6eI7b{color:var(--jp-gray-40);font-size:var(--font-body-small);line-height:20px}.UpZDGew6Ay1hPoP6eI7b:after{content:""}.NubApIV1vQCRUNprfm6b{background-color:var(--jp-yellow-10);border-radius:4px;font-size:13px;font-weight:600;margin-right:var(--spacing-base);padding-left:var(--spacing-base);padding-right:var(--spacing-base)}.TDiiPbuW1Z0_05u_pvcK{font-weight:400}jp-search.asset.php                                                                                                                                                                                                                                            139           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/build/instant-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   <?php return array('dependencies' => array('wp-i18n', 'wp-jp-i18n-loader', 'wp-polyfill', 'wp-url'), 'version' => 'e542366027ed428e7f4c');
jp-search.chunk-main-payload.css                                                                                                                                                                                                                               36793         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/build/instant-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   .jetpack-instant-search__overlay{background:rgba(29,35,39,.7);bottom:0;box-sizing:border-box;color:#00101c;font-size:16px;left:0;opacity:1;overflow-x:hidden;overflow-y:auto;position:fixed;right:0;top:0;z-index:9999999999999}body.jps-theme-argent .jetpack-instant-search__overlay *{font-family:Helvetica,sans-serif}@media(max-width:767.98px){.jetpack-instant-search__overlay{padding:3em 1em}}@media(max-width:575.98px){.jetpack-instant-search__overlay{padding:0}}@media(min-width:768px){.jetpack-instant-search__overlay{padding:3em}}.jetpack-instant-search__overlay h1,.jetpack-instant-search__overlay h2,.jetpack-instant-search__overlay h3,.jetpack-instant-search__overlay h4,.jetpack-instant-search__overlay h5,.jetpack-instant-search__overlay h6{letter-spacing:inherit}.jetpack-instant-search__overlay.is-hidden{background:transparent;opacity:0;visibility:hidden}.jetpack-instant-search__overlay *,.jetpack-instant-search__overlay :after,.jetpack-instant-search__overlay :before{box-sizing:inherit}@media print{.jetpack-instant-search__overlay.is-hidden{display:none}}@media(prefers-reduced-motion:no-preference){.jetpack-instant-search__overlay{transition:opacity .1s ease-in}}.gridicon{fill:currentColor;display:inline-block}.gridicon.needs-offset g{transform:translate(1px,1px)}.gridicon.needs-offset-x g{transform:translate(1px)}.gridicon.needs-offset-y g{transform:translateY(1px)}.jetpack-instant-search__jetpack-colophon{margin-bottom:2em;margin-top:2em;text-align:center}.jetpack-instant-search__jetpack-colophon-link{align-items:center;color:inherit;display:flex;text-decoration:none}.jetpack-instant-search__jetpack-colophon-logo{display:inline;height:16px;width:16px}.jetpack-instant-search__jetpack-colophon-text{color:#2c3338;font-size:.7em;font-weight:500;line-height:16px;padding-left:12px}.jetpack-instant-search__notice{display:flex;font-size:14px;margin:1em 0;padding:.75em}.jetpack-instant-search__notice.jetpack-instant-search__notice--warning{background-color:#f5e6b3;color:#4f3500}.jetpack-instant-search__notice .gridicon{flex-shrink:0;margin-right:.5em;margin-top:1px;vertical-align:middle}.jetpack-instant-search__scroll-button{border:0;box-shadow:none;outline:0;padding:0 6px}.jetpack-instant-search__scroll-button:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}.jetpack-instant-search__search-results .jetpack-instant-search__search-results-pagination button.jetpack-instant-search__scroll-button{background-color:inherit;color:#646970;font-size:inherit;font-weight:inherit}.jetpack-instant-search__search-sort{align-items:center;display:flex}.jetpack-instant-search__search-sort>label[for=jetpack-instant-search__search-sort-select]{flex-shrink:0;font-size:1em;font-weight:700;margin:0 .25em 0 0}.jetpack-instant-search__search-sort-with-links{font-size:13px}.jetpack-instant-search__search-sort-with-links .jetpack-instant-search__search-sort-separator{color:#646970;font-weight:300}@media(max-width:575.98px){.jetpack-instant-search__search-sort-with-select{margin-right:1em;width:100%}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-sort-with-select{margin-right:0}}@media(min-width:992px){.jetpack-instant-search__search-sort-with-select{margin-top:-4px}}.jetpack-instant-search__search-sort-select{-webkit-appearance:auto;appearance:auto;background:#fff;border:1px solid #e6f1f5;border-radius:5px;color:#00101c;font-size:1em;height:inherit;padding:.25em}@media(max-width:575.98px){.jetpack-instant-search__search-sort-select{padding:.5em;width:100%}}.jetpack-instant-search__search-sort-option{border:none;border-radius:0;cursor:pointer;margin:0;padding:0 2px;text-decoration:none;text-shadow:none;text-transform:none}.jetpack-instant-search__search-sort-option,.jetpack-instant-search__search-sort-option:focus,.jetpack-instant-search__search-sort-option:hover{-webkit-appearance:none;appearance:none;background:none;box-shadow:none;outline:none}.jetpack-instant-search__search-sort-option:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}.jetpack-instant-search__search-form-controls .jetpack-instant-search__search-sort button.jetpack-instant-search__search-sort-option{background-color:inherit;color:#646970;font-size:inherit;font-weight:inherit}.jetpack-instant-search__search-form-controls .jetpack-instant-search__search-sort button.jetpack-instant-search__search-sort-option.is-selected{color:#044b7a;font-weight:600;text-decoration:none}.jetpack-instant-search__search-form-controls{align-items:center;display:flex;line-height:1.3;margin-left:56px;margin-right:56px;margin-top:16px;z-index:1}@media(max-width:991.98px){.jetpack-instant-search__search-form-controls{flex-direction:row-reverse;justify-content:space-between;left:0;margin-left:40px;margin-right:40px;position:relative;right:0}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-form-controls{flex-direction:row-reverse;justify-content:space-between;left:0;margin-left:40px;margin-right:40px;position:relative;right:0}}@media(max-width:767.98px){.jetpack-instant-search__search-form-controls{margin-left:20px;margin-right:20px}}@media(min-width:992px){.jetpack-instant-search__search-form-controls{position:absolute;right:320px}}@media(min-width:1200px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-form-controls{position:absolute;right:320px}}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-form-controls{right:0}.jetpack-instant-search__box{border-bottom:1px solid #e6f1f5;border-right:1px solid #e6f1f5}.jetpack-instant-search__box-label{align-items:center;display:flex;flex:0 0 100%;margin:0}input.jetpack-instant-search__box-input.search-field{-webkit-appearance:none;appearance:none;background:#fff;border:0;box-shadow:none;color:#3c434a;font-size:18px;height:60px;line-height:1;margin:0;max-width:none;padding:0 14px;text-indent:32px;vertical-align:middle}input.jetpack-instant-search__box-input.search-field:focus,input.jetpack-instant-search__box-input.search-field:hover{background:#fff;color:#00101c}input.jetpack-instant-search__box-input.search-field.search-field{letter-spacing:-.02em;padding-left:0;text-indent:0}.jetpack-instant-search__box-gridicon{align-items:center;display:flex;flex-shrink:0;height:60px;justify-content:center;left:0;position:relative;top:0;width:60px;z-index:1}.jetpack-instant-search__box-gridicon svg{fill:#646970}.jetpack-instant-search__box input[type=button]{border:none;border-radius:0;color:#646970;cursor:pointer;font-size:1em;font-weight:400;height:60px;line-height:1;margin:0 .25em 0 0;padding:0;text-decoration:none;text-shadow:none;text-transform:none;width:60px;word-wrap:normal}.jetpack-instant-search__box input[type=button],.jetpack-instant-search__box input[type=button]:focus,.jetpack-instant-search__box input[type=button]:hover{-webkit-appearance:none;appearance:none;background:none;box-shadow:none;outline:none}.jetpack-instant-search__box input[type=button]:focus,.jetpack-instant-search__box input[type=button]:hover{color:#3c434a}.jetpack-instant-search__box input[type=button]:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input{border:none;box-shadow:none;height:52px;outline-style:none;padding:0 10px;width:100%}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input:focus,.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input:hover{border:none;box-shadow:none}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input:focus{border-radius:5px;margin-left:-50px;margin-right:5px;outline:thin dotted #3c434a;outline-offset:inherit;padding-left:60px}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-webkit-search-results-button,.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-webkit-search-results-decoration{appearance:none;-webkit-appearance:none;display:initial}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-webkit-search-cancel-button{display:none}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-ms-clear,.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-ms-reveal{display:none}@media(prefers-reduced-motion:no-preference){.jetpack-instant-search__box input[type=button]{transition:all .1s linear}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input{transition:color .15s ease-in-out,border-color .25s ease-in-out}}.jetpack-instant-search__path-breadcrumb{font-size:.9em;margin:0;max-width:calc(100vw - 2em);overflow-x:hidden;text-overflow:ellipsis}.jetpack-instant-search__path-breadcrumb-link{max-width:100%;overflow:hidden;text-decoration:none;text-overflow:ellipsis;white-space:nowrap}.jetpack-instant-search__path-breadcrumb-link:focus,.jetpack-instant-search__path-breadcrumb-link:hover{text-decoration:underline}.jetpack-instant-search__path-breadcrumb,.jetpack-instant-search__path-breadcrumb-link{color:#3c434a}.jetpack-instant-search__search-result-comments{border-left:2px solid #f0f0f1;font-size:.9em;margin-left:8px;margin-top:16px;padding-left:16px;word-break:break-word}.jetpack-instant-search__search-result-comments .gridicon{margin-right:8px;vertical-align:middle}.jetpack-instant-search__search-result-expanded{display:flex;flex-flow:column}.jetpack-instant-search__search-result-expanded:last-child{margin-right:0}.jetpack-instant-search__search-result-expanded .jetpack-instant-search__search-result-expanded__title{width:100%}.jetpack-instant-search__search-result-expanded__path{color:#646970;font-size:.9375em;margin:0 0 .4em}.jetpack-instant-search__search-result-expanded__copy-container{max-width:100%}@media(min-width:576px){.jetpack-instant-search__search-result-expanded__copy-container{width:calc(100% - 128px - 1em)}}.jetpack-instant-search__search-result-expanded--no-image .jetpack-instant-search__search-result-expanded__copy-container{width:auto}.jetpack-instant-search__search-result-expanded__content{color:#00101c;font-size:.9375em}.jetpack-instant-search__search-result-expanded__image-link{margin-left:1em}@media(max-width:575.98px){.jetpack-instant-search__search-result-expanded__image-link{margin:0 auto .5em}}.jetpack-instant-search__search-result-expanded__image-container{width:128px}@media(max-width:575.98px){.jetpack-instant-search__search-result-expanded__image-container{width:256px}}.jetpack-instant-search__search-result-expanded--no-image .jetpack-instant-search__search-result-expanded__image-container{display:none}.jetpack-instant-search__search-result-expanded__image-container{position:relative}.jetpack-instant-search__search-result-expanded__image-container:before{content:"";display:block;padding-top:100%;width:100%}.jetpack-instant-search__search-result-expanded__image{border-radius:5px;bottom:0;height:100%;left:0;object-fit:cover;position:absolute;right:0;top:0;width:100%}.jetpack-instant-search__search-result-expanded__content-container{display:flex;flex-flow:column}@media(min-width:576px){.jetpack-instant-search__search-result-expanded__content-container{flex-flow:row nowrap}}.jetpack-instant-search__search-result-expanded__footer{display:flex;list-style-type:none;margin-left:0;margin-top:10px;padding-left:0}.jetpack-instant-search__search-result-expanded__footer li{margin-right:10px}.jetpack-instant-search__search-result-expanded__footer-blog-image{border-radius:2px;margin-right:3px;vertical-align:middle}.jetpack-instant-search__search-result-expanded__footer-blog{font-size:13px;font-style:normal;font-weight:600;line-height:180%}.jetpack-instant-search__search-result-expanded__footer-author:after,.jetpack-instant-search__search-result-expanded__footer-blog:after{color:#636363;content:"";margin-left:10px}li:last-child .jetpack-instant-search__search-result-expanded__footer-author:after,li:last-child .jetpack-instant-search__search-result-expanded__footer-blog:after{content:""}.jetpack-instant-search__search-result-expanded__footer-author,.jetpack-instant-search__search-result-expanded__footer-date{color:#636363;font-size:13px;font-style:normal;font-weight:400}.jetpack-instant-search__search-result-title.jetpack-instant-search__search-result-minimal-title{margin-bottom:.4em}.jetpack-instant-search__search-result-title.jetpack-instant-search__search-result-minimal-title .gridicon{margin-right:8px}.jetpack-instant-search__search-result-minimal-cats-and-tags{display:flex;flex-flow:row wrap;font-size:.9375em}.jetpack-instant-search__search-result-minimal-cats,.jetpack-instant-search__search-result-minimal-tags{display:flex;flex-flow:row wrap;list-style-type:none;margin:0;padding:0}.jetpack-instant-search__search-result-minimal-cat,.jetpack-instant-search__search-result-minimal-tag{margin:0 .75em 0 0}.jetpack-instant-search__search-result-minimal-cat .gridicon,.jetpack-instant-search__search-result-minimal-tag .gridicon{margin-right:.25em}.jetpack-instant-search__search-result-minimal-cat .gridicon,.jetpack-instant-search__search-result-minimal-cat-text,.jetpack-instant-search__search-result-minimal-tag .gridicon,.jetpack-instant-search__search-result-minimal-tag-text{vertical-align:middle}.jetpack-instant-search__search-result-minimal-content{word-break:break-word}.jetpack-instant-search__product-price-regular{color:#646970;padding-right:.25em}.jetpack-instant-search__product-rating-stars .gridicon{vertical-align:middle;fill:#f0c930}.jetpack-instant-search a.jetpack-instant-search__product-rating-count{color:#646970;font-size:.9em;text-decoration:underline;vertical-align:text-top}.jetpack-instant-search__search-results-list.is-format-product{display:flex;flex-wrap:wrap;margin-right:40px;padding:0 0 3em}@media(max-width:991.98px){.jetpack-instant-search__search-results-list.is-format-product{margin-right:24px}}@media(max-width:767.98px){.jetpack-instant-search__search-results-list.is-format-product{margin-right:4px}}.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{display:flex;flex-direction:column;margin:0 16px 16px 0;position:relative;width:calc(50% - 16px)}@media(min-width:576px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(33.33333% - 16px)}}@media(min-width:768px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(25% - 16px)}}@media(min-width:992px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(33.33333% - 16px)}}@media(min-width:1200px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(25% - 16px)}}@media(min-width:1400px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(20% - 16px)}}.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product .jetpack-instant-search__search-result-title-link{display:initial}.jetpack-instant-search__search-result>.jetpack-instant-search__search-result-product-img-link{display:block}.jetpack-instant-search__search-result-product-img-container{border-radius:5px;color:transparent;position:relative}.jetpack-instant-search__search-result-product-img-container.jetpack-instant-search__search-result-product-img-container--placeholder{background:#c3c4c7}.jetpack-instant-search__search-result-product-img-container .gridicon{fill:#fff}.jetpack-instant-search__search-result-product-img-container:before{content:"";display:block;padding-top:100%;width:100%}.jetpack-instant-search__search-result-product-img{border-radius:5px;bottom:0;height:100%;left:0;object-fit:cover;position:absolute;right:0;top:0;width:100%}.jetpack-instant-search__search-result-product-img>.gridicon{left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}.jetpack-instant-search__search-result-product-img>.gridicons-image{height:25%;width:25%}.jetpack-instant-search__search-result-product-img>.gridicons-block{height:50%;width:50%}.jetpack-instant-search__search-result-title.jetpack-instant-search__search-result-product-title{font-size:1.25em;margin:.25em 0 0}.jetpack-instant-search__search-result-product-match{font-size:.9em;margin-top:.25em}.jetpack-instant-search__search-result-product-match mark{align-items:center;display:flex;font-weight:400}.jetpack-instant-search__search-result-product-match .gridicon{height:1em;margin-right:.25em;width:1em}.jetpack-instant-search__search-result{margin:0 0 2em}.jetpack-instant-search__search-result-title{font-size:1.6em;font-weight:400;line-height:1.35;margin:0;overflow-wrap:break-word}.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-link{align-items:center;display:flex;text-decoration:none}.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-link:focus,.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-link:hover{text-decoration:underline}.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-checkmark{background-color:#b8e6bf;border-radius:50%;height:30px;margin-left:.35em;position:relative;width:30px}.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-checkmark:after{border-bottom:3px solid #00450c;border-left-color:#00450c;border-right:3px solid #00450c;border-top-color:#00450c;content:"";height:16px;left:11px;position:absolute;top:6px;transform:rotate(40deg);width:8px}.jetpack-instant-search__search-filters{position:relative}.jetpack-instant-search__search-filters>div{margin-top:1em}.jetpack-instant-search__search-filters-title{color:#00101c;display:block;font-size:inherit;font-weight:700;line-height:1.3;margin:0;padding:0}.jetpack-instant-search__clear-filters-link{border:none;cursor:pointer;line-height:1.3;margin:0;padding:0 4px;position:absolute;right:0;top:0}.jetpack-instant-search__clear-filters-link:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}.jetpack-instant-search__sidebar .jetpack-instant-search__search-filters button.jetpack-instant-search__clear-filters-link{background-color:inherit;color:#646970;font-size:inherit;font-weight:inherit}.jetpack-instant-search__search-filter-sub-heading{color:#646970;font-size:inherit;margin:0;padding:0}.jetpack-instant-search__search-filter-list{text-align:left}.jetpack-instant-search__search-filter-list>div{align-items:baseline;display:flex;margin-top:8px}.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-input,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-input{-webkit-appearance:checkbox;appearance:checkbox;background:none;border:none;cursor:pointer;height:auto;margin:0;top:1px;width:auto}.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-input:after,.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-input:before,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-input:after,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-input:before{display:none!important}.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-input:focus,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-input:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit;outline-offset:2px}.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-label,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-label{color:inherit;cursor:pointer;display:inline-block;font-weight:400;margin:0 0 0 8px;padding:0;width:auto}.jetpack-instant-search__search-static-filter-list{font-size:.875rem;line-height:1.8}.jetpack-instant-search__widget-area-container{margin-bottom:2em}.jetpack-instant-search__sidebar{padding-top:14px}.jetpack-instant-search__sidebar .jetpack-instant-search__widget-area>.widget{background:none;border:none;margin:0;padding:0}.jetpack-instant-search__sidebar .jetpack-instant-search__widget-area>.widget a{font-weight:400}.jetpack-instant-search__sidebar h2.widgettitle{border:none;font-size:1.3em;margin:1em 0 .5em}.jetpack-instant-search__sidebar h2.widgettitle:after,.jetpack-instant-search__sidebar h2.widgettitle:before{display:none!important}.jetpack-instant-search__search-static-filter-variation-tabbed{border-bottom:1px solid #e6f1f5;display:flex}.jetpack-instant-search__search-static-filter-variation-tabbed>div{margin:0}.jetpack-instant-search__search-static-filter-variation-tabbed .jetpack-instant-search__search-filter-list-label{margin:0;padding:10px 20px}.jetpack-instant-search__search-static-filter-variation-tabbed .jetpack-instant-search__search-filter-list-input{display:none}.jetpack-instant-search__search-static-filter-variation-tabbed .jetpack-instant-search__search-filter-list-input:checked+.jetpack-instant-search__search-filter-list-label{border-bottom:3px solid #0675c4}.jetpack-instant-search__search-results-wrapper{border-radius:4px;height:100%;margin:0 auto;max-width:1080px;overflow:hidden;position:relative}@media(min-width:992px){.jetpack-instant-search__search-results-wrapper{max-width:95%}}.jetpack-instant-search__search-results-wrapper.has-colophon{padding-bottom:40px}.jetpack-instant-search__jetpack-colophon{background-color:#fff;border-top:1px solid #e6f1f5;bottom:0;display:flex;height:40px;justify-content:center;margin:0;position:absolute;width:100%}.jetpack-instant-search__search-results{background:#fff;height:100%;min-height:100%;overflow-y:auto;position:relative;z-index:10}@media(max-width:575.98px){.jetpack-instant-search__search-results{border-radius:0}}.jetpack-instant-search__search-results mark{background:#ffc;color:#00101c}.jetpack-instant-search__search-results #jetpack-instant-search__overlay-focus-anchor{background-color:inherit;border:none;bottom:0;color:inherit;font-size:.7em;font-weight:400;margin-bottom:4px;margin-right:4px;overflow:hidden;padding:4px 6px;position:absolute;right:0;width:1px;clip:rect(1px,1px,1px,1px)}.jetpack-instant-search__search-results #jetpack-instant-search__overlay-focus-anchor:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit;clip:auto!important;-webkit-clip-path:none;clip-path:none;width:auto}.jetpack-instant-search__search-results-controls{display:flex}.jetpack-instant-search__search-results-content{display:flex;position:relative}.jetpack-instant-search__search-results-filter-button{align-items:center;border:0;color:#646970;cursor:pointer;display:flex;flex-shrink:0;font-size:12px;margin:0;padding:8px;text-decoration:none}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-results-filter-button{visibility:hidden}@media(min-width:576px){.jetpack-instant-search__search-results-filter-button{font-size:13px;padding:10px 14px}}@media(min-width:992px){.jetpack-instant-search__search-results-filter-button{display:none}.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-filter-button{display:flex}}@media(min-width:1200px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-filter-button{display:none}}.jetpack-instant-search__search-results-filter-button:focus,.jetpack-instant-search__search-results-filter-button:hover{color:#00101c}.jetpack-instant-search__search-results-filter-button .gridicon{margin-left:4px}.jetpack-instant-search__search-results-primary{margin:0;max-width:calc(100% - 320px);width:100%}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-results-primary{max-width:100%}@media(max-width:991.98px){.jetpack-instant-search__search-results-primary{max-width:100%}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-primary{max-width:100%}}.jetpack-instant-search__search-results-secondary{background:none;border-left:1px solid #e6f1f5;border-radius:0;bottom:0;box-shadow:none;color:#00101c;display:block;flex:none;padding:0 32px;position:static;width:320px}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-results-secondary{display:none}@media(max-width:991.98px){.jetpack-instant-search__search-results-secondary{display:none}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-secondary{display:none}}@media(max-width:991.98px){.jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{background:#fff;border:1px solid rgba(0,0,0,.1);border-radius:6px;box-shadow:0 2px 3px rgba(0,0,0,.1);display:block;left:1em;max-height:70vh;min-width:360px;overflow-y:scroll;padding:16px 24px;position:absolute;right:1em;top:0;width:auto;z-index:10}}@media(max-width:991.98px)and (max-width:575.98px){.jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{max-height:80vh}}@media(max-width:991.98px){.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{display:none}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{background:#fff;border:1px solid rgba(0,0,0,.1);border-radius:6px;box-shadow:0 2px 3px rgba(0,0,0,.1);display:block;left:1em;max-height:70vh;min-width:360px;overflow-y:scroll;padding:16px 24px;position:absolute;right:1em;top:0;width:auto;z-index:10}}@media(max-width:1199.98px)and (max-width:575.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{max-height:80vh}}@media(max-width:1199.98px){.jetpack-instant-search__overlay--no-sidebar .jp-search-configure-app-wrapper .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{display:none}}.jetpack-instant-search__search-results-title,.jetpack-instant-search__search-results-unused-query{color:#00101c;font-size:1em;font-weight:700;line-height:1.3;margin:1em 56px 1.5em;padding:0;word-break:break-word}@media(max-width:991.98px){.jetpack-instant-search__search-results-title,.jetpack-instant-search__search-results-unused-query{margin-bottom:1em;margin-left:40px;margin-right:40px}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-title,.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-unused-query{margin-bottom:1em;margin-left:40px;margin-right:40px}}@media(max-width:767.98px){.jetpack-instant-search__search-results-title,.jetpack-instant-search__search-results-unused-query{margin-left:20px;margin-right:20px}}@media(min-width:992px){.jetpack-instant-search__search-results-title{padding-right:210px}}@media(min-width:1200px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-title{padding-right:210px}}.jetpack-instant-search__search-results-list{color:#00101c;list-style:none;margin-left:56px;margin-right:56px;padding:0}@media(max-width:991.98px){.jetpack-instant-search__search-results-list{margin-left:40px;margin-right:40px}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-list{margin-left:40px;margin-right:40px}}@media(max-width:767.98px){.jetpack-instant-search__search-results-list{margin-left:20px;margin-right:20px}}.jetpack-instant-search__search-results-list li:before{content:"";height:1px;position:absolute;width:1px}.jetpack-instant-search__search-results-search-form{font-size:.8em;margin:0;top:0;width:100%}button.jetpack-instant-search__overlay-close{align-items:center;-webkit-appearance:none;appearance:none;background:none;background-color:transparent!important;border:none;border-bottom:1px solid #e6f1f5;border-radius:0;box-shadow:none;cursor:pointer;display:flex;height:61px;justify-content:center;line-height:1;margin:0;outline:none;padding:0;text-decoration:none;text-shadow:none;text-transform:none;width:60px}button.jetpack-instant-search__overlay-close:focus,button.jetpack-instant-search__overlay-close:hover{-webkit-appearance:none;appearance:none;background:none;box-shadow:none;outline:none}button.jetpack-instant-search__overlay-close:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}button.jetpack-instant-search__overlay-close svg.gridicon{fill:#646970}button.jetpack-instant-search__overlay-close:active,button.jetpack-instant-search__overlay-close:focus,button.jetpack-instant-search__overlay-close:hover{background-color:transparent!important;border-color:#e6f1f5}button.jetpack-instant-search__overlay-close:active svg.gridicon,button.jetpack-instant-search__overlay-close:focus svg.gridicon,button.jetpack-instant-search__overlay-close:hover svg.gridicon{fill:#3c434a}.jetpack-instant-search__search-results-pagination{display:block;flex:none;margin:50px}@media(prefers-reduced-motion:no-preference){.jetpack-instant-search__search-results-filter-button{transition:background-color .25s ease-in-out}}.jetpack-instant-search .widget a,.jetpack-instant-search .widget.widget_archive ul li a,.jetpack-instant-search a{border:none;color:#001621;text-decoration:none}.jetpack-instant-search .widget a:focus,.jetpack-instant-search .widget a:hover,.jetpack-instant-search .widget.widget_archive ul li a:focus,.jetpack-instant-search .widget.widget_archive ul li a:hover,.jetpack-instant-search a:focus,.jetpack-instant-search a:hover{color:#044b7a;text-decoration:underline}.jetpack-search-filters-widget__filter-list{list-style-type:none}body.enable-search-modal .cover-modal.show-modal.search-modal.active{display:none}.screen-reader-text{border:0;clip:rect(1px,1px,1px,1px);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;word-wrap:normal!important}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark{background:rgba(29,35,39,.7);color:#e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget a,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget.widget_archive ul li a,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark a{color:#f6f7f7}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget a:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget a:hover,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget.widget_archive ul li a:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget.widget_archive ul li a:hover,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark a:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark a:hover{color:#1689db}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-filters-title,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-result-expanded__content,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-list,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-title,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-unused-query{color:#e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__jetpack-colophon-text,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__path-breadcrumb,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__path-breadcrumb-link{color:#a7aaad}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-filter-sub-heading,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-result-expanded__path{color:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__jetpack-colophon{background-color:#000;border-color:#3c434a}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close{border-color:#3c434a}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box-gridicon svg,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close svg.gridicon{fill:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close{border-color:#3c434a}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close:focus svg.gridicon,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close:hover svg.gridicon{fill:#a7aaad}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box input[type=button]{color:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box input[type=button]:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box input[type=button]:hover{color:#a7aaad}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark input.jetpack-instant-search__box-input.search-field{background:#000;color:#a7aaad}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark input.jetpack-instant-search__box-input.search-field:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark input.jetpack-instant-search__box-input.search-field:hover{background:#000;color:#e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark input.jetpack-instant-search__box-input.search-field:focus{outline:thin dotted #e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results{background:#000}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results mark{color:#e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-filter-button{color:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-filter-button:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-filter-button:hover,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-secondary{color:#e6f1f5}@media(min-width:992px){.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-secondary{border-color:#3c434a}}@media(max-width:991.98px){.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{background:#000;border-color:#3c434a;box-shadow:0 2px 3px #3c434a}}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-form-controls .jetpack-instant-search__search-sort button.jetpack-instant-search__search-sort-option{color:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-form-controls .jetpack-instant-search__search-sort button.jetpack-instant-search__search-sort-option.is-selected{color:#1689db}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-result-product-img--placeholder{color:#2c3338}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-sort-select{background:#000;border-color:#3c434a;color:#e6f1f5}jp-search.chunk-main-payload.js                                                                                                                                                                                                                                75772         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/build/instant-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "use strict";(globalThis.webpackChunkjetpack_search=globalThis.webpackChunkjetpack_search||[]).push([[613],{5332:(e,t,s)=>{s.d(t,{Z:()=>n});var r=s(211),a=s(4184);class n extends r.Component{componentDidMount(){(0,a.vJ)(this.handleOverlayOptionsUpdate),(0,a.Em)(this.props.toggleResults)}handleOverlayOptionsUpdate=e=>{this.props.updateOverlayOptions(e,(()=>this.props.showResults()))};render(){return null}}},1773:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(3259),a=s.n(r),n=s(211),i=s(4797);class o extends n.Component{constructor(){super(...arguments),this.state={isComposing:!1,bodyScrollTop:0,prefersReducedMotion:(0,i.O)(),previousStyle:null,previousBodyStyleAttribute:""},this.props.initializeQueryValues()}componentDidMount(){this.disableUnnecessaryFormAndInputAttributes(),this.addEventListeners()}componentWillUnmount(){this.removeEventListeners(),this.restoreBodyScroll()}componentDidUpdate(e){this.props.isVisible!==e.isVisible&&this.fixBodyScroll()}disableUnnecessaryFormAndInputAttributes(){document.querySelectorAll(this.props.themeOptions.searchInputSelector).forEach((e=>{e.removeAttribute("required"),e.removeAttribute("autocomplete"),e.form.removeAttribute("autocomplete")}))}addEventListeners(){window.addEventListener("popstate",this.handleHistoryNavigation),document.querySelectorAll(this.props.themeOptions.searchInputSelector).forEach((e=>{e.form.addEventListener("submit",this.handleSubmit),e.addEventListener("keyup",this.handleKeyup),e.addEventListener("input",this.handleInput),e.addEventListener("compositionstart",this.handleCompositionStart),e.addEventListener("compositionend",this.handleCompositionEnd)})),document.querySelectorAll(this.props.themeOptions.overlayTriggerSelector).forEach((e=>{e.addEventListener("click",this.handleOverlayTriggerClick,!0)})),document.querySelectorAll(this.props.themeOptions.filterInputSelector).forEach((e=>{e.addEventListener("click",this.handleFilterInputClick)}))}removeEventListeners(){window.removeEventListener("popstate",this.handleHistoryNavigation),document.querySelectorAll(this.props.themeOptions.searchInputSelector).forEach((e=>{e.form.removeEventListener("submit",this.handleSubmit),e.removeEventListener("keyup",this.handleKeyup),e.removeEventListener("input",this.handleInput),e.removeEventListener("compositionstart",this.handleCompositionStart),e.removeEventListener("compositionend",this.handleCompositionEnd)})),document.querySelectorAll(this.props.themeOptions.overlayTriggerSelector).forEach((e=>{e.removeEventListener("click",this.handleOverlayTriggerClick,!0)})),document.querySelectorAll(this.props.themeOptions.filterInputSelector).forEach((e=>{e.removeEventListener("click",this.handleFilterInputClick)}))}handleCompositionStart=()=>this.setState({isComposing:!0});handleCompositionEnd=()=>this.setState({isComposing:!1});handleFilterInputClick=e=>{e.preventDefault(),e.currentTarget.dataset.filterType&&("taxonomy"===e.currentTarget.dataset.filterType?this.props.setFilter(e.currentTarget.dataset.taxonomy,e.currentTarget.dataset.val):this.props.setFilter(e.currentTarget.dataset.filterType,e.currentTarget.dataset.val)),this.props.setSearchQuery(""),this.props.showResults()};handleHistoryNavigation=()=>{this.props.initializeQueryValues({isHistoryNavigation:!0})};handleInput=a()((e=>{e.inputType?.includes("format")||""===e.target.value||this.state.isComposing||"submit"===this.props.overlayOptions.overlayTrigger||this.state.prefersReducedMotion||(this.props.setSearchQuery(e.target.value),["immediate","results"].includes(this.props.overlayOptions.overlayTrigger)&&this.props.showResults())}),200);handleKeyup=e=>{"Enter"===e.key&&(this.props.setSearchQuery(e.target.value),this.props.showResults())};handleOverlayTriggerClick=e=>{e.stopImmediatePropagation(),this.props.setSearchQuery(""),this.props.showResults()};handleSubmit=e=>{if(e.preventDefault(),this.handleInput.flush(),!this.props.isVisible){const t=e.target.querySelector(this.props.themeOptions.searchInputSelector)?.value;"string"==typeof t&&this.props.setSearchQuery(t),this.props.showResults()}};fixBodyScroll=()=>{this.props.isVisible?(this.preventBodyScroll(),window?.scrollTo(0,0)):this.props.isVisible||this.restoreBodyScroll()};preventBodyScroll(){this.setState({bodyScrollTop:parseInt(window.scrollY)||0,previousStyle:{top:document.body.style.top,left:document.body.style.left,right:document.body.style.right,scrollBehavior:document.documentElement.style.scrollBehavior},previousBodyStyleAttribute:document.body.getAttribute("style")},(()=>{const e=document.documentElement?.scrollHeight-document.body?.scrollHeight||0;document.body.setAttribute("style","position: fixed !important"),document.body.style.top=`-${this.state.bodyScrollTop-e}px`,document.body.style.left=0,document.body.style.right=0}))}restoreBodyScroll(){this.state.previousBodyStyleAttribute?document.body.setAttribute("style",this.state.previousBodyStyleAttribute):document.body.removeAttribute("style"),document.body.style.top=this.state.previousStyle?.top??"",document.body.style.left=this.state.previousStyle?.left??"",document.body.style.right=this.state.previousStyle?.right??"",document.documentElement.style.scrollBehavior="revert",this.state.bodyScrollTop>0&&window.scrollTo(0,this.state.bodyScrollTop),document.documentElement.style.scrollBehavior=this.state.previousStyle?.scrollBehavior??"",this.setState({bodyScrollTop:0,previousStyle:null,previousBodyStyleAttribute:""})}render(){return null}}},1180:(e,t,s)=>{s.d(t,{Z:()=>o});s(2753);var r=s(5736),a=s(211),n=s.n(a);const __=r.__;class i extends a.Component{static defaultProps={"aria-hidden":"false",focusable:"true"};needsOffset(e,t){return["gridicons-calendar","gridicons-cart","gridicons-folder","gridicons-info","gridicons-posts","gridicons-star-outline","gridicons-star"].indexOf(e)>=0&&t%18==0}getSVGTitle(e){if("title"in this.props)return this.props.title?n().createElement("title",null,this.props.title):null;switch(e){default:return null;case"gridicons-audio":return n().createElement("title",null,__("Has audio.","jetpack-search-pkg"));case"gridicons-calendar":return n().createElement("title",null,__("Is an event.","jetpack-search-pkg"));case"gridicons-cart":return n().createElement("title",null,__("Is a product.","jetpack-search-pkg"));case"chevron-down":return n().createElement("title",null,__("Show filters","jetpack-search-pkg"));case"gridicons-comment":return n().createElement("title",null,__("Matching comment.","jetpack-search-pkg"));case"gridicons-cross":return n().createElement("title",null,__("Close search results","jetpack-search-pkg"));case"gridicons-filter":return n().createElement("title",null,__("Toggle search filters.","jetpack-search-pkg"));case"gridicons-folder":return n().createElement("title",null,__("Category","jetpack-search-pkg"));case"gridicons-image-multiple":return n().createElement("title",null,__("Has multiple images.","jetpack-search-pkg"));case"gridicons-image":return n().createElement("title",null,__("Has an image.","jetpack-search-pkg"));case"gridicons-page":return n().createElement("title",null,__("Page","jetpack-search-pkg"));case"gridicons-post":return n().createElement("title",null,__("Post","jetpack-search-pkg"));case"gridicons-jetpack-search":case"gridicons-search":return n().createElement("title",null,__("Magnifying Glass","jetpack-search-pkg"));case"gridicons-tag":return n().createElement("title",null,__("Tag","jetpack-search-pkg"));case"gridicons-video":return n().createElement("title",null,__("Has a video.","jetpack-search-pkg"))}}renderIcon(e){switch(e){default:return null;case"gridicons-audio":return n().createElement("g",null,n().createElement("path",{d:"M8 4v10.184C7.686 14.072 7.353 14 7 14c-1.657 0-3 1.343-3 3s1.343 3 3 3 3-1.343 3-3V7h7v4.184c-.314-.112-.647-.184-1-.184-1.657 0-3 1.343-3 3s1.343 3 3 3 3-1.343 3-3V4H8z"}));case"gridicons-block":return n().createElement("g",null,n().createElement("path",{d:"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM4 12c0-4.418 3.582-8 8-8 1.848 0 3.545.633 4.9 1.686L5.686 16.9C4.633 15.545 4 13.848 4 12zm8 8c-1.848 0-3.546-.633-4.9-1.686L18.314 7.1C19.367 8.455 20 10.152 20 12c0 4.418-3.582 8-8 8z"}));case"gridicons-calendar":return n().createElement("g",null,n().createElement("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.105 0-2 .896-2 2v13c0 1.104.895 2 2 2h14c1.104 0 2-.896 2-2V6c0-1.104-.896-2-2-2zm0 15H5V8h14v11z"}));case"gridicons-cart":return n().createElement("g",null,n().createElement("path",{d:"M9 20c0 1.1-.9 2-2 2s-1.99-.9-1.99-2S5.9 18 7 18s2 .9 2 2zm8-2c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2zm.396-5c.937 0 1.75-.65 1.952-1.566L21 5H7V4c0-1.105-.895-2-2-2H3v2h2v11c0 1.105.895 2 2 2h12c0-1.105-.895-2-2-2H7v-2h10.396z"}));case"gridicons-checkmark":return n().createElement("g",null,n().createElement("path",{d:"M11 17.768l-4.884-4.884 1.768-1.768L11 14.232l8.658-8.658C17.823 3.39 15.075 2 12 2 6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10c0-1.528-.353-2.97-.966-4.266L11 17.768z"}));case"gridicons-chevron-down":return n().createElement("g",null,n().createElement("path",{d:"M20 9l-8 8-8-8 1.414-1.414L12 14.172l6.586-6.586"}));case"gridicons-comment":return n().createElement("g",null,n().createElement("path",{d:"M3 6v9c0 1.105.895 2 2 2h9v5l5.325-3.804c1.05-.75 1.675-1.963 1.675-3.254V6c0-1.105-.895-2-2-2H5c-1.105 0-2 .895-2 2z"}));case"gridicons-cross":return n().createElement("g",null,n().createElement("path",{d:"M18.36 19.78L12 13.41l-6.36 6.37-1.42-1.42L10.59 12 4.22 5.64l1.42-1.42L12 10.59l6.36-6.36 1.41 1.41L13.41 12l6.36 6.36z"}));case"gridicons-filter":return n().createElement("g",null,n().createElement("path",{d:"M10 19h4v-2h-4v2zm-4-6h12v-2H6v2zM3 5v2h18V5H3z"}));case"gridicons-folder":return n().createElement("g",null,n().createElement("path",{d:"M18 19H6c-1.1 0-2-.9-2-2V7c0-1.1.9-2 2-2h3c1.1 0 2 .9 2 2h7c1.1 0 2 .9 2 2v8c0 1.1-.9 2-2 2z"}));case"gridicons-image":return n().createElement("g",null,n().createElement("path",{d:"M13 9.5c0-.828.672-1.5 1.5-1.5s1.5.672 1.5 1.5-.672 1.5-1.5 1.5-1.5-.672-1.5-1.5zM22 6v12c0 1.105-.895 2-2 2H4c-1.105 0-2-.895-2-2V6c0-1.105.895-2 2-2h16c1.105 0 2 .895 2 2zm-2 0H4v7.444L8 9l5.895 6.55 1.587-1.85c.798-.932 2.24-.932 3.037 0L20 15.426V6z"}));case"gridicons-image-multiple":return n().createElement("g",null,n().createElement("path",{d:"M15 7.5c0-.828.672-1.5 1.5-1.5s1.5.672 1.5 1.5S17.328 9 16.5 9 15 8.328 15 7.5zM4 20h14c0 1.105-.895 2-2 2H4c-1.1 0-2-.9-2-2V8c0-1.105.895-2 2-2v14zM22 4v12c0 1.105-.895 2-2 2H8c-1.105 0-2-.895-2-2V4c0-1.105.895-2 2-2h12c1.105 0 2 .895 2 2zM8 4v6.333L11 7l4.855 5.395.656-.73c.796-.886 2.183-.886 2.977 0l.513.57V4H8z"}));case"gridicons-info":return n().createElement("g",null,n().createElement("path",{d:"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}));case"gridicons-jetpack-search":return n().createElement("g",null,n().createElement("path",{d:"M0 9.257C0 4.15 4.151 0 9.257 0c5.105 0 9.256 4.151 9.256 9.257a9.218 9.218 0 01-2.251 6.045l.034.033h1.053L24 22.01l-1.986 1.989-6.664-6.662v-1.055l-.033-.033a9.218 9.218 0 01-6.06 2.264C4.15 18.513 0 14.362 0 9.257zm4.169 1.537h4.61V1.82l-4.61 8.973zm5.547-3.092v8.974l4.61-8.974h-4.61z"}));case"gridicons-pages":return n().createElement("g",null,n().createElement("path",{d:"M16 8H8V6h8v2zm0 2H8v2h8v-2zm4-6v12l-6 6H6c-1.105 0-2-.895-2-2V4c0-1.105.895-2 2-2h12c1.105 0 2 .895 2 2zm-2 10V4H6v16h6v-4c0-1.105.895-2 2-2h4z"}));case"gridicons-posts":return n().createElement("g",null,n().createElement("path",{d:"M16 19H3v-2h13v2zm5-10H3v2h18V9zM3 5v2h11V5H3zm14 0v2h4V5h-4zm-6 8v2h10v-2H11zm-8 0v2h5v-2H3z"}));case"gridicons-search":return n().createElement("g",null,n().createElement("path",{d:"M21 19l-5.154-5.154C16.574 12.742 17 11.42 17 10c0-3.866-3.134-7-7-7s-7 3.134-7 7 3.134 7 7 7c1.42 0 2.742-.426 3.846-1.154L19 21l2-2zM5 10c0-2.757 2.243-5 5-5s5 2.243 5 5-2.243 5-5 5-5-2.243-5-5z"}));case"gridicons-star-outline":return n().createElement("g",null,n().createElement("path",{d:"M12 6.308l1.176 3.167.347.936.997.042 3.374.14-2.647 2.09-.784.62.27.963.91 3.25-2.813-1.872-.83-.553-.83.552-2.814 1.87.91-3.248.27-.962-.783-.62-2.648-2.092 3.374-.14.996-.04.347-.936L12 6.308M12 2L9.418 8.953 2 9.257l5.822 4.602L5.82 21 12 16.89 18.18 21l-2.002-7.14L22 9.256l-7.418-.305L12 2z"}));case"gridicons-star":return n().createElement("g",null,n().createElement("path",{d:"M12 2l2.582 6.953L22 9.257l-5.822 4.602L18.18 21 12 16.89 5.82 21l2.002-7.14L2 9.256l7.418-.304"}));case"gridicons-tag":return n().createElement("g",null,n().createElement("path",{d:"M20 2.007h-7.087c-.53 0-1.04.21-1.414.586L2.592 11.5c-.78.78-.78 2.046 0 2.827l7.086 7.086c.78.78 2.046.78 2.827 0l8.906-8.906c.376-.374.587-.883.587-1.413V4.007c0-1.105-.895-2-2-2zM17.007 9c-1.105 0-2-.895-2-2s.895-2 2-2 2 .895 2 2-.895 2-2 2z"}));case"gridicons-video":return n().createElement("g",null,n().createElement("path",{d:"M20 4v2h-2V4H6v2H4V4c-1.105 0-2 .895-2 2v12c0 1.105.895 2 2 2v-2h2v2h12v-2h2v2c1.105 0 2-.895 2-2V6c0-1.105-.895-2-2-2zM6 16H4v-3h2v3zm0-5H4V8h2v3zm4 4V9l4.5 3-4.5 3zm10 1h-2v-3h2v3zm0-5h-2V8h2v3z"}))}}render(){const{size:e=24,className:t=""}=this.props,s=this.props.height||e,r=this.props.width||e,a=this.props.style||{height:s,width:r},i="gridicons-"+this.props.icon;let o=["gridicon",i,t];return this.needsOffset(i,e)&&o.push("needs-offset"),o=o.join(" "),n().createElement("svg",{"aria-label":this.props.description,className:o,focusable:this.props.focusable,height:s,onClick:this.props.onClick,style:a,viewBox:"0 0 24 24",width:r,xmlns:"http://www.w3.org/2000/svg","aria-hidden":this.props["aria-hidden"]},this.getSVGTitle(i),this.renderIcon(i))}}const o=i},8852:(e,t,s)=>{s.d(t,{Z:()=>l});var r=s(5736),a=s(211),n=s.n(a);const __=r.__,i="#fff",o=n().createElement("svg",{className:"jetpack-instant-search__jetpack-colophon-logo",height:12,width:12,viewBox:"0 0 32 32"},n().createElement("path",{className:"jetpack-logo__icon-circle",fill:"#069e08",d:"M16,0C7.2,0,0,7.2,0,16s7.2,16,16,16s16-7.2,16-16S24.8,0,16,0z"}),n().createElement("polygon",{className:"jetpack-logo__icon-triangle",fill:i,points:"15,19 7,19 15,3 "}),n().createElement("polygon",{className:"jetpack-logo__icon-triangle",fill:i,points:"17,29 17,13 25,13 "})),l=e=>{const t="string"==typeof e.locale?e.locale.split("-",1)[0]:null,s=t&&"en"!==t?"https://"+t+".jetpack.com/upgrade/search?utm_source=poweredby":"https://jetpack.com/upgrade/search/?utm_source=poweredby";return n().createElement("div",{className:"jetpack-instant-search__jetpack-colophon"},n().createElement("a",{href:s,rel:"external noopener noreferrer nofollow",target:"_blank",className:"jetpack-instant-search__jetpack-colophon-link"},o,n().createElement("span",{className:"jetpack-instant-search__jetpack-colophon-text"},__("Search powered by Jetpack","jetpack-search-pkg"))))}},4741:(e,t,s)=>{s.d(t,{Z:()=>i});var r=s(211),a=s.n(r),n=s(1180);const i=({type:e,children:t})=>"warning"!==e?null:a().createElement("div",{className:"jetpack-instant-search__notice jetpack-instant-search__notice--warning"},a().createElement(n.Z,{icon:"info",size:20}),a().createElement("div",null,t))},6321:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(5736),a=s(211),n=s.n(a),i=s(9755);const __=r.__,o=e=>{const{children:t,closeOverlay:s,colorTheme:r,hasOverlayWidgets:o,isVisible:l}=e;return(0,a.useEffect)((()=>{const e=e=>{"Escape"===e.key&&(e.preventDefault(),s())},t=e=>{if("Tab"===e.key){const t=document.getElementsByClassName(i.zg)[0].contains(e.target),s=document.getElementsByClassName(i.LO)[0],r=document.getElementById(i.VB);!0===e.shiftKey&&(e.target!==s&&!1!==t||(e.preventDefault(),r.focus())),!1===e.shiftKey&&(e.target!==r&&!1!==t||(e.preventDefault(),s.focus()))}},r=e=>{const t=document.getElementsByClassName("jetpack-instant-search__search-results-wrapper")[0];e.target?.isConnected&&t&&!t.contains(e.target)&&s()},a=()=>{window.removeEventListener("click",r),window.removeEventListener("keydown",e),window.removeEventListener("keydown",t)};return l?(window.addEventListener("click",r),window.addEventListener("keydown",e),window.addEventListener("keydown",t)):a(),()=>{a()}}),[s,l]),n().createElement("div",{"aria-hidden":!l,"aria-labelledby":"jetpack-instant-search__overlay-title",className:["jetpack-instant-search",i.zg,`jetpack-instant-search__overlay--${r}`,o?"":"jetpack-instant-search__overlay--no-sidebar",l?"":"is-hidden"].join(" "),role:"dialog"},n().createElement("h1",{id:"jetpack-instant-search__overlay-title",className:"screen-reader-text"},__("Search results","jetpack-search-pkg")),t)}},4809:(e,t,s)=>{s.d(t,{Z:()=>n});var r=s(211),a=s.n(r);const n=({className:e,onClick:t,url:s})=>{const r=function(e){const t=e.split("/").filter((e=>e.length>0));return t.shift(),t}(s);return r.length<1?null:a().createElement("div",{className:`jetpack-instant-search__path-breadcrumb ${e||""}`},a().createElement("a",{className:"jetpack-instant-search__path-breadcrumb-link",href:`//${s}`,onClick:t,tabIndex:"-1","aria-hidden":"true"},r.map(((e,t,s)=>a().createElement("span",{className:"jetpack-instant-search__path-breadcrumb-piece",key:e},decodeURIComponent(e),t!==s.length-1?"  ":"")))))}},1459:(e,t,s)=>{s.d(t,{Z:()=>l});var r=s(2674),a=s.n(r),n=s(211),i=s.n(n),o=s(9087);const l=e=>{const{alt:t,isPhotonEnabled:s,maxHeight:r=600,maxWidth:n=600,src:l,lazyLoad:c=!0,...p}=e,h=(0,o.y)(l,n,r,s);return i().createElement("img",a()({alt:t,src:h,loading:""+(c?"lazy":"eager")},p))}},883:(e,t,s)=>{s.d(t,{Z:()=>u});var r=s(5736),a=s(211),n=s.n(a),i=s(2601),o=s(1180);const __=r.__,l=["youtube","ooyala","anvplayer","wpvideo","bc_video","video","brightcove","tp_video","jwplayer","tempo-video","vimeo"],c=["gallery","ione_media_gallery"],p=["audio","soundcloud"],h={product:"cart",video:"video",gallery:"image-multiple",event:"calendar",events:"calendar"},u=({postType:e,shortcodeTypes:t,iconSize:s=18})=>{if(Object.keys(h).includes(e))return n().createElement(o.Z,{icon:h[e],size:s});const r=(0,i.Z)(t,l),a=(0,i.Z)(t,p),u=(0,i.Z)(t,c);return r?n().createElement(o.Z,{icon:"video",size:s}):a?n().createElement(o.Z,{icon:"audio",size:s}):"page"===e?n().createElement(o.Z,{icon:"pages",size:s,description:__("Page","jetpack-search-pkg")}):u?n().createElement(o.Z,{icon:"image-multiple",size:s,description:__("Image","jetpack-search-pkg")}):null}},4682:(e,t,s)=>{s.d(t,{Z:()=>i});var r=s(211),a=s.n(r);class n extends r.Component{render(){const{formattedPrice:e,formattedSalePrice:t,formattedRegularPrice:s,price:n,salePrice:i}=this.props;return n?a().createElement("span",{className:"jetpack-instant-search__product-price"},i>0?a().createElement(r.Fragment,null,a().createElement("s",{className:"jetpack-instant-search__product-price-regular",dangerouslySetInnerHTML:{__html:s}}),a().createElement("span",{dangerouslySetInnerHTML:{__html:t}})):a().createElement("span",{dangerouslySetInnerHTML:{__html:e}})):null}}const i=n},6565:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(5736),a=s(211),n=s.n(a),i=s(1180);const _n=r._n;function o({rating:e=0,count:t=0,permalink:s}){return n().createElement("div",{className:"jetpack-instant-search__product-rating"},n().createElement("span",{"aria-hidden":!0,className:"jetpack-instant-search__product-rating-stars"},Array(5).fill(n().createElement(i.Z,{size:16,icon:"star-outline"})).fill(n().createElement(i.Z,{size:16,icon:"star"}),0,e))," ",n().createElement("a",{"aria-hidden":!0,className:"jetpack-instant-search__product-rating-count",href:s+"#reviews"},(0,r.sprintf)(/* Translators: the placeholder is the number of product reviews. */
_n("%d review","%d reviews",t,"jetpack-search-pkg"),t)),n().createElement("span",{className:"screen-reader-text"},(0,r.sprintf)(/* Translators: the first placeholder is the average product rating out of 5; the second is the number of product reviews. */
_n("Average rating of %1$d out of 5 from %2$d review.","Average rating of %1$d out of 5 from %2$d reviews.",t,"jetpack-search-pkg"),Number(e).toFixed(2),t)))}},423:(e,t,s)=>{s.d(t,{Z:()=>p});var r=s(5736),a=s(3259),n=s.n(a),i=s(211),o=s.n(i),l=s(9755);const __=r.__;class c extends i.Component{scrollElement=document.getElementsByClassName(l.Ov)[0];componentDidMount(){this.scrollElement.addEventListener("scroll",this.checkScroll)}componentDidUnmount(){this.scrollElement.removeEventListener("scroll",this.checkScroll)}checkScroll=n()((()=>{const e=this.scrollElement.clientHeight+this.scrollElement.scrollTop+l.Qy;this.props.enableLoadOnScroll&&e>=this.scrollElement.scrollHeight&&this.props.onLoadNextPage()}),100);render(){return o().createElement("button",{className:"jetpack-instant-search__scroll-button",disabled:this.props.isLoading,onClick:this.props.onLoadNextPage},this.props.isLoading?o().createElement("span",null,__("Loading","jetpack-search-pkg")):o().createElement("span",null,__("Load more","jetpack-search-pkg")))}}const p=c},5652:(e,t,s)=>{s.d(t,{Z:()=>k});var r=s(7390),a=s.n(r),n=s(3259),i=s.n(n),o=s(211),l=s.n(o),c=s(9309),p=s(9755),h=s(1547),u=s(6302),d=s(8050),m=s(8389),g=s(1530),_=s(5332),y=s(1773),f=s(6321),v=s(2975);class E extends o.Component{static defaultProps={overlayOptions:{},widgets:[]};constructor(){super(...arguments),this.state={isVisible:!!this.props.initialIsVisible,overlayOptionsCustomizerOverride:{}},this.getResults=i()(this.getResults,200),this.props.enableAnalytics?this.initializeAnalytics():(0,d.IJ)(),this.props.shouldIntegrateWithDom?this.props.initializeQueryValues():this.props.disableQueryStringIntegration()}static getDerivedStateFromProps(e,t){return{overlayOptions:{...e.overlayOptions,...t.overlayOptionsCustomizerOverride}}}componentDidMount(){(this.props.initialShowResults&&this.props.initialIsVisible||this.props.isInCustomizer)&&this.getResults(),this.props.hasActiveQuery&&this.props.overlayOptions.enableFilteringOpensOverlay&&this.showResults()}componentDidUpdate(e,t){e.searchQuery===this.props.searchQuery&&e.sort===this.props.sort&&a()(e.filters)===a()(this.props.filters)&&a()(e.staticFilters)===a()(this.props.staticFilters)||this.onChangeQueryString(this.props.isHistoryNavigation),t.overlayOptions.defaultSort!==this.state.overlayOptions.defaultSort&&this.props.setSort(this.state.overlayOptions.defaultSort),a()(t.overlayOptions.excludedPostTypes)!==a()(this.state.overlayOptions.excludedPostTypes)&&this.getResults()}initializeAnalytics(){(0,d.tU)(),!window[p.W1].preventTrackingCookiesReset&&(0,d.vy)(),(0,d.AM)(this.props.options.siteId)}getResultFormat=()=>{const e=(0,u.ug)();return this.props.staticFilters&&this.props.staticFilters.group_id&&this.props.staticFilters.group_id!==p.Bk?p.Pz:e||this.state.overlayOptions.resultFormat};initializeStaticFilters=()=>{const e=(0,h.bA)();e.length>0&&0===Object.keys(this.props.staticFilters).length&&e.forEach((e=>this.props.setStaticFilter(e.filter_id,e.selected,!0)))};hideResults=e=>{this.props.shouldIntegrateWithDom&&(0,u.Q0)(this.props.initialHref,(()=>{this.setState({isVisible:!1}),this.props.clearQueryValues()}),e)};toggleResults=e=>{this.props.shouldIntegrateWithDom&&this.state.isVisible!==e&&(e&&this.initializeStaticFilters(),this.setState({isVisible:e}))};showResults=this.toggleResults.bind(this,!0);onChangeQueryString=e=>{this.getResults(),this.props.hasActiveQuery&&!this.state.isVisible&&this.showResults(),!this.props.hasActiveQuery&&e&&this.hideResults(e),null!==this.props.searchQuery&&document.querySelectorAll(this.props.themeOptions.searchInputSelector).forEach((e=>{e.value=this.props.searchQuery}))};loadNextPage=()=>{this.props.hasNextPage&&this.getResults({pageHandle:this.props.response.page_handle})};getResults=({pageHandle:e}={})=>{this.props.makeSearchRequest({aggregations:e?{}:this.props.aggregations,excludedPostTypes:this.state.overlayOptions.excludedPostTypes,filter:this.props.filters,staticFilters:this.props.staticFilters,pageHandle:e,query:this.props.searchQuery,resultFormat:this.getResultFormat(),siteId:this.props.options.siteId,additionalBlogIds:this.props.options.additionalBlogIds,sort:this.props.sort,postsPerPage:this.props.options.postsPerPage,adminQueryFilter:this.props.options.adminQueryFilter,isInCustomizer:this.props.isInCustomizer})};updateOverlayOptions=(e,t)=>{this.setState((t=>({overlayOptionsCustomizerOverride:{...t.overlayOptionsCustomizerOverride,...e}})),t)};render(){const e=this.getResultFormat(),t=this.props.shouldCreatePortal?o.createPortal:e=>e;return l().createElement(o.Fragment,null,this.props.isInCustomizer&&l().createElement(_.Z,{showResults:this.showResults,toggleResults:this.toggleResults,updateOverlayOptions:this.updateOverlayOptions}),this.props.shouldIntegrateWithDom&&l().createElement(y.Z,{initializeQueryValues:this.props.initializeQueryValues,isVisible:this.state.isVisible,overlayOptions:this.state.overlayOptions,setFilter:this.props.setFilter,setSearchQuery:this.props.setSearchQuery,showResults:this.showResults,themeOptions:this.props.themeOptions}),t(l().createElement(f.Z,{closeColor:this.state.overlayOptions.closeColor,closeOverlay:this.hideResults,colorTheme:this.state.overlayOptions.colorTheme,hasOverlayWidgets:this.props.hasOverlayWidgets,isVisible:this.state.isVisible},l().createElement(v.Z,{closeOverlay:this.hideResults,enableLoadOnScroll:this.state.overlayOptions.enableInfScroll,enableFilteringOpensOverlay:this.state.overlayOptions.enableFilteringOpensOverlay,enableSort:this.state.overlayOptions.enableSort,filters:this.props.filters,staticFilters:this.props.staticFilters,hasError:this.props.hasError,hasNextPage:this.props.hasNextPage,highlightColor:this.state.overlayOptions.highlightColor,isLoading:this.props.isLoading,isPhotonEnabled:this.props.options.isPhotonEnabled,isPrivateSite:this.props.options.isPrivateSite,isVisible:this.state.isVisible,locale:this.props.options.locale,onChangeSearch:this.props.setSearchQuery,onChangeSort:this.props.setSort,onLoadNextPage:this.loadNextPage,overlayTrigger:this.state.overlayOptions.overlayTrigger,postTypes:this.props.options.postTypes,response:this.props.response,resultFormat:e,searchQuery:this.props.searchQuery,showPoweredBy:this.state.overlayOptions.showPoweredBy,sort:this.props.sort,widgets:this.props.options.widgets,widgetOutsideOverlay:this.props.widgetOutsideOverlay,hasNonSearchWidgets:this.props.options.hasNonSearchWidgets,additionalBlogIds:this.props.options.additionalBlogIds,showPostDate:this.state.overlayOptions.enablePostDate})),document.body))}}const k=(0,c.$j)(((e,t)=>({filters:(0,g.Zj)(e),staticFilters:(0,g.Bk)(e),hasActiveQuery:(0,g.en)(e),hasError:(0,g.xT)(e),isHistoryNavigation:(0,g.wI)(e),hasNextPage:(0,g.Qy)(e),isLoading:(0,g.hg)(e),response:(0,g.ck)(e),searchQuery:(0,g.uP)(e),sort:(0,g.r$)(e,t.overlayOptions.defaultSort),widgetOutsideOverlay:(0,g.ZN)(e)})),{clearQueryValues:m.Mz,disableQueryStringIntegration:m.OZ,initializeQueryValues:m.Ln,makeSearchRequest:m.x1,setStaticFilter:m.O1,setFilter:m.Tv,setSearchQuery:m.ql,setSort:m.HD})(E)},3725:(e,t,s)=>{s.d(t,{Z:()=>h});var r=s(5736),a=s(5348),n=s.n(a),i=s(211),o=s.n(i),l=s(9755),c=s(1180);const __=r.__;let p=null;const h=e=>{const[t]=(0,i.useState)((()=>n()("jetpack-instant-search__box-input-"))),s=(0,i.useRef)(null);return(0,i.useEffect)((()=>{var t;e.isVisible?(t=s.current,()=>{p=document.activeElement,t.focus()})():e.shouldRestoreFocus&&p&&p.focus()}),[e.isVisible,e.shouldRestoreFocus]),o().createElement(i.Fragment,null,o().createElement("div",{className:"jetpack-instant-search__box"},o().createElement("label",{className:"jetpack-instant-search__box-label",htmlFor:t},o().createElement("div",{className:"jetpack-instant-search__box-gridicon"},o().createElement(c.Z,{icon:"search",size:24})),o().createElement("input",{autoComplete:"off",id:t,className:"search-field "+l.LO,inputMode:"search",onChange:e.isVisible?e.onChange:null,ref:s,placeholder:__("Search","jetpack-search-pkg"),type:"search",value:e.searchQuery??""}),"string"==typeof e.searchQuery&&e.searchQuery.length>0&&
/* Translators: Button is used to clear the search input query. */
o().createElement("input",{type:"button",value:__("clear","jetpack-search-pkg"),onClick:e.onClear}),o().createElement("button",{className:"screen-reader-text assistive-text",tabIndex:"-1"},__("Search","jetpack-search-pkg")))))}},7704:(e,t,s)=>{s.d(t,{Z:()=>i});var r=s(211),a=s.n(r),n=s(9873);const i=e=>a().createElement("div",{className:"jetpack-instant-search__search-form-controls",role:"form"},e.children,e.enableSort&&a().createElement(n.Z,{onChange:e.onChangeSort,resultFormat:e.resultFormat,value:e.sort}))},2547:(e,t,s)=>{s.d(t,{Z:()=>g,a:()=>d});var r=s(5235),a=s.n(r),n=s(5348),i=s.n(n),o=s(211),l=s.n(o),c=s(9309),p=s(4553),h=s.n(p),u=s(2160);const d=e=>e.split(" ").join("T");class m extends o.Component{filtersList=(0,o.createRef)();idPrefix=i()("jetpack-instant-search__search-filter-");getIdentifier(){return"postType"===this.props.type?"post_types":"author"===this.props.type?"authors":"blogId"===this.props.type?"blog_ids":"date"===this.props.type?`${this.props.configuration.interval}_${this.props.configuration.field}`:"taxonomy"===this.props.type?this.props.configuration.taxonomy:"group"===this.props.type?this.props.configuration.filter_id:void 0}isChecked(e){return Boolean(this.props.value&&this.props.value.includes(e))}toggleFilter=()=>{this.props.onChange(this.getIdentifier(),(0,u.b)(this.filtersList.current))};toggleStaticFilter=e=>{this.props.onChange(this.getIdentifier(),e.target.value)};renderDate=({key_as_string:e,doc_count:t})=>{const{locale:s="en-US"}=this.props;return l().createElement("div",null,l().createElement("input",{checked:this.isChecked(e),disabled:!this.isChecked(e)&&0===t,id:`${this.idPrefix}-dates-${this.getIdentifier()}-${e}`,name:e,onChange:this.toggleFilter,type:"checkbox",className:"jetpack-instant-search__search-filter-list-input"}),l().createElement("label",{htmlFor:`${this.idPrefix}-dates-${this.getIdentifier()}-${e}`,className:"jetpack-instant-search__search-filter-list-label"},new Date(d(e)).toLocaleString(s,function(e){switch(e){case"day":return{year:"numeric",month:"long",day:"numeric"};case"month":return{year:"numeric",month:"long"};case"year":return{year:"numeric"}}return{year:"numeric",month:"long"}}(this.props.configuration.interval))," ","(",t,")"))};renderPostType=({key:e,doc_count:t})=>{const s=e in this.props.postTypes?this.props.postTypes[e].singular_name:e;return l().createElement("div",null,l().createElement("input",{checked:this.isChecked(e),disabled:!this.isChecked(e)&&0===t,id:`${this.idPrefix}-post-types-${e}`,name:e,onChange:this.toggleFilter,type:"checkbox",className:"jetpack-instant-search__search-filter-list-input"}),l().createElement("label",{htmlFor:`${this.idPrefix}-post-types-${e}`,className:"jetpack-instant-search__search-filter-list-label"},h()(s)," (",t,")"))};renderAuthor=({key:e,doc_count:t})=>{const[s,r]=e&&e.split(/\/(.+)/);return l().createElement("div",null,l().createElement("input",{checked:this.isChecked(s),disabled:!this.isChecked(s)&&0===t,id:`${this.idPrefix}-authors-${s}`,name:s,onChange:this.toggleFilter,type:"checkbox",className:"jetpack-instant-search__search-filter-list-input"}),l().createElement("label",{htmlFor:`${this.idPrefix}-authors-${s}`,className:"jetpack-instant-search__search-filter-list-label"},h()(r)," (",t,")"))};renderBlogId=({key:e,doc_count:t})=>{const s=e.toString(),r=this.props.blogIdFilteringLabels?.[e]||s;return l().createElement("div",null,l().createElement("input",{checked:this.isChecked(s),disabled:!this.isChecked(s)&&0===t,id:`${this.idPrefix}-blog-ids-${s}`,name:s,onChange:this.toggleFilter,type:"checkbox",className:"jetpack-instant-search__search-filter-list-input"}),l().createElement("label",{htmlFor:`${this.idPrefix}-blog-ids-${s}`,className:"jetpack-instant-search__search-filter-list-label"},h()(r)," (",t,")"))};renderTaxonomy=({key:e,doc_count:t})=>{const[s,r]=e&&e.split(/\/(.+)/);return l().createElement("div",null,l().createElement("input",{checked:this.isChecked(s),disabled:!this.isChecked(s)&&0===t,id:`${this.idPrefix}-taxonomies-${s}`,name:s,onChange:this.toggleFilter,type:"checkbox",className:"jetpack-instant-search__search-filter-list-input"}),l().createElement("label",{htmlFor:`${this.idPrefix}-taxonomies-${s}`,className:"jetpack-instant-search__search-filter-list-label"},h()(r)," (",t,")"))};renderGroup=e=>l().createElement("div",{className:"jetpack-instant-search__search-filter-group-item"},l().createElement("input",{checked:this.isChecked(e.value),id:`${this.idPrefix}-groups-${e.value}`,name:this.props.configuration.filter_id,onChange:this.toggleStaticFilter,value:e.value,type:"radio",className:"jetpack-instant-search__search-filter-list-input"}),l().createElement("label",{htmlFor:`${this.idPrefix}-groups-${e.value}`,className:"jetpack-instant-search__search-filter-list-label"},e.name));renderDates(){return[...this.props.aggregation.buckets.filter((e=>!!e)).map(this.renderDate)].reverse().slice(0,this.props.configuration.count)}renderPostTypes(){return this.props.aggregation.buckets.map(this.renderPostType)}renderAuthors(){return this.props.aggregation.buckets.map(this.renderAuthor)}renderBlogIds(){return this.props.aggregation.buckets.map(this.renderBlogId)}renderTaxonomies(){return this.props.aggregation.buckets.map(this.renderTaxonomy)}renderGroups(){return this.props.configuration.values.map(this.renderGroup)}render(){return l().createElement("div",{id:`${this.idPrefix}-${this.props.type}`},l().createElement("h3",{className:"jetpack-instant-search__search-filter-sub-heading"},this.props.configuration.name),l().createElement("div",{ref:this.filtersList},l().createElement("div",{className:a()("jetpack-instant-search__search-filter-list","jetpack-instant-search__search-static-filter-list",`jetpack-instant-search__search-static-filter-variation-${this.props.configuration.variation}`)},"group"===this.props.type&&this.renderGroups()),this.props.aggregation&&"buckets"in this.props.aggregation&&l().createElement("div",{className:"jetpack-instant-search__search-filter-list"},"date"===this.props.type&&this.renderDates(),"postType"===this.props.type&&this.renderPostTypes(),"author"===this.props.type&&this.renderAuthors(),"blogId"===this.props.type&&this.renderBlogIds(),"taxonomy"===this.props.type&&this.renderTaxonomies())))}}const g=(0,c.$j)((e=>({blogIdFilteringLabels:e.serverOptions.blogIdFilteringLabels})))(m)},1631:(e,t,s)=>{s.d(t,{Z:()=>u});var r=s(5736),a=s(211),n=s.n(a),i=s(9309),o=s(1547),l=s(8050),c=s(8389),p=s(2547);const __=r.__;class h extends a.Component{static defaultProps={showClearFiltersButton:!0,showTitle:!0};onChangeFilter=(e,t)=>{this.props.setFilter(e,t),this.props.onChange&&this.props.onChange()};onChangeStaticFilter=(e,t)=>{(0,l.GE)({filterName:e,filterValue:t}),this.props.setStaticFilter(e,t),this.props.onChange&&this.props.onChange()};onClearFilters=e=>{e.preventDefault(),this.props.clearFilters(),this.props.onChange&&this.props.onChange()};hasActiveFilters(){return Object.keys(this.props.filters).length>0}renderFilterComponent=({configuration:e,results:t})=>t&&n().createElement(p.Z,{aggregation:t,configuration:e,locale:this.props.locale,onChange:this.onChangeFilter,postTypes:this.props.postTypes,type:(0,o.jc)(e),value:this.props.filters[(0,o.jZ)(e)]});renderStaticFilterComponent=e=>e.hasOwnProperty("visible")&&!e.visible?null:n().createElement(p.Z,{aggregation:[],configuration:e,locale:this.props.locale,onChange:this.onChangeStaticFilter,postTypes:this.props.postTypes,type:(0,o.jc)(e),value:this.props.staticFilters[(0,o.jZ)(e)]});render(){if(!this.props.widget)return null;const e=(0,o.bA)("sidebar"),t=this.props.results?.aggregations;return n().createElement("div",{className:"jetpack-instant-search__search-filters"},this.props.showTitle&&n().createElement("h2",{className:"jetpack-instant-search__search-filters-title"},__("Filter options","jetpack-search-pkg")),this.props.showClearFiltersButton&&this.hasActiveFilters()&&n().createElement("button",{class:"jetpack-instant-search__clear-filters-link",onClick:this.onClearFilters},__("Clear filters","jetpack-search-pkg")),this.props.widget?.filters&&this.props.widget.filters.length>0&&e.map(this.renderStaticFilterComponent),this.props.widget?.filters?.map((e=>t?{configuration:e,results:t[e.filter_id]}:null)).filter((e=>!!e)).filter((({results:e})=>!!e&&Array.isArray(e.buckets)&&e.buckets.length>0)).map(this.renderFilterComponent))}}const u=(0,i.$j)(null,{clearFilters:c.K5,setFilter:c.Tv,setStaticFilter:c.O1})(h)},9988:(e,t,s)=>{s.d(t,{Z:()=>l});var r=s(211),a=s.n(r),n=s(3725);const i=e=>e.preventDefault();class o extends r.Component{onClear=()=>this.props.onChangeSearch("");onChangeSearch=e=>this.props.onChangeSearch(e.currentTarget.value);render(){return a().createElement("form",{autoComplete:"off",onSubmit:i,role:"search",className:this.props.className},a().createElement("div",{className:"jetpack-instant-search__search-form"},a().createElement(n.Z,{isVisible:this.props.isVisible,onChange:this.onChangeSearch,onClear:this.onClear,shouldRestoreFocus:!0,searchQuery:this.props.searchQuery})))}}const l=o},3162:(e,t,s)=>{s.d(t,{Z:()=>i});var r=s(211),a=s.n(r),n=s(1180);const i=({comments:e,iconSize:t=18})=>e?a().createElement("div",{className:"jetpack-instant-search__search-result-comments"},a().createElement(n.Z,{icon:"comment",size:t}),a().createElement("span",{className:"jetpack-instant-search__search-result-comments-text",dangerouslySetInnerHTML:{__html:e.join(" ... ")}})):null},1954:(e,t,s)=>{s.d(t,{Z:()=>p});var r=s(6483),a=s(211),n=s.n(a),i=s(4809),o=s(1459),l=s(2547),c=s(3162);function p(e){const{isMultiSite:t,locale:s="en-US",showPostDate:a}=e,{result_type:p,fields:h,highlight:u}=e.result;if("post"!==p)return null;const d=Array.isArray(h["image.url.raw"])?h["image.url.raw"][0]:h["image.url.raw"];return Array.isArray(h.author)&&(h.author.length>3?h.author=h.author.slice(0,3).join(", ")+"...":h.author=h.author.join(", ")),n().createElement("li",{className:["jetpack-instant-search__search-result","jetpack-instant-search__search-result-expanded",`jetpack-instant-search__search-result-expanded--${h.post_type}`,d?"":"jetpack-instant-search__search-result-expanded--no-image",t?"is-multisite":"",(()=>{let e=h["category.name.default"];return e?(Array.isArray(e)||(e=[e]),e):[]})().map((e=>"jetpack-instant-search__search-result-category--"+(0,r.cleanForSlug)(e))).join(" ")].join(" ")},n().createElement("div",{className:"jetpack-instant-search__search-result-expanded__content-container"},n().createElement("div",{className:"jetpack-instant-search__search-result-expanded__copy-container"},n().createElement("h3",{className:"jetpack-instant-search__search-result-title jetpack-instant-search__search-result-expanded__title"},n().createElement("a",{className:"jetpack-instant-search__search-result-title-link jetpack-instant-search__search-result-expanded__title-link",href:`//${h["permalink.url.raw"]}`,onClick:e.onClick},n().createElement("span",{dangerouslySetInnerHTML:{__html:u.title}}),"yes"===h["forum.topic_resolved"]&&n().createElement("span",{className:"jetpack-instant-search__search-result-title-checkmark"}))),!t&&n().createElement(i.Z,{className:"jetpack-instant-search__search-result-expanded__path",onClick:e.onClick,url:`//${h["permalink.url.raw"]}`}),n().createElement("div",{className:"jetpack-instant-search__search-result-expanded__content",dangerouslySetInnerHTML:{__html:u.content.join(" ... ")}}),u.comments&&n().createElement(c.Z,{comments:u.comments})),n().createElement("a",{className:"jetpack-instant-search__search-result-expanded__image-link",href:`//${h["permalink.url.raw"]}`,onClick:e.onClick,tabIndex:"-1","aria-hidden":"true"},n().createElement("div",{className:"jetpack-instant-search__search-result-expanded__image-container"},d?n().createElement(o.Z,{alt:h["image.alt_text"],className:"jetpack-instant-search__search-result-expanded__image",isPhotonEnabled:e.isPhotonEnabled,src:`//${d}`}):null))),(t||a)&&n().createElement("ul",{className:"jetpack-instant-search__search-result-expanded__footer"},t&&n().createElement(n().Fragment,null,n().createElement("li",null,n().createElement(o.Z,{alt:h.blog_name,className:"jetpack-instant-search__search-result-expanded__footer-blog-image",isPhotonEnabled:!1,height:24,width:24,src:h.blog_icon_url,lazyLoad:!1}),n().createElement("span",{className:"jetpack-instant-search__search-result-expanded__footer-blog"},h.blog_name)),n().createElement("li",null,n().createElement("span",{className:"jetpack-instant-search__search-result-expanded__footer-author"},h.author))),a&&n().createElement("li",null,n().createElement("span",{className:"jetpack-instant-search__search-result-expanded__footer-date"},new Date((0,l.a)(h.date)).toLocaleDateString(s,{year:"numeric",month:"short",day:"numeric"})))))}},122:(e,t,s)=>{s.d(t,{Z:()=>h});var r=s(6483),a=s(211),n=s.n(a),i=s(1180),o=s(4809),l=s(883),c=s(3162);class p extends a.Component{getIconSize(){return 18}getTags(){let e=this.props.result.fields["tag.name.default"];return e?(Array.isArray(e)||(e=[e]),e.slice(0,5)):[]}getCategories(e=!1){let t=this.props.result.fields["category.name.default"];return t?(Array.isArray(t)||(t=[t]),e?t:t.slice(0,5)):[]}renderNoMatchingContent(){const e=this.getTags(),t=this.getCategories(),s=0===e.length&&0===t.length;return n().createElement("div",{className:"jetpack-instant-search__search-result-minimal-content"},s&&n().createElement(o.Z,{url:this.props.result.fields["permalink.url.raw"]}),n().createElement("div",{className:"jetpack-instant-search__search-result-minimal-cats-and-tags"},0!==e.length&&n().createElement("ul",{className:"jetpack-instant-search__search-result-minimal-tags"},e.map((e=>n().createElement("li",{className:"jetpack-instant-search__search-result-minimal-tag"},n().createElement(i.Z,{icon:"tag",size:this.getIconSize()}),n().createElement("span",{className:"jetpack-instant-search__search-result-minimal-tag-text"},e))))),0!==t.length&&n().createElement("ul",{className:"jetpack-instant-search__search-result-minimal-cats"},t.map((e=>n().createElement("li",{className:"jetpack-instant-search__search-result-minimal-cat"},n().createElement(i.Z,{icon:"folder",size:this.getIconSize()}),n().createElement("span",{className:"jetpack-instant-search__search-result-minimal-cat-text"},e)))))))}renderMatchingContent(){return n().createElement("div",{className:"jetpack-instant-search__search-result-minimal-content",dangerouslySetInnerHTML:{__html:this.props.result.highlight.content.join(" ... ")}})}render(){const{result_type:e,fields:t,highlight:s}=this.props.result;if("post"!==e)return null;const a=!s.content||""===s.content[0];return n().createElement("li",{className:["jetpack-instant-search__search-result","jetpack-instant-search__search-result-minimal",this.getCategories(!0).map((e=>"jetpack-instant-search__search-result-category--"+(0,r.cleanForSlug)(e))).join(" ")].join(" ")},n().createElement("h3",{className:"jetpack-instant-search__search-result-title jetpack-instant-search__search-result-minimal-title"},n().createElement(l.Z,{postType:t.post_type,shortcodeTypes:t.shortcode_types}),n().createElement("a",{className:"jetpack-instant-search__search-result-title-link jetpack-instant-search__search-result-minimal-title-link",href:`//${t["permalink.url.raw"]}`,onClick:this.props.onClick},n().createElement("span",{dangerouslySetInnerHTML:{__html:s.title}}),"yes"===t["forum.topic_resolved"]&&n().createElement("span",{className:"jetpack-instant-search__search-result-title-checkmark"}))),a?this.renderNoMatchingContent():this.renderMatchingContent(),n().createElement(c.Z,{comments:s&&s.comments}))}}const h=p},6504:(e,t,s)=>{s.d(t,{Z:()=>u});var r=s(5736),a=s(6483),n=s(211),i=s.n(n),o=s(1180),l=s(1459),c=s(4682),p=s(6565);const __=r.__;class h extends n.Component{render(){const{result_type:e,fields:t,highlight:s}=this.props.result;if("post"!==e)return null;const r=Array.isArray(t["image.url.raw"])?t["image.url.raw"][0]:t["image.url.raw"],n=Array.isArray(s.title)&&s.title[0].length>0?s.title[0]:__("No title","jetpack-search-pkg"),h="string"==typeof this.props.searchQuery&&""!==this.props.searchQuery.trim(),u=n.includes("<mark>"),d=h&&!u&&Array.isArray(s.content)&&s.content[0]?.length>0;return i().createElement("li",{className:["jetpack-instant-search__search-result","jetpack-instant-search__search-result-product",(()=>{let e=t["category.name.default"];return e?(Array.isArray(e)||(e=[e]),e):[]})().map((e=>"jetpack-instant-search__search-result-category--"+(0,a.cleanForSlug)(e))).join(" ")].join(" ")},i().createElement("a",{className:"jetpack-instant-search__search-result-product-img-link",href:`//${t["permalink.url.raw"]}`,onClick:this.props.onClick},i().createElement("div",{className:"jetpack-instant-search__search-result-product-img-container "+(r?"":"jetpack-instant-search__search-result-product-img-container--placeholder")},r?i().createElement(l.Z,{alt:t["image.alt_text"],className:"jetpack-instant-search__search-result-product-img",isPhotonEnabled:this.props.isPhotonEnabled,src:`//${r}`}):i().createElement("div",{className:"jetpack-instant-search__search-result-product-img"},i().createElement(o.Z,{icon:"block",style:{}}),i().createElement(o.Z,{icon:"image",style:{},title:__("Does not have an image","jetpack-search-pkg")})))),i().createElement("h3",{className:"jetpack-instant-search__search-result-title jetpack-instant-search__search-result-product-title"},i().createElement("a",{className:"jetpack-instant-search__search-result-title-link",href:`//${t["permalink.url.raw"]}`,onClick:this.props.onClick,dangerouslySetInnerHTML:{__html:n}})),i().createElement(c.Z,{price:t["wc.price"],salePrice:t["wc.sale_price"],formattedPrice:t["wc.formatted_price"],formattedRegularPrice:t["wc.formatted_regular_price"],formattedSalePrice:t["wc.formatted_sale_price"]}),!!t["meta._wc_average_rating.double"]&&i().createElement(p.Z,{count:t["meta._wc_review_count.long"],rating:t["meta._wc_average_rating.double"],permalink:`//${t["permalink.url.raw"]}`}),d&&i().createElement("div",{className:"jetpack-instant-search__search-result-product-match"},i().createElement("mark",null,i().createElement(o.Z,{icon:"search",style:{},title:!1}),i().createElement("span",null,"comment"in s?__("Matches comments","jetpack-search-pkg"):__("Matches content","jetpack-search-pkg",0)))))}}const u=h},8192:(e,t,s)=>{s.d(t,{Z:()=>d});var r=s(2674),a=s.n(r),n=s(211),i=s.n(n),o=s(9755),l=s(8050),c=s(1954),p=s(122),h=s(6504);class u extends n.Component{componentDidMount(){this.props.railcar&&(0,l.Sn)(this.getCommonTrainTracksProps())}componentDidUpdate(e){this.props.railcar!==e.railcar&&this.props.railcar&&(0,l.Sn)(this.getCommonTrainTracksProps())}getCommonTrainTracksProps(){return{fetch_algo:this.props.railcar.fetch_algo,fetch_position:this.props.railcar.fetch_position,fetch_query:this.props.railcar.fetch_query,railcar:this.props.railcar.railcar,rec_blog_id:this.props.railcar.rec_blog_id,rec_post_id:this.props.railcar.rec_post_id,session_id:this.props.railcar.session_id,ui_algo:"jetpack-instant-search-ui/v1",ui_position:this.props.index}}onClick=()=>{this.props.railcar&&(0,l.Lo)({...this.getCommonTrainTracksProps(),action:"click"})};render(){return this.props.resultFormat===o.LI?i().createElement(h.Z,a()({onClick:this.onClick},this.props)):this.props.resultFormat===o.Pz?i().createElement(c.Z,a()({onClick:this.onClick},this.props)):i().createElement(p.Z,a()({onClick:this.onClick},this.props))}}const d=u},2975:(e,t,s)=>{s.d(t,{Z:()=>w});var r=s(5736),a=s(5235),n=s.n(a),i=s(211),o=s.n(i),l=s(5825),c=s(9755),p=s(9730),h=s(1547),u=s(1180),d=s(8852),m=s(4741),g=s(423),_=s(7704),y=s(9988),f=s(8192),v=s(4524),E=s(604);const __=r.__,_n=r._n;class k extends i.Component{state={shouldShowMobileSecondary:!1};toggleMobileSecondary=e=>{"click"!==e.type&&("keydown"!==e.type||"Enter"!==e.key&&" "!==e.key)||(" "===e.key&&e.preventDefault(),this.setState((e=>({shouldShowMobileSecondary:!e.shouldShowMobileSecondary}))))};hasFilterOptions(){let e=[...this.props.widgets];return this.props.widgetOutsideOverlay?.filters?.length>0&&(e=[this.props.widgetOutsideOverlay,...e]),e.length>0}getSearchTitle(){const{total:e=0,corrected_query:t=!1}=this.props.response,s=""!==this.props.searchQuery,a=!1!==t,n=(new Intl.NumberFormat).format(e),i=this.props.staticFilters&&this.props.staticFilters.group_id&&this.props.staticFilters.group_id!==c.Bk;if(this.props.isLoading)return s?__("Searching","jetpack-search-pkg",0):__("Loading popular results","jetpack-search-pkg");if(0===e||this.props.hasError)return __("No results found","jetpack-search-pkg");if(s&&a)return(0,r.sprintf)(/* translators: %1$s: number of results. %2$s: the corrected search query. */
_n('Found %1$s result for "%2$s"','Found %1$s results for "%2$s"',e,"jetpack-search-pkg"),n,t);if(i){const t=(0,h.bA)().find((e=>"group_id"===e.filter_id)),s=t?.filter_id,a=this.props.staticFilters[s],i=t?.selected,o=t?.values?.[0],l=a||i||o?.value,c=t?.values?.find?.((e=>e.value===l));return c?.name?(0,r.sprintf)(/* translators: %1$s: number of results. - %2$s: site name. */
_n("Found %1$s result in %2$s","Found %1$s results in %2$s",e,"jetpack-search-pkg"),n,c?.name):(0,r.sprintf)(/* translators: %s: number of results. */
_n("Found %s result","Found %s results",e,"jetpack-search-pkg"),n)}return __("Showing popular results","jetpack-search-pkg")}renderPrimarySection(){const{highlightColor:e,searchQuery:t}=this.props,{results:s=[],total:a=0,corrected_query:n=!1}=this.props.response,h=(0,l.B)(e),u=!1!==n,d=a>0,_=this.props.additionalBlogIds?.length>0||this.props.staticFilters&&this.props.staticFilters.group_id&&this.props.staticFilters.group_id!==c.Bk;return o().createElement(i.Fragment,null,o().createElement("style",{dangerouslySetInnerHTML:{__html:`\n\t\t\t\t\t\t\t.jetpack-instant-search *::selection,\n\t\t\t\t\t\t\t.jetpack-instant-search .jetpack-instant-search__search-results .jetpack-instant-search__search-results-primary .jetpack-instant-search__search-result mark {\n\t\t\t\t\t\t\t\tcolor: ${h};\n\t\t\t\t\t\t\t\tbackground-color: ${e};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t`}}),o().createElement(E.Z,null),o().createElement("h2",{className:"jetpack-instant-search__search-results-title"},this.getSearchTitle()),d&&u&&o().createElement("p",{className:"jetpack-instant-search__search-results-unused-query"},/* translators: %s: Search query. */ /* translators: %s: Search query. */
(0,r.sprintf)(__('No results for "%s"',"jetpack-search-pkg"),t)),this.props.hasError&&o().createElement(m.Z,{type:"warning"},(0,p.e)(this.props.response.error)),d&&!this.props.hasError&&this.props.response._isOffline&&o().createElement(m.Z,{type:"warning"},(0,p.e)({message:"offline"})),d&&!this.props.hasError&&o().createElement("ol",{className:`jetpack-instant-search__search-results-list is-format-${this.props.resultFormat}`},s.map(((e,t)=>o().createElement(f.Z,{index:t,key:t,staticFilters:this.props.staticFilters,isPhotonEnabled:this.props.isPhotonEnabled,locale:this.props.locale,railcar:this.props.isVisible?e.railcar:null,result:e,resultFormat:this.props.resultFormat,searchQuery:this.props.searchQuery,isMultiSite:_,showPostDate:this.props.showPostDate})))),d&&this.props.hasNextPage&&o().createElement("div",{className:"jetpack-instant-search__search-results-pagination"},o().createElement(g.Z,{enableLoadOnScroll:this.props.enableLoadOnScroll,isLoading:this.props.isLoading,onLoadNextPage:this.props.onLoadNextPage})))}renderSecondarySection(){return o().createElement(v.Z,{filters:this.props.filters,staticFilters:this.props.staticFilters,isLoading:this.props.isLoading,locale:this.props.locale,postTypes:this.props.postTypes,response:this.props.response,widgets:this.props.widgets,widgetOutsideOverlay:this.props.widgetOutsideOverlay})}closeOverlay=e=>{e.preventDefault(),this.props.closeOverlay()};onKeyPressHandler=e=>{"Enter"===e.key&&(e.preventDefault(),this.props.closeOverlay())};render(){return o().createElement("div",{className:n()("jetpack-instant-search__search-results-wrapper",{"has-colophon":this.props.showPoweredBy})},o().createElement("div",{"aria-hidden":!0===this.props.isLoading,className:"jetpack-instant-search__search-results"},o().createElement("div",{className:"jetpack-instant-search__search-results-controls",role:"form"},o().createElement(y.Z,{"aria-controls":"jetpack-instant-search__search-results-content",className:"jetpack-instant-search__search-results-search-form",isVisible:this.props.isVisible,onChangeSearch:this.props.onChangeSearch,searchQuery:this.props.searchQuery}),o().createElement("button",{className:"jetpack-instant-search__overlay-close",onClick:this.closeOverlay,onKeyPress:this.onKeyPressHandler,tabIndex:"0","aria-label":__("Close search results","jetpack-search-pkg")},o().createElement(u.Z,{icon:"cross",size:"24","aria-hidden":"true",focusable:"false"}))),o().createElement(_.Z,{enableSort:this.props.enableSort,onChangeSort:this.props.onChangeSort,resultFormat:this.props.resultFormat,sort:this.props.sort},(this.hasFilterOptions()||this.props.hasNonSearchWidgets)&&o().createElement("div",{role:"button",onClick:this.toggleMobileSecondary,onKeyDown:this.toggleMobileSecondary,tabIndex:"0",className:"jetpack-instant-search__search-results-filter-button"},__("Filters","jetpack-search-pkg"),o().createElement(u.Z,{icon:"chevron-down",size:16,alt:__("Show search filters","jetpack-search-pkg"),"aria-hidden":"true"}),o().createElement("span",{className:"screen-reader-text assistive-text"},this.state.shouldShowMobileSecondary?__("Hide filters","jetpack-search-pkg"):__("Show filters","jetpack-search-pkg")))),o().createElement("div",{"aria-live":"polite",className:"jetpack-instant-search__search-results-content",id:"jetpack-instant-search__search-results-content"},o().createElement("div",{className:"jetpack-instant-search__search-results-primary"},this.renderPrimarySection()),o().createElement("div",{className:["jetpack-instant-search__search-results-secondary",(this.state.shouldShowMobileSecondary?"jetpack-instant-search__search-results-secondary--show-as-modal":"")+" "].join(" ")},this.renderSecondarySection())),o().createElement("button",{id:c.VB,onClick:this.closeOverlay},"Close Search")),this.props.showPoweredBy&&o().createElement(d.Z,{locale:this.props.locale}))}}const w=k},9873:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(5736),a=s(211),n=s.n(a),i=s(343);const __=r.__;class o extends a.Component{handleClick=e=>{this.props.value!==e.currentTarget.value&&(e.preventDefault(),this.props.onChange(e.currentTarget.dataset.value))};handleSelectChange=e=>{this.props.value!==e.currentTarget.value&&(e.preventDefault(),this.props.onChange(e.currentTarget.value))};render(){const e=(0,i.n)(this.props.resultFormat),t=e.size;let s=0;return e.size>3?n().createElement("div",{"aria-controls":"jetpack-instant-search__search-results-content",className:"jetpack-instant-search__search-sort jetpack-instant-search__search-sort-with-select"},n().createElement("label",{htmlFor:"jetpack-instant-search__search-sort-select"},__("Sort:","jetpack-search-pkg")),n().createElement("select",{className:"jetpack-instant-search__search-sort-select",id:"jetpack-instant-search__search-sort-select",onBlur:this.handleSelectChange,onChange:this.handleSelectChange},[...e.entries()].map((([e,t])=>n().createElement("option",{value:e,key:e,selected:this.props.value===e?"selected":""},t))))):n().createElement("div",{"aria-controls":"jetpack-instant-search__search-results-content",className:"jetpack-instant-search__search-sort jetpack-instant-search__search-sort-with-links"},n().createElement("div",{className:"screen-reader-text"},__("Sort by: ","jetpack-search-pkg")),[...e.entries()].map((([e,r])=>n().createElement(n().Fragment,null,n().createElement("button",{"aria-current":this.props.value===e?"true":"false",className:"jetpack-instant-search__search-sort-option "+(this.props.value===e?"is-selected":""),"data-value":e,key:e,onClick:this.handleClick},r),++s<t?n().createElement("span",{"aria-hidden":"true",className:"jetpack-instant-search__search-sort-separator"},""):""))))}}},4524:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(211),a=s.n(r),n=s(1631),i=s(5181);const o=e=>a().createElement("div",{className:"jetpack-instant-search__sidebar"},a().createElement(n.Z,{filters:e.filters,staticFilters:e.staticFilters,loading:e.isLoading,locale:e.locale,postTypes:e.postTypes,results:e.response,showClearFiltersButton:!0,widget:e.widgetOutsideOverlay}),a().createElement(i.Z,null),e.widgets.map((t=>(0,r.createPortal)(a().createElement("div",{id:`${t.widget_id}-portaled-wrapper`,className:"jetpack-instant-search__portaled-wrapper"},a().createElement(n.Z,{filters:e.filters,staticFilters:e.staticFilters,loading:e.isLoading,locale:e.locale,postTypes:e.postTypes,results:e.response,showClearFiltersButton:!1,showTitle:!1,widget:t})),document.getElementById(`${t.widget_id}-wrapper`)))))},604:(e,t,s)=>{s.d(t,{Z:()=>p});var r=s(211),a=s.n(r),n=s(9309),i=s(1547),o=s(8389),l=s(2547);class c extends r.Component{onChangeStaticFilter=(e,t)=>{this.props.setStaticFilter(e,t),this.props.onChange&&this.props.onChange()};renderStaticFilterComponent=e=>e.hasOwnProperty("visible")&&!e.visible?null:a().createElement(l.Z,{aggregation:[],configuration:e,locale:this.props.locale,onChange:this.onChangeStaticFilter,postTypes:this.props.postTypes,type:(0,i.jc)(e),value:this.props.staticFilters[(0,i.jZ)(e)],variation:"tabbed"});render(){const e=(0,i.bA)("tabbed");return e.length?a().createElement("div",{className:"jetpack-instant-search__search-tabbed-filters"},e.map(this.renderStaticFilterComponent)):null}}const p=(0,n.$j)((e=>({staticFilters:e.staticFilters})),{setStaticFilter:o.O1})(c)},5181:(e,t,s)=>{s.d(t,{Z:()=>n});var r=s(211),a=s.n(r);class n extends r.Component{container=(0,r.createRef)();componentDidMount(){const e=document.getElementsByClassName("jetpack-instant-search__widget-area")[0];e&&(e.style.removeProperty("display"),this.container.current.appendChild(e))}shouldComponentUpdate(){return!1}render(){return a().createElement("div",{className:"jetpack-instant-search__widget-area-container",ref:this.container})}}},564:(e,t,s)=>{function r(e,t,s){if(!e)return"";const r=decodeURIComponent(e);return(!t||"false"!==r)&&(!(!t||"true"!==r)||(s&&0*+r==0?+r:r))}function a(e,t,s){let a,n;const i={},o=e.split("&");for(t=void 0===t||t,s=void 0===s||s;a=o.shift();)a=a.split("="),n=a.shift(),void 0!==i[n]?i[n]=[].concat(i[n],r(a.shift(),t,s)):i[n]=r(a.shift(),t,s);return i}s.d(t,{J:()=>a})},1559:(e,t,s)=>{s.r(t),s.d(t,{initialize:()=>d});s(554);var r=s(2687),a=s(762),n=s(9309),i=s(5652),o=s(5476),l=s(9755),c=s(4184),p=s(2160),h=s(9379);const u=()=>{(0,r.render)(a.ZP.createElement(n.zt,{store:h.Z},a.ZP.createElement(i.Z,{aggregations:(0,o.a5)([...window[l.W1].widgets,...window[l.W1].widgetsOutsideOverlay]),enableAnalytics:!0,hasOverlayWidgets:!!window[l.W1].hasOverlayWidgets,initialHref:window.location.href,initialIsVisible:window[l.W1].showResults,isInCustomizer:(0,c.bS)(),overlayOptions:window[l.W1].overlayOptions,options:window[l.W1],shouldCreatePortal:!0,shouldIntegrateWithDom:!0,themeOptions:(0,p.C)(window[l.W1])})),document.body)};function d(){window[l.W1]&&"siteId"in window[l.W1]&&u()}},4797:(e,t,s)=>{function r(){return!window.matchMedia("(prefers-reduced-motion: no-preference)").matches}s.d(t,{O:()=>r})},5476:(e,t,s)=>{s.d(t,{Wb:()=>g,a5:()=>m,yC:()=>S});s(2753);var r=s(7390),a=s.n(r),n=s(5731),i=s(8750),o=s(9353),l=s(9755),c=s(1547);let p;const h=e=>Array.isArray(e)&&e.length>0,u=(0,o.Z)(30,5*l.AG),d=(0,o.Z)(30,30*l.AG);function m(e=[]){const t={};return e.forEach((({filters:e})=>e.forEach((e=>{t[e.filter_id]=function(e){switch(e.type){case"date_histogram":return{date_histogram:{field:"post_date_gmt"===e.field?"date_gmt":"date",interval:e.interval}};case"taxonomy":{let t=`taxonomy.${e.taxonomy}.slug_slash_name`;return"post_tag"===e.taxonomy?t="tag.slug_slash_name":"category"===e.taxonomy&&(t="category.slug_slash_name"),{terms:{field:t,size:e.count}}}case"post_type":case"blog_id":return{terms:{field:e.type,size:e.count}};case"author":return{terms:{field:"author_login_slash_name",size:e.count}}}}(e)})))),t}function g(e){return e=e??{},Object.fromEntries(Object.entries(e).filter((([,e])=>e?.buckets?.length>0)).map((([e,t])=>{const s=t.buckets.map((e=>({...e,doc_count:0})));return[e,{...t,buckets:s}]})))}b();const _=/(\d{4})-(\d{2})-(\d{2})/;function y(e,t,s){let r,a;"year"===s&&([,r,,]=t.match(_)),"month"===s&&([,r,a]=t.match(_));let n="",i="";if(a){const e=+a+1;n=`${r}-${a}-01`,i=e<=12?`${r}-${e<10?`0${e}`:`${e}`}-01`:+r+1+"-01-01"}else r&&(n=`${r}-01-01`,i=+r+1+"-01-01");return{range:{[e]:{gte:n,lt:i}}}}const f=new Map([["post_types",e=>({term:{post_type:e}})],["authors",e=>({term:{author_login:e}})],["blog_ids",e=>({term:{blog_id:e}})],["category",e=>({term:{"category.slug":e}})],["post_tag",e=>({term:{"tag.slug":e}})],["month_post_date",e=>y("date",e,"month")],["month_post_date_gmt",e=>y("date_gmt",e,"month")],["month_post_modified",e=>y("date",e,"month")],["month_post_modified_gmt",e=>y("date_gmt",e,"month")],["year_post_date",e=>y("date",e,"year")],["year_post_date_gmt",e=>y("date_gmt",e,"year")],["year_post_modified",e=>y("date",e,"year")],["year_post_modified_gmt",e=>y("date_gmt",e,"year")]]);function v(e){const t={};return Object.keys(e).forEach((s=>{const r=e[s];"group_id"===s&&r!==l.Bk&&(t[s]=r)})),t}function E(e,t,s){const r={bool:{must:[]}};return(0,c.wP)().filter((t=>h(e[t]))).forEach((t=>{e[t].forEach((e=>{f.has(t)?r.bool.must.push(f.get(t)(e)):r.bool.must.push({term:{[`taxonomy.${t}.slug`]:e}})}))})),t&&r.bool.must.push(t),s?.length>0&&r.bool.must.push({bool:{must_not:s.map((e=>f.get("post_types")(e)))}}),r}const k=new Map([["oldest","date_asc"],["newest","date_desc"],["relevance","score_default"]]);function w(e){return["price_asc","price_desc","rating_desc"].includes(e)?e:k.get(e,"score_default")}function b(){p&&p.abort(),p=new AbortController}function S(e,t){const s=a()(Array.from(arguments));if(!navigator.onLine&&d.get(s))return Promise.resolve(d.get(s)).then((e=>({_isCached:!0,_isError:!1,_isOffline:!0,...e})));if(u.get(s))return Promise.resolve(u.get(s)).then((e=>({_isCached:!0,_isError:!1,_isOffline:!1,...e})));const r=function({aggregations:e,excludedPostTypes:t,filter:s,staticFilters:r,pageHandle:a,query:o,resultFormat:c,sort:p,postsPerPage:h=10,adminQueryFilter:u,isInCustomizer:d=!1,additionalBlogIds:m=[]}){null===o&&(o="");let g=["date","permalink.url.raw","tag.name.default","category.name.default","post_type","shortcode_types","forum.topic_resolved"];(c!==l.TZ||d)&&(g=g.concat(["has.image","image.url.raw","image.alt_text"])),(c===l.LI||d)&&(g=g.concat(["meta._wc_average_rating.double","meta._wc_review_count.long","wc.formatted_price","wc.formatted_regular_price","wc.formatted_sale_price","wc.price","wc.sale_price"])),r&&r.group_id&&r.group_id!==l.Bk&&(g=g.concat(["author","blog_name","blog_icon_url"]));let _={aggregations:e,fields:g,highlight_fields:["title","content","comments"],filter:E(s,u,t),query:encodeURIComponent(o),sort:w(p),page_handle:a,size:h};return m?.length>0&&(_.fields=g.concat(["author","blog_name","blog_icon_url","blog_id"]),_.additional_blog_ids=m),r&&Object.keys(r).length>0&&(_={..._,...v(r)}),(0,i.c)((0,n.x)(_))}(e),o=(c=s,function(e){const t=u.get(c)||d.get(c);if("AbortError"===e.name)return t?{_isCached:!0,_isError:!1,_isOffline:!1,...t}:null;if(t)return{_isCached:!0,_isError:!0,_isOffline:!1,...t};throw e});var c;const h=function(e,t){return function(s){const r={...s,requestId:t};return u.set(e,r),d.set(e,r),r}}(s,t),m=`/sites/${e.siteId}/search?${r}`,{apiNonce:g,apiRoot:_,homeUrl:y,isPrivateSite:f,isWpcom:k}=window[l.W1];let S=`https://public-api.wordpress.com/rest/v1.3${m}`;return f&&k?S=`${y}/wp-json/wpcom-origin/v1.3${m}`:f&&(S=`${_}jetpack/v4/search?${r}`),b(),fetch(S,{headers:f?{"X-WP-Nonce":g}:{},credentials:f?"include":"same-origin",signal:p.signal}).then((e=>200!==e.status?e.json().then((e=>{throw new Error(e.error)})):e)).then((e=>e.json())).then(h).catch(o)}},2601:(e,t,s)=>{function r(e,t){Array.isArray(e)||(e=[e]);return 0!==e.filter((e=>t.includes(e))).length}s.d(t,{Z:()=>r})},5825:(e,t,s)=>{function r(e){const t=function(e){let t;return"#"===e[0]&&(t=e.substring(1)),3===t.length&&(t=t.split("").map((e=>`${e}${e}`)).join("")),t}(e);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3>=128?"black":"white"}s.d(t,{B:()=>r})},2160:(e,t,s)=>{function r(e){return[...e.querySelectorAll('input[type="checkbox"]').values()].filter((e=>e.checked)).map((e=>e.name))}function a(e){const t={searchInputSelector:['input[name="s"]:not(.jetpack-instant-search__box-input)',"#searchform input.search-field:not(.jetpack-instant-search__box-input)",".search-form input.search-field:not(.jetpack-instant-search__box-input)",".searchform input.search-field:not(.jetpack-instant-search__box-input)"].join(", "),filterInputSelector:["a.jetpack-search-filter__link"],overlayTriggerSelector:[".jetpack-instant-search__open-overlay-button","header#site-header .search-toggle[data-toggle-target]"].join(",")};return e.theme_options?{...t,...e.theme_options}:t}s.d(t,{C:()=>a,b:()=>r})},3499:(e,t,s)=>{s.d(t,{Z:()=>a});const r=()=>{},a=()=>r},9730:(e,t,s)=>{s.d(t,{e:()=>a});var r=s(5736);const __=r.__;function a(e){switch(e?.message){case"service_unavailable":return(0,r.sprintf)(
// translators: %s: Error code.
__("Jetpack Search is currently unavailable. Please try again later. [%s]","jetpack-search-pkg"),e?.message);case"offline":return __("It looks like you're offline. Please reconnect to load the latest results.","jetpack-search-pkg");default:return(0,r.sprintf)(
// translators: %s: Error code.
__("Jetpack Search has encountered an error. Please contact the site administrator if the issue persists. [%s]","jetpack-search-pkg"),e?.message??"unknown")}}},1547:(e,t,s)=>{s.d(t,{$s:()=>h,bA:()=>i,do:()=>l,i3:()=>o,jZ:()=>p,jc:()=>u,wP:()=>n});var r=s(9755);const a=Object.freeze(["blog_ids","authors","post_types","category","post_format","post_tag","month_post_date","month_post_date_gmt","month_post_modified","month_post_modified_gmt","year_post_date","year_post_date_gmt","year_post_modified","year_post_modified_gmt"]);function n(e=window[r.W1]?.widgets,t=window[r.W1]?.widgetsOutsideOverlay){const s=new Set(a);return[...e??[],...t??[]].map((e=>e.filters)).filter((e=>Array.isArray(e))).reduce(((e,t)=>e.concat(t)),[]).filter((e=>"taxonomy"===e.type)).forEach((e=>s.add(e.taxonomy))),[...s]}function i(e){return window[r.W1]?.staticFilters?window[r.W1].staticFilters.filter((t=>!e||("sidebar"===e&&!t.variation||(e&&t.variation?t.variation===e:void 0)))):[]}function o(){const e=i(),t=new Set;return e.forEach((e=>t.add(e.filter_id))),[...t]}function l(e=window[r.W1]?.widgets){const t=function(e=window[r.W1]?.widgets){return e?.map(c).reduce(((e,t)=>e.concat(t)),[])??[]}(e);return n().filter((e=>!t.includes(e)))}function c(e){return e.filters.map(p).filter((e=>"string"==typeof e))}function p(e){return"date_histogram"===e.type?`${e.interval}_${e.field}`:"taxonomy"===e.type?`${e.taxonomy}`:"post_type"===e.type?"post_types":"author"===e.type?"authors":"blog_id"===e.type?"blog_ids":"group"===e.type?e.filter_id:null}function h(e){return e.includes("month")?{field:e.split("month_").pop(),type:"date_histogram",interval:"month"}:e.includes("year")?{field:e.split("year_").pop(),type:"date_histogram",interval:"year"}:"post_types"===e?{type:"post_type"}:"authors"===e?{type:"author"}:"blog_ids"===e?{type:"blog_id"}:"group"===e?{type:"group"}:{type:"taxonomy",taxonomy:e}}function u(e){return"date_histogram"===e.type?"date":"taxonomy"===e.type?"taxonomy":"post_type"===e.type?"postType":"author"===e.type?"author":"blog_id"===e.type?"blogId":"group"===e.type?"group":void 0}},9087:(e,t,s)=>{s.d(t,{y:()=>n});var r=s(9424),a=s(211);function n(e,t,s,n=!0){const[i,o]=(0,a.useState)(null),l=(c=e)?c.split("?",1)[0]:"";var c;const p=l?.substring(l.lastIndexOf(".")+1).toLowerCase(),h=["gif","jpg","jpeg","png","webp","heic"].includes(p);return(0,a.useEffect)((()=>{if(n&&h){const a=(0,r.Z)(l,{resize:`${t},${s}`});o(a||e)}else o(e)}),[e,t,s,n,l,h]),i}},6302:(e,t,s)=>{s.d(t,{Q0:()=>p,_L:()=>l,pm:()=>o,ug:()=>c});var r=s(8750),a=s(564),n=s(9755),i=s(1547);function o(e=window.location.search){return(0,a.J)(e.substring(1),!1,!1)}function l(e){window.instantSearchSkipPushState||function(e){if(history.pushState){const t=new window.URL(window.location.href);window[n.W1]&&"homeUrl"in window[n.W1]&&(t.href=window[n.W1].homeUrl),t.search=e,window.history.pushState(null,null,t.toString())}}((0,r.c)(e))}function c(){const e=o();return n.bk.includes(e.result_format)?e.result_format:null}function p(e,t,s=!1){if(history.pushState&&history.replaceState){const a=new URL(e),n=o(a.search),l=[...(0,i.wP)(),...(0,i.i3)(),"s","sort"],c=Object.keys(n).some((e=>l.includes(e)));if(c&&l.forEach((e=>delete n[e])),a.search=(0,r.c)(n),s?window.history.replaceState(null,null,a.toString()):window.history.pushState(null,null,a.toString()),c)return void window.location.reload();t()}}},343:(e,t,s)=>{s.d(t,{n:()=>a});var r=s(9755);function a(e=null){return e!==r.LI?r.aP:new Map([...r.aP,...r.rs])}},8050:(e,t,s)=>{s.d(t,{AM:()=>l,GE:()=>u,IJ:()=>n,Lo:()=>h,Sn:()=>p,tU:()=>i,vy:()=>o});s(2753);let r=!0;const a={};function n(){r=!1}function i(e=!1){(e||r)&&(window._tkq=window._tkq||[])}function o(e=!1){(e||r)&&window._tkq.push(["clearIdentity"])}function l(e,t=!1){(t||r)&&(a.blog_id=e)}function c(e,t,s=!1){(s||r)&&window._tkq.push(["recordEvent",e,{...a,...t}])}function p(e,t=!1){c("jetpack_instant_search_traintracks_render",e,t)}function h(e,t=!1){c("jetpack_instant_search_traintracks_interact",e,t)}function u(e,t=!1){c("jetpack_instant_search_static_filter_select",e,t)}},8389:(e,t,s)=>{function r(e){return{type:"MAKE_SEARCH_REQUEST",options:e}}function a({options:e,response:t}){return{type:"RECORD_SUCCESSFUL_SEARCH_REQUEST",options:e,response:t}}function n(e){return{type:"RECORD_FAILED_SEARCH_REQUEST",error:e}}function i({isHistoryNavigation:e=!1}={}){return{type:"INITIALIZE_QUERY_VALUES",isHistoryNavigation:e}}function o(e,t=!0){return{type:"SET_SEARCH_QUERY",query:e,propagateToWindow:t}}function l(e,t=!0){return{type:"SET_SORT",sort:e,propagateToWindow:t}}function c(e,t,s=!0){return{type:"SET_FILTER",name:e,value:t,propagateToWindow:s}}function p(e,t,s=!0){return{type:"SET_STATIC_FILTER",name:e,value:t,propagateToWindow:s}}function h(e=!0){return{type:"CLEAR_FILTERS",propagateToWindow:e}}function u(){return{type:"CLEAR_QUERY_VALUES"}}function d(){return{type:"DISABLE_QUERY_STRING_INTEGRATION"}}s.d(t,{C0:()=>a,HD:()=>l,K5:()=>h,Ln:()=>i,Mz:()=>u,O1:()=>p,OZ:()=>d,Tv:()=>c,Y6:()=>n,ql:()=>o,x1:()=>r})},4587:(e,t,s)=>{s.d(t,{Z:()=>d});var r=s(3259),a=s.n(r),n=s(5476),i=s(9755),o=s(1547),l=s(6302),c=s(8389);let p=0,h=!0;const u=a()(l._L,i.yb);const d={CLEAR_FILTERS:function(e){if(!1===e.propagateToWindow||!h)return;const t=(0,l.pm)();(0,o.wP)().forEach((e=>delete t[e])),(0,o.i3)().forEach((e=>delete t[e])),(0,l._L)(t)},DISABLE_QUERY_STRING_INTEGRATION:function(){h=!1},INITIALIZE_QUERY_VALUES:function(e,t){const s=(0,l.pm)();let r;"s"in s?t.dispatch((0,c.ql)(s.s,!1)):t.dispatch((0,c.ql)(null,!1)),i.kQ.includes(s.sort)?r=s.sort:"date"===s.orderby?r="string"==typeof s.order&&s.order.toUpperCase()===i.oy?"oldest":"newest":"relevance"===s.orderby&&(r="relevance"),"string"==typeof r&&t.dispatch((0,c.HD)(r,!1)),t.dispatch((0,c.K5)(!1)),(0,o.wP)().filter((e=>e in s)).forEach((e=>t.dispatch((0,c.Tv)(e,s[e],!1)))),(0,o.i3)().filter((e=>e in s)).forEach((e=>t.dispatch((0,c.O1)(e,s[e],!1))))},MAKE_SEARCH_REQUEST:function(e,t){p++,(0,n.yC)(e.options,p).then((s=>{null!==s&&t.dispatch((0,c.C0)({options:e.options,response:s}))})).catch((e=>{console.error("Jetpack Search ",e),t.dispatch((0,c.Y6)(e))}))},SET_FILTER:function(e){if(!1===e.propagateToWindow||!h)return;if(!(0,o.wP)().includes(e.name))return;const t=(0,l.pm)();t[e.name]=e.value,(0,l._L)(t)},SET_STATIC_FILTER:function(e){if(!1===e.propagateToWindow)return;if(!(0,o.i3)().includes(e.name))return;const t=(0,l.pm)();t[e.name]=e.value,(0,l._L)(t)},SET_SEARCH_QUERY:function(e){if(!1===e.propagateToWindow||!h)return;const t=(0,l.pm)();null!==e.query?t.s=e.query:delete t.s,u(t)},SET_SORT:function(e){if(!1===e.propagateToWindow||!h)return;if(!i.kQ.includes(e.sort))return;const t=(0,l.pm)();t.sort=e.sort,delete t.order,delete t.orderby,(0,l._L)(t)}}},9379:(e,t,s)=>{s.d(t,{Z:()=>c});var r=s(835),a=s(4274),n=s.n(a),i=s(4587),o=s(4408);const l=[n()(i.Z)],c=(0,r.MT)(o.ZP,{},(0,r.md)(...l))},9267:(e,t,s)=>{s.d(t,{hg:()=>i,p:()=>o,xT:()=>n});var r=s(5476);let a={};function n(e=!1,t){switch(t.type){case"MAKE_SEARCH_REQUEST":case"RECORD_SUCCESSFUL_SEARCH_REQUEST":return!1;case"RECORD_FAILED_SEARCH_REQUEST":return!0}return e}function i(e=!1,t){switch(t.type){case"MAKE_SEARCH_REQUEST":return!0;case"RECORD_SUCCESSFUL_SEARCH_REQUEST":case"RECORD_FAILED_SEARCH_REQUEST":return!1}return e}function o(e={},t){switch(t.type){case"RECORD_SUCCESSFUL_SEARCH_REQUEST":{if("requestId"in e&&"requestId"in t.response&&e.requestId>t.response.requestId)return e;const s={...t.response};return t.options.pageHandle&&(s.aggregations={..."aggregations"in e&&!Array.isArray(e)?e.aggregations:{},...Array.isArray(s.aggregations)?{}:s.aggregations},s.results=[..."results"in e?e.results:[],...s.results],a={}),Array.isArray(s.results)&&s.results.length>s.total&&(s.total=s.results.length),t.options.pageHandle||(s.results?.length>0?a=(0,r.Wb)(s.aggregations):s.aggregations=a),s}case"RECORD_FAILED_SEARCH_REQUEST":return e.error=t.error,e}return e}},9049:(e,t,s)=>{function r(e=!1,t){switch(t.type){case"INITIALIZE_QUERY_VALUES":return t.isHistoryNavigation;case"SET_SEARCH_QUERY":case"SET_SORT":case"CLEAR_FILTERS":case"SET_FILTER":return!t.propagateToWindow&&e}return e}s.d(t,{w:()=>r})},4408:(e,t,s)=>{s.d(t,{ZP:()=>l});var r=s(835),a=s(9267),n=s(9049),i=s(4754),o=s(5188);const l=(0,r.UY)({filters:i.u8,staticFilters:i.OY,hasError:a.xT,isLoading:a.hg,isHistoryNavigation:n.w,response:a.p,searchQuery:i.w4,serverOptions:o.M,sort:i.DY})},4754:(e,t,s)=>{s.d(t,{DY:()=>i,OY:()=>l,u8:()=>o,w4:()=>n});var r=s(9755),a=s(1547);function n(e=null,t){switch(t.type){case"SET_SEARCH_QUERY":return t.query;case"CLEAR_QUERY_VALUES":return null}return e}function i(e=null,t){switch(t.type){case"SET_SORT":return r.kQ.includes(t.sort)?t.sort:e;case"CLEAR_QUERY_VALUES":return null}return e}function o(e={},t){switch(t.type){case"CLEAR_FILTERS":case"CLEAR_QUERY_VALUES":return{};case"SET_FILTER":if(!(0,a.wP)().includes(t.name)||!Array.isArray(t.value)&&"string"!=typeof t.value)return e;if(0===t.value.length){const s={...e};return delete s[t.name],s}return{...e,[t.name]:"string"==typeof t.value?[t.value]:t.value}}return e}function l(e={},t){switch(t.type){case"CLEAR_QUERY_VALUES":return{};case"SET_STATIC_FILTER":return(0,a.i3)().includes(t.name)?{...e,[t.name]:t.value}:e}return e}},5188:(e,t,s)=>{s.d(t,{M:()=>a});var r=s(9755);function a(e=window[r.W1]??{}){return e}},1530:(e,t,s)=>{s.d(t,{Bk:()=>u,Qy:()=>o,ZN:()=>m,Zj:()=>h,ck:()=>n,en:()=>d,hg:()=>l,r$:()=>p,uP:()=>c,wI:()=>g,xT:()=>i});var r=s(9755),a=s(1547);function n(e){return e.response}function i(e){return e.hasError}function o(e){return!i(e)&&n(e)?.page_handle}function l(e){return e.isLoading}function c(e){return e.searchQuery}function p(e,t){return"string"!=typeof t&&(t=r.PP),"string"==typeof e.sort?e.sort:t}function h(e){return e.filters}function u(e){return e.staticFilters}function d(e){return null!==c(e)||function(e){return Object.keys(e.filters).length>0}(e)&&e.serverOptions.overlayOptions.enableFilteringOpensOverlay||function(e){return Object.keys(e.staticFilters).length>0}(e)}function m(e){if(!e.serverOptions.widgets||!e.filters)return{};const t=(0,a.do)(e.serverOptions.widgets);return{filters:Object.keys(e.filters).filter((e=>t.includes(e))).map(a.$s)}}function g(e){return e.isHistoryNavigation}}}]);jp-search.chunk-main-payload.rtl.css                                                                                                                                                                                                                           36789         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/build/instant-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   .jetpack-instant-search__overlay{background:rgba(29,35,39,.7);bottom:0;box-sizing:border-box;color:#00101c;font-size:16px;left:0;opacity:1;overflow-x:hidden;overflow-y:auto;position:fixed;right:0;top:0;z-index:9999999999999}body.jps-theme-argent .jetpack-instant-search__overlay *{font-family:Helvetica,sans-serif}@media(max-width:767.98px){.jetpack-instant-search__overlay{padding:3em 1em}}@media(max-width:575.98px){.jetpack-instant-search__overlay{padding:0}}@media(min-width:768px){.jetpack-instant-search__overlay{padding:3em}}.jetpack-instant-search__overlay h1,.jetpack-instant-search__overlay h2,.jetpack-instant-search__overlay h3,.jetpack-instant-search__overlay h4,.jetpack-instant-search__overlay h5,.jetpack-instant-search__overlay h6{letter-spacing:inherit}.jetpack-instant-search__overlay.is-hidden{background:transparent;opacity:0;visibility:hidden}.jetpack-instant-search__overlay *,.jetpack-instant-search__overlay :after,.jetpack-instant-search__overlay :before{box-sizing:inherit}@media print{.jetpack-instant-search__overlay.is-hidden{display:none}}@media(prefers-reduced-motion:no-preference){.jetpack-instant-search__overlay{transition:opacity .1s ease-in}}.gridicon{fill:currentColor;display:inline-block}.gridicon.needs-offset g{transform:translate(-1px,1px)}.gridicon.needs-offset-x g{transform:translate(-1px)}.gridicon.needs-offset-y g{transform:translateY(1px)}.jetpack-instant-search__jetpack-colophon{margin-bottom:2em;margin-top:2em;text-align:center}.jetpack-instant-search__jetpack-colophon-link{align-items:center;color:inherit;display:flex;text-decoration:none}.jetpack-instant-search__jetpack-colophon-logo{display:inline;height:16px;width:16px}.jetpack-instant-search__jetpack-colophon-text{color:#2c3338;font-size:.7em;font-weight:500;line-height:16px;padding-right:12px}.jetpack-instant-search__notice{display:flex;font-size:14px;margin:1em 0;padding:.75em}.jetpack-instant-search__notice.jetpack-instant-search__notice--warning{background-color:#f5e6b3;color:#4f3500}.jetpack-instant-search__notice .gridicon{flex-shrink:0;margin-left:.5em;margin-top:1px;vertical-align:middle}.jetpack-instant-search__scroll-button{border:0;box-shadow:none;outline:0;padding:0 6px}.jetpack-instant-search__scroll-button:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}.jetpack-instant-search__search-results .jetpack-instant-search__search-results-pagination button.jetpack-instant-search__scroll-button{background-color:inherit;color:#646970;font-size:inherit;font-weight:inherit}.jetpack-instant-search__search-sort{align-items:center;display:flex}.jetpack-instant-search__search-sort>label[for=jetpack-instant-search__search-sort-select]{flex-shrink:0;font-size:1em;font-weight:700;margin:0 0 0 .25em}.jetpack-instant-search__search-sort-with-links{font-size:13px}.jetpack-instant-search__search-sort-with-links .jetpack-instant-search__search-sort-separator{color:#646970;font-weight:300}@media(max-width:575.98px){.jetpack-instant-search__search-sort-with-select{margin-left:1em;width:100%}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-sort-with-select{margin-left:0}}@media(min-width:992px){.jetpack-instant-search__search-sort-with-select{margin-top:-4px}}.jetpack-instant-search__search-sort-select{-webkit-appearance:auto;appearance:auto;background:#fff;border:1px solid #e6f1f5;border-radius:5px;color:#00101c;font-size:1em;height:inherit;padding:.25em}@media(max-width:575.98px){.jetpack-instant-search__search-sort-select{padding:.5em;width:100%}}.jetpack-instant-search__search-sort-option{border:none;border-radius:0;cursor:pointer;margin:0;padding:0 2px;text-decoration:none;text-shadow:none;text-transform:none}.jetpack-instant-search__search-sort-option,.jetpack-instant-search__search-sort-option:focus,.jetpack-instant-search__search-sort-option:hover{-webkit-appearance:none;appearance:none;background:none;box-shadow:none;outline:none}.jetpack-instant-search__search-sort-option:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}.jetpack-instant-search__search-form-controls .jetpack-instant-search__search-sort button.jetpack-instant-search__search-sort-option{background-color:inherit;color:#646970;font-size:inherit;font-weight:inherit}.jetpack-instant-search__search-form-controls .jetpack-instant-search__search-sort button.jetpack-instant-search__search-sort-option.is-selected{color:#044b7a;font-weight:600;text-decoration:none}.jetpack-instant-search__search-form-controls{align-items:center;display:flex;line-height:1.3;margin-left:56px;margin-right:56px;margin-top:16px;z-index:1}@media(max-width:991.98px){.jetpack-instant-search__search-form-controls{flex-direction:row-reverse;justify-content:space-between;left:0;margin-left:40px;margin-right:40px;position:relative;right:0}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-form-controls{flex-direction:row-reverse;justify-content:space-between;left:0;margin-left:40px;margin-right:40px;position:relative;right:0}}@media(max-width:767.98px){.jetpack-instant-search__search-form-controls{margin-left:20px;margin-right:20px}}@media(min-width:992px){.jetpack-instant-search__search-form-controls{left:320px;position:absolute}}@media(min-width:1200px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-form-controls{left:320px;position:absolute}}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-form-controls{left:0}.jetpack-instant-search__box{border-bottom:1px solid #e6f1f5;border-left:1px solid #e6f1f5}.jetpack-instant-search__box-label{align-items:center;display:flex;flex:0 0 100%;margin:0}input.jetpack-instant-search__box-input.search-field{-webkit-appearance:none;appearance:none;background:#fff;border:0;box-shadow:none;color:#3c434a;font-size:18px;height:60px;line-height:1;margin:0;max-width:none;padding:0 14px;text-indent:32px;vertical-align:middle}input.jetpack-instant-search__box-input.search-field:focus,input.jetpack-instant-search__box-input.search-field:hover{background:#fff;color:#00101c}input.jetpack-instant-search__box-input.search-field.search-field{letter-spacing:-.02em;padding-right:0;text-indent:0}.jetpack-instant-search__box-gridicon{align-items:center;display:flex;flex-shrink:0;height:60px;justify-content:center;position:relative;right:0;top:0;width:60px;z-index:1}.jetpack-instant-search__box-gridicon svg{fill:#646970}.jetpack-instant-search__box input[type=button]{border:none;border-radius:0;color:#646970;cursor:pointer;font-size:1em;font-weight:400;height:60px;line-height:1;margin:0 0 0 .25em;padding:0;text-decoration:none;text-shadow:none;text-transform:none;width:60px;word-wrap:normal}.jetpack-instant-search__box input[type=button],.jetpack-instant-search__box input[type=button]:focus,.jetpack-instant-search__box input[type=button]:hover{-webkit-appearance:none;appearance:none;background:none;box-shadow:none;outline:none}.jetpack-instant-search__box input[type=button]:focus,.jetpack-instant-search__box input[type=button]:hover{color:#3c434a}.jetpack-instant-search__box input[type=button]:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input{border:none;box-shadow:none;height:52px;outline-style:none;padding:0 10px;width:100%}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input:focus,.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input:hover{border:none;box-shadow:none}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input:focus{border-radius:5px;margin-left:5px;margin-right:-50px;outline:thin dotted #3c434a;outline-offset:inherit;padding-right:60px}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-webkit-search-results-button,.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-webkit-search-results-decoration{appearance:none;-webkit-appearance:none;display:initial}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-webkit-search-cancel-button{display:none}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-ms-clear,.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input::-ms-reveal{display:none}@media(prefers-reduced-motion:no-preference){.jetpack-instant-search__box input[type=button]{transition:all .1s linear}.jetpack-instant-search__box input[type=search].jetpack-instant-search__box-input{transition:color .15s ease-in-out,border-color .25s ease-in-out}}.jetpack-instant-search__path-breadcrumb{font-size:.9em;margin:0;max-width:calc(100vw - 2em);overflow-x:hidden;text-overflow:ellipsis}.jetpack-instant-search__path-breadcrumb-link{max-width:100%;overflow:hidden;text-decoration:none;text-overflow:ellipsis;white-space:nowrap}.jetpack-instant-search__path-breadcrumb-link:focus,.jetpack-instant-search__path-breadcrumb-link:hover{text-decoration:underline}.jetpack-instant-search__path-breadcrumb,.jetpack-instant-search__path-breadcrumb-link{color:#3c434a}.jetpack-instant-search__search-result-comments{border-right:2px solid #f0f0f1;font-size:.9em;margin-right:8px;margin-top:16px;padding-right:16px;word-break:break-word}.jetpack-instant-search__search-result-comments .gridicon{margin-left:8px;vertical-align:middle}.jetpack-instant-search__search-result-expanded{display:flex;flex-flow:column}.jetpack-instant-search__search-result-expanded:last-child{margin-left:0}.jetpack-instant-search__search-result-expanded .jetpack-instant-search__search-result-expanded__title{width:100%}.jetpack-instant-search__search-result-expanded__path{color:#646970;font-size:.9375em;margin:0 0 .4em}.jetpack-instant-search__search-result-expanded__copy-container{max-width:100%}@media(min-width:576px){.jetpack-instant-search__search-result-expanded__copy-container{width:calc(100% - 128px - 1em)}}.jetpack-instant-search__search-result-expanded--no-image .jetpack-instant-search__search-result-expanded__copy-container{width:auto}.jetpack-instant-search__search-result-expanded__content{color:#00101c;font-size:.9375em}.jetpack-instant-search__search-result-expanded__image-link{margin-right:1em}@media(max-width:575.98px){.jetpack-instant-search__search-result-expanded__image-link{margin:0 auto .5em}}.jetpack-instant-search__search-result-expanded__image-container{width:128px}@media(max-width:575.98px){.jetpack-instant-search__search-result-expanded__image-container{width:256px}}.jetpack-instant-search__search-result-expanded--no-image .jetpack-instant-search__search-result-expanded__image-container{display:none}.jetpack-instant-search__search-result-expanded__image-container{position:relative}.jetpack-instant-search__search-result-expanded__image-container:before{content:"";display:block;padding-top:100%;width:100%}.jetpack-instant-search__search-result-expanded__image{border-radius:5px;bottom:0;height:100%;left:0;object-fit:cover;position:absolute;right:0;top:0;width:100%}.jetpack-instant-search__search-result-expanded__content-container{display:flex;flex-flow:column}@media(min-width:576px){.jetpack-instant-search__search-result-expanded__content-container{flex-flow:row nowrap}}.jetpack-instant-search__search-result-expanded__footer{display:flex;list-style-type:none;margin-right:0;margin-top:10px;padding-right:0}.jetpack-instant-search__search-result-expanded__footer li{margin-left:10px}.jetpack-instant-search__search-result-expanded__footer-blog-image{border-radius:2px;margin-left:3px;vertical-align:middle}.jetpack-instant-search__search-result-expanded__footer-blog{font-size:13px;font-style:normal;font-weight:600;line-height:180%}.jetpack-instant-search__search-result-expanded__footer-author:after,.jetpack-instant-search__search-result-expanded__footer-blog:after{color:#636363;content:"";margin-right:10px}li:last-child .jetpack-instant-search__search-result-expanded__footer-author:after,li:last-child .jetpack-instant-search__search-result-expanded__footer-blog:after{content:""}.jetpack-instant-search__search-result-expanded__footer-author,.jetpack-instant-search__search-result-expanded__footer-date{color:#636363;font-size:13px;font-style:normal;font-weight:400}.jetpack-instant-search__search-result-title.jetpack-instant-search__search-result-minimal-title{margin-bottom:.4em}.jetpack-instant-search__search-result-title.jetpack-instant-search__search-result-minimal-title .gridicon{margin-left:8px}.jetpack-instant-search__search-result-minimal-cats-and-tags{display:flex;flex-flow:row wrap;font-size:.9375em}.jetpack-instant-search__search-result-minimal-cats,.jetpack-instant-search__search-result-minimal-tags{display:flex;flex-flow:row wrap;list-style-type:none;margin:0;padding:0}.jetpack-instant-search__search-result-minimal-cat,.jetpack-instant-search__search-result-minimal-tag{margin:0 0 0 .75em}.jetpack-instant-search__search-result-minimal-cat .gridicon,.jetpack-instant-search__search-result-minimal-tag .gridicon{margin-left:.25em}.jetpack-instant-search__search-result-minimal-cat .gridicon,.jetpack-instant-search__search-result-minimal-cat-text,.jetpack-instant-search__search-result-minimal-tag .gridicon,.jetpack-instant-search__search-result-minimal-tag-text{vertical-align:middle}.jetpack-instant-search__search-result-minimal-content{word-break:break-word}.jetpack-instant-search__product-price-regular{color:#646970;padding-left:.25em}.jetpack-instant-search__product-rating-stars .gridicon{vertical-align:middle;fill:#f0c930}.jetpack-instant-search a.jetpack-instant-search__product-rating-count{color:#646970;font-size:.9em;text-decoration:underline;vertical-align:text-top}.jetpack-instant-search__search-results-list.is-format-product{display:flex;flex-wrap:wrap;margin-left:40px;padding:0 0 3em}@media(max-width:991.98px){.jetpack-instant-search__search-results-list.is-format-product{margin-left:24px}}@media(max-width:767.98px){.jetpack-instant-search__search-results-list.is-format-product{margin-left:4px}}.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{display:flex;flex-direction:column;margin:0 0 16px 16px;position:relative;width:calc(50% - 16px)}@media(min-width:576px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(33.33333% - 16px)}}@media(min-width:768px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(25% - 16px)}}@media(min-width:992px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(33.33333% - 16px)}}@media(min-width:1200px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(25% - 16px)}}@media(min-width:1400px){.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product{width:calc(20% - 16px)}}.jetpack-instant-search__search-result.jetpack-instant-search__search-result-product .jetpack-instant-search__search-result-title-link{display:initial}.jetpack-instant-search__search-result>.jetpack-instant-search__search-result-product-img-link{display:block}.jetpack-instant-search__search-result-product-img-container{border-radius:5px;color:transparent;position:relative}.jetpack-instant-search__search-result-product-img-container.jetpack-instant-search__search-result-product-img-container--placeholder{background:#c3c4c7}.jetpack-instant-search__search-result-product-img-container .gridicon{fill:#fff}.jetpack-instant-search__search-result-product-img-container:before{content:"";display:block;padding-top:100%;width:100%}.jetpack-instant-search__search-result-product-img{border-radius:5px;bottom:0;height:100%;left:0;object-fit:cover;position:absolute;right:0;top:0;width:100%}.jetpack-instant-search__search-result-product-img>.gridicon{position:absolute;right:50%;top:50%;transform:translate(50%,-50%)}.jetpack-instant-search__search-result-product-img>.gridicons-image{height:25%;width:25%}.jetpack-instant-search__search-result-product-img>.gridicons-block{height:50%;width:50%}.jetpack-instant-search__search-result-title.jetpack-instant-search__search-result-product-title{font-size:1.25em;margin:.25em 0 0}.jetpack-instant-search__search-result-product-match{font-size:.9em;margin-top:.25em}.jetpack-instant-search__search-result-product-match mark{align-items:center;display:flex;font-weight:400}.jetpack-instant-search__search-result-product-match .gridicon{height:1em;margin-left:.25em;width:1em}.jetpack-instant-search__search-result{margin:0 0 2em}.jetpack-instant-search__search-result-title{font-size:1.6em;font-weight:400;line-height:1.35;margin:0;overflow-wrap:break-word}.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-link{align-items:center;display:flex;text-decoration:none}.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-link:focus,.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-link:hover{text-decoration:underline}.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-checkmark{background-color:#b8e6bf;border-radius:50%;height:30px;margin-right:.35em;position:relative;width:30px}.jetpack-instant-search__search-result-title .jetpack-instant-search__search-result-title-checkmark:after{border-bottom:3px solid #00450c;border-left:3px solid #00450c;border-right-color:#00450c;border-top-color:#00450c;content:"";height:16px;position:absolute;right:11px;top:6px;transform:rotate(-40deg);width:8px}.jetpack-instant-search__search-filters{position:relative}.jetpack-instant-search__search-filters>div{margin-top:1em}.jetpack-instant-search__search-filters-title{color:#00101c;display:block;font-size:inherit;font-weight:700;line-height:1.3;margin:0;padding:0}.jetpack-instant-search__clear-filters-link{border:none;cursor:pointer;left:0;line-height:1.3;margin:0;padding:0 4px;position:absolute;top:0}.jetpack-instant-search__clear-filters-link:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}.jetpack-instant-search__sidebar .jetpack-instant-search__search-filters button.jetpack-instant-search__clear-filters-link{background-color:inherit;color:#646970;font-size:inherit;font-weight:inherit}.jetpack-instant-search__search-filter-sub-heading{color:#646970;font-size:inherit;margin:0;padding:0}.jetpack-instant-search__search-filter-list{text-align:right}.jetpack-instant-search__search-filter-list>div{align-items:baseline;display:flex;margin-top:8px}.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-input,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-input{-webkit-appearance:checkbox;appearance:checkbox;background:none;border:none;cursor:pointer;height:auto;margin:0;top:1px;width:auto}.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-input:after,.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-input:before,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-input:after,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-input:before{display:none!important}.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-input:focus,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-input:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit;outline-offset:2px}.jetpack-instant-search__search-filter-list .jetpack-instant-search__search-filter-list-label,.jetpack-instant-search__search-filter-list .widget_search .jetpack-instant-search__search-filter-list-label{color:inherit;cursor:pointer;display:inline-block;font-weight:400;margin:0 8px 0 0;padding:0;width:auto}.jetpack-instant-search__search-static-filter-list{font-size:.875rem;line-height:1.8}.jetpack-instant-search__widget-area-container{margin-bottom:2em}.jetpack-instant-search__sidebar{padding-top:14px}.jetpack-instant-search__sidebar .jetpack-instant-search__widget-area>.widget{background:none;border:none;margin:0;padding:0}.jetpack-instant-search__sidebar .jetpack-instant-search__widget-area>.widget a{font-weight:400}.jetpack-instant-search__sidebar h2.widgettitle{border:none;font-size:1.3em;margin:1em 0 .5em}.jetpack-instant-search__sidebar h2.widgettitle:after,.jetpack-instant-search__sidebar h2.widgettitle:before{display:none!important}.jetpack-instant-search__search-static-filter-variation-tabbed{border-bottom:1px solid #e6f1f5;display:flex}.jetpack-instant-search__search-static-filter-variation-tabbed>div{margin:0}.jetpack-instant-search__search-static-filter-variation-tabbed .jetpack-instant-search__search-filter-list-label{margin:0;padding:10px 20px}.jetpack-instant-search__search-static-filter-variation-tabbed .jetpack-instant-search__search-filter-list-input{display:none}.jetpack-instant-search__search-static-filter-variation-tabbed .jetpack-instant-search__search-filter-list-input:checked+.jetpack-instant-search__search-filter-list-label{border-bottom:3px solid #0675c4}.jetpack-instant-search__search-results-wrapper{border-radius:4px;height:100%;margin:0 auto;max-width:1080px;overflow:hidden;position:relative}@media(min-width:992px){.jetpack-instant-search__search-results-wrapper{max-width:95%}}.jetpack-instant-search__search-results-wrapper.has-colophon{padding-bottom:40px}.jetpack-instant-search__jetpack-colophon{background-color:#fff;border-top:1px solid #e6f1f5;bottom:0;display:flex;height:40px;justify-content:center;margin:0;position:absolute;width:100%}.jetpack-instant-search__search-results{background:#fff;height:100%;min-height:100%;overflow-y:auto;position:relative;z-index:10}@media(max-width:575.98px){.jetpack-instant-search__search-results{border-radius:0}}.jetpack-instant-search__search-results mark{background:#ffc;color:#00101c}.jetpack-instant-search__search-results #jetpack-instant-search__overlay-focus-anchor{background-color:inherit;border:none;bottom:0;color:inherit;font-size:.7em;font-weight:400;left:0;margin-bottom:4px;margin-left:4px;overflow:hidden;padding:4px 6px;position:absolute;width:1px;clip:rect(1px,1px,1px,1px)}.jetpack-instant-search__search-results #jetpack-instant-search__overlay-focus-anchor:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit;clip:auto!important;-webkit-clip-path:none;clip-path:none;width:auto}.jetpack-instant-search__search-results-controls{display:flex}.jetpack-instant-search__search-results-content{display:flex;position:relative}.jetpack-instant-search__search-results-filter-button{align-items:center;border:0;color:#646970;cursor:pointer;display:flex;flex-shrink:0;font-size:12px;margin:0;padding:8px;text-decoration:none}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-results-filter-button{visibility:hidden}@media(min-width:576px){.jetpack-instant-search__search-results-filter-button{font-size:13px;padding:10px 14px}}@media(min-width:992px){.jetpack-instant-search__search-results-filter-button{display:none}.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-filter-button{display:flex}}@media(min-width:1200px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-filter-button{display:none}}.jetpack-instant-search__search-results-filter-button:focus,.jetpack-instant-search__search-results-filter-button:hover{color:#00101c}.jetpack-instant-search__search-results-filter-button .gridicon{margin-right:4px}.jetpack-instant-search__search-results-primary{margin:0;max-width:calc(100% - 320px);width:100%}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-results-primary{max-width:100%}@media(max-width:991.98px){.jetpack-instant-search__search-results-primary{max-width:100%}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-primary{max-width:100%}}.jetpack-instant-search__search-results-secondary{background:none;border-radius:0;border-right:1px solid #e6f1f5;bottom:0;box-shadow:none;color:#00101c;display:block;flex:none;padding:0 32px;position:static;width:320px}.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-results-secondary{display:none}@media(max-width:991.98px){.jetpack-instant-search__search-results-secondary{display:none}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-secondary{display:none}}@media(max-width:991.98px){.jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{background:#fff;border:1px solid rgba(0,0,0,.1);border-radius:6px;box-shadow:0 2px 3px rgba(0,0,0,.1);display:block;left:1em;max-height:70vh;min-width:360px;overflow-y:scroll;padding:16px 24px;position:absolute;right:1em;top:0;width:auto;z-index:10}}@media(max-width:991.98px)and (max-width:575.98px){.jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{max-height:80vh}}@media(max-width:991.98px){.jetpack-instant-search__overlay--no-sidebar .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{display:none}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{background:#fff;border:1px solid rgba(0,0,0,.1);border-radius:6px;box-shadow:0 2px 3px rgba(0,0,0,.1);display:block;left:1em;max-height:70vh;min-width:360px;overflow-y:scroll;padding:16px 24px;position:absolute;right:1em;top:0;width:auto;z-index:10}}@media(max-width:1199.98px)and (max-width:575.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{max-height:80vh}}@media(max-width:1199.98px){.jetpack-instant-search__overlay--no-sidebar .jp-search-configure-app-wrapper .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{display:none}}.jetpack-instant-search__search-results-title,.jetpack-instant-search__search-results-unused-query{color:#00101c;font-size:1em;font-weight:700;line-height:1.3;margin:1em 56px 1.5em;padding:0;word-break:break-word}@media(max-width:991.98px){.jetpack-instant-search__search-results-title,.jetpack-instant-search__search-results-unused-query{margin-bottom:1em;margin-left:40px;margin-right:40px}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-title,.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-unused-query{margin-bottom:1em;margin-left:40px;margin-right:40px}}@media(max-width:767.98px){.jetpack-instant-search__search-results-title,.jetpack-instant-search__search-results-unused-query{margin-left:20px;margin-right:20px}}@media(min-width:992px){.jetpack-instant-search__search-results-title{padding-left:210px}}@media(min-width:1200px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-title{padding-left:210px}}.jetpack-instant-search__search-results-list{color:#00101c;list-style:none;margin-left:56px;margin-right:56px;padding:0}@media(max-width:991.98px){.jetpack-instant-search__search-results-list{margin-left:40px;margin-right:40px}}@media(max-width:1199.98px){.jp-search-configure-app-wrapper .jetpack-instant-search__search-results-list{margin-left:40px;margin-right:40px}}@media(max-width:767.98px){.jetpack-instant-search__search-results-list{margin-left:20px;margin-right:20px}}.jetpack-instant-search__search-results-list li:before{content:"";height:1px;position:absolute;width:1px}.jetpack-instant-search__search-results-search-form{font-size:.8em;margin:0;top:0;width:100%}button.jetpack-instant-search__overlay-close{align-items:center;-webkit-appearance:none;appearance:none;background:none;background-color:transparent!important;border:none;border-bottom:1px solid #e6f1f5;border-radius:0;box-shadow:none;cursor:pointer;display:flex;height:61px;justify-content:center;line-height:1;margin:0;outline:none;padding:0;text-decoration:none;text-shadow:none;text-transform:none;width:60px}button.jetpack-instant-search__overlay-close:focus,button.jetpack-instant-search__overlay-close:hover{-webkit-appearance:none;appearance:none;background:none;box-shadow:none;outline:none}button.jetpack-instant-search__overlay-close:focus{outline:1px auto Highlight;outline:1px auto -webkit-focus-ring-color!important;outline-offset:inherit}button.jetpack-instant-search__overlay-close svg.gridicon{fill:#646970}button.jetpack-instant-search__overlay-close:active,button.jetpack-instant-search__overlay-close:focus,button.jetpack-instant-search__overlay-close:hover{background-color:transparent!important;border-color:#e6f1f5}button.jetpack-instant-search__overlay-close:active svg.gridicon,button.jetpack-instant-search__overlay-close:focus svg.gridicon,button.jetpack-instant-search__overlay-close:hover svg.gridicon{fill:#3c434a}.jetpack-instant-search__search-results-pagination{display:block;flex:none;margin:50px}@media(prefers-reduced-motion:no-preference){.jetpack-instant-search__search-results-filter-button{transition:background-color .25s ease-in-out}}.jetpack-instant-search .widget a,.jetpack-instant-search .widget.widget_archive ul li a,.jetpack-instant-search a{border:none;color:#001621;text-decoration:none}.jetpack-instant-search .widget a:focus,.jetpack-instant-search .widget a:hover,.jetpack-instant-search .widget.widget_archive ul li a:focus,.jetpack-instant-search .widget.widget_archive ul li a:hover,.jetpack-instant-search a:focus,.jetpack-instant-search a:hover{color:#044b7a;text-decoration:underline}.jetpack-search-filters-widget__filter-list{list-style-type:none}body.enable-search-modal .cover-modal.show-modal.search-modal.active{display:none}.screen-reader-text{border:0;clip:rect(1px,1px,1px,1px);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;word-wrap:normal!important}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark{background:rgba(29,35,39,.7);color:#e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget a,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget.widget_archive ul li a,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark a{color:#f6f7f7}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget a:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget a:hover,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget.widget_archive ul li a:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .widget.widget_archive ul li a:hover,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark a:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark a:hover{color:#1689db}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-filters-title,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-result-expanded__content,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-list,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-title,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-unused-query{color:#e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__jetpack-colophon-text,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__path-breadcrumb,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__path-breadcrumb-link{color:#a7aaad}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-filter-sub-heading,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-result-expanded__path{color:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__jetpack-colophon{background-color:#000;border-color:#3c434a}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close{border-color:#3c434a}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box-gridicon svg,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close svg.gridicon{fill:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close{border-color:#3c434a}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close:focus svg.gridicon,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark button.jetpack-instant-search__overlay-close:hover svg.gridicon{fill:#a7aaad}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box input[type=button]{color:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box input[type=button]:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__box input[type=button]:hover{color:#a7aaad}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark input.jetpack-instant-search__box-input.search-field{background:#000;color:#a7aaad}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark input.jetpack-instant-search__box-input.search-field:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark input.jetpack-instant-search__box-input.search-field:hover{background:#000;color:#e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark input.jetpack-instant-search__box-input.search-field:focus{outline:thin dotted #e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results{background:#000}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results mark{color:#e6f1f5}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-filter-button{color:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-filter-button:focus,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-filter-button:hover,.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-secondary{color:#e6f1f5}@media(min-width:992px){.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-secondary{border-color:#3c434a}}@media(max-width:991.98px){.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-results-secondary.jetpack-instant-search__search-results-secondary--show-as-modal{background:#000;border-color:#3c434a;box-shadow:0 2px 3px #3c434a}}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-form-controls .jetpack-instant-search__search-sort button.jetpack-instant-search__search-sort-option{color:#8c8f94}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-form-controls .jetpack-instant-search__search-sort button.jetpack-instant-search__search-sort-option.is-selected{color:#1689db}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-result-product-img--placeholder{color:#2c3338}.jetpack-instant-search__overlay.jetpack-instant-search__overlay--dark .jetpack-instant-search__search-sort-select{background:#000;border-color:#3c434a;color:#e6f1f5}jp-search.defaultVendors.js                                                                                                                                                                                                                                    75393         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/build/instant-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /*! For license information please see jp-search.defaultVendors.js.LICENSE.txt */
(globalThis.webpackChunkjetpack_search=globalThis.webpackChunkjetpack_search||[]).push([[303],{5235:(t,e)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var i=typeof n;if("string"===i||"number"===i)t.push(n);else if(Array.isArray(n)){if(n.length){var u=o.apply(null,n);u&&t.push(u)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){t.push(n.toString());continue}for(var a in n)r.call(n,a)&&n[a]&&t.push(a)}}}return t.join(" ")}t.exports?(o.default=o,t.exports=o):void 0===(n=function(){return o}.apply(e,[]))||(t.exports=n)}()},6198:(t,e,n)=>{var r=n(5006),o=n(7232),i=TypeError;t.exports=function(t){if(r(t))return t;throw i(o(t)+" is not a function")}},3794:(t,e,n)=>{var r=n(2702),o=String,i=TypeError;t.exports=function(t){if(r(t))return t;throw i(o(t)+" is not an object")}},8845:(t,e,n)=>{var r=n(4929),o=n(645),i=n(5570),u=function(t){return function(e,n,u){var a,c=r(e),s=i(c),l=o(u,s);if(t&&n!=n){for(;s>l;)if((a=c[l++])!=a)return!0}else for(;s>l;l++)if((t||l in c)&&c[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:u(!0),indexOf:u(!1)}},237:(t,e,n)=>{var r=n(3715),o=r({}.toString),i=r("".slice);t.exports=function(t){return i(o(t),8,-1)}},1184:(t,e,n)=>{var r=n(4242),o=n(3496),i=n(4225),u=n(2016);t.exports=function(t,e,n){for(var a=o(e),c=u.f,s=i.f,l=0;l<a.length;l++){var f=a[l];r(t,f)||n&&r(n,f)||c(t,f,s(e,f))}}},5506:(t,e,n)=>{var r=n(7778),o=n(2016),i=n(9487);t.exports=r?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},9487:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},1568:(t,e,n)=>{var r=n(5006),o=n(2016),i=n(6717),u=n(7832);t.exports=function(t,e,n,a){a||(a={});var c=a.enumerable,s=void 0!==a.name?a.name:e;if(r(n)&&i(n,s,a),a.global)c?t[e]=n:u(e,n);else{try{a.unsafe?t[e]&&(c=!0):delete t[e]}catch(t){}c?t[e]=n:o.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},7832:(t,e,n)=>{var r=n(1210),o=Object.defineProperty;t.exports=function(t,e){try{o(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},7778:(t,e,n)=>{var r=n(4258);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4716:(t,e,n)=>{var r=n(1210),o=n(2702),i=r.document,u=o(i)&&o(i.createElement);t.exports=function(t){return u?i.createElement(t):{}}},3337:t=>{var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},1455:(t,e,n)=>{var r=n(2265);t.exports=r("navigator","userAgent")||""},6475:(t,e,n)=>{var r,o,i=n(1210),u=n(1455),a=i.process,c=i.Deno,s=a&&a.versions||c&&c.version,l=s&&s.v8;l&&(o=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&u&&(!(r=u.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=u.match(/Chrome\/(\d+)/))&&(o=+r[1]),t.exports=o},9864:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8657:(t,e,n)=>{var r=n(1210),o=n(4225).f,i=n(5506),u=n(1568),a=n(7832),c=n(1184),s=n(9656);t.exports=function(t,e){var n,l,f,p,_,d=t.target,v=t.global,h=t.stat;if(n=v?r:h?r[d]||a(d,{}):(r[d]||{}).prototype)for(l in e){if(p=e[l],f=t.dontCallGetSet?(_=o(n,l))&&_.value:n[l],!s(v?l:d+(h?".":"#")+l,t.forced)&&void 0!==f){if(typeof p==typeof f)continue;c(p,f)}(t.sham||f&&f.sham)&&i(p,"sham",!0),u(n,l,p,t)}}},4258:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},5200:(t,e,n)=>{var r=n(4258);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},4264:(t,e,n)=>{var r=n(5200),o=Function.prototype.call;t.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},232:(t,e,n)=>{var r=n(7778),o=n(4242),i=Function.prototype,u=r&&Object.getOwnPropertyDescriptor,a=o(i,"name"),c=a&&"something"===function(){}.name,s=a&&(!r||r&&u(i,"name").configurable);t.exports={EXISTS:a,PROPER:c,CONFIGURABLE:s}},3715:(t,e,n)=>{var r=n(5200),o=Function.prototype,i=o.bind,u=o.call,a=r&&i.bind(u,u);t.exports=r?function(t){return t&&a(t)}:function(t){return t&&function(){return u.apply(t,arguments)}}},2265:(t,e,n)=>{var r=n(1210),o=n(5006);t.exports=function(t,e){return arguments.length<2?(n=r[t],o(n)?n:void 0):r[t]&&r[t][e];var n}},9722:(t,e,n)=>{var r=n(6198);t.exports=function(t,e){var n=t[e];return null==n?void 0:r(n)}},1210:t=>{var e=function(t){return t&&t.Math==Math&&t};t.exports=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof window&&window)||function(){return this}()||Function("return this")()},4242:(t,e,n)=>{var r=n(3715),o=n(2103),i=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return i(o(t),e)}},3953:t=>{t.exports={}},4165:(t,e,n)=>{var r=n(7778),o=n(4258),i=n(4716);t.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},600:(t,e,n)=>{var r=n(3715),o=n(4258),i=n(237),u=Object,a=r("".split);t.exports=o((function(){return!u("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?a(t,""):u(t)}:u},3667:(t,e,n)=>{var r=n(3715),o=n(5006),i=n(4434),u=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return u(t)}),t.exports=i.inspectSource},2406:(t,e,n)=>{var r,o,i,u=n(4564),a=n(1210),c=n(3715),s=n(2702),l=n(5506),f=n(4242),p=n(4434),_=n(9116),d=n(3953),v="Object already initialized",h=a.TypeError,y=a.WeakMap;if(u||p.state){var m=p.state||(p.state=new y),b=c(m.get),g=c(m.has),x=c(m.set);r=function(t,e){if(g(m,t))throw new h(v);return e.facade=t,x(m,t,e),e},o=function(t){return b(m,t)||{}},i=function(t){return g(m,t)}}else{var w=_("state");d[w]=!0,r=function(t,e){if(f(t,w))throw new h(v);return e.facade=t,l(t,w,e),e},o=function(t){return f(t,w)?t[w]:{}},i=function(t){return f(t,w)}}t.exports={set:r,get:o,has:i,enforce:function(t){return i(t)?o(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!s(e)||(n=o(e)).type!==t)throw h("Incompatible receiver, "+t+" required");return n}}}},5006:t=>{t.exports=function(t){return"function"==typeof t}},9656:(t,e,n)=>{var r=n(4258),o=n(5006),i=/#|\.prototype\./,u=function(t,e){var n=c[a(t)];return n==l||n!=s&&(o(e)?r(e):!!e)},a=u.normalize=function(t){return String(t).replace(i,".").toLowerCase()},c=u.data={},s=u.NATIVE="N",l=u.POLYFILL="P";t.exports=u},2702:(t,e,n)=>{var r=n(5006);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},4832:t=>{t.exports=!1},664:(t,e,n)=>{var r=n(2265),o=n(5006),i=n(3387),u=n(8264),a=Object;t.exports=u?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return o(e)&&i(e.prototype,a(t))}},5570:(t,e,n)=>{var r=n(8464);t.exports=function(t){return r(t.length)}},6717:(t,e,n)=>{var r=n(4258),o=n(5006),i=n(4242),u=n(7778),a=n(232).CONFIGURABLE,c=n(3667),s=n(2406),l=s.enforce,f=s.get,p=Object.defineProperty,_=u&&!r((function(){return 8!==p((function(){}),"length",{value:8}).length})),d=String(String).split("String"),v=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!i(t,"name")||a&&t.name!==e)&&(u?p(t,"name",{value:e,configurable:!0}):t.name=e),_&&n&&i(n,"arity")&&t.length!==n.arity&&p(t,"length",{value:n.arity});try{n&&i(n,"constructor")&&n.constructor?u&&p(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=l(t);return i(r,"source")||(r.source=d.join("string"==typeof e?e:"")),t};Function.prototype.toString=v((function(){return o(this)&&f(this).source||c(this)}),"toString")},8981:t=>{var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},9868:(t,e,n)=>{var r=n(6475),o=n(4258);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},4564:(t,e,n)=>{var r=n(1210),o=n(5006),i=n(3667),u=r.WeakMap;t.exports=o(u)&&/native code/.test(i(u))},2016:(t,e,n)=>{var r=n(7778),o=n(4165),i=n(2879),u=n(3794),a=n(8901),c=TypeError,s=Object.defineProperty,l=Object.getOwnPropertyDescriptor,f="enumerable",p="configurable",_="writable";e.f=r?i?function(t,e,n){if(u(t),e=a(e),u(n),"function"==typeof t&&"prototype"===e&&"value"in n&&_ in n&&!n[_]){var r=l(t,e);r&&r[_]&&(t[e]=n.value,n={configurable:p in n?n[p]:r[p],enumerable:f in n?n[f]:r[f],writable:!1})}return s(t,e,n)}:s:function(t,e,n){if(u(t),e=a(e),u(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},4225:(t,e,n)=>{var r=n(7778),o=n(4264),i=n(9532),u=n(9487),a=n(4929),c=n(8901),s=n(4242),l=n(4165),f=Object.getOwnPropertyDescriptor;e.f=r?f:function(t,e){if(t=a(t),e=c(e),l)try{return f(t,e)}catch(t){}if(s(t,e))return u(!o(i.f,t,e),t[e])}},6112:(t,e,n)=>{var r=n(6166),o=n(9864).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},5603:(t,e)=>{e.f=Object.getOwnPropertySymbols},3387:(t,e,n)=>{var r=n(3715);t.exports=r({}.isPrototypeOf)},6166:(t,e,n)=>{var r=n(3715),o=n(4242),i=n(4929),u=n(8845).indexOf,a=n(3953),c=r([].push);t.exports=function(t,e){var n,r=i(t),s=0,l=[];for(n in r)!o(a,n)&&o(r,n)&&c(l,n);for(;e.length>s;)o(r,n=e[s++])&&(~u(l,n)||c(l,n));return l}},9532:(t,e)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);e.f=o?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},896:(t,e,n)=>{var r=n(4264),o=n(5006),i=n(2702),u=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&o(n=t.toString)&&!i(a=r(n,t)))return a;if(o(n=t.valueOf)&&!i(a=r(n,t)))return a;if("string"!==e&&o(n=t.toString)&&!i(a=r(n,t)))return a;throw u("Can't convert object to primitive value")}},3496:(t,e,n)=>{var r=n(2265),o=n(3715),i=n(6112),u=n(5603),a=n(3794),c=o([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(a(t)),n=u.f;return n?c(e,n(t)):e}},5262:t=>{var e=TypeError;t.exports=function(t){if(null==t)throw e("Can't call method on "+t);return t}},9116:(t,e,n)=>{var r=n(1843),o=n(3705),i=r("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},4434:(t,e,n)=>{var r=n(1210),o=n(7832),i="__core-js_shared__",u=r[i]||o(i,{});t.exports=u},1843:(t,e,n)=>{var r=n(4832),o=n(4434);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.23.5",mode:r?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.5/LICENSE",source:"https://github.com/zloirock/core-js"})},645:(t,e,n)=>{var r=n(8249),o=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):i(n,e)}},4929:(t,e,n)=>{var r=n(600),o=n(5262);t.exports=function(t){return r(o(t))}},8249:(t,e,n)=>{var r=n(8981);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},8464:(t,e,n)=>{var r=n(8249),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},2103:(t,e,n)=>{var r=n(5262),o=Object;t.exports=function(t){return o(r(t))}},357:(t,e,n)=>{var r=n(4264),o=n(2702),i=n(664),u=n(9722),a=n(896),c=n(8875),s=TypeError,l=c("toPrimitive");t.exports=function(t,e){if(!o(t)||i(t))return t;var n,c=u(t,l);if(c){if(void 0===e&&(e="default"),n=r(c,t,e),!o(n)||i(n))return n;throw s("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},8901:(t,e,n)=>{var r=n(357),o=n(664);t.exports=function(t){var e=r(t,"string");return o(e)?e:e+""}},7232:t=>{var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},3705:(t,e,n)=>{var r=n(3715),o=0,i=Math.random(),u=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+u(++o+i,36)}},8264:(t,e,n)=>{var r=n(9868);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},2879:(t,e,n)=>{var r=n(7778),o=n(4258);t.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8875:(t,e,n)=>{var r=n(1210),o=n(1843),i=n(4242),u=n(3705),a=n(9868),c=n(8264),s=o("wks"),l=r.Symbol,f=l&&l.for,p=c?l:l&&l.withoutSetter||u;t.exports=function(t){if(!i(s,t)||!a&&"string"!=typeof s[t]){var e="Symbol."+t;a&&i(l,t)?s[t]=l[t]:s[t]=c&&f?f(e):p(e)}return s[t]}},2753:(t,e,n)=>{"use strict";var r=n(8657),o=n(2103),i=n(5570),u=n(3337),a=n(4258)((function(){return 4294967297!==[].push.call({length:4294967296},1)})),c=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}();r({target:"Array",proto:!0,arity:1,forced:a||c},{push:function(t){var e=o(this),n=i(e),r=arguments.length;u(n+r);for(var a=0;a<r;a++)e[n]=arguments[a],n++;return e.length=n,n}})},4273:t=>{!function(){"use strict";var e=[],n=3988292384;function r(t){var e,r,o,i,u=-1;for(e=0,o=t.length;e<o;e+=1){for(i=255&(u^t[e]),r=0;r<8;r+=1)1==(1&i)?i=i>>>1^n:i>>>=1;u=u>>>8^i}return-1^u}function o(t,n){var r,i,u;if(void 0!==o.crc&&n&&t||(o.crc=-1,t)){for(r=o.crc,i=0,u=t.length;i<u;i+=1)r=r>>>8^e[255&(r^t[i])];return o.crc=r,-1^r}}!function(){var t,r,o;for(r=0;r<256;r+=1){for(t=r,o=0;o<8;o+=1)1&t?t=n^t>>>1:t>>>=1;e[r]=t>>>0}}(),t.exports=function(t,e){var n;t="string"==typeof t?(n=t,Array.prototype.map.call(n,(function(t){return t.charCodeAt(0)}))):t;return((e?r(t):o(t))>>>0).toString(16)},t.exports.direct=r,t.exports.table=o}()},7390:t=>{"use strict";t.exports=function(t,e){e||(e={}),"function"==typeof e&&(e={cmp:e});var n,r="boolean"==typeof e.cycles&&e.cycles,o=e.cmp&&(n=e.cmp,function(t){return function(e,r){var o={key:e,value:t[e]},i={key:r,value:t[r]};return n(o,i)}}),i=[];return function t(e){if(e&&e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!=typeof e)return JSON.stringify(e);var n,u;if(Array.isArray(e)){for(u="[",n=0;n<e.length;n++)n&&(u+=","),u+=t(e[n])||"null";return u+"]"}if(null===e)return"null";if(-1!==i.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var a=i.push(e)-1,c=Object.keys(e).sort(o&&o(e));for(u="",n=0;n<c.length;n++){var s=c[n],l=t(e[s]);l&&(u&&(u+=","),u+=JSON.stringify(s)+":"+l)}return i.splice(a,1),"{"+u+"}"}}(t)}},7692:(t,e,n)=>{"use strict";var r=n(3801),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},u={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(t){return r.isMemo(t)?u:a[t.$$typeof]||o}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=u;var s=Object.defineProperty,l=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,_=Object.getPrototypeOf,d=Object.prototype;t.exports=function t(e,n,r){if("string"!=typeof n){if(d){var o=_(n);o&&o!==d&&t(e,o,r)}var u=l(n);f&&(u=u.concat(f(n)));for(var a=c(e),v=c(n),h=0;h<u.length;++h){var y=u[h];if(!(i[y]||r&&r[y]||v&&v[y]||a&&a[y])){var m=p(n,y);try{s(e,y,m)}catch(t){}}}}return e}},4924:(t,e,n)=>{var r=n(9159).Symbol;t.exports=r},4729:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}},530:(t,e,n)=>{var r=n(4924),o=n(8792),i=n(8004),u=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":u&&u in Object(t)?o(t):i(t)}},3042:(t,e,n)=>{var r=n(4924),o=n(4729),i=n(6259),u=n(6260),a=r?r.prototype:void 0,c=a?a.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(i(e))return o(e,t)+"";if(u(e))return c?c.call(e):"";var n=e+"";return"0"==n&&1/e==-Infinity?"-0":n}},9504:(t,e,n)=>{var r=n(310),o=/^\s+/;t.exports=function(t){return t?t.slice(0,r(t)+1).replace(o,""):t}},6150:t=>{var e="object"==typeof window&&window&&window.Object===Object&&window;t.exports=e},8792:(t,e,n)=>{var r=n(4924),o=Object.prototype,i=o.hasOwnProperty,u=o.toString,a=r?r.toStringTag:void 0;t.exports=function(t){var e=i.call(t,a),n=t[a];try{t[a]=void 0;var r=!0}catch(t){}var o=u.call(t);return r&&(e?t[a]=n:delete t[a]),o}},8004:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},9159:(t,e,n)=>{var r=n(6150),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();t.exports=i},310:t=>{var e=/\s/;t.exports=function(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}},3259:(t,e,n)=>{var r=n(731),o=n(6199),i=n(4934),u=Math.max,a=Math.min;t.exports=function(t,e,n){var c,s,l,f,p,_,d=0,v=!1,h=!1,y=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function m(e){var n=c,r=s;return c=s=void 0,d=e,f=t.apply(r,n)}function b(t){var n=t-_;return void 0===_||n>=e||n<0||h&&t-d>=l}function g(){var t=o();if(b(t))return x(t);p=setTimeout(g,function(t){var n=e-(t-_);return h?a(n,l-(t-d)):n}(t))}function x(t){return p=void 0,y&&c?m(t):(c=s=void 0,f)}function w(){var t=o(),n=b(t);if(c=arguments,s=this,_=t,n){if(void 0===p)return function(t){return d=t,p=setTimeout(g,e),v?m(t):f}(_);if(h)return clearTimeout(p),p=setTimeout(g,e),m(_)}return void 0===p&&(p=setTimeout(g,e)),f}return e=i(e)||0,r(n)&&(v=!!n.leading,l=(h="maxWait"in n)?u(i(n.maxWait)||0,e):l,y="trailing"in n?!!n.trailing:y),w.cancel=function(){void 0!==p&&clearTimeout(p),d=0,c=_=s=p=void 0},w.flush=function(){return void 0===p?f:x(o())},w}},6259:t=>{var e=Array.isArray;t.exports=e},731:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},1642:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},6260:(t,e,n)=>{var r=n(530),o=n(1642);t.exports=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==r(t)}},6199:(t,e,n)=>{var r=n(9159);t.exports=function(){return r.Date.now()}},4934:(t,e,n)=>{var r=n(9504),o=n(731),i=n(6260),u=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,s=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return NaN;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=r(t);var n=a.test(t);return n||c.test(t)?s(t.slice(2),n?2:8):u.test(t)?NaN:+t}},6700:(t,e,n)=>{var r=n(3042);t.exports=function(t){return null==t?"":r(t)}},5348:(t,e,n)=>{var r=n(6700),o=0;t.exports=function(t){var e=++o;return r(t)+e}},9424:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var r=n(4273),o=n.n(r),i=n(3191),u=n.n(i),a=(0,n(3499).Z)("photon"),c={width:"w",height:"h",letterboxing:"lb",removeLetterboxing:"ulb"},s="__domain__.invalid",l="http://".concat(s),f="https://i0.wp.com";function p(t,e){var n;try{n=new URL(t,l)}catch(t){return null}var r,i,p,_,d,v="https:"===n.protocol,h=new URL(f);if(d=n.host,/^i[0-2]\.wp\.com$/.test(d))h.pathname=n.pathname,h.hostname=n.hostname;else{if(n.search)return null;var y=n.href.replace("".concat(n.protocol,"/"),"");"blob:"===n.protocol&&(y=n.pathname.replace("://","//")),n.hostname===s&&(y=n.pathname),h.pathname=y,h.hostname=(r=y,i=o()(r),p=u()(i),_="i"+Math.floor(3*p()),a('determined server "%s" to use with "%s"',_,r),_+".wp.com"),v&&h.searchParams.set("ssl",1)}if(e)for(var m in e)"host"!==m&&"hostname"!==m?"secure"!==m||e[m]?h.searchParams.set(c[m]||m,e[m]):h.protocol="http:":h.hostname=e[m];return a("generated Photon URL: %s",h.href),h.href}},211:(t,e,n)=>{var r=n(2687),o=n(3538);function i(t,e){for(var n in e)t[n]=e[n];return t}function u(t,e){for(var n in t)if("__source"!==n&&!(n in e))return!0;for(var r in e)if("__source"!==r&&t[r]!==e[r])return!0;return!1}function a(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e}function c(t){this.props=t}function s(t,e){function n(t){var n=this.props.ref,r=n==t.ref;return!r&&n&&(n.call?n(null):n.current=null),e?!e(this.props,t)||!r:u(this.props,t)}function o(e){return this.shouldComponentUpdate=n,r.createElement(t,e)}return o.displayName="Memo("+(t.displayName||t.name)+")",o.prototype.isReactComponent=!0,o.__f=!0,o}(c.prototype=new r.Component).isPureReactComponent=!0,c.prototype.shouldComponentUpdate=function(t,e){return u(this.props,t)||u(this.state,e)};var l=r.options.__b;r.options.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),l&&l(t)};var f="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function p(t){function e(e){var n=i({},e);return delete n.ref,t(n,e.ref||null)}return e.$$typeof=f,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var _=function(t,e){return null==t?null:r.toChildArray(r.toChildArray(t).map(e))},d={map:_,forEach:_,count:function(t){return t?r.toChildArray(t).length:0},only:function(t){var e=r.toChildArray(t);if(1!==e.length)throw"Children.only";return e[0]},toArray:r.toChildArray},v=r.options.__e;r.options.__e=function(t,e,n,r){if(t.then)for(var o,i=e;i=i.__;)if((o=i.__c)&&o.__c)return null==e.__e&&(e.__e=n.__e,e.__k=n.__k),o.__c(t,e);v(t,e,n,r)};var h=r.options.unmount;function y(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach((function(t){"function"==typeof t.__c&&t.__c()})),t.__c.__H=null),null!=(t=i({},t)).__c&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map((function(t){return y(t,e,n)}))),t}function m(t,e,n){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map((function(t){return m(t,e,n)})),t.__c&&t.__c.__P===e&&(t.__e&&n.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=n)),t}function b(){this.__u=0,this.t=null,this.__b=null}function g(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function x(t){var e,n,o;function i(i){if(e||(e=t()).then((function(t){n=t.default||t}),(function(t){o=t})),o)throw o;if(!n)throw e;return r.createElement(n,i)}return i.displayName="Lazy",i.__f=!0,i}function w(){this.u=null,this.o=null}r.options.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&!0===t.__h&&(t.type=null),h&&h(t)},(b.prototype=new r.Component).__c=function(t,e){var n=e.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var o=g(r.__v),i=!1,u=function(){i||(i=!0,n.__R=null,o?o(a):a())};n.__R=u;var a=function(){if(! --r.__u){if(r.state.__a){var t=r.state.__a;r.__v.__k[0]=m(t,t.__c.__P,t.__c.__O)}var e;for(r.setState({__a:r.__b=null});e=r.t.pop();)e.forceUpdate()}},c=!0===e.__h;r.__u++||c||r.setState({__a:r.__b=r.__v.__k[0]}),t.then(u,u)},b.prototype.componentWillUnmount=function(){this.t=[]},b.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=y(this.__b,n,o.__O=o.__P)}this.__b=null}var i=e.__a&&r.createElement(r.Fragment,null,t.fallback);return i&&(i.__h=null),[r.createElement(r.Fragment,null,e.__a?null:t.children),i]};var S=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&("t"!==t.props.revealOrder[0]||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};function O(t){return this.getChildContext=function(){return t.context},t.children}function C(t){var e=this,n=t.i;e.componentWillUnmount=function(){r.render(null,e.l),e.l=null,e.i=null},e.i&&e.i!==n&&e.componentWillUnmount(),t.__v?(e.l||(e.i=n,e.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(t){this.childNodes.push(t),e.i.appendChild(t)},insertBefore:function(t,n){this.childNodes.push(t),e.i.appendChild(t)},removeChild:function(t){this.childNodes.splice(this.childNodes.indexOf(t)>>>1,1),e.i.removeChild(t)}}),r.render(r.createElement(O,{context:e.context},t.__v),e.l)):e.l&&e.componentWillUnmount()}function E(t,e){var n=r.createElement(C,{__v:t,i:e});return n.containerInfo=e,n}(w.prototype=new r.Component).__a=function(t){var e=this,n=g(e.__v),r=e.o.get(t);return r[0]++,function(o){var i=function(){e.props.revealOrder?(r.push(o),S(e,t,r)):o()};n?n(i):i()}},w.prototype.render=function(t){this.u=null,this.o=new Map;var e=r.toChildArray(t.children);t.revealOrder&&"b"===t.revealOrder[0]&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},w.prototype.componentDidUpdate=w.prototype.componentDidMount=function(){var t=this;this.o.forEach((function(e,n){S(t,n,e)}))};var P="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,k=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,N="undefined"!=typeof document,j=function(t){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(t)};function T(t,e,n){return null==e.__k&&(e.textContent=""),r.render(t,e),"function"==typeof n&&n(),t?t.__c:null}function R(t,e,n){return r.hydrate(t,e),"function"==typeof n&&n(),t?t.__c:null}r.Component.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(t){Object.defineProperty(r.Component.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})}));var A=r.options.event;function M(){}function D(){return this.cancelBubble}function U(){return this.defaultPrevented}r.options.event=function(t){return A&&(t=A(t)),t.persist=M,t.isPropagationStopped=D,t.isDefaultPrevented=U,t.nativeEvent=t};var $,F={configurable:!0,get:function(){return this.class}},L=r.options.vnode;r.options.vnode=function(t){var e=t.type,n=t.props,o=n;if("string"==typeof e){var i=-1===e.indexOf("-");for(var u in o={},n){var a=n[u];N&&"children"===u&&"noscript"===e||"value"===u&&"defaultValue"in n&&null==a||("defaultValue"===u&&"value"in n&&null==n.value?u="value":"download"===u&&!0===a?a="":/ondoubleclick/i.test(u)?u="ondblclick":/^onchange(textarea|input)/i.test(u+e)&&!j(n.type)?u="oninput":/^onfocus$/i.test(u)?u="onfocusin":/^onblur$/i.test(u)?u="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(u)?u=u.toLowerCase():i&&k.test(u)?u=u.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===a&&(a=void 0),/^oninput$/i.test(u)&&(u=u.toLowerCase(),o[u]&&(u="oninputCapture")),o[u]=a)}"select"==e&&o.multiple&&Array.isArray(o.value)&&(o.value=r.toChildArray(n.children).forEach((function(t){t.props.selected=-1!=o.value.indexOf(t.props.value)}))),"select"==e&&null!=o.defaultValue&&(o.value=r.toChildArray(n.children).forEach((function(t){t.props.selected=o.multiple?-1!=o.defaultValue.indexOf(t.props.value):o.defaultValue==t.props.value}))),t.props=o,n.class!=n.className&&(F.enumerable="className"in n,null!=n.className&&(o.class=n.className),Object.defineProperty(o,"className",F))}t.$$typeof=P,L&&L(t)};var I=r.options.__r;r.options.__r=function(t){I&&I(t),$=t.__c};var Z={ReactCurrentDispatcher:{current:{readContext:function(t){return $.__n[t.__c].props.value}}}};function H(t){return r.createElement.bind(null,t)}function W(t){return!!t&&t.$$typeof===P}function V(t){return W(t)?r.cloneElement.apply(null,arguments):t}function z(t){return!!t.__k&&(r.render(null,t),!0)}function B(t){return t&&(t.base||1===t.nodeType&&t)||null}var q=function(t,e){return t(e)},X=function(t,e){return t(e)},J=r.Fragment;function K(t){t()}function G(t){return t}function Y(){return[!1,K]}var Q=o.useLayoutEffect;function tt(t,e){var n=e(),r=o.useState({p:{__:n,h:e}}),i=r[0].p,u=r[1];return o.useLayoutEffect((function(){i.__=n,i.h=e,a(i.__,e())||u({p:i})}),[t,n,e]),o.useEffect((function(){return a(i.__,i.h())||u({p:i}),t((function(){a(i.__,i.h())||u({p:i})}))}),[t]),n}var et={useState:o.useState,useId:o.useId,useReducer:o.useReducer,useEffect:o.useEffect,useLayoutEffect:o.useLayoutEffect,useInsertionEffect:Q,useTransition:Y,useDeferredValue:G,useSyncExternalStore:tt,startTransition:K,useRef:o.useRef,useImperativeHandle:o.useImperativeHandle,useMemo:o.useMemo,useCallback:o.useCallback,useContext:o.useContext,useDebugValue:o.useDebugValue,version:"17.0.2",Children:d,render:T,hydrate:R,unmountComponentAtNode:z,createPortal:E,createElement:r.createElement,createContext:r.createContext,createFactory:H,cloneElement:V,createRef:r.createRef,Fragment:r.Fragment,isValidElement:W,findDOMNode:B,Component:r.Component,PureComponent:c,memo:s,forwardRef:p,flushSync:X,unstable_batchedUpdates:q,StrictMode:J,Suspense:b,SuspenseList:w,lazy:x,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Z};Object.defineProperty(e,"Component",{enumerable:!0,get:function(){return r.Component}}),Object.defineProperty(e,"Fragment",{enumerable:!0,get:function(){return r.Fragment}}),Object.defineProperty(e,"createContext",{enumerable:!0,get:function(){return r.createContext}}),Object.defineProperty(e,"createElement",{enumerable:!0,get:function(){return r.createElement}}),Object.defineProperty(e,"createRef",{enumerable:!0,get:function(){return r.createRef}}),e.Children=d,e.PureComponent=c,e.StrictMode=J,e.Suspense=b,e.SuspenseList=w,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,e.cloneElement=V,e.createFactory=H,e.createPortal=E,e.default=et,e.findDOMNode=B,e.flushSync=X,e.forwardRef=p,e.hydrate=R,e.isValidElement=W,e.lazy=x,e.memo=s,e.render=T,e.startTransition=K,e.unmountComponentAtNode=z,e.unstable_batchedUpdates=q,e.useDeferredValue=G,e.useInsertionEffect=Q,e.useSyncExternalStore=tt,e.useTransition=Y,e.version="17.0.2",Object.keys(o).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}})}))},762:(t,e,n)=>{"use strict";n.d(e,{ZP:()=>I});var r=n(2687),o=n(3538);function i(t,e){for(var n in e)t[n]=e[n];return t}function u(t,e){for(var n in t)if("__source"!==n&&!(n in e))return!0;for(var r in e)if("__source"!==r&&t[r]!==e[r])return!0;return!1}function a(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e}function c(t){this.props=t}(c.prototype=new r.Component).isPureReactComponent=!0,c.prototype.shouldComponentUpdate=function(t,e){return u(this.props,t)||u(this.state,e)};var s=r.options.__b;r.options.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),s&&s(t)};var l="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;var f=function(t,e){return null==t?null:(0,r.toChildArray)((0,r.toChildArray)(t).map(e))},p={map:f,forEach:f,count:function(t){return t?(0,r.toChildArray)(t).length:0},only:function(t){var e=(0,r.toChildArray)(t);if(1!==e.length)throw"Children.only";return e[0]},toArray:r.toChildArray},_=r.options.__e;r.options.__e=function(t,e,n,r){if(t.then)for(var o,i=e;i=i.__;)if((o=i.__c)&&o.__c)return null==e.__e&&(e.__e=n.__e,e.__k=n.__k),o.__c(t,e);_(t,e,n,r)};var d=r.options.unmount;function v(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach((function(t){"function"==typeof t.__c&&t.__c()})),t.__c.__H=null),null!=(t=i({},t)).__c&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map((function(t){return v(t,e,n)}))),t}function h(t,e,n){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map((function(t){return h(t,e,n)})),t.__c&&t.__c.__P===e&&(t.__e&&n.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=n)),t}function y(){this.__u=0,this.t=null,this.__b=null}function m(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function b(){this.u=null,this.o=null}r.options.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&!0===t.__h&&(t.type=null),d&&d(t)},(y.prototype=new r.Component).__c=function(t,e){var n=e.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var o=m(r.__v),i=!1,u=function(){i||(i=!0,n.__R=null,o?o(a):a())};n.__R=u;var a=function(){if(! --r.__u){if(r.state.__a){var t=r.state.__a;r.__v.__k[0]=h(t,t.__c.__P,t.__c.__O)}var e;for(r.setState({__a:r.__b=null});e=r.t.pop();)e.forceUpdate()}},c=!0===e.__h;r.__u++||c||r.setState({__a:r.__b=r.__v.__k[0]}),t.then(u,u)},y.prototype.componentWillUnmount=function(){this.t=[]},y.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=v(this.__b,n,o.__O=o.__P)}this.__b=null}var i=e.__a&&(0,r.createElement)(r.Fragment,null,t.fallback);return i&&(i.__h=null),[(0,r.createElement)(r.Fragment,null,e.__a?null:t.children),i]};var g=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&("t"!==t.props.revealOrder[0]||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};function x(t){return this.getChildContext=function(){return t.context},t.children}function w(t){var e=this,n=t.i;e.componentWillUnmount=function(){(0,r.render)(null,e.l),e.l=null,e.i=null},e.i&&e.i!==n&&e.componentWillUnmount(),t.__v?(e.l||(e.i=n,e.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(t){this.childNodes.push(t),e.i.appendChild(t)},insertBefore:function(t,n){this.childNodes.push(t),e.i.appendChild(t)},removeChild:function(t){this.childNodes.splice(this.childNodes.indexOf(t)>>>1,1),e.i.removeChild(t)}}),(0,r.render)((0,r.createElement)(x,{context:e.context},t.__v),e.l)):e.l&&e.componentWillUnmount()}(b.prototype=new r.Component).__a=function(t){var e=this,n=m(e.__v),r=e.o.get(t);return r[0]++,function(o){var i=function(){e.props.revealOrder?(r.push(o),g(e,t,r)):o()};n?n(i):i()}},b.prototype.render=function(t){this.u=null,this.o=new Map;var e=(0,r.toChildArray)(t.children);t.revealOrder&&"b"===t.revealOrder[0]&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},b.prototype.componentDidUpdate=b.prototype.componentDidMount=function(){var t=this;this.o.forEach((function(e,n){g(t,n,e)}))};var S="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,O=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,C="undefined"!=typeof document,E=function(t){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(t)};r.Component.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(t){Object.defineProperty(r.Component.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})}));var P=r.options.event;function k(){}function N(){return this.cancelBubble}function j(){return this.defaultPrevented}r.options.event=function(t){return P&&(t=P(t)),t.persist=k,t.isPropagationStopped=N,t.isDefaultPrevented=j,t.nativeEvent=t};var T,R={configurable:!0,get:function(){return this.class}},A=r.options.vnode;r.options.vnode=function(t){var e=t.type,n=t.props,o=n;if("string"==typeof e){var i=-1===e.indexOf("-");for(var u in o={},n){var a=n[u];C&&"children"===u&&"noscript"===e||"value"===u&&"defaultValue"in n&&null==a||("defaultValue"===u&&"value"in n&&null==n.value?u="value":"download"===u&&!0===a?a="":/ondoubleclick/i.test(u)?u="ondblclick":/^onchange(textarea|input)/i.test(u+e)&&!E(n.type)?u="oninput":/^onfocus$/i.test(u)?u="onfocusin":/^onblur$/i.test(u)?u="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(u)?u=u.toLowerCase():i&&O.test(u)?u=u.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===a&&(a=void 0),/^oninput$/i.test(u)&&(u=u.toLowerCase(),o[u]&&(u="oninputCapture")),o[u]=a)}"select"==e&&o.multiple&&Array.isArray(o.value)&&(o.value=(0,r.toChildArray)(n.children).forEach((function(t){t.props.selected=-1!=o.value.indexOf(t.props.value)}))),"select"==e&&null!=o.defaultValue&&(o.value=(0,r.toChildArray)(n.children).forEach((function(t){t.props.selected=o.multiple?-1!=o.defaultValue.indexOf(t.props.value):o.defaultValue==t.props.value}))),t.props=o,n.class!=n.className&&(R.enumerable="className"in n,null!=n.className&&(o.class=n.className),Object.defineProperty(o,"className",R))}t.$$typeof=S,A&&A(t)};var M=r.options.__r;r.options.__r=function(t){M&&M(t),T=t.__c};var D={ReactCurrentDispatcher:{current:{readContext:function(t){return T.__n[t.__c].props.value}}}};function U(t){return!!t&&t.$$typeof===S}var $=r.Fragment;function F(t){t()}var L=o.useLayoutEffect;var I={useState:o.useState,useId:o.useId,useReducer:o.useReducer,useEffect:o.useEffect,useLayoutEffect:o.useLayoutEffect,useInsertionEffect:L,useTransition:function(){return[!1,F]},useDeferredValue:function(t){return t},useSyncExternalStore:function(t,e){var n=e(),r=(0,o.useState)({h:{__:n,v:e}}),i=r[0].h,u=r[1];return(0,o.useLayoutEffect)((function(){i.__=n,i.v=e,a(i.__,e())||u({h:i})}),[t,n,e]),(0,o.useEffect)((function(){return a(i.__,i.v())||u({h:i}),t((function(){a(i.__,i.v())||u({h:i})}))}),[t]),n},startTransition:F,useRef:o.useRef,useImperativeHandle:o.useImperativeHandle,useMemo:o.useMemo,useCallback:o.useCallback,useContext:o.useContext,useDebugValue:o.useDebugValue,version:"17.0.2",Children:p,render:function(t,e,n){return null==e.__k&&(e.textContent=""),(0,r.render)(t,e),"function"==typeof n&&n(),t?t.__c:null},hydrate:function(t,e,n){return(0,r.hydrate)(t,e),"function"==typeof n&&n(),t?t.__c:null},unmountComponentAtNode:function(t){return!!t.__k&&((0,r.render)(null,t),!0)},createPortal:function(t,e){var n=(0,r.createElement)(w,{__v:t,i:e});return n.containerInfo=e,n},createElement:r.createElement,createContext:r.createContext,createFactory:function(t){return r.createElement.bind(null,t)},cloneElement:function(t){return U(t)?r.cloneElement.apply(null,arguments):t},createRef:r.createRef,Fragment:r.Fragment,isValidElement:U,findDOMNode:function(t){return t&&(t.base||1===t.nodeType&&t)||null},Component:r.Component,PureComponent:c,memo:function(t,e){function n(t){var n=this.props.ref,r=n==t.ref;return!r&&n&&(n.call?n(null):n.current=null),e?!e(this.props,t)||!r:u(this.props,t)}function o(e){return this.shouldComponentUpdate=n,(0,r.createElement)(t,e)}return o.displayName="Memo("+(t.displayName||t.name)+")",o.prototype.isReactComponent=!0,o.__f=!0,o},forwardRef:function(t){function e(e){var n=i({},e);return delete n.ref,t(n,e.ref||null)}return e.$$typeof=l,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e},flushSync:function(t,e){return t(e)},unstable_batchedUpdates:function(t,e){return t(e)},StrictMode:$,Suspense:y,SuspenseList:b,lazy:function(t){var e,n,o;function i(i){if(e||(e=t()).then((function(t){n=t.default||t}),(function(t){o=t})),o)throw o;if(!n)throw e;return(0,r.createElement)(n,i)}return i.displayName="Lazy",i.__f=!0,i},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:D}},2687:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Component:()=>C,Fragment:()=>g,cloneElement:()=>V,createContext:()=>z,createElement:()=>y,createRef:()=>b,h:()=>y,hydrate:()=>W,isValidElement:()=>u,options:()=>o,render:()=>H,toChildArray:()=>A});var r,o,i,u,a,c,s,l,f,p={},_=[],d=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function v(t,e){for(var n in e)t[n]=e[n];return t}function h(t){var e=t.parentNode;e&&e.removeChild(t)}function y(t,e,n){var o,i,u,a={};for(u in e)"key"==u?o=e[u]:"ref"==u?i=e[u]:a[u]=e[u];if(arguments.length>2&&(a.children=arguments.length>3?r.call(arguments,2):n),"function"==typeof t&&null!=t.defaultProps)for(u in t.defaultProps)void 0===a[u]&&(a[u]=t.defaultProps[u]);return m(t,a,o,i,null)}function m(t,e,n,r,u){var a={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==u?++i:u};return null==u&&null!=o.vnode&&o.vnode(a),a}function b(){return{current:null}}function g(t){return t.children}function x(t,e,n){"-"===e[0]?t.setProperty(e,null==n?"":n):t[e]=null==n?"":"number"!=typeof n||d.test(e)?n:n+"px"}function w(t,e,n,r,o){var i;t:if("style"===e)if("string"==typeof n)t.style.cssText=n;else{if("string"==typeof r&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||x(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||x(t.style,e,n[e])}else if("o"===e[0]&&"n"===e[1])i=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?r||t.addEventListener(e,i?O:S,i):t.removeEventListener(e,i?O:S,i);else if("dangerouslySetInnerHTML"!==e){if(o)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==e&&"height"!==e&&"href"!==e&&"list"!==e&&"form"!==e&&"tabIndex"!==e&&"download"!==e&&e in t)try{t[e]=null==n?"":n;break t}catch(t){}"function"==typeof n||(null==n||!1===n&&-1==e.indexOf("-")?t.removeAttribute(e):t.setAttribute(e,n))}}function S(t){a=!0;try{return this.l[t.type+!1](o.event?o.event(t):t)}finally{a=!1}}function O(t){a=!0;try{return this.l[t.type+!0](o.event?o.event(t):t)}finally{a=!1}}function C(t,e){this.props=t,this.context=e}function E(t,e){if(null==e)return t.__?E(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?E(t):null}function P(t){var e,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return P(t)}}function k(t){a?setTimeout(t):l(t)}function N(t){(!t.__d&&(t.__d=!0)&&c.push(t)&&!j.__r++||s!==o.debounceRendering)&&((s=o.debounceRendering)||k)(j)}function j(){var t,e,n,r,o,i,u,a;for(c.sort((function(t,e){return t.__v.__b-e.__v.__b}));t=c.shift();)t.__d&&(e=c.length,r=void 0,o=void 0,u=(i=(n=t).__v).__e,(a=n.__P)&&(r=[],(o=v({},i)).__v=i.__v+1,U(a,i,o,n.__n,void 0!==a.ownerSVGElement,null!=i.__h?[u]:null,r,null==u?E(i):u,i.__h),$(r,i),i.__e!=u&&P(i)),c.length>e&&c.sort((function(t,e){return t.__v.__b-e.__v.__b})));j.__r=0}function T(t,e,n,r,o,i,u,a,c,s){var l,f,d,v,h,y,b,x=r&&r.__k||_,w=x.length;for(n.__k=[],l=0;l<e.length;l++)if(null!=(v=n.__k[l]=null==(v=e[l])||"boolean"==typeof v?null:"string"==typeof v||"number"==typeof v||"bigint"==typeof v?m(null,v,null,null,v):Array.isArray(v)?m(g,{children:v},null,null,null):v.__b>0?m(v.type,v.props,v.key,v.ref?v.ref:null,v.__v):v)){if(v.__=n,v.__b=n.__b+1,null===(d=x[l])||d&&v.key==d.key&&v.type===d.type)x[l]=void 0;else for(f=0;f<w;f++){if((d=x[f])&&v.key==d.key&&v.type===d.type){x[f]=void 0;break}d=null}U(t,v,d=d||p,o,i,u,a,c,s),h=v.__e,(f=v.ref)&&d.ref!=f&&(b||(b=[]),d.ref&&b.push(d.ref,null,v),b.push(f,v.__c||h,v)),null!=h?(null==y&&(y=h),"function"==typeof v.type&&v.__k===d.__k?v.__d=c=R(v,c,t):c=M(t,v,d,x,h,c),"function"==typeof n.type&&(n.__d=c)):c&&d.__e==c&&c.parentNode!=t&&(c=E(d))}for(n.__e=y,l=w;l--;)null!=x[l]&&("function"==typeof n.type&&null!=x[l].__e&&x[l].__e==n.__d&&(n.__d=D(r).nextSibling),I(x[l],x[l]));if(b)for(l=0;l<b.length;l++)L(b[l],b[++l],b[++l])}function R(t,e,n){for(var r,o=t.__k,i=0;o&&i<o.length;i++)(r=o[i])&&(r.__=t,e="function"==typeof r.type?R(r,e,n):M(n,r,r,o,r.__e,e));return e}function A(t,e){return e=e||[],null==t||"boolean"==typeof t||(Array.isArray(t)?t.some((function(t){A(t,e)})):e.push(t)),e}function M(t,e,n,r,o,i){var u,a,c;if(void 0!==e.__d)u=e.__d,e.__d=void 0;else if(null==n||o!=i||null==o.parentNode)t:if(null==i||i.parentNode!==t)t.appendChild(o),u=null;else{for(a=i,c=0;(a=a.nextSibling)&&c<r.length;c+=1)if(a==o)break t;t.insertBefore(o,i),u=i}return void 0!==u?u:o.nextSibling}function D(t){var e,n,r;if(null==t.type||"string"==typeof t.type)return t.__e;if(t.__k)for(e=t.__k.length-1;e>=0;e--)if((n=t.__k[e])&&(r=D(n)))return r;return null}function U(t,e,n,r,i,u,a,c,s){var l,f,p,_,d,h,y,m,b,x,w,S,O,E,P,k=e.type;if(void 0!==e.constructor)return null;null!=n.__h&&(s=n.__h,c=e.__e=n.__e,e.__h=null,u=[c]),(l=o.__b)&&l(e);try{t:if("function"==typeof k){if(m=e.props,b=(l=k.contextType)&&r[l.__c],x=l?b?b.props.value:l.__:r,n.__c?y=(f=e.__c=n.__c).__=f.__E:("prototype"in k&&k.prototype.render?e.__c=f=new k(m,x):(e.__c=f=new C(m,x),f.constructor=k,f.render=Z),b&&b.sub(f),f.props=m,f.state||(f.state={}),f.context=x,f.__n=r,p=f.__d=!0,f.__h=[],f._sb=[]),null==f.__s&&(f.__s=f.state),null!=k.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=v({},f.__s)),v(f.__s,k.getDerivedStateFromProps(m,f.__s))),_=f.props,d=f.state,f.__v=e,p)null==k.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(null==k.getDerivedStateFromProps&&m!==_&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(m,x),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(m,f.__s,x)||e.__v===n.__v){for(e.__v!==n.__v&&(f.props=m,f.state=f.__s,f.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.forEach((function(t){t&&(t.__=e)})),w=0;w<f._sb.length;w++)f.__h.push(f._sb[w]);f._sb=[],f.__h.length&&a.push(f);break t}null!=f.componentWillUpdate&&f.componentWillUpdate(m,f.__s,x),null!=f.componentDidUpdate&&f.__h.push((function(){f.componentDidUpdate(_,d,h)}))}if(f.context=x,f.props=m,f.__P=t,S=o.__r,O=0,"prototype"in k&&k.prototype.render){for(f.state=f.__s,f.__d=!1,S&&S(e),l=f.render(f.props,f.state,f.context),E=0;E<f._sb.length;E++)f.__h.push(f._sb[E]);f._sb=[]}else do{f.__d=!1,S&&S(e),l=f.render(f.props,f.state,f.context),f.state=f.__s}while(f.__d&&++O<25);f.state=f.__s,null!=f.getChildContext&&(r=v(v({},r),f.getChildContext())),p||null==f.getSnapshotBeforeUpdate||(h=f.getSnapshotBeforeUpdate(_,d)),P=null!=l&&l.type===g&&null==l.key?l.props.children:l,T(t,Array.isArray(P)?P:[P],e,n,r,i,u,a,c,s),f.base=e.__e,e.__h=null,f.__h.length&&a.push(f),y&&(f.__E=f.__=null),f.__e=!1}else null==u&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=F(n.__e,e,n,r,i,u,a,s);(l=o.diffed)&&l(e)}catch(t){e.__v=null,(s||null!=u)&&(e.__e=c,e.__h=!!s,u[u.indexOf(c)]=null),o.__e(t,e,n)}}function $(t,e){o.__c&&o.__c(e,t),t.some((function(e){try{t=e.__h,e.__h=[],t.some((function(t){t.call(e)}))}catch(t){o.__e(t,e.__v)}}))}function F(t,e,n,o,i,u,a,c){var s,l,f,_=n.props,d=e.props,v=e.type,y=0;if("svg"===v&&(i=!0),null!=u)for(;y<u.length;y++)if((s=u[y])&&"setAttribute"in s==!!v&&(v?s.localName===v:3===s.nodeType)){t=s,u[y]=null;break}if(null==t){if(null===v)return document.createTextNode(d);t=i?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,d.is&&d),u=null,c=!1}if(null===v)_===d||c&&t.data===d||(t.data=d);else{if(u=u&&r.call(t.childNodes),l=(_=n.props||p).dangerouslySetInnerHTML,f=d.dangerouslySetInnerHTML,!c){if(null!=u)for(_={},y=0;y<t.attributes.length;y++)_[t.attributes[y].name]=t.attributes[y].value;(f||l)&&(f&&(l&&f.__html==l.__html||f.__html===t.innerHTML)||(t.innerHTML=f&&f.__html||""))}if(function(t,e,n,r,o){var i;for(i in n)"children"===i||"key"===i||i in e||w(t,i,null,n[i],r);for(i in e)o&&"function"!=typeof e[i]||"children"===i||"key"===i||"value"===i||"checked"===i||n[i]===e[i]||w(t,i,e[i],n[i],r)}(t,d,_,i,c),f)e.__k=[];else if(y=e.props.children,T(t,Array.isArray(y)?y:[y],e,n,o,i&&"foreignObject"!==v,u,a,u?u[0]:n.__k&&E(n,0),c),null!=u)for(y=u.length;y--;)null!=u[y]&&h(u[y]);c||("value"in d&&void 0!==(y=d.value)&&(y!==t.value||"progress"===v&&!y||"option"===v&&y!==_.value)&&w(t,"value",y,_.value,!1),"checked"in d&&void 0!==(y=d.checked)&&y!==t.checked&&w(t,"checked",y,_.checked,!1))}return t}function L(t,e,n){try{"function"==typeof t?t(e):t.current=e}catch(t){o.__e(t,n)}}function I(t,e,n){var r,i;if(o.unmount&&o.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||L(r,null,e)),null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(t){o.__e(t,e)}r.base=r.__P=null,t.__c=void 0}if(r=t.__k)for(i=0;i<r.length;i++)r[i]&&I(r[i],e,n||"function"!=typeof t.type);n||null==t.__e||h(t.__e),t.__=t.__e=t.__d=void 0}function Z(t,e,n){return this.constructor(t,n)}function H(t,e,n){var i,u,a;o.__&&o.__(t,e),u=(i="function"==typeof n)?null:n&&n.__k||e.__k,a=[],U(e,t=(!i&&n||e).__k=y(g,null,[t]),u||p,p,void 0!==e.ownerSVGElement,!i&&n?[n]:u?null:e.firstChild?r.call(e.childNodes):null,a,!i&&n?n:u?u.__e:e.firstChild,i),$(a,t)}function W(t,e){H(t,e,W)}function V(t,e,n){var o,i,u,a=v({},t.props);for(u in e)"key"==u?o=e[u]:"ref"==u?i=e[u]:a[u]=e[u];return arguments.length>2&&(a.children=arguments.length>3?r.call(arguments,2):n),m(t.type,a,o||t.key,i||t.ref,null)}function z(t,e){var n={__c:e="__cC"+f++,__:t,Consumer:function(t,e){return t.children(e)},Provider:function(t){var n,r;return this.getChildContext||(n=[],(r={})[e]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(t){this.props.value!==t.value&&n.some((function(t){t.__e=!0,N(t)}))},this.sub=function(t){n.push(t);var e=t.componentWillUnmount;t.componentWillUnmount=function(){n.splice(n.indexOf(t),1),e&&e.call(t)}}),t.children}};return n.Provider.__=n.Consumer.contextType=n}r=_.slice,o={__e:function(t,e,n,r){for(var o,i,u;e=e.__;)if((o=e.__c)&&!o.__)try{if((i=o.constructor)&&null!=i.getDerivedStateFromError&&(o.setState(i.getDerivedStateFromError(t)),u=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(t,r||{}),u=o.__d),u)return o.__E=o}catch(e){t=e}throw t}},i=0,u=function(t){return null!=t&&void 0===t.constructor},a=!1,C.prototype.setState=function(t,e){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=v({},this.state),"function"==typeof t&&(t=t(v({},n),this.props)),t&&v(n,t),null!=t&&this.__v&&(e&&this._sb.push(e),N(this))},C.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),N(this))},C.prototype.render=g,c=[],l="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,j.__r=0,f=0},3538:(t,e,n)=>{"use strict";n.r(e),n.d(e,{useCallback:()=>O,useContext:()=>C,useDebugValue:()=>E,useEffect:()=>b,useErrorBoundary:()=>P,useId:()=>k,useImperativeHandle:()=>w,useLayoutEffect:()=>g,useMemo:()=>S,useReducer:()=>m,useRef:()=>x,useState:()=>y});var r,o,i,u,a=n(2687),c=0,s=[],l=[],f=a.options.__b,p=a.options.__r,_=a.options.diffed,d=a.options.__c,v=a.options.unmount;function h(t,e){a.options.__h&&a.options.__h(o,t,c||e),c=0;var n=o.__H||(o.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({__V:l}),n.__[t]}function y(t){return c=1,m(D,t)}function m(t,e,n){var i=h(r++,2);if(i.t=t,!i.__c&&(i.__=[n?n(e):D(void 0,e),function(t){var e=i.__N?i.__N[0]:i.__[0],n=i.t(e,t);e!==n&&(i.__N=[n,i.__[1]],i.__c.setState({}))}],i.__c=o,!o.u)){o.u=!0;var u=o.shouldComponentUpdate;o.shouldComponentUpdate=function(t,e,n){if(!i.__c.__H)return!0;var r=i.__c.__H.__.filter((function(t){return t.__c}));if(r.every((function(t){return!t.__N})))return!u||u.call(this,t,e,n);var o=!1;return r.forEach((function(t){if(t.__N){var e=t.__[0];t.__=t.__N,t.__N=void 0,e!==t.__[0]&&(o=!0)}})),!(!o&&i.__c.props===t)&&(!u||u.call(this,t,e,n))}}return i.__N||i.__}function b(t,e){var n=h(r++,3);!a.options.__s&&M(n.__H,e)&&(n.__=t,n.i=e,o.__H.__h.push(n))}function g(t,e){var n=h(r++,4);!a.options.__s&&M(n.__H,e)&&(n.__=t,n.i=e,o.__h.push(n))}function x(t){return c=5,S((function(){return{current:t}}),[])}function w(t,e,n){c=6,g((function(){return"function"==typeof t?(t(e()),function(){return t(null)}):t?(t.current=e(),function(){return t.current=null}):void 0}),null==n?n:n.concat(t))}function S(t,e){var n=h(r++,7);return M(n.__H,e)?(n.__V=t(),n.i=e,n.__h=t,n.__V):n.__}function O(t,e){return c=8,S((function(){return t}),e)}function C(t){var e=o.context[t.__c],n=h(r++,9);return n.c=t,e?(null==n.__&&(n.__=!0,e.sub(o)),e.props.value):t.__}function E(t,e){a.options.useDebugValue&&a.options.useDebugValue(e?e(t):t)}function P(t){var e=h(r++,10),n=y();return e.__=t,o.componentDidCatch||(o.componentDidCatch=function(t,r){e.__&&e.__(t,r),n[1](t)}),[n[0],function(){n[1](void 0)}]}function k(){var t=h(r++,11);if(!t.__){for(var e=o.__v;null!==e&&!e.__m&&null!==e.__;)e=e.__;var n=e.__m||(e.__m=[0,0]);t.__="P"+n[0]+"-"+n[1]++}return t.__}function N(){for(var t;t=s.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(R),t.__H.__h.forEach(A),t.__H.__h=[]}catch(e){t.__H.__h=[],a.options.__e(e,t.__v)}}a.options.__b=function(t){o=null,f&&f(t)},a.options.__r=function(t){p&&p(t),r=0;var e=(o=t.__c).__H;e&&(i===o?(e.__h=[],o.__h=[],e.__.forEach((function(t){t.__N&&(t.__=t.__N),t.__V=l,t.__N=t.i=void 0}))):(e.__h.forEach(R),e.__h.forEach(A),e.__h=[])),i=o},a.options.diffed=function(t){_&&_(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(1!==s.push(e)&&u===a.options.requestAnimationFrame||((u=a.options.requestAnimationFrame)||T)(N)),e.__H.__.forEach((function(t){t.i&&(t.__H=t.i),t.__V!==l&&(t.__=t.__V),t.i=void 0,t.__V=l}))),i=o=null},a.options.__c=function(t,e){e.some((function(t){try{t.__h.forEach(R),t.__h=t.__h.filter((function(t){return!t.__||A(t)}))}catch(n){e.some((function(t){t.__h&&(t.__h=[])})),e=[],a.options.__e(n,t.__v)}})),d&&d(t,e)},a.options.unmount=function(t){v&&v(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach((function(t){try{R(t)}catch(t){e=t}})),n.__H=void 0,e&&a.options.__e(e,n.__v))};var j="function"==typeof requestAnimationFrame;function T(t){var e,n=function(){clearTimeout(r),j&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,100);j&&(e=requestAnimationFrame(n))}function R(t){var e=o,n=t.__c;"function"==typeof n&&(t.__c=void 0,n()),o=e}function A(t){var e=o;t.__c=t.__(),o=e}function M(t,e){return!t||t.length!==e.length||e.some((function(e,n){return e!==t[n]}))}function D(t,e){return"function"==typeof e?e(t):e}},5731:(t,e)=>{"use strict";var n=Object.prototype,r=n.toString,o=n.hasOwnProperty,i="[object Object]",u="[object Array]";function a(t,e){return null!=t?t+"["+e+"]":e}e.x=function t(e,n,c){var s=r.call(e);if(void 0===c)if(s===i)c={};else{if(s!==u)return;c=[]}for(var l in e)if(o.call(e,l)){var f=e[l];if(null!=f)switch(r.call(f)){case u:case i:t(f,a(n,l),c);break;default:c[a(n,l)]=f}}return c}},8750:(t,e,n)=>{"use strict";function r(t,e){var n,r,o,i="";for(n in t)if(void 0!==(o=t[n]))if(Array.isArray(o))for(r=0;r<o.length;r++)i&&(i+="&"),i+=encodeURIComponent(n)+"="+encodeURIComponent(o[r]);else i&&(i+="&"),i+=encodeURIComponent(n)+"="+encodeURIComponent(o);return(e||"")+i}n.d(e,{c:()=>r})},8922:(t,e)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,u=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,s=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,_=n?Symbol.for("react.suspense"):60113,d=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,h=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,m=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,g=n?Symbol.for("react.scope"):60119;function x(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case l:case f:case i:case a:case u:case _:return t;default:switch(t=t&&t.$$typeof){case s:case p:case h:case v:case c:return t;default:return e}}case o:return e}}}function w(t){return x(t)===f}e.AsyncMode=l,e.ConcurrentMode=f,e.ContextConsumer=s,e.ContextProvider=c,e.Element=r,e.ForwardRef=p,e.Fragment=i,e.Lazy=h,e.Memo=v,e.Portal=o,e.Profiler=a,e.StrictMode=u,e.Suspense=_,e.isAsyncMode=function(t){return w(t)||x(t)===l},e.isConcurrentMode=w,e.isContextConsumer=function(t){return x(t)===s},e.isContextProvider=function(t){return x(t)===c},e.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===r},e.isForwardRef=function(t){return x(t)===p},e.isFragment=function(t){return x(t)===i},e.isLazy=function(t){return x(t)===h},e.isMemo=function(t){return x(t)===v},e.isPortal=function(t){return x(t)===o},e.isProfiler=function(t){return x(t)===a},e.isStrictMode=function(t){return x(t)===u},e.isSuspense=function(t){return x(t)===_},e.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===i||t===f||t===a||t===u||t===_||t===d||"object"==typeof t&&null!==t&&(t.$$typeof===h||t.$$typeof===v||t.$$typeof===c||t.$$typeof===s||t.$$typeof===p||t.$$typeof===m||t.$$typeof===b||t.$$typeof===g||t.$$typeof===y)},e.typeOf=x},3801:(t,e,n)=>{"use strict";t.exports=n(8922)},4223:(t,e)=>{"use strict";var n=60103,r=60106,o=60107,i=60108,u=60114,a=60109,c=60110,s=60112,l=60113,f=60120,p=60115,_=60116,d=60121,v=60122,h=60117,y=60129,m=60131;if("function"==typeof Symbol&&Symbol.for){var b=Symbol.for;n=b("react.element"),r=b("react.portal"),o=b("react.fragment"),i=b("react.strict_mode"),u=b("react.profiler"),a=b("react.provider"),c=b("react.context"),s=b("react.forward_ref"),l=b("react.suspense"),f=b("react.suspense_list"),p=b("react.memo"),_=b("react.lazy"),d=b("react.block"),v=b("react.server.block"),h=b("react.fundamental"),y=b("react.debug_trace_mode"),m=b("react.legacy_hidden")}function g(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case n:switch(t=t.type){case o:case u:case i:case l:case f:return t;default:switch(t=t&&t.$$typeof){case c:case s:case _:case p:case a:return t;default:return e}}case r:return e}}}e.isContextConsumer=function(t){return g(t)===c}},1637:(t,e,n)=>{"use strict";t.exports=n(4223)},373:(t,e,n)=>{"use strict";n.d(e,{E:()=>o});var r=n(211),o=n.n(r)().createContext(null)},1290:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(211),o=n.n(r),i=n(373),u=n(5053),a=n(999);const c=function(t){var e=t.store,n=t.context,c=t.children,s=(0,r.useMemo)((function(){var t=(0,u.X)(e);return{store:e,subscription:t}}),[e]),l=(0,r.useMemo)((function(){return e.getState()}),[e]);(0,a.L)((function(){var t=s.subscription;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),l!==e.getState()&&t.notifyNestedSubs(),function(){t.tryUnsubscribe(),t.onStateChange=null}}),[s,l]);var f=n||i.E;return o().createElement(f.Provider,{value:s},c)}},5642:(t,e,n)=>{"use strict";n.d(e,{Z:()=>w});var r=n(255),o=n(7921),i=n(7692),u=n.n(i),a=n(211),c=n.n(a),s=n(1637),l=n(5053),f=n(999),p=n(373),_=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],d=["reactReduxForwardedRef"],v=[],h=[null,null];function y(t,e){var n=t[1];return[e.payload,n+1]}function m(t,e,n){(0,f.L)((function(){return t.apply(void 0,e)}),n)}function b(t,e,n,r,o,i,u){t.current=r,e.current=o,n.current=!1,i.current&&(i.current=null,u())}function g(t,e,n,r,o,i,u,a,c,s){if(t){var l=!1,f=null,p=function(){if(!l){var t,n,p=e.getState();try{t=r(p,o.current)}catch(t){n=t,f=t}n||(f=null),t===i.current?u.current||c():(i.current=t,a.current=t,u.current=!0,s({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=p,n.trySubscribe(),p();return function(){if(l=!0,n.tryUnsubscribe(),n.onStateChange=null,f)throw f}}}var x=function(){return[null,0]};function w(t,e){void 0===e&&(e={});var n=e,i=n.getDisplayName,f=void 0===i?function(t){return"ConnectAdvanced("+t+")"}:i,w=n.methodName,S=void 0===w?"connectAdvanced":w,O=n.renderCountProp,C=void 0===O?void 0:O,E=n.shouldHandleStateChanges,P=void 0===E||E,k=n.storeKey,N=void 0===k?"store":k,j=(n.withRef,n.forwardRef),T=void 0!==j&&j,R=n.context,A=void 0===R?p.E:R,M=(0,o.Z)(n,_),D=A;return function(e){var n=e.displayName||e.name||"Component",i=f(n),p=(0,r.Z)({},M,{getDisplayName:f,methodName:S,renderCountProp:C,shouldHandleStateChanges:P,storeKey:N,displayName:i,wrappedComponentName:n,WrappedComponent:e}),_=M.pure;var w=_?a.useMemo:function(t){return t()};function O(n){var i=(0,a.useMemo)((function(){var t=n.reactReduxForwardedRef,e=(0,o.Z)(n,d);return[n.context,t,e]}),[n]),u=i[0],f=i[1],_=i[2],S=(0,a.useMemo)((function(){return u&&u.Consumer&&(0,s.isContextConsumer)(c().createElement(u.Consumer,null))?u:D}),[u,D]),O=(0,a.useContext)(S),C=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(O)&&Boolean(O.store);var E=C?n.store:O.store,k=(0,a.useMemo)((function(){return function(e){return t(e.dispatch,p)}(E)}),[E]),N=(0,a.useMemo)((function(){if(!P)return h;var t=(0,l.X)(E,C?null:O.subscription),e=t.notifyNestedSubs.bind(t);return[t,e]}),[E,C,O]),j=N[0],T=N[1],R=(0,a.useMemo)((function(){return C?O:(0,r.Z)({},O,{subscription:j})}),[C,O,j]),A=(0,a.useReducer)(y,v,x),M=A[0][0],U=A[1];if(M&&M.error)throw M.error;var $=(0,a.useRef)(),F=(0,a.useRef)(_),L=(0,a.useRef)(),I=(0,a.useRef)(!1),Z=w((function(){return L.current&&_===F.current?L.current:k(E.getState(),_)}),[E,M,_]);m(b,[F,$,I,_,Z,L,T]),m(g,[P,E,j,k,F,$,I,L,T,U],[E,j,k]);var H=(0,a.useMemo)((function(){return c().createElement(e,(0,r.Z)({},Z,{ref:f}))}),[f,e,Z]);return(0,a.useMemo)((function(){return P?c().createElement(S.Provider,{value:R},H):H}),[S,H,R])}var E=_?c().memo(O):O;if(E.WrappedComponent=e,E.displayName=O.displayName=i,T){var k=c().forwardRef((function(t,e){return c().createElement(E,(0,r.Z)({},t,{reactReduxForwardedRef:e}))}));return k.displayName=i,k.WrappedComponent=e,u()(k,e)}return u()(E,e)}}},1479:(t,e,n)=>{"use strict";n.d(e,{Z:()=>v});var r=n(255),o=n(7921),i=n(5642),u=n(8588),a=n(2320),c=n(2004),s=n(4769),l=n(8164),f=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function p(t,e,n){for(var r=e.length-1;r>=0;r--){var o=e[r](t);if(o)return o}return function(e,r){throw new Error("Invalid value of type "+typeof t+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function _(t,e){return t===e}function d(t){var e=void 0===t?{}:t,n=e.connectHOC,d=void 0===n?i.Z:n,v=e.mapStateToPropsFactories,h=void 0===v?c.ZP:v,y=e.mapDispatchToPropsFactories,m=void 0===y?a.ZP:y,b=e.mergePropsFactories,g=void 0===b?s.ZP:b,x=e.selectorFactory,w=void 0===x?l.ZP:x;return function(t,e,n,i){void 0===i&&(i={});var a=i,c=a.pure,s=void 0===c||c,l=a.areStatesEqual,v=void 0===l?_:l,y=a.areOwnPropsEqual,b=void 0===y?u.Z:y,x=a.areStatePropsEqual,S=void 0===x?u.Z:x,O=a.areMergedPropsEqual,C=void 0===O?u.Z:O,E=(0,o.Z)(a,f),P=p(t,h,"mapStateToProps"),k=p(e,m,"mapDispatchToProps"),N=p(n,g,"mergeProps");return d(w,(0,r.Z)({methodName:"connect",getDisplayName:function(t){return"Connect("+t+")"},shouldHandleStateChanges:Boolean(t),initMapStateToProps:P,initMapDispatchToProps:k,initMergeProps:N,pure:s,areStatesEqual:v,areOwnPropsEqual:b,areStatePropsEqual:S,areMergedPropsEqual:C},E))}}const v=d()},2320:(t,e,n)=>{"use strict";n.d(e,{ZP:()=>i});var r=n(7059),o=n(278);const i=[function(t){return"function"==typeof t?(0,o.xv)(t,"mapDispatchToProps"):void 0},function(t){return t?void 0:(0,o.dX)((function(t){return{dispatch:t}}))},function(t){return t&&"object"==typeof t?(0,o.dX)((function(e){return(0,r.Z)(t,e)})):void 0}]},2004:(t,e,n)=>{"use strict";n.d(e,{ZP:()=>o});var r=n(278);const o=[function(t){return"function"==typeof t?(0,r.xv)(t,"mapStateToProps"):void 0},function(t){return t?void 0:(0,r.dX)((function(){return{}}))}]},4769:(t,e,n)=>{"use strict";n.d(e,{ZP:()=>i});var r=n(255);function o(t,e,n){return(0,r.Z)({},n,t,e)}const i=[function(t){return"function"==typeof t?function(t){return function(e,n){n.displayName;var r,o=n.pure,i=n.areMergedPropsEqual,u=!1;return function(e,n,a){var c=t(e,n,a);return u?o&&i(c,r)||(r=c):(u=!0,r=c),r}}}(t):void 0},function(t){return t?void 0:function(){return o}}]},8164:(t,e,n)=>{"use strict";n.d(e,{ZP:()=>a});var r=n(7921),o=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function i(t,e,n,r){return function(o,i){return n(t(o,i),e(r,i),i)}}function u(t,e,n,r,o){var i,u,a,c,s,l=o.areStatesEqual,f=o.areOwnPropsEqual,p=o.areStatePropsEqual,_=!1;function d(o,_){var d,v,h=!f(_,u),y=!l(o,i);return i=o,u=_,h&&y?(a=t(i,u),e.dependsOnOwnProps&&(c=e(r,u)),s=n(a,c,u)):h?(t.dependsOnOwnProps&&(a=t(i,u)),e.dependsOnOwnProps&&(c=e(r,u)),s=n(a,c,u)):y?(d=t(i,u),v=!p(d,a),a=d,v&&(s=n(a,c,u)),s):s}return function(o,l){return _?d(o,l):(a=t(i=o,u=l),c=e(r,u),s=n(a,c,u),_=!0,s)}}function a(t,e){var n=e.initMapStateToProps,a=e.initMapDispatchToProps,c=e.initMergeProps,s=(0,r.Z)(e,o),l=n(t,s),f=a(t,s),p=c(t,s);return(s.pure?u:i)(l,f,p,t,s)}},278:(t,e,n)=>{"use strict";function r(t){return function(e,n){var r=t(e,n);function o(){return r}return o.dependsOnOwnProps=!1,o}}function o(t){return null!==t.dependsOnOwnProps&&void 0!==t.dependsOnOwnProps?Boolean(t.dependsOnOwnProps):1!==t.length}function i(t,e){return function(e,n){n.displayName;var r=function(t,e){return r.dependsOnOwnProps?r.mapToProps(t,e):r.mapToProps(t)};return r.dependsOnOwnProps=!0,r.mapToProps=function(e,n){r.mapToProps=t,r.dependsOnOwnProps=o(t);var i=r(e,n);return"function"==typeof i&&(r.mapToProps=i,r.dependsOnOwnProps=o(i),i=r(e,n)),i},r}}n.d(e,{dX:()=>r,xv:()=>i})},1654:(t,e,n)=>{"use strict";n.d(e,{$j:()=>o.Z,zt:()=>r.Z});var r=n(1290),o=(n(5642),n(373),n(1479));n(7518),n(8882),n(6271)},7518:(t,e,n)=>{"use strict";n(373),n(6271)},2830:(t,e,n)=>{"use strict";n(211),n(373)},8882:(t,e,n)=>{"use strict";n(211),n(2830),n(5053),n(999),n(373)},6271:(t,e,n)=>{"use strict";n(211),n(373),n(2830)},9309:(t,e,n)=>{"use strict";n.d(e,{$j:()=>r.$j,zt:()=>r.zt});var r=n(1654),o=n(9523);(0,n(2935).F)(o.m)},5053:(t,e,n)=>{"use strict";n.d(e,{X:()=>i});var r=n(2935);var o={notify:function(){},get:function(){return[]}};function i(t,e){var n,i=o;function u(){c.onStateChange&&c.onStateChange()}function a(){var o,a,c;n||(n=e?e.addNestedSub(u):t.subscribe(u),o=(0,r.k)(),a=null,c=null,i={clear:function(){a=null,c=null},notify:function(){o((function(){for(var t=a;t;)t.callback(),t=t.next}))},get:function(){for(var t=[],e=a;e;)t.push(e),e=e.next;return t},subscribe:function(t){var e=!0,n=c={callback:t,next:null,prev:c};return n.prev?n.prev.next=n:a=n,function(){e&&null!==a&&(e=!1,n.next?n.next.prev=n.prev:c=n.prev,n.prev?n.prev.next=n.next:a=n.next)}}})}var c={addNestedSub:function(t){return a(),i.subscribe(t)},notifyNestedSubs:function(){i.notify()},handleChangeWrapper:u,isSubscribed:function(){return Boolean(n)},trySubscribe:a,tryUnsubscribe:function(){n&&(n(),n=void 0,i.clear(),i=o)},getListeners:function(){return i}};return c}},2935:(t,e,n)=>{"use strict";n.d(e,{F:()=>o,k:()=>i});var r=function(t){t()},o=function(t){return r=t},i=function(){return r}},7059:(t,e,n)=>{"use strict";function r(t,e){var n={},r=function(r){var o=t[r];"function"==typeof o&&(n[r]=function(){return e(o.apply(void 0,arguments))})};for(var o in t)r(o);return n}n.d(e,{Z:()=>r})},9523:(t,e,n)=>{"use strict";n.d(e,{m:()=>r.unstable_batchedUpdates});var r=n(211)},8588:(t,e,n)=>{"use strict";function r(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function o(t,e){if(r(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),o=Object.keys(e);if(n.length!==o.length)return!1;for(var i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(e,n[i])||!r(t[n[i]],e[n[i]]))return!1;return!0}n.d(e,{Z:()=>o})},999:(t,e,n)=>{"use strict";n.d(e,{L:()=>o});var r=n(211),o="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect},835:(t,e,n)=>{"use strict";n.d(e,{MT:()=>s,UY:()=>l,md:()=>p});var r=n(8617);function o(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var i="function"==typeof Symbol&&Symbol.observable||"@@observable",u=function(){return Math.random().toString(36).substring(7).split("").join(".")},a={INIT:"@@redux/INIT"+u(),REPLACE:"@@redux/REPLACE"+u(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+u()}};function c(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function s(t,e,n){var r;if("function"==typeof e&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(o(0));if("function"==typeof e&&void 0===n&&(n=e,e=void 0),void 0!==n){if("function"!=typeof n)throw new Error(o(1));return n(s)(t,e)}if("function"!=typeof t)throw new Error(o(2));var u=t,l=e,f=[],p=f,_=!1;function d(){p===f&&(p=f.slice())}function v(){if(_)throw new Error(o(3));return l}function h(t){if("function"!=typeof t)throw new Error(o(4));if(_)throw new Error(o(5));var e=!0;return d(),p.push(t),function(){if(e){if(_)throw new Error(o(6));e=!1,d();var n=p.indexOf(t);p.splice(n,1),f=null}}}function y(t){if(!c(t))throw new Error(o(7));if(void 0===t.type)throw new Error(o(8));if(_)throw new Error(o(9));try{_=!0,l=u(l,t)}finally{_=!1}for(var e=f=p,n=0;n<e.length;n++){(0,e[n])()}return t}return y({type:a.INIT}),(r={dispatch:y,subscribe:h,getState:v,replaceReducer:function(t){if("function"!=typeof t)throw new Error(o(10));u=t,y({type:a.REPLACE})}})[i]=function(){var t,e=h;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new Error(o(11));function n(){t.next&&t.next(v())}return n(),{unsubscribe:e(n)}}})[i]=function(){return this},t},r}function l(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var i=e[r];0,"function"==typeof t[i]&&(n[i]=t[i])}var u,c=Object.keys(n);try{!function(t){Object.keys(t).forEach((function(e){var n=t[e];if(void 0===n(void 0,{type:a.INIT}))throw new Error(o(12));if(void 0===n(void 0,{type:a.PROBE_UNKNOWN_ACTION()}))throw new Error(o(13))}))}(n)}catch(t){u=t}return function(t,e){if(void 0===t&&(t={}),u)throw u;for(var r=!1,i={},a=0;a<c.length;a++){var s=c[a],l=n[s],f=t[s],p=l(f,e);if(void 0===p){e&&e.type;throw new Error(o(14))}i[s]=p,r=r||p!==f}return(r=r||c.length!==Object.keys(t).length)?i:t}}function f(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}function p(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return function(){var n=t.apply(void 0,arguments),i=function(){throw new Error(o(15))},u={getState:n.getState,dispatch:function(){return i.apply(void 0,arguments)}},a=e.map((function(t){return t(u)}));return i=f.apply(void 0,a)(n.dispatch),(0,r.Z)((0,r.Z)({},n),{},{dispatch:i})}}}},4274:t=>{"use strict";function e(t,n){var r;if(Array.isArray(n))for(r=0;r<n.length;r++)e(t,n[r]);else for(r in n)t[r]=(t[r]||[]).concat(n[r])}t.exports=function(t){var n,r={};return e(r,t),(n=function(t){return function(e){return function(n){var o,i,u=r[n.type],a=e(n);if(u)for(o=0;o<u.length;o++)(i=u[o](n,t))&&t.dispatch(i);return a}}}).effects=r,n}},3191:t=>{"use strict";var e=256,n=[],r=window,o=Math.pow(e,6),i=Math.pow(2,52),u=2*i,a=255,c=Math.random;function s(t){var n,r=t.length,o=this,i=0,u=o.i=o.j=0,c=o.S=[];for(r||(t=[r++]);i<e;)c[i]=i++;for(i=0;i<e;i++)c[i]=c[u=a&u+t[i%r]+(n=c[i])],c[u]=n;(o.g=function(t){for(var n,r=0,i=o.i,u=o.j,c=o.S;t--;)n=c[i=a&i+1],r=r*e+c[a&(c[i]=c[u=a&u+n])+(c[u]=n)];return o.i=i,o.j=u,r})(e)}function l(t,e){var n,r=[],o=(typeof t)[0];if(e&&"o"==o)for(n in t)try{r.push(l(t[n],e-1))}catch(t){}return r.length?r:"s"==o?t:t+"\0"}function f(t,e){for(var n,r=t+"",o=0;o<r.length;)e[a&o]=a&(n^=19*e[a&o])+r.charCodeAt(o++);return p(e)}function p(t){return String.fromCharCode.apply(0,t)}t.exports=function(a,c){if(c&&!0===c.global)return c.global=!1,Math.random=t.exports(a,c),c.global=!0,Math.random;var _=[],d=(f(l(c&&c.entropy||!1?[a,p(n)]:0 in arguments?a:function(t){try{return r.crypto.getRandomValues(t=new Uint8Array(e)),p(t)}catch(t){return[+new Date,r,r.navigator&&r.navigator.plugins,r.screen,p(n)]}}(),3),_),new s(_));return f(p(d.S),n),function(){for(var t=d.g(6),n=o,r=0;t<i;)t=(t+r)*e,n*=e,r=d.g(1);for(;t>=u;)t/=2,n/=2,r>>>=1;return(t+r)/n}},t.exports.resetGlobal=function(){Math.random=c},f(Math.random(),n)},4553:t=>{var e=/<\/?([a-z][a-z0-9]*)\b[^>]*>?/gi;t.exports=function(t){return(t=t||"").replace(e,"").trim()}},9353:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});class r{constructor(t=0,e=0){this.first=null,this.items=Object.create(null),this.last=null,this.max=t,this.size=0,this.ttl=e}has(t){return t in this.items}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(t){if(this.has(t)){const e=this.items[t];delete this.items[t],this.size--,null!==e.prev&&(e.prev.next=e.next),null!==e.next&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),this.last===e&&(this.last=e.prev)}return this}evict(){const t=this.first;return delete this.items[t.key],this.first=t.next,this.first.prev=null,this.size--,this}get(t){let e;if(this.has(t)){const n=this.items[t];this.ttl>0&&n.expiry<=(new Date).getTime()?this.delete(t):(e=n.value,this.set(t,e,!0))}return e}keys(){return Object.keys(this.items)}set(t,e,n=!1){let r;if(n||this.has(t)){if(r=this.items[t],r.value=e,!1===n&&(r.expiry=this.ttl>0?(new Date).getTime()+this.ttl:this.ttl),this.last!==r){const t=this.last,e=r.next,n=r.prev;this.first===r&&(this.first=r.next),r.next=null,r.prev=this.last,t.next=r,null!==n&&(n.next=e),null!==e&&(e.prev=n)}}else this.max>0&&this.size===this.max&&this.evict(),r=this.items[t]={expiry:this.ttl>0?(new Date).getTime()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e},1==++this.size?this.first=r:this.last.next=r;return this.last=r,this}}function o(t=1e3,e=0){if(isNaN(t)||t<0)throw new TypeError("Invalid max value");if(isNaN(e)||e<0)throw new TypeError("Invalid ttl value");return new r(t,e)}},2674:t=>{function e(){return t.exports=e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(this,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},2650:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(9800);function o(t,e,n){return(e=(0,r.Z)(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},255:(t,e,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r.apply(this,arguments)}n.d(e,{Z:()=>r})},8617:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(2650);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},7921:(t,e,n)=>{"use strict";function r(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}n.d(e,{Z:()=>r})},8191:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(7381);function o(t,e){if("object"!=(0,r.Z)(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=(0,r.Z)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}},9800:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(7381),o=n(8191);function i(t){var e=(0,o.Z)(t,"string");return"symbol"==(0,r.Z)(e)?e:String(e)}},7381:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}n.d(e,{Z:()=>r})}}]);jp-search.defaultVendors.js.LICENSE.txt                                                                                                                                                                                                                        614           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/build/instant-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/

/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
jp-search.js                                                                                                                                                                                                                                                   6881          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/build/instant-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (()=>{var e,t,r,a,n,o={9755:(e,t,r)=>{"use strict";r.d(t,{AG:()=>g,Bk:()=>n,LI:()=>f,LO:()=>l,Ov:()=>s,PP:()=>w,Pz:()=>u,Qy:()=>c,TZ:()=>h,VB:()=>d,W1:()=>o,aP:()=>b,bk:()=>_,kQ:()=>v,oy:()=>p,rs:()=>k,yb:()=>m,zg:()=>i});var a=r(5736);const __=a.__,n="__NO_GROUP__",o="JetpackInstantSearchOptions",i="jetpack-instant-search__overlay",s="jetpack-instant-search__search-results",c=70,l="jetpack-instant-search__box-input",d="jetpack-instant-search__overlay-focus-anchor",p="ASC",u="expanded",h="minimal",f="product",g=6e4,w="relevance",m=1e3,v=["newest","oldest",w,"price_asc","price_desc","rating_desc"],_=[u,h,f],b=new Map([[w,__("Relevance","jetpack-search-pkg")],["newest",__("Newest","jetpack-search-pkg")],["oldest",__("Oldest","jetpack-search-pkg")]]),k=new Map([["price_asc",__("Price: low to high","jetpack-search-pkg")],["price_desc",__("Price: high to low","jetpack-search-pkg")],["rating_desc",__("Rating","jetpack-search-pkg")]])},4184:(e,t,r)=>{"use strict";r.d(t,{Em:()=>i,bS:()=>o,vJ:()=>s});var a=r(9755);const n=new Map([["jetpack_search_color_theme","colorTheme"],["jetpack_search_enable_sort","enableSort"],["jetpack_search_highlight_color","highlightColor"],["jetpack_search_inf_scroll","enableInfScroll"],["jetpack_search_filtering_opens_overlay","enableFilteringOpensOverlay"],["jetpack_search_show_post_date","enablePostDate"],["jetpack_search_overlay_trigger","overlayTrigger"],["jetpack_search_show_powered_by","showPoweredBy"],["jetpack_search_result_format","resultFormat"]]);function o(){return"function"==typeof window?.wp?.customize}function i(e){o()&&window.addEventListener("message",(t=>{t.data&&t.target===window&&"jetpackSearchSectionOpen"===t.data?.key&&"expanded"in t.data&&e(t.data.expanded)}))}function s(e){o()&&n.forEach(((t,r)=>{window.wp.customize(r,(r=>{r.bind((function(r){const n={[t]:r};window[a.W1].showResults=!0,window[a.W1].overlayOptions={...window[a.W1].overlayOptions,...n},e&&e(n)}))}))}))}},554:(e,t,r)=>{r.p=window.JetpackInstantSearchOptions.webpackPublicPath},5736:e=>{"use strict";e.exports=window.wp.i18n},5417:e=>{"use strict";e.exports=window.wp.jpI18nLoader},6483:e=>{"use strict";e.exports=window.wp.url}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}};return o[e](r,r.exports,s),r.exports}s.m=o,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,r)=>(s.f[r](e,t),t)),[])),s.u=e=>({303:"jp-search.defaultVendors",613:"jp-search.chunk-main-payload"}[e]+".js?minify=false&ver="+{303:"80075e4517a23e15184e",613:"31192f0f7da170d807e1"}[e]),s.miniCssF=e=>"jp-search.chunk-main-payload.css?minify=false&ver=8974e0d29b5e5c14f39c",(()=>{if(!s.miniCssF)throw new Error("MiniCSSWithRTLPlugin was loaded before MiniCSSExtractPlugin");var e;s.miniCssF=(e=s.miniCssF,t=>{var r="rtl"===document.dir,a=e(t);return r?a.replace(/\.css(?:$|\?)/,".rtl$&"):a})})(),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="jetpack-search:",s.l=(r,a,n,o)=>{if(e[r])e[r].push(a);else{var i,c;if(void 0!==n)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var p=l[d];if(p.getAttribute("src")==r||p.getAttribute("data-webpack")==t+n){i=p;break}}i||(c=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.setAttribute("data-webpack",t+n),i.src=r),e[r]=[a];var u=(t,a)=>{i.onerror=i.onload=null,clearTimeout(h);var n=e[r];if(delete e[r],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((e=>e(a))),t)return t(a)},h=setTimeout(u.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=u.bind(null,i.onerror),i.onload=u.bind(null,i.onload),c&&document.head.appendChild(i)}},r={613:0},s.f.wpI18n=(e,t)=>{r[e]?t.push(r[e]):0===r[e]&&t.push(r[e]=(e=>{var t=s(5417);return t&&t.downloadI18n?t.downloadI18n("build/instant-search/"+s.u(e),"jetpack-search-pkg","plugin"):Promise.reject(new Error("I18n loader is not available. Check that WordPress is exporting wp.jpI18nLoader."))})(e).then((()=>{r[e]=!1}),(t=>{r[e]=0,console.error("Failed to fetch i18n data: ",t)})))},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),a=e=>new Promise(((t,r)=>{var a=s.miniCssF(e),n=s.p+a;if(((e,t)=>{for(var r=document.getElementsByTagName("link"),a=0;a<r.length;a++){var n=(i=r[a]).getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(n===e||n===t))return i}var o=document.getElementsByTagName("style");for(a=0;a<o.length;a++){var i;if((n=(i=o[a]).getAttribute("data-href"))===e||n===t)return i}})(a,n))return t();((e,t,r,a)=>{var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.onerror=n.onload=o=>{if(n.onerror=n.onload=null,"load"===o.type)r();else{var i=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=i,c.request=s,n.parentNode.removeChild(n),a(c)}},n.href=t,document.head.appendChild(n)})(e,n,t,r)})),n={942:0},s.f.miniCss=(e,t)=>{n[e]?t.push(n[e]):0!==n[e]&&{613:1}[e]&&t.push(n[e]=a(e).then((()=>{n[e]=0}),(t=>{throw delete n[e],t})))},(()=>{var e={942:0};s.f.j=(t,r)=>{var a=s.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var n=new Promise(((r,n)=>a=e[t]=[r,n]));r.push(a[2]=n);var o=s.p+s.u(t),i=new Error;s.l(o,(r=>{if(s.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var n=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+n+": "+o+")",i.name="ChunkLoadError",i.type=n,i.request=o,a[1](i)}}),"chunk-"+t,t)}};var t=(t,r)=>{var a,n,[o,i,c]=r,l=0;if(o.some((t=>0!==e[t]))){for(a in i)s.o(i,a)&&(s.m[a]=i[a]);if(c)c(s)}for(t&&t(r);l<o.length;l++)n=o[l],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0},r=globalThis.webpackChunkjetpack_search=globalThis.webpackChunkjetpack_search||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";s(554);var e=s(9755),t=s(4184);function r(){Promise.all([s.e(303),s.e(613)]).then(s.bind(s,1559)).then((e=>e.initialize()))}window[e.W1]&&(0,t.vJ)(),"loading"!==document.readyState?r():document.addEventListener("DOMContentLoaded",r)})()})();CHANGELOG.md                                                                                                                                                                                                                                                   36934         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/)
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [0.43.4] - 2024-03-04
### Changed
- Update dependencies. [#36113]
- Updated package dependencies.

## [0.43.3] - 2024-02-27
### Changed
- Update dependencies. [#35170]

## [0.43.2] - 2024-02-19
### Changed
- Internal updates.

## [0.43.1] - 2024-02-13
### Changed
- Updated package dependencies. [#35608]

## [0.43.0] - 2024-02-05
### Changed
- Updated package dependencies. [#35384]
- Updated package dependencies. [#35385]
- Use blog ID instead of site slug in checkout links. [#35000]

## [0.42.1] - 2024-01-29
### Changed
- Update dependencies. [#35170]

## [0.42.0] - 2024-01-25
### Added
- Add price and rating to default sort options. [#35167]

## [0.41.1] - 2024-01-22
### Changed
- Update dependencies. [#35117]

## [0.41.0] - 2024-01-04
### Added
- Search: Add a filter to prevent tracking cookie reset. [#34803]

### Changed
- Updated package dependencies. [#34815]

## [0.40.4] - 2023-12-20
### Changed
- Updated package dependencies. [#34694]

## [0.40.3] - 2023-12-11
### Changed
- Updated package dependencies. [#34416]

## [0.40.2] - 2023-12-03
### Changed
- Updated package dependencies. [#34411] [#34427]

### Fixed
- Instant Search: Fixed the title layout for product layout. [#34263]

## [0.40.1] - 2023-11-24
### Changed
- Replaced usage of strpos() with str_contains(). [#34137]
- Replaced usage of substr() with str_starts_with() and str_ends_with(). [#34207]

## [0.40.0] - 2023-11-20
### Changed
- Replaced usage of strpos() with str_starts_with(). [#34135]
- Updated required PHP version to >= 7.0. [#34192]

## [0.39.7] - 2023-11-14
### Changed
- Updated package dependencies. [#34093]

## [0.39.6] - 2023-11-13
### Fixed
- Switched to classic search for iOS 15 or lower. [#33929]

## [0.39.5] - 2023-11-03

## [0.39.4] - 2023-10-30
### Changed
- Instant Search: rely on browsers' native lazy loading functionality when we want to lazy load images. [#33817]

## [0.39.3] - 2023-10-23
### Changed
- Updated package dependencies. [#33646] [#33687]

## [0.39.2] - 2023-10-16
### Added
- Added HEIC (`*.heic`) to list of images types allowed to be passed through Photon during instant search. [#33494]

### Changed
- Updated package dependencies. [#33429, #33569]

### Fixed
- Search: Fixed excluded types option is not available under certain circumstances. [#33548]

## [0.39.1] - 2023-10-10
### Changed
- Updated package dependencies. [#33428]

## [0.39.0] - 2023-10-03
### Added
- Add a setting for Jetpack AI Search [#33432]

## [0.38.8] - 2023-09-19
### Changed
- Updated Jetpack submenu sort order so individual features are alpha-sorted. [#32958]
- Updated package dependencies. [#33001]

## [0.38.7] - 2023-09-11
### Changed
- General: remove WP 6.1 backwards compatibility checks [#32772]

## [0.38.6] - 2023-09-04
### Changed
- Updated package dependencies. [#32803]
- Updated package dependencies. [#32804]

## [0.38.5] - 2023-08-28
### Changed
- Updated package dependencies. [#32605]

## [0.38.4] - 2023-08-21
### Changed
- Use the new method to render Connection initial state. [#32499]

## [0.38.3] - 2023-08-09
### Changed
- Updated package dependencies. [#32166]

## [0.38.2] - 2023-07-25
### Changed
- Updated package dependencies. [#31923]
- Updated package dependencies. [#32040]
- Update props passed to JetpackFooter [#31627]

## [0.38.1] - 2023-07-17
### Changed
- Updated package dependencies. [#31785]

## [0.38.0] - 2023-07-10
### Removed
- Disable Customizer integration for Instant Search if the site is using a block-based theme [#31731]

## [0.37.4] - 2023-07-05
### Changed
- Updated package dependencies. [#31659]

## [0.37.3] - 2023-06-26
### Changed
- Updated package dependencies. [#31468]

## [0.37.2] - 2023-06-06
### Changed
- Updated package dependencies. [#31129]

## [0.37.1] - 2023-05-22
### Changed
- PHP Compatibility: fix dynamic property deprecation notices [#30786]

## [0.37.0] - 2023-05-15
### Added
- Jetpack Search: add "Open overlay from filter links" option, which allows users to enable/disable the opening of the search overlay when filtering from a separate widget outside of the Jetpack Search Sidebar [#30455]

### Changed
- PHP 8.1 compatibility updates [#30564]

## [0.36.3] - 2023-05-02
### Changed
- Updated package dependencies.

## [0.36.2] - 2023-05-01
### Changed
- Internal updates.

## [0.36.1] - 2023-04-25

- Minor internal updates.

## [0.36.0] - 2023-04-17
### Added
- Search: Restore Tracks to Instant Search [#29979]

### Changed
- Updated package dependencies. [#30019]

## [0.35.0] - 2023-04-10
### Added
- Add Jetpack Autoloader package suggestion. [#29988]
- Implemented a "tabbed" variation for static filters. This adds tabs on top of the results for each filter group. [#29811]

## [0.34.4] - 2023-04-04
### Changed
- Updated package dependencies. [#29854, #29857]

## [0.34.3] - 2023-04-03
### Changed
- Internal updates.

## [0.34.2] - 2023-03-28
### Changed
- Minor internal updates.

## [0.34.1] - 2023-03-27
### Added
- (Backup, Boost, Search, Social) Add links on upgrade pages to activate a license key, if you already have one. [#29443]

### Changed
- Updated package dependencies. [#29632]

## [0.34.0] - 2023-03-20
### Changed
- Updated package dependencies. [#29471]

### Removed
- Remove Tracks from Instant Search [#29490]

## [0.33.3] - 2023-03-13
### Fixed
- Search Dashboard: fix wrong return URL when site already has a valid subscription [#29409]

## [0.33.2] - 2023-03-08
### Changed
- Updated package dependencies. [#29216]

### Fixed
- Fix bad check against isMultiSite resulting in extended search format not showing expected additional post details. [#29179]

## [0.33.1] - 2023-02-28
### Added
- Search: Add JITM container [#29106]

### Changed
- Updated package dependencies.

### Fixed
- Fix CSS for products in search results [#29110]

## [0.33.0] - 2023-02-20
### Added
- Adds a "show post date" selector to Search customberg, allows non-multisite sites to show the post date in the "expanded" search result format. [#28918]

### Fixed
- Fixed unit tests without internet [#28985]
- Separated authors by comments if there are multiple authors in a search result [#28975]

## [0.32.0] - 2023-02-15
### Added
- Search: Adds assigned post categories as classnames to search results [#28816]

### Changed
- Update to React 18. [#28710]

## [0.31.7] - 2023-02-08
### Changed
- Updated package dependencies. [#28682]

## [0.31.6] - 2023-01-30
### Changed
- Increased Jetpack Search filters caching from one hour to four hours [#28632]

## [0.31.5] - 2023-01-26
### Changed
- Minor internal updates.

## [0.31.4] - 2023-01-23
### Changed
- Start using utilities from Status package to detect whether a site is private or "coming-soon" (unlaunched). [#28328]

### Fixed
- Clean up JavaScript eslint issues. [#28441]

## [0.31.3] - 2023-01-11
### Changed
- Updated package dependencies.

## [0.31.2] - 2022-12-19
### Changed
- Updated package dependencies. [#27887, #27916, #27962]

### Fixed
- Declare field `REST_Controller->plan`. [#27949]
- Improve PHP 8.2 compatibility. [#27968]

## [0.31.1] - 2022-12-06
### Changed
- Updated package dependencies. [#27340, #27688, #27696, #27697]

## [0.31.0] - 2022-11-28
### Added
- Add an optional global flag that prevents instant search from modifying the url as the search query is being written or modified. [#27264]
- Add prompt for Jetpack Search Free plan upgrade for users who exceed limits. [#27462]
- Search: Add checkmark icon for resolved topics [#27586]

### Changed
- Suggest free Jetpack Search plan instead of the paid one to classic search users [#27372]
- Updated package dependencies. [#26069]

## [0.30.2] - 2022-11-10
### Changed
- Updated package dependencies. [#27319]

### Fixed
- Jetpack Search: Fixed link to language support documentation [#27287]

## [0.30.1] - 2022-11-07
### Changed
- Updated package dependencies. [#27278]

## [0.30.0] - 2022-11-01
### Added
- Search: add blog ID filtering and `blogIdFilteringLabels` option [#27120]

### Changed
- Updated package dependencies. [#27089]

## [0.29.2] - 2022-10-26
### Fixed
- Search: Fix typo in CTA [#27044]
- Search: hide meters etc for Classic Search [#27073]

## [0.29.1] - 2022-10-25
### Added
- Search: add purchase tracking [#26981]

### Changed
- Search: now support 38 languages [#27025]
- Tweak colophon link to Search upgrade page [#26952]
- Updated package dependencies. [#26705]

### Fixed
- Hide Jetpack logo toggle, enforce display for free plans [#26951]
- Search: Hide post-purchase tooltips for free plan activation [#26953]

## [0.29.0] - 2022-10-19
### Added
- Search: enable new pricing if pricing_version is set to 202208 from API [#26900]

### Changed
- Updated package dependencies. [#26808]
- Use API values for paid allowance limits shown in the new pricing table [#26895]

## [0.28.0] - 2022-10-17
### Changed
- Check free plan by product_slug and disable Module Control only on free plan. [#26849]
- Fetch checkoutProductUrl for upgrade flow redirection. [#26848]
- Introduce GET param just_upgraded and localStorage upgrade_tooltip_finished to determine the tooltips showing. [#26828]
- Refactor upgrade tooltips. [#26851]
- Search: always add Search Dashboard page even when submenu is hidden [#26807]
- Search Dashboard: Add missing CTAs and associated logic. [#26852]
- Search Dashboard: Add siteTitle to plugin/package data. [#26816]
- Search Dashboard: Better handling of "Unlimited" requests. [#26813]
- Search Dashboard: Disable adaptive colors for Unlimited requests state. [#26850]
- Search Dashboard: Fix responsive layouts for usage meters. [#26815]
- Search Dashboard: Remove code duplication for support link. [#26811]
- Search Dashboard: Update Plan Usage section to remove info icons. [#26812]
- Updated package dependencies. [#26851]
- Use adaptive coloring for donut meters in search dashboard [#26847]

## [0.27.0] - 2022-10-13
### Added
- Add connection error notice to the Search plugin. [#26778]
- Introduce shadowed IconTooltips to tooltips for highlighting upgraded usage limits. [#26790]

### Changed
- Add upgrade button link with applying upgrade actions. [#26737]
- Search Dashboard: Update Plan Usage section to more closely match design. [#26783]
- Updated package dependencies. [#26790]

### Fixed
- Search: wpcom sites should not be considered as connected [#26835]

## [0.26.0] - 2022-10-11
### Added
- Search Dashboard: Add support for conditional CUTs. [#26656]

### Changed
- Apply ContextualUpgradeTrigger with checkout CTA [#26633]
- Apply tier and latest month usage to plan summary [#26695]
- Apply upgrade trigger displaying conditions and messages from API data [#26712]
- Stop controls when usage over plan limit months. [#26732]
- Updated package dependencies. [#26640]

### Fixed
- Fixed search dashboard for simple sites. [#26713]
- Search Dashboard: Add support link for plan limits. [#26694]
- Search Dashboard: Refactoring of new UI components. [#26723]
- Search Dashboard: Rename variables to avoid jargon. [#26691]

## [0.25.0] - 2022-10-05
### Added
- Added string translations used for the new pricing table [#26595]
- Components: Added UsageMeter along with DonutMeterContainer JS component. [#26344]
- Search: add post type breakdown endpoint [#26463]

### Changed
- Apply JetpackSearchLogo and replace footer link to upsell page [#26481]
- Search: add connection support for new pricing page [#26573]
- Search Dashboard: Added first run and usage section components. [#26639]
- Updated package dependencies. [#26457]
- Use library method for number formatting. [#26636]

### Fixed
- Search: fix redirection after purchase [#26598]

## [0.24.0] - 2022-10-03
### Changed
- Fix styles of Control components on page side to avoid deprecating component styles affecting. [#26567]

## [0.23.0] - 2022-09-27
### Added
- Added stories for the NoticeBox component [#26367]
- Search: added free_tier and new_pricing_202208 to gate new pricing features [#26338]

### Changed
- Introduce PricingTable to update Upsell page [#26408]
- Move JetpackColophon to bottom of SearchResults [#26320]
- Updated mentions of "Search" with "Jetpack Search" as part of rebranding project [#26410]
- Updated package dependencies.

### Fixed
- Fix error message styling in Instant Search overlay. [#26339]

## [0.22.2] - 2022-09-20
### Changed
- Updated package dependencies.

### Fixed
- Fixes the issue where search results are not loaded in customizer [#26212]

## [0.22.1] - 2022-09-13
### Changed
- Updated package dependencies. [#26176]

## [0.22.0] - 2022-09-08
### Added
- Search: added support to search through multiple sites [#26046]

### Changed
- Updated package dependencies.

### Fixed
- Instant Search: Update CSS styles to removes uses of "!important" where possible. [#25825]
- Search: Allow non-owner admins to see search dashboard [#26100]
- Search: fixed Automattic link in footer when Jetpack plugin does not exist [#26045]

## [0.21.1] - 2022-08-30
### Added
- Instant Search: add focus border to search input field [#25304]

### Changed
- Updated package dependencies. [#25694]

### Fixed
- Keep widget preview with settings [#25778]

## [0.21.0] - 2022-08-25
### Changed
- Search: revert "Search should not require user connection" [#25802]
- Updated package dependencies. [#25814]

## [0.20.0] - 2022-08-23
### Added
- Add author filtering support [#25409]

### Changed
- Updated package dependencies. [#25338, #25339, #25377, #25628, #25762, #25769]

### Fixed
- Instant Search: Add focus styles for easier keyboard navigation. (a11y) [#25671]
- Instant Search: Remove redundant links from search results. (a11y) [#25699]

## [0.19.0] - 2022-08-16
### Added
- Instant Search: always use submit overlay trigger if user prefers reduced motion. [#25413]
- Instant Search: only show animation to users who have not chosen reduced motion. [#25630]
- Instant Search: user friendly error messaging. [#25433]

### Fixed
- Instant Search: fix button styling in Twenty Twenty One theme. [#25631]
- Instant Search: fix the display order on mobile to match the tab order. [#25415]
- Instant Search: use classname rather than ID for styling sort select. [#25632]

## [0.18.0] - 2022-08-09
### Added
- Search: added proper error messages for search module control [#24476]

### Changed
- Instant Search: Updates dark mode active link color for increased contrast [#25343]
- Search: changed to only require site level connection [#24477]
- Updated package dependencies. [#24477, #25265]

### Removed
- Search: remove 'results' overlay trigger [#25393]

### Fixed
- Dashboard: updated Instant Search description to match changes in default overlay trigger [#25303]
- Instant Search: Constrain tab loop to overlay when visible. [#25288]
- Instant Search: Make "Clear filters" button accessible. [#25342]

## [0.17.1] - 2022-08-03
### Added
- Instant Search: Adds descriptions to post type icons for accessibility purposes [#25323]
- Record Meter: add info link to docs [#25002]

### Changed
- Updated package dependencies. [#25300, #25315]

### Fixed
- Instant Search: Improve accessibility of seach options controls.
- Search: ensure overlay trigger is consistent for new installs [#25093]

## [0.17.0] - 2022-07-29
### Added
- Record Meter: make feature available to all users
- Search: re-add 'Media' to 'Excluded Post Types'

## [0.16.2] - 2022-07-26
### Added
- Dashboard: added support WPCOM simple sites [#25094]

### Changed
- Instant search: updates overlay focus elements for design consistency [#25260]
- Updated package dependencies. [#25144]
- Updated package dependencies. [#25147]
- Updated package dependencies. [#25158]

### Fixed
- Instant Search: Fix keyboard handling of sort options. [#25163]
- Instant Search: prevent hidden submit button appearing on focus [#25136]
- Search Dashboard: Fixed layout issues when Hello Dolly plugin is active. [#25139]

## [0.16.1] - 2022-07-19
### Changed
- Updated package dependencies. [#25086]

### Fixed
- Customberg: re-add collapsing wp-admin sidebar to prevent menu overlap issue [#25060]
- Fixed the currency code missing issue for the upsell page [#25068]

## [0.16.0] - 2022-07-12
### Added
- Hide unsupported taxonomies from widget settings [#24823]

### Changed
- Updated package dependencies. [#25055]

### Fixed
- Fix irrelevant widgets in overlay sidebar [#24824]
- Hide 'Media' from 'Excluded Post Types' because we don't index them [#24822]
- Record Meter: rely less on last_indexed_date from API [#24967]
- Use consistent number formatting in Record Meter [#25003]

## [0.15.4] - 2022-07-06
### Added
- Record Meter: adds labels to custom post type breakdown [#24876]

### Changed
- Updated package dependencies. [#24923]

### Removed
- Record Meter: Remove dismissable functionality and design from notice boxes [#24922]

### Fixed
- Reset letter spacing for header tags [#24954]
- Restores support for multiple post types in the Jetpack Search Widget. [#24868]

## [0.15.3] - 2022-06-28
### Changed
- Record meter: format the numbers used in notice. [#24810]
- Record Meter: updated notice box content when site is not indexed [#24785]
- Search: use centralized search pricing API [#24795]
- Updated package dependencies. [#24826]

### Fixed
- Added My Jetpack package as dependency [#24826]

## [0.15.2] - 2022-06-21
### Changed
- Record Meter: Separated component styles [#24732]
- Renaming master to trunk. [#24661]

## [0.15.1] - 2022-06-14
### Changed
- Search record meter: pass sorted records to RecordMeterBar component [#24731]
- Updated package dependencies. [#24529]

## [0.15.0] - 2022-06-08
### Changed
- Record Meter: switches from using chartJS to the Jetpack RecordMeterBar component [#24322]
- Reorder JS imports for `import/order` eslint rule. [#24601]
- Search record meter: changed the notice box to include a header text [#24346]
- Search widget: use 'Search (Jetpack)' as wdiget name and remove `jetpack_widget_name` [#24577]
- Updated package dependencies. [#24510]

### Removed
- Search: don't open modal if only sort parameter is set [#24576]
- Search: Removed unused chart.js library [#24658]

### Fixed
- Search: avoid query on component mount when the overlay might not be visible [#24609]
- Search: fix gridicon color in dark mode on Customberg [#24668]

## [0.14.2] - 2022-05-30
### Changed
- Updated package dependencies
- Updated package dependencies.
- Use the Checkout workflow to establish the connection and make the purchase

### Fixed
- Avoid filter from being added multiple times

## [0.14.1] - 2022-05-24
### Added
- Allow plugins to filter the list of available modules. Only activate and consider active modules that are available [#24454]

### Changed
- Search: Use Modules methods for activating and deactivating the Search module. [#24385]
- Updated package dependencies. [#24449]

## [0.14.0] - 2022-05-19
### Removed
- Search: Disable auto-collapsing the wp-admin sidebar within Customberg [#24399]

## [0.13.4] - 2022-05-18
### Changed
- Adjust translatable string [#24357]
- Record Meter: switch noticebox persistence storage from localStorage to sessionStorage [#24348]
- Record Meter design updates [#24225]
- Search package: search dashboard refactoring [#24266]
- Updated package dependencies. [#23795] [#24153] [#24306] [#24372]

## [0.13.3] - 2022-05-10
### Added
- Add missing JS dep on `core-js`. [#24288]

### Changed
- Search: refactored Settings to expose the settings array for sync [#24167]
- Updated package dependencies. [#24189]
- Updated package dependencies. [#24204]
- Updated package dependencies. [#24302]
- Updated package dependencies [#24276]
- Updated package dependencies [#24296]
- Updated package dependencies [#24301]

### Fixed
- Search: Fix left padding for upsell page [#24285]
- Search: handle tiers without a record limit in Record Meter [#24264]

## [0.13.2] - 2022-05-04
### Added
- Add missing JavaScript dependencies. [#24096]

### Changed
- Remove use of `pnpx` in preparation for pnpm 7.0. [#24210]
- Updated package dependencies. [#24095] [#24230] [#24198] [#24228]

### Deprecated
- Moved the options class into Connection. [#24095]

### Fixed
- Adapt Record Meter to change in API response format [#24107]
- Search: Bundle vendor assets within the main chunk [#24068]
- Search: Fix search for private WoA sites [#24099]
- Search: reset border-radius for search buttons [#24100]

## [0.13.1] - 2022-04-26
### Added
- Search: added upsell page

### Changed
- Updated package dependencies.
- Update package.json metadata.

## [0.13.0] - 2022-04-19
### Added
- Search: add class to retrieve search product information
- Search: Add count estimation function
- Search: added API support for search product tier pricing

### Changed
- PHPCS: Fix `WordPress.Security.ValidatedSanitizedInput`
- Record meter: updates noticeboxes to be dismissable & styled
- Search Record Meter updates formatting
- Use new shared Gridicons component and shared Modules library

## [0.12.3] - 2022-04-12
### Added
- Added deprecated methods as a safety.

### Changed
- Updated package dependencies.

### Fixed
- Search: auto config no longer overrides option if it exists.

## [0.12.2] - 2022-04-06
### Added
- Adds API data to record meter chart.

### Changed
- Janitorial: Refactor classes into shared package.
- Updated package dependencies.

### Removed
- Removed tracking dependency.

### Fixed
- Search: allow Search submenu to be added only once

## [0.12.1] - 2022-03-31
### Fixed
- Search: fixed search submenu is shown because compatibility file is loaded too late.

## [0.12.0] - 2022-03-29
### Added
- Add selector for retrieving last indexed date
- Adds notice box component to record meter
- Search: Migrated tests from Jetpack plugin

### Changed
- Microperformance: Use === null instead of is_null
- Search: connection states
- Updated package dependencies

### Fixed
- Fixed lints found after fixing ESLint config
- Search: address feeback for #23477
- Search: move Jetpack plugin compatibility to the package

## [0.11.3] - 2022-03-24
### Added
- Search: adds a record count above the record meter chart.

### Fixed
- Deactivation: Do not attempt to redirect on a behind-the-scene deactivation.

## [0.11.2] - 2022-03-23
### Added
- adds basic structure for record meter with dummy data

### Changed
- Centralized all intializing logic
- Search dashboard: changed condition to always show dashboard submenu
- Updated package dependencies
- Use Migrated GlotPress locale classes from compat pkg.

### Fixed
- Search: fixed cli and package version reporting broken in #23435

## [0.11.1] - 2022-03-15
### Changed
- Fixed minor product defects
- Search: moved globals to a class for sake of autoloading correctly
- Search package: Updated Gridicon dependancy to use local version
- Updated package dependencies.

## [0.11.0] - 2022-03-08
### Changed
- Components: update attributes used within the Button component to match recent deprecations and changes.
- Move customizer integration into search package
- search: move record meter location on dashboard

### Fixed
- Ensure that WP CLI is present before extending the class.
- Ensure the Customizer classes are loaded.

## [0.10.0] - 2022-03-02
### Added
- Search: add chart.js package to dependencies
- Search: fetch search stats endpoint in wp-admin dashboard

### Changed
- Search: Renamed Customberg class file name
- Updated package dependencies.

### Fixed
- Fix various notices shown for Customberg
- Search package: i18n support for auto added search block label and button

## [0.9.1] - 2022-02-25
### Fixed
- Search: Fixed a regression that prevented modal from being spawned by link clicks

## [0.9.0] - 2022-02-22
### Added
- Bump package versions.
- Search: add stats endpoint to REST controller

### Changed
- Search package: refactor `auto_config_search` and run it from activation API

### Fixed
- Search package: fix auto config doesn't add search input for block themes

## [0.8.0] - 2022-02-16
### Added
- Add babel/runtime to dev dependencies
- Add tier maximum records for Record Meter
- Clicking outside overlay now closes overlay

### Changed
- Change `instance` function for improved compatibility
- Updated package dependencies.

### Fixed
- Form: avoid React warning.
- Improve display of colorpicker in Customberg
- Fixed undefined index features
- Should not exclude widget js in package distribution

## [0.7.0] - 2022-02-09
### Added
- Search Dashboard: add scaffolding for new record meter
- Search package: added auto config CLI

### Changed
- Search: move search widgets to package
- Updated package dependencies

## [0.6.0] - 2022-02-02
### Added
- Add `@use "sass:math"` in base styles scss for upcoming `@wordpress/block-editor` 8.1.0 requirement.
- Search package: added package version number and others

### Changed
- Build: remove unneeded files from production build.
- Instant Search: add image alt text from API
- Updated package dependencies.

## [0.5.4] - 2022-01-31
### Fixed
- Search: Fetch plan info as blog, not as user, to allow nonconnected admins to use dashboard

## [0.5.3] - 2022-01-27
### Fixed
- Search package: fixed compatibility issue with plan activation

## [0.5.2] - 2022-01-25
### Added
- Added a watch command for building assets
- Search E2E: added class names for some form components for easier E2E tests

### Changed
- Search: Improve accessibility via headings hierarchy and aria roles
- Updated package dependencies.

### Fixed
- Search widget: changed fetching search result to just before rendering jp search widget

## [0.5.1] - 2022-01-18
### Changed
- General: update required node version to v16.13.2

## [0.5.0] - 2022-01-11
### Added
- Search: Migrated Classic and Instant Search code from Jetpack plugin.
- Search API: activation and deactivation API.

### Changed
- Search: moved search dashboard to the package.
- Updated package dependencies.

## [0.4.0] - 2022-01-04
### Changed
- Do not escape widget title value
- Switch to pcov for code coverage.
- Updated package dependencies.
- Updated package textdomain from `jetpack` to `jetpack-search-pkg`.

### Fixed
- Add missing textdomains in JS code.

## [0.3.0] - 2021-12-14
### Changed
- Search package: add new methods and update timing for `Plan` class.
- Search package: refactored Module_Control class.

## [0.2.1] - 2021-12-07
### Changed
- Updated package dependencies.

## [0.2.0] - 2021-11-30
### Added
- Added essential scaffolding for package.
- Migrate additional helper classes to package
- Search: added new state store for search dashboard
- Search package: duplicated search dashboard dependencies to the package

### Changed
- Search: migrate/create necessary APIs for the frontend
- Search: removed other dependencies from copied code

## 0.1.0 - 2021-11-09
### Added
- Add a new Search package with Helper and Options classes.
- Search: Migrate helper classes from Jetpack plugin

### Changed
- Set `convertDeprecationsToExceptions` true in PHPUnit config.
- Updated package dependencies.
- Update PHPUnit configs to include just what needs coverage rather than include everything then try to exclude stuff that doesn't.

[0.43.4]: https://github.com/Automattic/jetpack-search/compare/v0.43.3...v0.43.4
[0.43.3]: https://github.com/Automattic/jetpack-search/compare/v0.43.2...v0.43.3
[0.43.2]: https://github.com/Automattic/jetpack-search/compare/v0.43.1...v0.43.2
[0.43.1]: https://github.com/Automattic/jetpack-search/compare/v0.43.0...v0.43.1
[0.43.0]: https://github.com/Automattic/jetpack-search/compare/v0.42.1...v0.43.0
[0.42.1]: https://github.com/Automattic/jetpack-search/compare/v0.42.0...v0.42.1
[0.42.0]: https://github.com/Automattic/jetpack-search/compare/v0.41.1...v0.42.0
[0.41.1]: https://github.com/Automattic/jetpack-search/compare/v0.41.0...v0.41.1
[0.41.0]: https://github.com/Automattic/jetpack-search/compare/v0.40.4...v0.41.0
[0.40.4]: https://github.com/Automattic/jetpack-search/compare/v0.40.3...v0.40.4
[0.40.3]: https://github.com/Automattic/jetpack-search/compare/v0.40.2...v0.40.3
[0.40.2]: https://github.com/Automattic/jetpack-search/compare/v0.40.1...v0.40.2
[0.40.1]: https://github.com/Automattic/jetpack-search/compare/v0.40.0...v0.40.1
[0.40.0]: https://github.com/Automattic/jetpack-search/compare/v0.39.7...v0.40.0
[0.39.7]: https://github.com/Automattic/jetpack-search/compare/v0.39.6...v0.39.7
[0.39.6]: https://github.com/Automattic/jetpack-search/compare/v0.39.5...v0.39.6
[0.39.5]: https://github.com/Automattic/jetpack-search/compare/v0.39.4...v0.39.5
[0.39.4]: https://github.com/Automattic/jetpack-search/compare/v0.39.3...v0.39.4
[0.39.3]: https://github.com/Automattic/jetpack-search/compare/v0.39.2...v0.39.3
[0.39.2]: https://github.com/Automattic/jetpack-search/compare/v0.39.1...v0.39.2
[0.39.1]: https://github.com/Automattic/jetpack-search/compare/v0.39.0...v0.39.1
[0.39.0]: https://github.com/Automattic/jetpack-search/compare/v0.38.8...v0.39.0
[0.38.8]: https://github.com/Automattic/jetpack-search/compare/v0.38.7...v0.38.8
[0.38.7]: https://github.com/Automattic/jetpack-search/compare/v0.38.6...v0.38.7
[0.38.6]: https://github.com/Automattic/jetpack-search/compare/v0.38.5...v0.38.6
[0.38.5]: https://github.com/Automattic/jetpack-search/compare/v0.38.4...v0.38.5
[0.38.4]: https://github.com/Automattic/jetpack-search/compare/v0.38.3...v0.38.4
[0.38.3]: https://github.com/Automattic/jetpack-search/compare/v0.38.2...v0.38.3
[0.38.2]: https://github.com/Automattic/jetpack-search/compare/v0.38.1...v0.38.2
[0.38.1]: https://github.com/Automattic/jetpack-search/compare/v0.38.0...v0.38.1
[0.38.0]: https://github.com/Automattic/jetpack-search/compare/v0.37.4...v0.38.0
[0.37.4]: https://github.com/Automattic/jetpack-search/compare/v0.37.3...v0.37.4
[0.37.3]: https://github.com/Automattic/jetpack-search/compare/v0.37.2...v0.37.3
[0.37.2]: https://github.com/Automattic/jetpack-search/compare/v0.37.1...v0.37.2
[0.37.1]: https://github.com/Automattic/jetpack-search/compare/v0.37.0...v0.37.1
[0.37.0]: https://github.com/Automattic/jetpack-search/compare/v0.36.3...v0.37.0
[0.36.3]: https://github.com/Automattic/jetpack-search/compare/v0.36.2...v0.36.3
[0.36.2]: https://github.com/Automattic/jetpack-search/compare/v0.36.1...v0.36.2
[0.36.1]: https://github.com/Automattic/jetpack-search/compare/v0.36.0...v0.36.1
[0.36.0]: https://github.com/Automattic/jetpack-search/compare/v0.35.0...v0.36.0
[0.35.0]: https://github.com/Automattic/jetpack-search/compare/v0.34.4...v0.35.0
[0.34.4]: https://github.com/Automattic/jetpack-search/compare/v0.34.3...v0.34.4
[0.34.3]: https://github.com/Automattic/jetpack-search/compare/v0.34.2...v0.34.3
[0.34.2]: https://github.com/Automattic/jetpack-search/compare/v0.34.1...v0.34.2
[0.34.1]: https://github.com/Automattic/jetpack-search/compare/v0.34.0...v0.34.1
[0.34.0]: https://github.com/Automattic/jetpack-search/compare/v0.33.3...v0.34.0
[0.33.3]: https://github.com/Automattic/jetpack-search/compare/v0.33.2...v0.33.3
[0.33.2]: https://github.com/Automattic/jetpack-search/compare/v0.33.1...v0.33.2
[0.33.1]: https://github.com/Automattic/jetpack-search/compare/v0.33.0...v0.33.1
[0.33.0]: https://github.com/Automattic/jetpack-search/compare/v0.32.0...v0.33.0
[0.32.0]: https://github.com/Automattic/jetpack-search/compare/v0.31.7...v0.32.0
[0.31.7]: https://github.com/Automattic/jetpack-search/compare/v0.31.6...v0.31.7
[0.31.6]: https://github.com/Automattic/jetpack-search/compare/v0.31.5...v0.31.6
[0.31.5]: https://github.com/Automattic/jetpack-search/compare/v0.31.4...v0.31.5
[0.31.4]: https://github.com/Automattic/jetpack-search/compare/v0.31.3...v0.31.4
[0.31.3]: https://github.com/Automattic/jetpack-search/compare/v0.31.2...v0.31.3
[0.31.2]: https://github.com/Automattic/jetpack-search/compare/v0.31.1...v0.31.2
[0.31.1]: https://github.com/Automattic/jetpack-search/compare/v0.31.0...v0.31.1
[0.31.0]: https://github.com/Automattic/jetpack-search/compare/v0.30.2...v0.31.0
[0.30.2]: https://github.com/Automattic/jetpack-search/compare/v0.30.1...v0.30.2
[0.30.1]: https://github.com/Automattic/jetpack-search/compare/v0.30.0...v0.30.1
[0.30.0]: https://github.com/Automattic/jetpack-search/compare/v0.29.2...v0.30.0
[0.29.2]: https://github.com/Automattic/jetpack-search/compare/v0.29.1...v0.29.2
[0.29.1]: https://github.com/Automattic/jetpack-search/compare/v0.29.0...v0.29.1
[0.29.0]: https://github.com/Automattic/jetpack-search/compare/v0.28.0...v0.29.0
[0.28.0]: https://github.com/Automattic/jetpack-search/compare/v0.27.0...v0.28.0
[0.27.0]: https://github.com/Automattic/jetpack-search/compare/v0.26.0...v0.27.0
[0.26.0]: https://github.com/Automattic/jetpack-search/compare/v0.25.0...v0.26.0
[0.25.0]: https://github.com/Automattic/jetpack-search/compare/v0.24.0...v0.25.0
[0.24.0]: https://github.com/Automattic/jetpack-search/compare/v0.23.0...v0.24.0
[0.23.0]: https://github.com/Automattic/jetpack-search/compare/v0.22.2...v0.23.0
[0.22.2]: https://github.com/Automattic/jetpack-search/compare/v0.22.1...v0.22.2
[0.22.1]: https://github.com/Automattic/jetpack-search/compare/v0.22.0...v0.22.1
[0.22.0]: https://github.com/Automattic/jetpack-search/compare/v0.21.1...v0.22.0
[0.21.1]: https://github.com/Automattic/jetpack-search/compare/v0.21.0...v0.21.1
[0.21.0]: https://github.com/Automattic/jetpack-search/compare/v0.20.0...v0.21.0
[0.20.0]: https://github.com/Automattic/jetpack-search/compare/v0.19.0...v0.20.0
[0.19.0]: https://github.com/Automattic/jetpack-search/compare/v0.18.0...v0.19.0
[0.18.0]: https://github.com/Automattic/jetpack-search/compare/v0.17.1...v0.18.0
[0.17.1]: https://github.com/Automattic/jetpack-search/compare/v0.17.0...v0.17.1
[0.17.0]: https://github.com/Automattic/jetpack-search/compare/v0.16.2...v0.17.0
[0.16.2]: https://github.com/Automattic/jetpack-search/compare/v0.16.1...v0.16.2
[0.16.1]: https://github.com/Automattic/jetpack-search/compare/v0.16.0...v0.16.1
[0.16.0]: https://github.com/Automattic/jetpack-search/compare/v0.15.4...v0.16.0
[0.15.4]: https://github.com/Automattic/jetpack-search/compare/v0.15.3...v0.15.4
[0.15.3]: https://github.com/Automattic/jetpack-search/compare/v0.15.2...v0.15.3
[0.15.2]: https://github.com/Automattic/jetpack-search/compare/v0.15.1...v0.15.2
[0.15.1]: https://github.com/Automattic/jetpack-search/compare/v0.15.0...v0.15.1
[0.15.0]: https://github.com/Automattic/jetpack-search/compare/v0.14.2...v0.15.0
[0.14.2]: https://github.com/Automattic/jetpack-search/compare/v0.14.1...v0.14.2
[0.14.1]: https://github.com/Automattic/jetpack-search/compare/v0.14.0...v0.14.1
[0.14.0]: https://github.com/Automattic/jetpack-search/compare/v0.13.4...v0.14.0
[0.13.4]: https://github.com/Automattic/jetpack-search/compare/v0.13.3...v0.13.4
[0.13.3]: https://github.com/Automattic/jetpack-search/compare/v0.13.2...v0.13.3
[0.13.2]: https://github.com/Automattic/jetpack-search/compare/v0.13.1...v0.13.2
[0.13.1]: https://github.com/Automattic/jetpack-search/compare/v0.13.0...v0.13.1
[0.13.0]: https://github.com/Automattic/jetpack-search/compare/v0.12.3...v0.13.0
[0.12.3]: https://github.com/Automattic/jetpack-search/compare/v0.12.2...v0.12.3
[0.12.2]: https://github.com/Automattic/jetpack-search/compare/v0.12.1...v0.12.2
[0.12.1]: https://github.com/Automattic/jetpack-search/compare/v0.12.0...v0.12.1
[0.12.0]: https://github.com/Automattic/jetpack-search/compare/v0.11.3...v0.12.0
[0.11.3]: https://github.com/Automattic/jetpack-search/compare/v0.11.2...v0.11.3
[0.11.2]: https://github.com/Automattic/jetpack-search/compare/v0.11.1...v0.11.2
[0.11.1]: https://github.com/Automattic/jetpack-search/compare/v0.11.0...v0.11.1
[0.11.0]: https://github.com/Automattic/jetpack-search/compare/v0.10.0...v0.11.0
[0.10.0]: https://github.com/Automattic/jetpack-search/compare/v0.9.1...v0.10.0
[0.9.1]: https://github.com/Automattic/jetpack-search/compare/v0.9.0...v0.9.1
[0.9.0]: https://github.com/Automattic/jetpack-search/compare/v0.8.0...v0.9.0
[0.8.0]: https://github.com/Automattic/jetpack-search/compare/v0.7.0...v0.8.0
[0.7.0]: https://github.com/Automattic/jetpack-search/compare/v0.6.0...v0.7.0
[0.6.0]: https://github.com/Automattic/jetpack-search/compare/v0.5.4...v0.6.0
[0.5.4]: https://github.com/Automattic/jetpack-search/compare/v0.5.3...v0.5.4
[0.5.3]: https://github.com/Automattic/jetpack-search/compare/v0.5.2...v0.5.3
[0.5.2]: https://github.com/Automattic/jetpack-search/compare/v0.5.1...v0.5.2
[0.5.1]: https://github.com/Automattic/jetpack-search/compare/v0.5.0...v0.5.1
[0.5.0]: https://github.com/Automattic/jetpack-search/compare/v0.4.0...v0.5.0
[0.4.0]: https://github.com/Automattic/jetpack-search/compare/v0.3.0...v0.4.0
[0.3.0]: https://github.com/Automattic/jetpack-search/compare/v0.2.1...v0.3.0
[0.2.1]: https://github.com/Automattic/jetpack-search/compare/v0.2.0...v0.2.1
[0.2.0]: https://github.com/Automattic/jetpack-search/compare/v0.1.0...v0.2.0
jetpack.php                                                                                                                                                                                                                                                    614           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/compatibility                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <?php
/**
 * Jetpack compatibility
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search\Compatibility\Jetpack;

use Jetpack;

/**
 * Override the condition to show Search submenu when Jetpack plugin exists.
 */
function should_show_jetpack_search_submenu() {
	if ( ! current_user_can( 'manage_options' ) ) {
		return false;
	}

	// If site is in Offline Mode or not connected yet.
	if ( ! Jetpack::is_active_and_not_offline_mode() ) {
		return false;
	}

	return true;
}

add_filter( 'jetpack_search_should_add_search_submenu', __NAMESPACE__ . '\should_show_jetpack_search_submenu' );
search-0.15.2.php                                                                                                                                                                                                                                              1027          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/compatibility                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <?php // phpcs:ignore WordPress.Files.FileName.NotHyphenatedLowercase
/**
 * Compatibility for Jetpack Search version <= 0.15.2.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search\Compatibility\Jetpack;

use Automattic\Jetpack\Search\Instant_Search;

add_filter( 'option_sidebars_widgets', __NAMESPACE__ . '\convert_old_jetpack_search_sidebar', 10, 2 );

/**
 * Map the old Jetpack Search sidebar to the new Instant Search sidebar.
 *
 * @param array $sidebars_widgets Value of `sidebars_widgets` option.
 */
function convert_old_jetpack_search_sidebar( $sidebars_widgets ) {
	if ( ! empty( $sidebars_widgets[ Instant_Search::INSTANT_SEARCH_SIDEBAR ] ) || empty( $sidebars_widgets[ Instant_Search::OLD_INSTANT_SEARCH_SIDEBAR ] ) ) {
		return $sidebars_widgets;
	}
	$sidebars_widgets[ Instant_Search::INSTANT_SEARCH_SIDEBAR ] = $sidebars_widgets[ Instant_Search::OLD_INSTANT_SEARCH_SIDEBAR ];
	unset( $sidebars_widgets[ Instant_Search::OLD_INSTANT_SEARCH_SIDEBAR ] );
	return $sidebars_widgets;
}
search-0.17.0.php                                                                                                                                                                                                                                              701           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/compatibility                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <?php // phpcs:ignore WordPress.Files.FileName.NotHyphenatedLowercase
/**
 * Compatibility for Jetpack Search version <= 0.17.0.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search\Compatibility\Jetpack;

add_filter( 'option_jetpack_search_overlay_trigger', __NAMESPACE__ . '\map_results_overlay_trigger', 10, 2 );

/**
 * We've retired the 'results' overlay trigger and want to migrate users to the similar 'immediate' setting.
 *
 * @param string $overlay_trigger Overlay trigger.
 */
function map_results_overlay_trigger( $overlay_trigger ) {
	return 'results' === $overlay_trigger ? \Automattic\Jetpack\Search\Options::OVERLAY_TRIGGER_IMMEDIATE : $overlay_trigger;
}
unsupported-browsers.php                                                                                                                                                                                                                                       1321          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/compatibility                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <?php // phpcs:ignore WordPress.Files.FileName.NotHyphenatedLowercase
/**
 * Compatibility for browsers that don't support Instant Search.
 *
 * @package automattic/jetpack-search
 */
namespace Automattic\Jetpack\Search\Compatibility;

add_filter( 'jetpack_search_classic_search_enabled', __NAMESPACE__ . '\enable_classic_search_for_unsupported_browsers', 10, 1 );

/**
 * Get the iOS version from the user agent.
 *
 * @param string $user_agent The user agent string.
 * @return null|string The iOS version, or null if not found.
 */
function get_ios_version_from_user_agent( $user_agent ) {
	preg_match( '#\((iPhone|iPad|iPod).*?OS (\d+_?\d?_?\d?).*?\)#', $user_agent, $matches );

	if ( empty( $matches[2] ) ) {
		return null;
	}

	$version = str_replace( '_', '.', $matches[2] );
	return $version;
}

/**
 * Force enable Classic Search for browsers for iOS versions < 16.
 *
 * @param boolean $classic_search_enabled whether Classic Search is enabled.
 */
function enable_classic_search_for_unsupported_browsers( $classic_search_enabled ) {
	$ios_version = get_ios_version_from_user_agent( isset( $_SERVER['HTTP_USER_AGENT'] ) ? filter_var( wp_unslash( $_SERVER['HTTP_USER_AGENT'] ) ) : '' );
	if ( $ios_version && version_compare( $ios_version, '16.0', '<' ) ) {
		return true;
	}
	return $classic_search_enabled;
}
LICENSE.txt                                                                                                                                                                                                                                                    18416         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA


===================================


GNU GENERAL PUBLIC LICENSE
   Version 2, June 1991

Copyright (C) 1989, 1991 Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

		Preamble

The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation's software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Lesser General Public License instead.)  You can apply it to
your programs, too.

When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.

For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.

We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors' reputations.

Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at all.

The precise terms and conditions for copying, distribution and
modification follow.

GNU GENERAL PUBLIC LICENSE
TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

0. This License applies to any program or other work which contains
a notice placed by the copyright holder saying it may be distributed
under the terms of this General Public License.  The "Program", below,
refers to any such program or work, and a "work based on the Program"
means either the Program or any derivative work under copyright law:
that is to say, a work containing the Program or a portion of it,
either verbatim or with modifications and/or translated into another
language.  (Hereinafter, translation is included without limitation in
the term "modification".)  Each licensee is addressed as "you".

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.

1. You may copy and distribute verbatim copies of the Program's
source code as you receive it, in any medium, provided that you
conspicuously and appropriately publish on each copy an appropriate
copyright notice and disclaimer of warranty; keep intact all the
notices that refer to this License and to the absence of any warranty;
and give any other recipients of the Program a copy of this License
along with the Program.

You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a fee.

2. You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:

a) You must cause the modified files to carry prominent notices
stating that you changed the files and the date of any change.

b) You must cause any work that you distribute or publish, that in
whole or in part contains or is derived from the Program or any
part thereof, to be licensed as a whole at no charge to all third
parties under the terms of this License.

c) If the modified program normally reads commands interactively
when run, you must cause it, when started running for such
interactive use in the most ordinary way, to print or display an
announcement including an appropriate copyright notice and a
notice that there is no warranty (or else, saying that you provide
a warranty) and that users may redistribute the program under
these conditions, and telling the user how to view a copy of this
License.  (Exception: if the Program itself is interactive but
does not normally print such an announcement, your work based on
the Program is not required to print an announcement.)

These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

3. You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:

a) Accompany it with the complete corresponding machine-readable
source code, which must be distributed under the terms of Sections
1 and 2 above on a medium customarily used for software interchange; or,

b) Accompany it with a written offer, valid for at least three
years, to give any third party, for a charge no more than your
cost of physically performing source distribution, a complete
machine-readable copy of the corresponding source code, to be
distributed under the terms of Sections 1 and 2 above on a medium
customarily used for software interchange; or,

c) Accompany it with the information you received as to the offer
to distribute corresponding source code.  (This alternative is
allowed only for noncommercial distribution and only if you
received the program in object code or executable form with such
an offer, in accord with Subsection b above.)

The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

4. You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.

5. You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

6. Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

7. If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

8. If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.

9. The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and "any
later version", you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.

10. If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.

		NO WARRANTY

11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
REPAIR OR CORRECTION.

12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.

 END OF TERMS AND CONDITIONS

How to Apply These Terms to Your New Programs

If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least
the "copyright" line and a pointer to where the full notice is found.

<one line to give the program's name and a brief idea of what it does.>
Copyright (C) <year>  <name of author>

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

Also add information on how to contact you by electronic and paper mail.

If the program is interactive, make it output a short notice like this
when it starts in an interactive mode:

Gnomovision version 69, Copyright (C) year name of author
Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.

The hypothetical commands `show w' and `show c' should show the appropriate
parts of the General Public License.  Of course, the commands you use may
be called something other than `show w' and `show c'; they could even be
mouse-clicks or menu items--whatever suits your program.

You should also get your employer (if you work as a programmer) or your
school, if any, to sign a "copyright disclaimer" for the program, if
necessary.  Here is a sample; alter the names:

Yoyodyne, Inc., hereby disclaims all copyright interest in the program
`Gnomovision' (which makes passes at compilers) written by James Hacker.

<signature of Ty Coon>, 1 April 1989
Ty Coon, President of Vice

This General Public License does not permit incorporating your program into
proprietary programs.  If your program is a subroutine library, you may
consider it more useful to permit linking proprietary applications with the
library.  If this is what you want to do, use the GNU Lesser General
Public License instead of this License.
SECURITY.md                                                                                                                                                                                                                                                    2506          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # Security Policy

Full details of the Automattic Security Policy can be found on [automattic.com](https://automattic.com/security/).

## Supported Versions

Generally, only the latest version of Jetpack and its associated plugins have continued support. If a critical vulnerability is found in the current version of a plugin, we may opt to backport any patches to previous versions. 

## Reporting a Vulnerability

Our HackerOne program covers the below plugin software, as well as a variety of related projects and infrastructure:

* [Jetpack](https://jetpack.com/)
* Jetpack Backup
* Jetpack Boost
* Jetpack CRM
* Jetpack Protect
* Jetpack Search
* Jetpack Social
* Jetpack VideoPress

**For responsible disclosure of security issues and to be eligible for our bug bounty program, please submit your report via the [HackerOne](https://hackerone.com/automattic) portal.**

Our most critical targets are:

* Jetpack and the Jetpack composer packages (all within this repo)
* Jetpack.com -- the primary marketing site.
* cloud.jetpack.com -- a management site.
* wordpress.com -- the shared management site for both Jetpack and WordPress.com sites.

For more targets, see the `In Scope` section on [HackerOne](https://hackerone.com/automattic).

_Please note that the **WordPress software is a separate entity** from Automattic. Please report vulnerabilities for WordPress through [the WordPress Foundation's HackerOne page](https://hackerone.com/wordpress)._

## Guidelines

We're committed to working with security researchers to resolve the vulnerabilities they discover. You can help us by following these guidelines:

*   Follow [HackerOne's disclosure guidelines](https://www.hackerone.com/disclosure-guidelines).
*   Pen-testing Production:
    *   Please **setup a local environment** instead whenever possible. Most of our code is open source (see above).
    *   If that's not possible, **limit any data access/modification** to the bare minimum necessary to reproduce a PoC.
    *   **_Don't_ automate form submissions!** That's very annoying for us, because it adds extra work for the volunteers who manage those systems, and reduces the signal/noise ratio in our communication channels.
    *   To be eligible for a bounty, all of these guidelines must be followed.
*   Be Patient - Give us a reasonable time to correct the issue before you disclose the vulnerability.

We also expect you to comply with all applicable laws. You're responsible to pay any taxes associated with your bounties.
class-cli.php                                                                                                                                                                                                                                                  1726          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * CLI class exposed by WPCLI
 *
 * @package    automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use WP_CLI;
use WP_CLI_Command;
use WP_Error;

if ( ! class_exists( 'WP_CLI_Command' ) ) {
	return;
}

/**
 * Provide functionality by WPCLI.
 */
class CLI extends WP_CLI_Command {
	/**
	 * Auto config instant search, including set result format, set up overlay widgets and add a search input to the home page thru widgets or blocks.
	 *
	 * ## EXAMPLES
	 *
	 * wp jetpack-search auto_config user_login
	 *
	 * wp jetpack-search auto_config user_id
	 *
	 * @param array $args - Args passsed in.
	 */
	public function auto_config( $args ) {
		try {
			if ( empty( $args ) ) {
				WP_CLI::error( 'A user login or ID is required.' );
			}

			// Some functions may require admin capabilities to run.
			$ret = $this->set_user( $args[0] );
			if ( is_wp_error( $ret ) ) {
				WP_CLI::error( $ret->get_error_message() );
			}

			WP_CLI::line( 'Running as user ' . $ret->user_login . '' );
			$blog_id = Helper::get_wpcom_site_id();
			Instant_Search::instance( $blog_id )->auto_config_search();
			WP_CLI::success( 'Auto config success!' );
		} catch ( \Exception $e ) {
			WP_CLI::error( $e->getMessage() );
		}
	}

	/**
	 * Set current user by ID or login
	 *
	 * @param string|int $user User ID or login.
	 */
	protected function set_user( $user ) {
		$get_user_by = 'login';
		if ( filter_var( $user, FILTER_VALIDATE_INT ) > 0 ) {
			$get_user_by = 'ID';
		}
		$user_info = get_user_by( $get_user_by, (string) $user );
		if ( ! $user_info ) {
			return new WP_Error( 'user_not_found', "Could not find user '{$user}' by {$get_user_by}." );
		}
		return wp_set_current_user( $user_info->ID );
	}
}
class-helper.php                                                                                                                                                                                                                                               30136         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * Helper class providing various static utility functions for use in Search.
 *
 * @package    automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Status;
use GP_Locales;
use Jetpack; // TODO: Remove this once migrated.

/**
 * Various helper functions for reuse throughout the Jetpack Search code.
 */
class Helper {

	/**
	 * The search widget's base ID.
	 *
	 * @since 5.8.0
	 * @var string
	 */
	const FILTER_WIDGET_BASE = 'jetpack-search-filters';

	/**
	 * Create a URL for the current search that doesn't include the "paged" parameter.
	 *
	 * @since 5.8.0
	 *
	 * @return string The search URL.
	 */
	public static function get_search_url() {
		// WordPress search doesn't use nonces.
		$query_args = stripslashes_deep( $_GET ); //phpcs:ignore WordPress.Security.NonceVerification.Recommended

		// Handle the case where a permastruct is being used, such as /search/{$query}.
		if ( ! isset( $query_args['s'] ) ) {
			$query_args['s'] = get_search_query();
		}

		if ( isset( $query_args['paged'] ) ) {
			unset( $query_args['paged'] );
		}

		$query = http_build_query( $query_args );

		return home_url( "?{$query}" );
	}

	/**
	 * Wraps add_query_arg() with the URL defaulting to the current search URL.
	 *
	 * @see   add_query_arg()
	 *
	 * @since 5.8.0
	 *
	 * @param string|array $key   Either a query variable key, or an associative array of query variables.
	 * @param string       $value Optional. A query variable value.
	 * @param bool|string  $url   Optional. A URL to act upon. Defaults to the current search URL.
	 *
	 * @return string New URL query string (unescaped).
	 */
	public static function add_query_arg( $key, $value = false, $url = false ) {
		$url = empty( $url ) ? self::get_search_url() : $url;
		if ( is_array( $key ) ) {
			return add_query_arg( $key, $url );
		}

		return add_query_arg( $key, $value, $url );
	}

	/**
	 * Wraps remove_query_arg() with the URL defaulting to the current search URL.
	 *
	 * @see   remove_query_arg()
	 *
	 * @since 5.8.0
	 *
	 * @param string|array $key   Query key or keys to remove.
	 * @param bool|string  $url Optional. A URL to act upon.  Defaults to the current search URL.
	 *
	 * @return string New URL query string (unescaped).
	 */
	public static function remove_query_arg( $key, $url = false ) {
		$url = empty( $url ) ? self::get_search_url() : $url;

		return remove_query_arg( $key, $url );
	}

	/**
	 * Returns the name of the search widget's option.
	 *
	 * @since 5.8.0
	 *
	 * @return string The search widget option name.
	 */
	public static function get_widget_option_name() {
		return sprintf( 'widget_%s', self::FILTER_WIDGET_BASE );
	}

	/**
	 * Returns the search widget instances from the widget's option.
	 *
	 * @since 5.8.0
	 *
	 * @return array The widget options.
	 */
	public static function get_widgets_from_option() {
		$widget_options = get_option( self::get_widget_option_name(), array() );

		// We don't need this.
		if ( ! empty( $widget_options ) && isset( $widget_options['_multiwidget'] ) ) {
			unset( $widget_options['_multiwidget'] );
		}

		return $widget_options;
	}

	/**
	 * Returns the widget ID (widget base plus the numeric ID).
	 *
	 * @param int $number The widget's numeric ID.
	 *
	 * @return string The widget's numeric ID prefixed with the search widget base.
	 */
	public static function build_widget_id( $number ) {
		return sprintf( '%s-%d', self::FILTER_WIDGET_BASE, $number );
	}

	/**
	 * Wrapper for is_active_widget() with the other parameters automatically supplied.
	 *
	 * @see   is_active_widget()
	 *
	 * @since 5.8.0
	 *
	 * @param int $widget_id Widget ID.
	 *
	 * @return bool Whether the widget is active or not.
	 */
	public static function is_active_widget( $widget_id ) {
		return (bool) is_active_widget( false, $widget_id, self::FILTER_WIDGET_BASE, true );
	}

	/**
	 * Returns an array of the filters from all active search widgets.
	 *
	 * @since 5.8.0
	 *
	 * @param array|null $allowed_widget_ids array of allowed widget IDs.
	 *
	 * @return array Active filters.
	 */
	public static function get_filters_from_widgets( $allowed_widget_ids = null ) {
		$filters = array();

		$widget_options = self::get_widgets_from_option();
		if ( empty( $widget_options ) ) {
			return $filters;
		}

		foreach ( (array) $widget_options as $number => $settings ) {
			$widget_id = self::build_widget_id( $number );
			if ( ! self::is_active_widget( $widget_id ) || empty( $settings['filters'] ) ) {
				continue;
			}
			if ( isset( $allowed_widget_ids ) && ! in_array( $widget_id, $allowed_widget_ids, true ) ) {
				continue;
			}

			foreach ( (array) $settings['filters'] as $widget_filter ) {
				$widget_filter['widget_id'] = $widget_id;

				if ( empty( $widget_filter['name'] ) ) {
					$widget_filter['name'] = self::generate_widget_filter_name( $widget_filter );
				}

				$type = ( isset( $widget_filter['type'] ) ) ? $widget_filter['type'] : '';
				$key  = sprintf( '%s_%d', $type, count( $filters ) );

				$filters[ $key ] = $widget_filter;
			}
		}

		return $filters;
	}

	/**
	 * Get the localized default label for a date filter.
	 *
	 * @since 5.8.0
	 *
	 * @param string $type       Date type, either year or month.
	 * @param bool   $is_updated Whether the filter was updated or not (adds "Updated" to the end).
	 *
	 * @return string The filter label.
	 */
	public static function get_date_filter_type_name( $type, $is_updated = false ) {
		switch ( $type ) {
			case 'year':
				$string = ( $is_updated )
					? esc_html_x( 'Year Updated', 'label for filtering posts', 'jetpack-search-pkg' )
					: esc_html_x( 'Year', 'label for filtering posts', 'jetpack-search-pkg' );
				break;
			case 'month':
			default:
				$string = ( $is_updated )
					? esc_html_x( 'Month Updated', 'label for filtering posts', 'jetpack-search-pkg' )
					: esc_html_x( 'Month', 'label for filtering posts', 'jetpack-search-pkg' );
				break;
		}

		return $string;
	}

	/**
	 * Creates a default name for a filter. Used when the filter label is blank.
	 *
	 * @since 5.8.0
	 *
	 * @param array $widget_filter The filter to generate the title for.
	 *
	 * @return string The suggested filter name.
	 */
	public static function generate_widget_filter_name( $widget_filter ) {
		$name = '';

		if ( ! isset( $widget_filter['type'] ) ) {
			return $name;
		}

		switch ( $widget_filter['type'] ) {
			case 'post_type':
				$name = _x( 'Post Types', 'label for filtering posts', 'jetpack-search-pkg' );
				break;

			case 'author':
				$name = _x( 'Authors', 'label for filtering posts', 'jetpack-search-pkg' );
				break;

			case 'blog_id':
				$name = _x( 'Blogs', 'label for filtering posts', 'jetpack-search-pkg' );
				break;

			case 'date_histogram':
				$modified_fields = array(
					'post_modified',
					'post_modified_gmt',
				);
				switch ( $widget_filter['interval'] ) {
					case 'year':
						$name = self::get_date_filter_type_name(
							'year',
							in_array( $widget_filter['field'], $modified_fields, true )
						);
						break;
					case 'month':
					default:
						$name = self::get_date_filter_type_name(
							'month',
							in_array( $widget_filter['field'], $modified_fields, true )
						);
						break;
				}
				break;

			case 'taxonomy':
				$tax = get_taxonomy( $widget_filter['taxonomy'] );
				if ( ! $tax ) {
					break;
				}

				if ( isset( $tax->label ) ) {
					$name = $tax->label;
				} elseif ( isset( $tax->labels ) && isset( $tax->labels->name ) ) {
					$name = $tax->labels->name;
				}
				break;
		}

		return $name;
	}

	/**
	 * Whether we should rerun a search in the customizer preview or not.
	 *
	 * @since 5.8.0
	 *
	 * @return bool
	 */
	public static function should_rerun_search_in_customizer_preview() {
		// Only update when in a customizer preview and data is being posted.
		// Check for $_POST removes an extra update when the customizer loads.
		//
		// Note: We use $GLOBALS['wp_customize'] here instead of is_customize_preview() to support unit tests.
		return isset( $GLOBALS['wp_customize'] ) && $GLOBALS['wp_customize']->is_preview() && ! empty( $_POST ); // phpcs:ignore
	}

	/**
	 * Since PHP's built-in array_diff() works by comparing the values that are in array 1 to the other arrays,
	 * if there are less values in array 1, it's possible to get an empty diff where one might be expected.
	 *
	 * @since 5.8.0
	 *
	 * @param array $array_1 The first array.
	 * @param array $array_2 The second array.
	 *
	 * @return array
	 */
	public static function array_diff( $array_1, $array_2 ) {
		// If the array counts are the same, then the order doesn't matter. If the count of
		// $array_1 is higher than $array_2, that's also fine. If the count of $array_2 is higher,
		// we need to swap the array order though.
		if ( count( $array_1 ) !== count( $array_2 ) && count( $array_2 ) > count( $array_1 ) ) {
			$temp    = $array_1;
			$array_1 = $array_2;
			$array_2 = $temp;
		}

		// Disregard keys.
		return array_values( array_diff( $array_1, $array_2 ) );
	}

	/**
	 * Given the widget instance, will return true when selected post types differ from searchable post types.
	 *
	 * @since 5.8.0
	 *
	 * @param array $post_types An array of post types.
	 *
	 * @return bool
	 */
	public static function post_types_differ_searchable( $post_types ) {
		if ( empty( $post_types ) ) {
			return false;
		}

		$searchable_post_types = get_post_types( array( 'exclude_from_search' => false ) );
		$diff_of_searchable    = self::array_diff( $searchable_post_types, (array) $post_types );

		return ! empty( $diff_of_searchable );
	}

	/**
	 * Given the array of post types, will return true when these differ from the current search query.
	 *
	 * @since 5.8.0
	 *
	 * @param array $post_types An array of post types.
	 *
	 * @return bool
	 */
	public static function post_types_differ_query( $post_types ) {
		if ( empty( $post_types ) ) {
			return false;
		}

		// phpcs:disable WordPress.Security.NonceVerification.Recommended -- WordPress search doesn't use nonces.
		// phpcs:disable WordPress.Security.ValidatedSanitizedInput -- Sanitization happens at the end.
		if ( empty( $_GET['post_type'] ) ) {
			$post_types_from_query = array();
		} elseif ( is_array( $_GET['post_type'] ) ) {
			$post_types_from_query = $_GET['post_type'];
		} else {
			$post_types_from_query = (array) explode( ',', $_GET['post_type'] );
		}
		// phpcs:enable WordPress.Security.NonceVerification.Recommended, WordPress.Security.ValidatedSanitizedInput

		$post_types_from_query = array_map( 'sanitize_key', $post_types_from_query );

		$diff_query = self::array_diff( (array) $post_types, $post_types_from_query );

		return ! empty( $diff_query );
	}

	/**
	 * Determine what Tracks value should be used when updating a widget.
	 *
	 * @since 5.8.0
	 *
	 * @param mixed $old_value The old option value.
	 * @param mixed $new_value The new option value.
	 *
	 * @return array|false False if the widget wasn't updated, otherwise an array of the Tracks action and widget properties.
	 */
	public static function get_widget_tracks_value( $old_value, $new_value ) {
		$old_value = (array) $old_value;
		if ( isset( $old_value['_multiwidget'] ) ) {
			unset( $old_value['_multiwidget'] );
		}

		$new_value = (array) $new_value;
		if ( isset( $new_value['_multiwidget'] ) ) {
			unset( $new_value['_multiwidget'] );
		}

		$old_keys = array_keys( $old_value );
		$new_keys = array_keys( $new_value );

		if ( count( $new_keys ) > count( $old_keys ) ) { // This is the case for a widget being added.
			$diff   = self::array_diff( $new_keys, $old_keys );
			$action = 'widget_added';
			$widget = empty( $diff ) || ! isset( $new_value[ $diff[0] ] )
				? false
				: $new_value[ $diff[0] ];
		} elseif ( count( $old_keys ) > count( $new_keys ) ) { // This is the case for a widget being deleted.
			$diff   = self::array_diff( $old_keys, $new_keys );
			$action = 'widget_deleted';
			$widget = empty( $diff ) || ! isset( $old_value[ $diff[0] ] )
				? false
				: $old_value[ $diff[0] ];
		} else {
			$action = 'widget_updated';
			$widget = false;

			// This is a bit crazy. Since there can be multiple widgets stored in a single option,
			// we need to diff the old and new values to figure out which widget was updated.
			foreach ( $new_value as $key => $new_instance ) {
				if ( ! isset( $old_value[ $key ] ) ) {
					continue;
				}
				$old_instance = $old_value[ $key ];

				// First, let's test the keys of each instance.
				$diff = self::array_diff( array_keys( $new_instance ), array_keys( $old_instance ) );
				if ( ! empty( $diff ) ) {
					$widget = $new_instance;
					break;
				}

				// Next, lets's loop over each value and compare it.
				foreach ( $new_instance as $k => $v ) {
					if ( is_scalar( $v ) && (string) $v !== (string) $old_instance[ $k ] ) {
						$widget = $new_instance;
						break;
					}

					if ( 'filters' === $k ) {
						if ( ! is_countable( $new_instance['filters'] ) || ! is_countable( $old_instance['filters'] ) ) {
							continue;
						}

						if ( count( $new_instance['filters'] ) !== count( $old_instance['filters'] ) ) {
							$widget = $new_instance;
							break;
						}

						foreach ( $v as $filter_key => $new_filter_value ) {
							$diff = self::array_diff( $new_filter_value, $old_instance['filters'][ $filter_key ] );
							if ( ! empty( $diff ) ) {
								$widget = $new_instance;
								break;
							}
						}
					}
				}
			}
		}

		if ( empty( $action ) || empty( $widget ) ) {
			return false;
		}

		return array(
			'action' => $action,
			'widget' => self::get_widget_properties_for_tracks( $widget ),
		);
	}

	/**
	 * Creates the widget properties for sending to Tracks.
	 *
	 * @since 5.8.0
	 *
	 * @param array $widget The widget instance.
	 *
	 * @return array The widget properties.
	 */
	public static function get_widget_properties_for_tracks( $widget ) {
		$sanitized = array();

		foreach ( (array) $widget as $key => $value ) {
			if ( '_multiwidget' === $key ) {
				continue;
			}

			if ( is_scalar( $value ) ) {
				$key               = str_replace( '-', '_', sanitize_key( $key ) );
				$key               = "widget_{$key}";
				$sanitized[ $key ] = $value;
			}
		}

		$filters_properties = ! empty( $widget['filters'] )
			? self::get_filter_properties_for_tracks( $widget['filters'] )
			: array();

		return array_merge( $sanitized, $filters_properties );
	}

	/**
	 * Creates the filter properties for sending to Tracks.
	 *
	 * @since 5.8.0
	 *
	 * @param array $filters An array of filters.
	 *
	 * @return array The filter properties.
	 */
	public static function get_filter_properties_for_tracks( $filters ) {
		if ( empty( $filters ) ) {
			return $filters;
		}

		$filters_properties = array(
			'widget_filter_count' => count( $filters ),
		);

		foreach ( $filters as $filter ) {
			if ( empty( $filter['type'] ) ) {
				continue;
			}

			$key = sprintf( 'widget_filter_type_%s', $filter['type'] );
			if ( isset( $filters_properties[ $key ] ) ) {
				++$filters_properties[ $key ];
			} else {
				$filters_properties[ $key ] = 1;
			}
		}

		return $filters_properties;
	}

	/**
	 * Gets the active post types given a set of filters.
	 *
	 * @since 5.8.0
	 *
	 * @param array $filters The active filters for the current query.
	 *
	 * @return array The active post types.
	 */
	public static function get_active_post_types( $filters ) {
		$active_post_types = array();

		foreach ( $filters as $item ) {
			if ( ( 'post_type' === $item['type'] ) && isset( $item['query_vars']['post_type'] ) ) {
				$active_post_types[] = $item['query_vars']['post_type'];
			}
		}

		return $active_post_types;
	}

	/**
	 * Sets active to false on all post type buckets.
	 *
	 * @since 5.8.0
	 *
	 * @param array $filters The available filters for the current query.
	 *
	 * @return array The filters for the current query with modified active field.
	 */
	public static function remove_active_from_post_type_buckets( $filters ) {
		$modified = $filters;
		foreach ( $filters as $key => $filter ) {
			if ( 'post_type' === $filter['type'] && ! empty( $filter['buckets'] ) ) {
				foreach ( $filter['buckets'] as $k => $bucket ) {
					$bucket['active']                  = false;
					$modified[ $key ]['buckets'][ $k ] = $bucket;
				}
			}
		}

		return $modified;
	}

	/**
	 * Given a url and an array of post types, will ensure that the post types are properly applied to the URL as args.
	 *
	 * @since 5.8.0
	 *
	 * @param string $url        The URL to add post types to.
	 * @param array  $post_types An array of post types that should be added to the URL.
	 *
	 * @return string The URL with added post types.
	 */
	public static function add_post_types_to_url( $url, $post_types ) {
		$url = self::remove_query_arg( 'post_type', $url );
		if ( empty( $post_types ) ) {
			return $url;
		}

		$url = self::add_query_arg(
			'post_type',
			implode( ',', $post_types ),
			$url
		);

		return $url;
	}

	/**
	 * Since we provide support for the widget restricting post types by adding the selected post types as
	 * active filters, if removing a post type filter would result in there no longer be post_type args in the URL,
	 * we need to be sure to add them back.
	 *
	 * @since 5.8.0
	 *
	 * @param array $filters    An array of possible filters for the current query.
	 * @param array $post_types The post types to ensure are on the link.
	 *
	 * @return array The updated array of filters with post typed added to the remove URLs.
	 */
	public static function ensure_post_types_on_remove_url( $filters, $post_types ) {
		$modified = $filters;

		foreach ( (array) $filters as $filter_key => $filter ) {
			if ( 'post_type' !== $filter['type'] || empty( $filter['buckets'] ) ) {
				$modified[ $filter_key ] = $filter;
				continue;
			}

			foreach ( (array) $filter['buckets'] as $bucket_key => $bucket ) {
				if ( empty( $bucket['remove_url'] ) ) {
					continue;
				}

				$parsed = wp_parse_url( $bucket['remove_url'] );
				if ( ! $parsed ) {
					continue;
				}

				$query = array();
				if ( ! empty( $parsed['query'] ) ) {
					wp_parse_str( $parsed['query'], $query );
				}

				if ( empty( $query['post_type'] ) ) {
					$modified[ $filter_key ]['buckets'][ $bucket_key ]['remove_url'] = self::add_post_types_to_url(
						$bucket['remove_url'],
						$post_types
					);
				}
			}
		}

		return $modified;
	}

	/**
	 * Wraps a WordPress filter called "jetpack_search_disable_widget_filters" that allows
	 * developers to disable filters supplied by the search widget. Useful if filters are
	 * being defined at the code level.
	 *
	 * @since 5.8.0
	 *
	 * @return bool
	 */
	public static function are_filters_by_widget_disabled() {
		/**
		 * Allows developers to disable filters being set by widget, in favor of manually
		 * setting filters via `Classic_Search::set_filters()`.
		 *
		 * @module search
		 *
		 * @since  5.7.0
		 *
		 * @param bool false
		 */
		return apply_filters( 'jetpack_search_disable_widget_filters', false );
	}

	/**
	 * Returns the maximum posts per page for a search query.
	 *
	 * @since 5.8.0
	 *
	 * @return int
	 */
	public static function get_max_posts_per_page() {
		return Options::site_has_vip_index() ? 1000 : 100;
	}

	/**
	 * Returns the maximum offset for a search query.
	 *
	 * @since 5.8.0
	 *
	 * @return int
	 */
	public static function get_max_offset() {
		return Options::site_has_vip_index() ? 9000 : 1000;
	}

	/**
	 * Returns the maximum offset for a search query.
	 *
	 * @since 8.4.0
	 * @param string $locale    A potentially valid locale string.
	 *
	 * @return bool
	 */
	public static function is_valid_locale( $locale ) {
		if ( ! class_exists( 'GP_Locales' ) ) {
			// Assume locale to be valid if we can't check with GlotPress.
			return true;
		}
		return false !== GP_Locales::by_field( 'wp_locale', $locale );
	}

	/**
	 * Get the version number to use when loading the file. Allows us to bypass cache when developing.
	 *
	 * @since 8.6.0
	 * @param string $file Path of the file we are looking for.
	 * @return string $script_version Version number.
	 */
	public static function get_asset_version( $file ) {
		return Package::is_development_version() && file_exists( Package::get_installed_path() . $file )
			? filemtime( Package::get_installed_path() . $file )
			: Package::VERSION;
	}

	/**
	 * Generates a customizer settings ID for a given post type.
	 *
	 * @since 8.8.0
	 * @param object $post_type Post type object returned from get_post_types.
	 * @return string $customizer_id Customizer setting ID.
	 */
	public static function generate_post_type_customizer_id( $post_type ) {
		return Options::OPTION_PREFIX . 'disable_post_type_' . $post_type->name;
	}

	/**
	 * Generates an array of post types associated with their customizer IDs.
	 *
	 * @since 8.8.0
	 * @return array $ids Post type => post type customizer ID object.
	 */
	public static function generate_post_type_customizer_ids() {
		return array_map(
			array( 'self', 'generate_post_type_customizer_id' ),
			get_post_types( array( 'exclude_from_search' => false ), 'objects' )
		);
	}

	/**
	 * Sanitizes a checkbox value for writing to the database.
	 *
	 * @since 8.9.0
	 *
	 * @param any $value from the customizer form.
	 * @return string either '0' or '1'.
	 */
	public static function sanitize_checkbox_value( $value ) {
		return true === $value ? '1' : '0';
	}

	/**
	 * Sanitizes a checkbox value for rendering the Customizer.
	 *
	 * @since 8.9.0
	 *
	 * @param any $value from the database.
	 * @return boolean
	 */
	public static function sanitize_checkbox_value_for_js( $value ) {
		return '1' === $value;
	}

	/**
	 * Passes all options to the JS app.
	 */
	public static function generate_initial_javascript_state() {
		$widget_options = self::get_widgets_from_option();
		if ( is_array( $widget_options ) ) {
			$widget_options = end( $widget_options );
		}

		$overlay_widget_ids      = is_active_sidebar( Instant_Search::INSTANT_SEARCH_SIDEBAR ) ?
			wp_get_sidebars_widgets()[ Instant_Search::INSTANT_SEARCH_SIDEBAR ] : array();
		$filters                 = self::get_filters_from_widgets();
		$widgets                 = array();
		$widgets_outside_overlay = array();
		foreach ( $filters as $key => &$filter ) {
			$filter['filter_id'] = $key;

			if ( in_array( $filter['widget_id'], $overlay_widget_ids, true ) ) {
				if ( ! isset( $widgets[ $filter['widget_id'] ] ) ) {
					$widgets[ $filter['widget_id'] ]['filters']   = array();
					$widgets[ $filter['widget_id'] ]['widget_id'] = $filter['widget_id'];
				}
				$widgets[ $filter['widget_id'] ]['filters'][] = $filter;
			} else {
				if ( ! isset( $widgets_outside_overlay[ $filter['widget_id'] ] ) ) {
					$widgets_outside_overlay[ $filter['widget_id'] ]['filters']   = array();
					$widgets_outside_overlay[ $filter['widget_id'] ]['widget_id'] = $filter['widget_id'];
				}
				$widgets_outside_overlay[ $filter['widget_id'] ]['filters'][] = $filter;
			}
		}
		unset( $filter );

		$has_non_search_widgets = false;
		foreach ( $overlay_widget_ids as $overlay_widget_id ) {
			if ( strpos( $overlay_widget_id, self::FILTER_WIDGET_BASE ) === false ) {
				$has_non_search_widgets = true;
				break;
			}
		}

		$post_type_objs   = get_post_types( array( 'exclude_from_search' => false ), 'objects' );
		$post_type_labels = array();
		foreach ( $post_type_objs as $key => $obj ) {
			$post_type_labels[ $key ] = array(
				'singular_name' => $obj->labels->singular_name,
				'name'          => $obj->labels->name,
			);
		}

		$prefix         = Options::OPTION_PREFIX;
		$posts_per_page = (int) get_option( 'posts_per_page' );
		if ( ( $posts_per_page > 20 ) || ( $posts_per_page <= 0 ) ) {
			$posts_per_page = 20;
		}

		$excluded_post_types   = get_option( $prefix . 'excluded_post_types' ) ? explode( ',', get_option( $prefix . 'excluded_post_types', '' ) ) : array();
		$post_types            = array_values(
			get_post_types(
				array(
					'exclude_from_search' => false,
					'public'              => true,
				)
			)
		);
		$unexcluded_post_types = array_diff( $post_types, $excluded_post_types );
		// NOTE: If all post types are being excluded, ignore the option value.
		if ( array() === $unexcluded_post_types ) {
			$excluded_post_types = array();
		}

		$is_wpcom                  = static::is_wpcom();
		$is_private_site           = ( new Status() )->is_private_site();
		$is_jetpack_photon_enabled = method_exists( 'Jetpack', 'is_module_active' ) && Jetpack::is_module_active( 'photon' );

		$options = array(
			'overlayOptions'              => array(
				'colorTheme'                  => get_option( $prefix . 'color_theme', 'light' ),
				'enableInfScroll'             => get_option( $prefix . 'inf_scroll', '1' ) === '1',
				'enableFilteringOpensOverlay' => get_option( $prefix . 'filtering_opens_overlay', '1' ) === '1',
				'enablePostDate'              => get_option( $prefix . 'show_post_date', '1' ) === '1',
				'enableSort'                  => get_option( $prefix . 'enable_sort', '1' ) === '1',
				'highlightColor'              => get_option( $prefix . 'highlight_color', '#FFC' ),
				'overlayTrigger'              => get_option( $prefix . 'overlay_trigger', Options::DEFAULT_OVERLAY_TRIGGER ),
				'resultFormat'                => get_option( $prefix . 'result_format', Options::RESULT_FORMAT_MINIMAL ),
				'showPoweredBy'               => ( new Plan() )->is_free_plan() || ( get_option( $prefix . 'show_powered_by', '1' ) === '1' ),

				// These options require kicking off a new search.
				'defaultSort'                 => get_option( $prefix . 'default_sort', 'relevance' ),
				'excludedPostTypes'           => $excluded_post_types,
			),

			// core config.
			'homeUrl'                     => home_url(),
			'locale'                      => str_replace( '_', '-', self::is_valid_locale( get_locale() ) ? get_locale() : 'en_US' ),
			'postsPerPage'                => $posts_per_page,
			'siteId'                      => self::get_wpcom_site_id(),
			'postTypes'                   => $post_type_labels,
			'webpackPublicPath'           => plugins_url( '/build/instant-search/', __DIR__ ),
			'isPhotonEnabled'             => ( $is_wpcom || $is_jetpack_photon_enabled ) && ! $is_private_site,
			'isFreePlan'                  => ( new Plan() )->is_free_plan(),

			// config values related to private site support.
			'apiRoot'                     => esc_url_raw( rest_url() ),
			'apiNonce'                    => wp_create_nonce( 'wp_rest' ),
			'isPrivateSite'               => $is_private_site,
			'isWpcom'                     => $is_wpcom,

			// widget info.
			'hasOverlayWidgets'           => is_countable( $overlay_widget_ids ) && count( $overlay_widget_ids ) > 0,
			'widgets'                     => array_values( $widgets ),
			'widgetsOutsideOverlay'       => array_values( $widgets_outside_overlay ),
			'hasNonSearchWidgets'         => $has_non_search_widgets,
			/**
			 * Whether to prevent tracking cookie reset. More information `pbmxuV-39H-p2`.
			 *
			 * @module search
			 *
			 * @since $next-version$
			 *
			 * @param bool Prevent cookie reset for automattic sites as default value.
			 */
			'preventTrackingCookiesReset' => apply_filters( 'jetpack_instant_search_prevent_tracking_cookies_reset', function_exists( 'is_automattic' ) && is_automattic() ),
		);

		/**
		 * Customize Instant Search Options.
		 *
		 * @module search
		 *
		 * @since 7.7.0
		 *
		 * @param array $options Array of parameters used in Instant Search queries.
		 */
		return apply_filters( 'jetpack_instant_search_options', $options );
	}

	/**
	 * Returns true if the site is a WordPress.com simple site, i.e. the code runs on WPCOM.
	 */
	public static function is_wpcom() {
		return defined( 'IS_WPCOM' ) && constant( 'IS_WPCOM' );
	}

	/**
	 * Prints the Instant Search sidebar.
	 */
	public static function print_instant_search_sidebar() {
		?>
		<div class="jetpack-instant-search__widget-area" style="display: none">
			<?php if ( is_active_sidebar( Instant_Search::INSTANT_SEARCH_SIDEBAR ) ) { ?>
				<?php dynamic_sidebar( Instant_Search::INSTANT_SEARCH_SIDEBAR ); ?>
			<?php } ?>
		</div>
		<?php
	}

	/**
	 * Gets all of the active plugins via site options.
	 * Forked from Jetpack::get_active_plugins from the Jetpack plugin.
	 *
	 * @return string[]
	 */
	public static function get_active_plugins() {
		// active_plugins plugins as values.
		$active_plugins = (array) get_option( 'active_plugins', array() );

		// active_sitewide_plugins stores plugins as keys.
		if ( is_multisite() ) {
			$network_plugins = array_keys( get_site_option( 'active_sitewide_plugins', array() ) );
			if ( $network_plugins ) {
				$active_plugins = array_merge( $active_plugins, $network_plugins );
			}
		}

		sort( $active_plugins );
		return array_unique( $active_plugins );
	}

	/**
	 * Get the current site's WordPress.com ID.
	 *
	 * @return int Blog ID.
	 */
	public static function get_wpcom_site_id() {
		// Returns local blog ID for a multi-site network.
		if ( defined( 'IS_WPCOM' ) && constant( 'IS_WPCOM' ) ) {
			return \get_current_blog_id();
		}

		// Returns cache site ID.
		return \Jetpack_Options::get_option( 'id' );
	}

	/**
	 * Returns true if the free_plan is set to not empty in URL, which is used for testing purpose.
	 */
	public static function is_forced_free_plan() {
		// phpcs:ignore WordPress.Security.NonceVerification.Recommended, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized, WordPress.Security.ValidatedSanitizedInput.MissingUnslash
		return isset( $_GET['free_plan'] ) && $_GET['free_plan'];
	}

	/**
	 * Returns true if the new_pricing_202210 is set to not empty in URL for testing purpose.
	 */
	public static function is_forced_new_pricing_202208() {
		$referrer = wp_get_referer();
		// phpcs:ignore WordPress.Security.NonceVerification.Recommended, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized, WordPress.Security.ValidatedSanitizedInput.MissingUnslash
		return ( isset( $_GET['new_pricing_202208'] ) && $_GET['new_pricing_202208'] ) || $referrer && strpos( $referrer, 'new_pricing_202208=1' ) !== false;
	}
}
class-module-control.php                                                                                                                                                                                                                                       5074          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * Jetpack Search: Module_Control class
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Connection\Manager as Connection_Manager;
use Automattic\Jetpack\Modules;
use Automattic\Jetpack\Status;
use WP_Error;

/**
 * To get and set Searh module settings
 */
class Module_Control {
	/**
	 * Plan object
	 *
	 * @var Plan
	 */
	protected $plan;

	/**
	 * Connection_Manager object
	 *
	 * @var Automattic\Jetpack\Connection\Manager
	 */
	protected $connection_manager;

	/**
	 * We use the same options as Jetpack the plugin to flag whether Search is active.
	 */
	const JETPACK_ACTIVE_MODULES_OPTION_KEY       = 'active_modules';
	const JETPACK_SEARCH_MODULE_SLUG              = 'search';
	const SEARCH_MODULE_INSTANT_SEARCH_OPTION_KEY = 'instant_search_enabled';

	/**
	 * Contructor
	 *
	 * @param Plan|null                                  $plan - Plan object.
	 * @param Automattic\Jetpack\Connection\Manager|null $connection_manager - Connection_Manager object.
	 */
	public function __construct( $plan = null, $connection_manager = null ) {
		$this->plan               = $plan === null ? new Plan() : $plan;
		$this->connection_manager = $connection_manager === null ? new Connection_Manager( Package::SLUG ) : $connection_manager;
		if ( ! did_action( 'jetpack_search_module_control_initialized' ) ) {
			add_filter( 'jetpack_get_available_standalone_modules', array( $this, 'search_filter_available_modules' ), 10, 1 );
			if ( Helper::is_wpcom() ) {
				add_filter( 'jetpack_active_modules', array( $this, 'search_filter_available_modules' ), 10, 2 );
			}
			/**
			 * Fires when the Automattic\Jetpack\Search\Module_Control is initialized for the first time.
			 */
			do_action( 'jetpack_search_module_control_initialized' );
		}
	}

	/**
	 * Returns a boolean for whether of the module is enabled.
	 *
	 * @return bool
	 */
	public function is_active() {
		return ( new Modules() )->is_active( self::JETPACK_SEARCH_MODULE_SLUG );
	}

	/**
	 * Returns a boolean for whether instant search is enabled.
	 *
	 * @return bool
	 */
	public function is_instant_search_enabled() {
		return (bool) get_option( self::SEARCH_MODULE_INSTANT_SEARCH_OPTION_KEY );
	}

	/**
	 * Activiate Search module
	 */
	public function activate() {
		if ( ( new Status() )->is_offline_mode() ) {
			return new WP_Error( 'site_offline', __( 'Jetpack Search can not be used in offline mode.', 'jetpack-search-pkg' ) );
		}
		if ( ! $this->connection_manager->is_connected() ) {
			return new WP_Error( 'connection_required', __( 'Connect your site to use Jetpack Search.', 'jetpack-search-pkg' ) );
		}
		if ( ! $this->plan->supports_search() ) {
			return new WP_Error( 'not_supported', __( 'Your plan does not support Jetpack Search.', 'jetpack-search-pkg' ) );
		}

		$success = ( new Modules() )->activate( self::JETPACK_SEARCH_MODULE_SLUG, false, false );
		if ( false === $success ) {
			return new WP_Error( 'not_updated', __( 'Setting not updated.', 'jetpack-search-pkg' ) );
		}
		return $success;
	}

	/**
	 * Deactiviate Search module
	 */
	public function deactivate() {
		$success = ( new Modules() )->deactivate( self::JETPACK_SEARCH_MODULE_SLUG );

		$this->disable_instant_search();

		return $success;
	}

	/**
	 * Update module status
	 *
	 * @param boolean $active - true to activate, false to deactivate.
	 */
	public function update_status( $active ) {
		return $active ? $this->activate() : $this->deactivate();
	}

	/**
	 * Disable Instant Search Experience
	 */
	public function disable_instant_search() {
		return update_option( self::SEARCH_MODULE_INSTANT_SEARCH_OPTION_KEY, false );
	}

	/**
	 * Enable Instant Search Experience
	 */
	public function enable_instant_search() {
		if ( ! $this->is_active() ) {
			return new WP_Error( 'search_module_inactive', __( 'Search module needs to be activated before enabling instant search.', 'jetpack-search-pkg' ) );
		}
		if ( ! $this->plan->supports_instant_search() ) {
			return new WP_Error( 'not_supported', __( 'Your plan does not support Instant Search.', 'jetpack-search-pkg' ) );
		}
		return update_option( self::SEARCH_MODULE_INSTANT_SEARCH_OPTION_KEY, true );
	}

	/**
	 * Update instant search status
	 *
	 * @param boolean $enabled - true to enable, false to disable.
	 */
	public function update_instant_search_status( $enabled ) {
		return $enabled ? $this->enable_instant_search() : $this->disable_instant_search();
	}

	/**
	 * Get a list of activated modules as an array of module slugs.
	 *
	 * @deprecated 0.12.3
	 * @return Array $active_modules
	 */
	public function get_active_modules() {
		_deprecated_function(
			__METHOD__,
			'jetpack-search-0.12.3',
			'Automattic\\Jetpack\\Modules\\get_active'
		);

		return ( new Modules() )->get_active();
	}

	/**
	 * Adds search to the list of available modules
	 *
	 * @param array $modules The available modules.
	 * @return array
	 */
	public function search_filter_available_modules( $modules ) {
		return array_merge( array( self::JETPACK_SEARCH_MODULE_SLUG ), $modules );
	}
}
class-options.php                                                                                                                                                                                                                                              1933          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * Another helper class for parsing Jetpack Search options.
 *
 * @package    automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Constants;

/**
 * Helpers for parsing the various Search options
 */
class Options {
	/**
	 * The search widget's base ID.
	 *
	 * @since 5.8.0
	 * @var string
	 */
	const FILTER_WIDGET_BASE = 'jetpack-search-filters';

	/**
	 * Prefix for options in DB.
	 *
	 * @since 8.3.0
	 * @var string
	 */
	const OPTION_PREFIX = 'jetpack_search_';

	/**
	 * Available result formats.
	 *
	 * @since 9.6.0
	 * @var string
	 */
	const RESULT_FORMAT_MINIMAL  = 'minimal';
	const RESULT_FORMAT_EXPANDED = 'expanded';
	const RESULT_FORMAT_PRODUCT  = 'product';

	/**
	 * Available overlay triggers.
	 *
	 * @since 9.9.0
	 * @var string
	 */
	const OVERLAY_TRIGGER_IMMEDIATE = 'immediate';
	const OVERLAY_TRIGGER_SUBMIT    = 'submit';
	const DEFAULT_OVERLAY_TRIGGER   = self::OVERLAY_TRIGGER_SUBMIT;

	/**
	 * Deprecated overlay trigger.
	 *
	 * @var string
	 * @deprecated since 11.3
	 */
	const OVERLAY_TRIGGER_RESULTS = 'results';

	/**
	 * Returns a boolean for whether instant search is enabled.
	 *
	 * @since 8.3.0
	 *
	 * @return bool
	 */
	public static function is_instant_enabled() {
		return true === (bool) get_option( 'instant_search_enabled' );
	}

	/**
	 * Returns a boolean for whether the current site has a VIP index.
	 *
	 * @since 5.8.0
	 *
	 * @return bool
	 */
	public static function site_has_vip_index() {
		$has_vip_index = (
			Constants::is_defined( 'JETPACK_SEARCH_VIP_INDEX' ) &&
			Constants::get_constant( 'JETPACK_SEARCH_VIP_INDEX' )
		);

		/**
		 * Allows developers to filter whether the current site has a VIP index.
		 *
		 * @module search
		 *
		 * @since  5.8.0
		 *
		 * @param bool $has_vip_index Whether the current site has a VIP index.
		 */
		return apply_filters( 'jetpack_search_has_vip_index', $has_vip_index );
	}
}
class-package.php                                                                                                                                                                                                                                              1786          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * Search package information.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

/**
 * Search package general information
 */
class Package {
	const VERSION = '0.43.4';
	const SLUG    = 'search';

	/**
	 * The path where package is installed.
	 *
	 * @var string
	 */
	protected static $installed_path;

	/**
	 * Adds the package slug and version to the package version tracker's data.
	 *
	 * @param array $package_versions The package version array.
	 *
	 * @return array The packge version array.
	 */
	public static function send_version_to_tracker( $package_versions ) {
		// Multiple versions could co-exist, we want to send the version which is in use.
		// `jetpack-autoloader` would load classes from the latest package, so we send the latest version here.
		if ( empty( $package_versions[ self::SLUG ] ) || version_compare( $package_versions[ self::SLUG ], self::VERSION, '<' ) ) {
			$package_versions[ self::SLUG ] = self::VERSION;
		}
		return $package_versions;
	}

	/**
	 * Whether Jetpack Search Package's version maps to a public release, or a development version.
	 */
	public static function is_development_version() {
		return (bool) apply_filters(
			'jetpack_search_is_development_version',
			! preg_match( '/^\d+(\.\d+)+$/', self::VERSION )
		);
	}

	/**
	 * Return the path where the package is installed with trailing slash.
	 * It's important not to use a constant, as there could be multiple versions of search package installed.
	 *
	 * @return string
	 */
	public static function get_installed_path() {
		if ( static::$installed_path === null ) {
			static::$installed_path = dirname( __DIR__ ) . DIRECTORY_SEPARATOR;
		}
		return apply_filters( 'jetpack_search_installed_path', static::$installed_path );
	}
}
class-plan.php                                                                                                                                                                                                                                                 5284          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * The Search Plan class.
 * Registers the REST routes for Search.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Connection\Client;
use Jetpack_Options;
use WP_Error;

/**
 * Registers the REST routes for Search.
 */
class Plan {
	const JETPACK_SEARCH_PLAN_INFO_OPTION_KEY  = 'jetpack_search_plan_info';
	const JETPACK_SEARCH_EVER_SUPPORTED_SEARCH = 'jetpack_search_ever_supported_search';

	// The pricing update starting from August 2022.
	const JETPACK_SEARCH_NEW_PRICING_VERSION = '202208';
	const JETPACK_SEARCH_FREE_PRODUCT_SLUG   = 'jetpack_search_free';

	/**
	 * Whether we have hooked the actions.
	 *
	 * @var boolean
	 */
	protected static $update_plan_hook_initialized = false;

	/**
	 * Init hooks for updating plan info
	 */
	public function init_hooks() {
		// Update plan info from WPCOM on Jetpack heartbeat.
		// TODO: implement heartbeart for search.
		if ( ! static::$update_plan_hook_initialized ) {
			add_action( 'jetpack_heartbeat', array( $this, 'get_plan_info_from_wpcom' ) );
			static::$update_plan_hook_initialized = true;
		}
	}

	/**
	 * Refresh plan info stored in options
	 */
	public function get_plan_info_from_wpcom() {
		$blog_id  = Jetpack_Options::get_option( 'id' );
		$response = Client::wpcom_json_api_request_as_blog(
			'/sites/' . $blog_id . '/jetpack-search/plan',
			'2',
			array(),
			null,
			'wpcom'
		);

		// store plan in options.
		$this->update_search_plan_info( $response );

		return $response;
	}

	/**
	 * Get plan info.
	 *
	 * @param {bool} $force_refresh - Default to false. Set true to load from WPCOM.
	 */
	public function get_plan_info( $force_refresh = false ) {
		if ( $force_refresh ) {
			$this->get_plan_info_from_wpcom();
		}
		$plan_info = get_option( self::JETPACK_SEARCH_PLAN_INFO_OPTION_KEY );
		if ( false === $plan_info && ! $force_refresh ) {
			$plan_info = $this->get_plan_info( true );
		}
		return $plan_info;
	}

	/**
	 * Please use `supports_instant_search` instead.
	 *
	 * @deprecated
	 */
	public function has_jetpack_search_product() {
		return (bool) get_option( 'has_jetpack_search_product' );
	}

	/**
	 * Returns true if plan supports Instant Search.
	 */
	public function supports_instant_search() {
		$plan_info = $this->get_plan_info();
		return ( isset( $plan_info['supports_instant_search'] ) && $plan_info['supports_instant_search'] ) || $this->has_jetpack_search_product();
	}

	/**
	 * Returns true if the plan support either Instant Search or Classic Search.
	 */
	public function supports_search() {
		$plan_info = $this->get_plan_info();
		return ( isset( $plan_info['supports_search'] ) && $plan_info['supports_search'] ) || $this->has_jetpack_search_product();
	}

	/**
	 * Returns true if the plan usage is exceeded and search should no longer work.
	 */
	public function must_upgrade() {
		$plan_info = $this->get_plan_info();
		return isset( $plan_info['plan_usage']['must_upgrade'] ) && $plan_info['plan_usage']['must_upgrade'];
	}

	/**
	 * Returns true if the plan only supports Classic Search.
	 */
	public function supports_only_classic_search() {
		$plan_info = $this->get_plan_info();
		return isset( $plan_info['supports_only_classic_search'] ) && $plan_info['supports_only_classic_search'];
	}

	/**
	 * Whether the plan(s) ever supported search.
	 */
	public function ever_supported_search() {
		return (bool) get_option( self::JETPACK_SEARCH_EVER_SUPPORTED_SEARCH ) || $this->supports_search();
	}

	/**
	 * Returns true if the site is on free plan.
	 */
	public function is_free_plan() {
		$plan_info = $this->get_plan_info();
		return Helper::is_forced_free_plan() || ( isset( $plan_info['effective_subscription']['product_slug'] ) && $plan_info['effective_subscription']['product_slug'] === self::JETPACK_SEARCH_FREE_PRODUCT_SLUG );
	}

	/**
	 * Update `has_jetpack_search_product` regarding the plan information
	 *
	 * @param array|WP_Error $response - Resopnse from WPCOM.
	 * @return bool - true on success, false on failure.
	 */
	public function update_search_plan_info( $response ) {
		if ( is_wp_error( $response ) ) {
			return false;
		}
		$body        = json_decode( wp_remote_retrieve_body( $response ), true );
		$status_code = wp_remote_retrieve_response_code( $response );

		if ( 200 !== $status_code ) {
			return false;
		}

		return $this->set_plan_options( $body );
	}

	/**
	 * Set plan info to options table
	 *
	 * @param array $plan_info - the decoded plan info array.
	 */
	public function set_plan_options( $plan_info ) {
		if ( ! isset( $plan_info['supports_instant_search'] ) ) {
			return false;
		}
		// set option whether has Jetpack Search plan for capability reason.
		if ( get_option( 'has_jetpack_search_product' ) !== (bool) $plan_info['supports_instant_search'] ) {
			update_option( 'has_jetpack_search_product', (bool) $plan_info['supports_instant_search'] );
		}
		// We use this option to determine the visibility of search submenu.
		// If the site ever had search subscription, then we record it and show the menu after.
		if ( $plan_info['supports_instant_search'] ) {
			update_option( self::JETPACK_SEARCH_EVER_SUPPORTED_SEARCH, true, false );
		}
		update_option( self::JETPACK_SEARCH_PLAN_INFO_OPTION_KEY, $plan_info );
		return true;
	}
}
class-rest-controller.php                                                                                                                                                                                                                                      13339         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * The Search Rest Controller class.
 * Registers the REST routes for Search.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Connection\Client;
use Automattic\Jetpack\Connection\Rest_Authentication;
use Automattic\Jetpack\My_Jetpack\Products\Search as Search_Product;
use Automattic\Jetpack\My_Jetpack\Products\Search_Stats as Search_Product_Stats;
use Jetpack_Options;
use WP_Error;
use WP_REST_Request;
use WP_REST_Server;

/**
 * Registers the REST routes for Search.
 */
class REST_Controller {
	/**
	 * Namespace for the REST API.
	 *
	 * This is overriden with value `wpcom-orgin/jetpack/v4` for WPCOM.
	 *
	 * @var string
	 */
	public static $namespace = 'jetpack/v4';
	/**
	 * Whether it's run on WPCOM.
	 *
	 * @var bool
	 */
	protected $is_wpcom;

	/**
	 * Module Control object.
	 *
	 * @var Module_Control
	 */
	protected $search_module;

	/**
	 * Plan object.
	 *
	 * @var Plan
	 */
	public $plan;

	/**
	 * Constructor
	 *
	 * @param bool                $is_wpcom - Whether it's run on WPCOM.
	 * @param Module_Control|null $module_control - Module_Control object if any.
	 * @param Plan|null           $plan - Plan object if any.
	 */
	public function __construct( $is_wpcom = false, $module_control = null, $plan = null ) {
		$this->is_wpcom      = $is_wpcom;
		$this->search_module = $module_control === null ? new Module_Control() : $module_control;
		$this->plan          = $plan === null ? new Plan() : $plan;
	}

	/**
	 * Registers the REST routes for Search.
	 *
	 * @access public
	 * @static
	 */
	public function register_rest_routes() {
		$this->register_common_rest_routes();
		if ( ! Helper::is_wpcom() ) {
			$this->register_jetpack_only_rest_routes();
		} else {
			$this->register_wpcom_only_rest_routes();
		}
	}

	/**
	 * Routes both existing in Jetpack and WPCOM simple sites.
	 */
	protected function register_common_rest_routes() {
		register_rest_route(
			static::$namespace,
			'/search/plan',
			array(
				'methods'             => WP_REST_Server::READABLE,
				'callback'            => array( $this, 'get_search_plan' ),
				'permission_callback' => array( $this, 'require_admin_privilege_callback' ),
			)
		);
		register_rest_route(
			static::$namespace,
			'/search/settings',
			array(
				'methods'             => WP_REST_Server::EDITABLE,
				'callback'            => array( $this, 'update_settings' ),
				'permission_callback' => array( $this, 'require_admin_privilege_callback' ),
			)
		);
		register_rest_route(
			static::$namespace,
			'/search/settings',
			array(
				'methods'             => WP_REST_Server::READABLE,
				'callback'            => array( $this, 'get_settings' ),
				'permission_callback' => array( $this, 'require_admin_privilege_callback' ),
			)
		);
		register_rest_route(
			static::$namespace,
			'/search/stats',
			array(
				'methods'             => WP_REST_Server::READABLE,
				'callback'            => array( $this, 'get_stats' ),
				'permission_callback' => array( $this, 'require_admin_privilege_callback' ),
			)
		);
		register_rest_route(
			static::$namespace,
			'/search/pricing',
			array(
				'methods'             => WP_REST_Server::READABLE,
				'callback'            => array( $this, 'product_pricing' ),
				'permission_callback' => 'is_user_logged_in',
			)
		);
	}

	/**
	 * Routes only existing in Jetpack.
	 */
	protected function register_jetpack_only_rest_routes() {
		register_rest_route(
			static::$namespace,
			'/search/plan/activate',
			array(
				'methods'             => WP_REST_Server::EDITABLE,
				'callback'            => array( $this, 'activate_plan' ),
				'permission_callback' => array( $this, 'require_admin_privilege_callback' ),
			)
		);
		register_rest_route(
			static::$namespace,
			'/search/plan/deactivate',
			array(
				'methods'             => WP_REST_Server::EDITABLE,
				'callback'            => array( $this, 'deactivate_plan' ),
				'permission_callback' => array( $this, 'require_admin_privilege_callback' ),
			)
		);
		register_rest_route(
			static::$namespace,
			'/search',
			array(
				'methods'             => WP_REST_Server::READABLE,
				'callback'            => array( $this, 'get_search_results' ),
				'permission_callback' => 'is_user_logged_in',
			)
		);
		register_rest_route(
			static::$namespace,
			'/search/local-stats',
			array(
				'methods'             => WP_REST_Server::READABLE,
				'callback'            => array( $this, 'get_local_stats' ),
				'permission_callback' => array( $this, 'require_valid_blog_token_callback' ),
			)
		);
	}

	/**
	 * Routes only existing in WPCOM.
	 *
	 * We currently don't have any.
	 */
	protected function register_wpcom_only_rest_routes() {
		return true;
	}

	/**
	 * Only administrators can access the API.
	 *
	 * @return bool|WP_Error True if a blog token was used to sign the request, WP_Error otherwise.
	 */
	public function require_admin_privilege_callback() {
		if ( current_user_can( 'manage_options' ) ) {
			return true;
		}

		return $this->get_forbidden_error();
	}

	/**
	 * The corresponding endpoints can only be accessible from WPCOM.
	 *
	 * @access public
	 * @static
	 *
	 * @return bool|WP_Error True if a blog token was used to sign the request, WP_Error otherwise.
	 */
	public function require_valid_blog_token_callback() {
		if ( Rest_Authentication::is_signed_with_blog_token() ) {
			return true;
		}

		return $this->get_forbidden_error();
	}

	/**
	 * Return a WP_Error object with a forbidden error.
	 */
	protected function get_forbidden_error() {
		$error_msg = esc_html__(
			'You are not allowed to perform this action.',
			'jetpack-search-pkg'
		);

		return new WP_Error( 'rest_forbidden', $error_msg, array( 'status' => rest_authorization_required_code() ) );
	}

	/**
	 * Proxy the request to WPCOM and return the response.
	 *
	 * GET `jetpack/v4/search/plan`
	 */
	public function get_search_plan() {
		$response = ( new Plan() )->get_plan_info_from_wpcom();
		return $this->make_proper_response( $response );
	}

	/**
	 * POST `jetpack/v4/search/settings`
	 *
	 * @param WP_REST_Request $request - REST request.
	 */
	public function update_settings( $request ) {
		$request_body = $request->get_json_params();

		$module_active          = isset( $request_body['module_active'] ) ? (bool) $request_body['module_active'] : null;
		$instant_search_enabled = isset( $request_body['instant_search_enabled'] ) ? (bool) $request_body['instant_search_enabled'] : null;

		$error = $this->validate_search_settings( $module_active, $instant_search_enabled );

		if ( is_wp_error( $error ) ) {
			return $error;
		}

		// Enabling instant search should enable the module too.
		if ( true === $instant_search_enabled && true !== $module_active ) {
			$module_active = true;
		}

		$errors = array();
		if ( $module_active !== null ) {
			$module_active_updated = $this->search_module->update_status( $module_active );
			if ( is_wp_error( $module_active_updated ) ) {
				$errors['module_active'] = $module_active_updated;
			}
		}

		if ( $instant_search_enabled !== null ) {
			$instant_search_enabled_updated = $this->search_module->update_instant_search_status( $instant_search_enabled );
			if ( is_wp_error( $instant_search_enabled_updated ) ) {
				$errors['instant_search_enabled'] = $instant_search_enabled_updated;
			}
		}

		if ( ! empty( $errors ) ) {
			return new WP_Error(
				'some_updated',
				sprintf(
					/* translators: %s are the setting name that not updated. */
					__( 'Some settings ( %s ) not updated.', 'jetpack-search-pkg' ),
					implode(
						',',
						array_keys( $errors )
					)
				),
				array( 'status' => 400 )
			);
		}

		return rest_ensure_response( $this->get_settings() );
	}

	/**
	 * Validate $module_active and $instant_search_enabled. Returns an WP_Error instance if invalid.
	 *
	 * @param boolean $module_active - Module status.
	 * @param boolean $instant_search_enabled - Instant Search status.
	 */
	protected function validate_search_settings( $module_active, $instant_search_enabled ) {
		if ( ( true === $instant_search_enabled && false === $module_active ) || ( $module_active === null && $instant_search_enabled === null ) ) {
			return new WP_Error(
				'rest_invalid_arguments',
				esc_html__( 'The arguments passed in are invalid.', 'jetpack-search-pkg' ),
				array( 'status' => 400 )
			);
		}
		return true;
	}

	/**
	 * GET `jetpack/v4/search/settings`
	 */
	public function get_settings() {
		return rest_ensure_response(
			array(
				'module_active'          => $this->search_module->is_active(),
				'instant_search_enabled' => $this->search_module->is_instant_search_enabled(),
			)
		);
	}

	/**
	 * Proxy the request to WPCOM and return the response.
	 *
	 * GET `jetpack/v4/search/stats`
	 */
	public function get_stats() {
		$response = ( new Stats() )->get_stats_from_wpcom();
		return $this->make_proper_response( $response );
	}

	/**
	 * Search Endpoint for private sites.
	 *
	 * GET `jetpack/v4/search`
	 *
	 * @param WP_REST_Request $request - REST request.
	 */
	public function get_search_results( $request ) {
		$blog_id  = $this->get_blog_id();
		$path     = sprintf( '/sites/%d/search', absint( $blog_id ) );
		$path     = add_query_arg(
			$request->get_query_params(),
			sprintf( '/sites/%d/search', absint( $blog_id ) )
		);
		$response = Client::wpcom_json_api_request_as_blog( $path, '1.3', array(), null, 'rest' );
		return rest_ensure_response( $this->make_proper_response( $response ) );
	}

	/**
	 * Activate plan: activate the search module, instant search and do initial configuration.
	 * Typically called from WPCOM.
	 *
	 * POST `jetpack/v4/search/plan/activate`
	 *
	 * @param WP_REST_Request $request - REST request.
	 */
	public function activate_plan( $request ) {
		$default_options = array(
			'search_plan_info'      => null,
			'enable_search'         => true,
			'enable_instant_search' => true,
			'auto_config_search'    => true,
		);
		$payload         = $request->get_json_params();
		$payload         = wp_parse_args( $payload, $default_options );

		// Update plan data, plan info is in the request body.
		// We do this to avoid another call to WPCOM and reduce latency.
		if ( $payload['search_plan_info'] === null || ! $this->plan->set_plan_options( $payload['search_plan_info'] ) ) {
			$this->plan->get_plan_info_from_wpcom();
		}

		// Enable search module by default, unless `enable_search` is explicitly set to boolean `false`.
		if ( false !== $payload['enable_search'] ) {
			// Eligibility is checked in `activate` function.
			$ret = $this->search_module->activate();
			if ( is_wp_error( $ret ) ) {
				return $ret;
			}
		}

		// Enable instant search by default, unless `enable_instant_search` is explicitly set to boolean `false`.
		if ( false !== $payload['enable_instant_search'] ) {
			// Eligibility is checked in `enable_instant_search` function.
			$ret = $this->search_module->enable_instant_search();
			if ( is_wp_error( $ret ) ) {
				return $ret;
			}
		}

		// Automatically configure necessary settings for instant search, unless `auto_config_search` is explicitly set to boolean `false`.
		if ( false !== $payload['auto_config_search'] ) {
			Instant_Search::instance( $this->get_blog_id() )->auto_config_search();
		}

		return rest_ensure_response(
			array(
				'code' => 'success',
			)
		);
	}

	/**
	 * Deactivate plan: turn off search module and instant search.
	 * If the plan is still valid then the function would simply deactivate the search module.
	 * Typically called from WPCOM.
	 *
	 * POST `jetpack/v4/search/plan/deactivate`
	 */
	public function deactivate_plan() {
		// Instant Search would be disabled along with search module.
		$this->search_module->deactivate();
		return rest_ensure_response(
			array(
				'code' => 'success',
			)
		);
	}

	/**
	 * Return post type breakdown for the site.
	 */
	public function get_local_stats() {
		return array(
			'post_count'          => Search_Product_Stats::estimate_count(),
			'post_type_breakdown' => Search_Product_Stats::get_post_type_breakdown(),
		);
	}

	/**
	 * Pricing for record count of the site
	 */
	public function product_pricing() {
		$tier_pricing = Search_Product::get_pricing_for_ui();
		// we can force the plugin to use the new pricing by appending `new_pricing_202208=1` to URL.
		if ( Helper::is_forced_new_pricing_202208() ) {
			$tier_pricing['pricing_version'] = Plan::JETPACK_SEARCH_NEW_PRICING_VERSION;
		}
		return rest_ensure_response( $tier_pricing );
	}

	/**
	 * Forward remote response to client with error handling.
	 *
	 * @param array|WP_Error $response - Response from WPCOM.
	 */
	protected function make_proper_response( $response ) {
		if ( is_wp_error( $response ) ) {
			return $response;
		}

		$body        = json_decode( wp_remote_retrieve_body( $response ), true );
		$status_code = wp_remote_retrieve_response_code( $response );

		if ( 200 === $status_code ) {
			return $body;
		}

		return new WP_Error(
			isset( $body['error'] ) ? 'remote-error-' . $body['error'] : 'remote-error',
			isset( $body['message'] ) ? $body['message'] : 'unknown remote error',
			array( 'status' => $status_code )
		);
	}

	/**
	 * Get blog id
	 */
	protected function get_blog_id() {
		return $this->is_wpcom ? get_current_blog_id() : Jetpack_Options::get_option( 'id' );
	}
}
class-settings.php                                                                                                                                                                                                                                             2017          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * Jetpack Search Overlay Settings
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

// Exit if file is accessed directly.
if ( ! defined( 'ABSPATH' ) ) {
	exit;
}

/**
 * Class to initialize search settings on the site.
 *
 * 1. Settings are synced to WPCOM according to `Automattic\Jetpack\Sync\Modules\Search::$options_to_sync`.
 * 2. All synced options must also be explicitly whitelisted and sanitized on WPCOM; see `PCYsg-sBM-p2`.
 */
class Settings {

	/**
	 * Class initialization.
	 */
	public function __construct() {
		add_action( 'admin_init', array( $this, 'settings_register' ) );
		add_action( 'rest_api_init', array( $this, 'settings_register' ) );
	}

	/**
	 * Register requisite settings.
	 *
	 * @since 9.x.x
	 */
	public function settings_register() {
		// NOTE: This contains significant code overlap with class-jetpack-search-customize.
		$setting_prefix = Options::OPTION_PREFIX;
		$settings       = array(
			array( $setting_prefix . 'ai_prompt_override', 'string', '' ),
			array( $setting_prefix . 'color_theme', 'string', 'light' ),
			array( $setting_prefix . 'result_format', 'string', 'minimal' ),
			array( $setting_prefix . 'default_sort', 'string', 'relevance' ),
			array( $setting_prefix . 'overlay_trigger', 'string', Options::DEFAULT_OVERLAY_TRIGGER ),
			array( $setting_prefix . 'excluded_post_types', 'string', '' ),
			array( $setting_prefix . 'highlight_color', 'string', '#FFC' ),
			array( $setting_prefix . 'enable_sort', 'boolean', true ),
			array( $setting_prefix . 'inf_scroll', 'boolean', true ),
			array( $setting_prefix . 'filtering_opens_overlay', 'boolean', true ),
			array( $setting_prefix . 'show_post_date', 'boolean', true ),
			array( $setting_prefix . 'show_powered_by', 'boolean', true ),
		);
		foreach ( $settings as $value ) {
			register_setting(
				'options',
				$value[0],
				array(
					'default'      => $value[2],
					'show_in_rest' => true,
					'type'         => $value[1],
				)
			);
		}
	}
}
class-stats.php                                                                                                                                                                                                                                                698           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * Get search stats for use in the wp-admin dashboard.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Connection\Client;
use Jetpack_Options;

/**
 * Search stats (e.g. post count, post type breakdown)
 */
class Stats {
	/**
	 * Get stats from the WordPress.com API for the current blog ID.
	 */
	public function get_stats_from_wpcom() {
		$blog_id = Jetpack_Options::get_option( 'id' );

		if ( ! is_numeric( $blog_id ) ) {
			return null;
		}

		$response = Client::wpcom_json_api_request_as_blog(
			'/sites/' . (int) $blog_id . '/jetpack-search/stats',
			'2',
			array(),
			null,
			'wpcom'
		);

		return $response;
	}
}
class-template-tags.php                                                                                                                                                                                                                                        10286         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <?php
/**
 * Template tags class used primarily for rendering widget-related HTML.
 *
 * @package    automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

/**
 * Class that has various methods for outputting functionality into a theme that doesn't support widgets.
 * Additionally the widget itself makes use of these class.
 *
 * @since 5.8.0
 */
class Template_Tags {

	/**
	 * Renders all available filters that can be used to filter down search results on the frontend.
	 *
	 * @since 5.8.0
	 *
	 * @param array $filters    The available filters for the current query.
	 * @param array $post_types An array of post types to make filterable.
	 */
	public static function render_available_filters( $filters = null, $post_types = null ) {
		if ( $filters === null ) {
			$filters = Classic_Search::instance()->get_filters();
		}

		if ( $post_types === null ) {
			$post_types = get_post_types( array( 'exclude_from_search' => false ) );
		}

		/**
		 * If the post types specified by the widget differ from the default set of searchable post types,
		 * then we need to track their state.
		 */
		$active_post_types = array();
		if ( Helper::post_types_differ_searchable( $post_types ) ) {
			// get the active filter buckets from the query.
			$active_buckets          = Classic_Search::instance()->get_active_filter_buckets();
			$post_types_differ_query = Helper::post_types_differ_query( $post_types );

			// remove any post_type filters from display if the current query
			// already specifies to match all post types.
			if ( ! $post_types_differ_query ) {
				$active_buckets = array_filter( $active_buckets, array( __CLASS__, 'is_not_post_type_filter' ) );
			}

			$active_post_types = Helper::get_active_post_types( $active_buckets );
			if ( empty( $active_post_types ) ) {
				$active_post_types = $post_types;
			}

			if ( $post_types_differ_query ) {
				$filters = Helper::ensure_post_types_on_remove_url( $filters, $post_types );
			} else {
				$filters = Helper::remove_active_from_post_type_buckets( $filters );
			}
		} else {
			$post_types = array();
		}

		foreach ( (array) $filters as $filter ) {
			if ( 'post_type' === $filter['type'] ) {
				self::render_filter( $filter, $post_types );
			} else {
				self::render_filter( $filter, $active_post_types );
			}
		}
	}

	/**
	 * Renders filters for instant search.
	 *
	 * @param array $filters    The available filters for the current query.
	 */
	public static function render_instant_filters( $filters = null ) {
		if ( $filters === null ) {
			$filters = Classic_Search::instance()->get_filters();
		}

		foreach ( (array) $filters as $filter ) {
			self::render_instant_filter( $filter );
		}
	}

	/**
	 * Renders a single filter that can be applied to the current search.
	 *
	 * @since 5.8.0
	 *
	 * @param array $filter             The filter to render.
	 * @param array $default_post_types The default post types for this filter.
	 */
	public static function render_filter( $filter, $default_post_types ) {
		if ( empty( $filter ) || empty( $filter['buckets'] ) ) {
			return;
		}

		$query_vars = null;
		foreach ( $filter['buckets'] as $item ) {
			if ( $item['active'] ) {
				$query_vars = array_keys( $item['query_vars'] );
				break;
			}
		}
		$clear_url = null;
		if ( ! empty( $query_vars ) ) {
			$clear_url = Helper::remove_query_arg( $query_vars );
			if ( ! empty( $default_post_types ) ) {
				$clear_url = Helper::add_post_types_to_url( $clear_url, $default_post_types );
			}
		}

		?>
		<h4 class="jetpack-search-filters-widget__sub-heading">
			<?php echo esc_html( $filter['name'] ); ?>
		</h4>
		<?php if ( $clear_url ) : ?>
			<div class="jetpack-search-filters-widget__clear">
				<a href="<?php echo esc_url( $clear_url ); ?>">
					<?php esc_html_e( '< Clear Filters', 'jetpack-search-pkg' ); ?>
				</a>
			</div>
		<?php endif; ?>
		<ul class="jetpack-search-filters-widget__filter-list">
			<?php
			foreach ( $filter['buckets'] as $item ) :
				$url = ( empty( $item['active'] ) ) ? $item['url'] : $item['remove_url'];
				?>
				<li>
					<label>
						<input type="checkbox"<?php checked( ! empty( $item['active'] ) ); ?> disabled="disabled" />&nbsp;
						<a href="<?php echo esc_url( $url ); ?>">
							<?php
								echo esc_html( $item['name'] );
								echo '&nbsp;';
								echo esc_html(
									sprintf(
										'(%s)',
										number_format_i18n( absint( $item['count'] ) )
									)
								);
							?>
						</a>
					</label>
				</li>
			<?php endforeach; ?>
		</ul>
		<?php
	}

	/**
	 * Renders a single filter for instant search.
	 *
	 * @since 8.3.0
	 *
	 * @param array $filter             The filter to render.
	 */
	public static function render_instant_filter( $filter ) {
		if ( empty( $filter ) || empty( $filter['buckets'] ) ) {
			return;
		}

		$data_base = '';
		$qv        = $filter['buckets'][0]['query_vars'];
		$tax_key   = '';
		switch ( $filter['buckets'][0]['type'] ) {
			case 'taxonomy':
				$data_base = 'data-filter-type="' . esc_attr( $filter['buckets'][0]['type'] ) . '" ';
				$tax_key   = key( $qv );
				if ( 'category_name' === $tax_key ) {
					$data_base .= 'data-taxonomy="category"';
				} elseif ( 'tag' === $tax_key ) {
					$data_base .= 'data-taxonomy="post_tag"';
				} else {
					$data_base .= 'data-taxonomy="' . esc_attr( $tax_key ) . '"';
				}
				break;
			case 'post_type':
				$data_base = 'data-filter-type="post_types" ';
				break;
			case 'author':
				$data_base = 'data-filter-type="authors" ';
				break;
			case 'blog_id':
				$data_base = 'data-filter-type="blog_ids" ';
				break;
			case 'date_histogram':
				if ( $filter['buckets'][0]['query_vars']['monthnum'] ) {
					$data_base = 'data-filter-type="month_post_date" ';
				} else {
					$data_base = 'data-filter-type="year_post_date" ';
				}
				break;
		}

		?>
		<h4 class="jetpack-search-filters-widget__sub-heading">
			<?php echo esc_html( $filter['name'] ); ?>
		</h4>
		<ul class="jetpack-search-filters-widget__filter-list">
			<?php
			foreach ( $filter['buckets'] as $item ) :
				$data_str = $data_base . ' ';
				switch ( $filter['buckets'][0]['type'] ) {
					case 'taxonomy':
						$data_str .= 'data-val="' . esc_attr( $item['query_vars'][ $tax_key ] ) . '"';
						break;
					case 'post_type':
						$data_str .= 'data-val="' . esc_attr( $item['query_vars']['post_type'] ) . '"';
						break;
					case 'author':
						$data_str .= 'data-val="' . esc_attr( $item['query_vars']['author'] ) . '"';
						break;
					case 'blog_id':
						$data_str .= 'data-val="' . esc_attr( $item['query_vars']['blog_id'] ) . '"';
						break;
					case 'date_histogram':
						if ( $item['query_vars']['monthnum'] ) {
							$d = sprintf( '%d-%02d-01 00:00:00', $item['query_vars']['year'], $item['query_vars']['monthnum'] );
						} else {
							$d = sprintf( '%d-01-01 00:00:00', $item['query_vars']['year'] );
						}
						$data_str .= 'data-val="' . esc_attr( $d ) . '" ';
						break;
				}
				?>
				<li>
				<?php // TODO: Figure out how to properly escape $data_str below. ?>
				<a href="#" class="jetpack-search-filter__link" <?php echo $data_str; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>>
						<?php
							echo esc_html( $item['name'] );
							echo '&nbsp;';
							echo esc_html(
								sprintf(
									'(%s)',
									number_format_i18n( absint( $item['count'] ) )
								)
							);
						?>
					</a>
				</li>
			<?php endforeach; ?>
		</ul>
		<?php
	}

	/**
	 * Outputs the search widget's title.
	 *
	 * @since 5.8.0
	 *
	 * @param string $title        The widget's title.
	 * @param string $before_title The HTML tag to display before the title.
	 * @param string $after_title  The HTML tag to display after the title.
	 */
	public static function render_widget_title( $title, $before_title, $after_title ) {
		// This doesn't need to be escaped because it's provided by WP and goes through filters, where it is not escaped.
		echo $before_title . $title . $after_title; //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * Responsible for rendering the search box within our widget on the frontend.
	 *
	 * @since 5.8.0
	 *
	 * @param array  $post_types Array of post types to limit search results to.
	 * @param string $orderby    How to order the search results.
	 * @param string $order      In what direction to order the search results.
	 */
	public static function render_widget_search_form( $post_types, $orderby, $order ) {
		$form = get_search_form( false );

		$fields_to_inject = array(
			'orderby' => $orderby,
			'order'   => $order,
		);

		// If the widget has specified post types to search within and IF the post types differ
		// from the default post types that would have been searched, set the selected post
		// types via hidden inputs.
		if ( Helper::post_types_differ_searchable( $post_types ) ) {
			$fields_to_inject['post_type'] = implode( ',', $post_types );
		}

		$form = self::inject_hidden_form_fields( $form, $fields_to_inject );

		echo '<div class="jetpack-search-form">';
		// TODO: Figure out how to properly escape this.
		echo $form; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
		echo '</div>';
	}

	/**
	 * Modifies an HTML form to add some additional hidden fields.
	 *
	 * @since 5.8.0
	 *
	 * @param string $form   The form HTML to modify.
	 * @param array  $fields Array of hidden fields to add. Key is field name and value is the field value.
	 *
	 * @return string The modified form HTML.
	 */
	private static function inject_hidden_form_fields( $form, $fields ) {
		$form_injection = '';

		foreach ( $fields as $field_name => $field_value ) {
			$form_injection .= sprintf(
				'<input type="hidden" name="%s" value="%s" />',
				esc_attr( $field_name ),
				esc_attr( $field_value )
			);
		}

		// This shouldn't need to be escaped since we've escaped above as we built $form_injection.
		$form = str_replace(
			'</form>',
			$form_injection . '</form>',
			$form
		);

		return $form;
	}

	/**
	 * Internal method for filtering out non-post_type filters.
	 *
	 * @since 5.8.0
	 *
	 * @param array $filter Filter object.
	 *
	 * @return bool
	 */
	private static function is_not_post_type_filter( $filter ) {
		return 'post_type' !== $filter['type'];
	}
}
class-classic-search.php                                                                                                                                                                                                                                       57060         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/classic-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <?php
/**
 * Classic Search: Our original search experience with filtering capability.
 *
 * @package    @automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Connection\Client;
use WP_Error;
use WP_Query;
use WP_Tax_Query;

/**
 * Class responsible for enabling the Classic Search experience on the site.
 */
class Classic_Search {
	/**
	 * The singleton instance of this class.
	 *
	 * @since 5.0.0
	 * @var Classic_Search
	 */
	private static $instance;

	/**
	 * The number of found posts.
	 *
	 * @since 5.0.0
	 * @var int
	 */
	protected $found_posts = 0;

	/**
	 * The search result, as returned by the WordPress.com REST API.
	 *
	 * @since 5.0.0
	 * @var array
	 */
	protected $search_result;

	/**
	 * This site's blog ID on WordPress.com.
	 *
	 * @since 5.0.0
	 * @var int
	 */
	protected $jetpack_blog_id;

	/**
	 * The Elasticsearch aggregations (filters).
	 *
	 * @since 5.0.0
	 * @var array
	 */
	protected $aggregations = array();

	/**
	 * The maximum number of aggregations allowed.
	 *
	 * @since 5.0.0
	 * @var int
	 */
	protected $max_aggregations_count = 100;

	/**
	 * Statistics about the last Elasticsearch query.
	 *
	 * @since 5.6.0
	 * @var array
	 */
	protected $last_query_info = array();

	/**
	 * Statistics about the last Elasticsearch query failure.
	 *
	 * @since 5.6.0
	 * @var array
	 */
	protected $last_query_failure_info = array();

	/**
	 * Languages with custom analyzers. Other languages are supported, but are analyzed with the default analyzer.
	 *
	 * @since 5.0.0
	 * @var array
	 */
	public static $analyzed_langs = array( 'ar', 'bg', 'ca', 'cs', 'da', 'de', 'el', 'en', 'es', 'eu', 'fa', 'fi', 'fr', 'he', 'hi', 'hu', 'hy', 'id', 'it', 'ja', 'ko', 'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr', 'zh' );

	/**
	 * The constructor is not used for this singleton class.
	 */
	protected function __construct() {
	}

	/**
	 * Returns a class singleton. Initializes with first-time setup if given a blog ID parameter.
	 *
	 * @param string $blog_id Blog id.
	 * @return static The class singleton.
	 */
	public static function instance( $blog_id = null ) {
		if ( ! isset( self::$instance ) ) {
			if ( null === $blog_id ) {
				$blog_id = Helper::get_wpcom_site_id();
			}
			self::$instance = new static();
			self::$instance->setup( $blog_id );
		}
		return self::$instance;
	}

	/**
	 * Alias of the instance function.
	 */
	public static function initialize() {
		return call_user_func_array( array( static::class, 'instance' ), func_get_args() );
	}

	/**
	 * Performs setup tasks for the singleton. To be used exclusively after singleton instantitaion.
	 *
	 * @param string $blog_id Blog id.
	 */
	public function setup( $blog_id ) {
		if ( ! $blog_id ) {
			return;
		}

		$this->jetpack_blog_id = $blog_id;
		$this->init_hooks();
	}

	/**
	 * Prevent __clone()'ing of this class.
	 *
	 * @since 5.0.0
	 */
	public function __clone() {
		wp_die( "Please don't __clone Classic_Search" );
	}

	/**
	 * Prevent __wakeup()'ing of this class.
	 *
	 * @since 5.0.0
	 */
	public function __wakeup() {
		wp_die( "Please don't __wakeup Classic_Search" );
	}

	/**
	 * Setup the various hooks needed for the plugin to take over search duties.
	 *
	 * @since 5.0.0
	 */
	public function init_hooks() {
		if ( ! is_admin() ) {
			add_filter( 'posts_pre_query', array( $this, 'filter__posts_pre_query' ), 10, 2 );

			add_filter( 'jetpack_search_es_wp_query_args', array( $this, 'filter__add_date_filter_to_query' ), 10, 2 );

			add_action( 'did_jetpack_search_query', array( $this, 'store_last_query_info' ) );
			add_action( 'failed_jetpack_search_query', array( $this, 'store_query_failure' ) );

			add_action( 'init', array( $this, 'set_filters_from_widgets' ) );

			add_action( 'pre_get_posts', array( $this, 'maybe_add_post_type_as_var' ) );
		} else {
			add_action( 'update_option', array( $this, 'track_widget_updates' ), 10, 3 );
		}

		add_action( 'jetpack_deactivate_module_search', array( $this, 'move_search_widgets_to_inactive' ) );
	}

	/**
	 * Does this site have a VIP index
	 * Get the version number to use when loading the file. Allows us to bypass cache when developing.
	 *
	 * @since 6.0
	 * @return string $script_version Version number.
	 */
	public function has_vip_index() {
		return defined( 'JETPACK_SEARCH_VIP_INDEX' ) && JETPACK_SEARCH_VIP_INDEX;
	}

	/**
	 * When an Elasticsearch query fails, this stores it and enqueues some debug information in the footer.
	 *
	 * @since 5.6.0
	 *
	 * @param array $meta Information about the failure.
	 */
	public function store_query_failure( $meta ) {
		$this->last_query_failure_info = $meta;
		add_action( 'wp_footer', array( $this, 'print_query_failure' ) );
	}

	/**
	 * Outputs information about the last Elasticsearch failure.
	 *
	 * @since 5.6.0
	 */
	public function print_query_failure() {
		if ( $this->last_query_failure_info ) {
			printf(
				'<!-- Jetpack Search failed with code %s: %s - %s -->',
				esc_html( $this->last_query_failure_info['response_code'] ),
				esc_html( $this->last_query_failure_info['json']['error'] ),
				esc_html( $this->last_query_failure_info['json']['message'] )
			);
		}
	}

	/**
	 * Stores information about the last Elasticsearch query and enqueues some debug information in the footer.
	 *
	 * @since 5.6.0
	 *
	 * @param array $meta Information about the query.
	 */
	public function store_last_query_info( $meta ) {
		$this->last_query_info = $meta;
		add_action( 'wp_footer', array( $this, 'print_query_success' ) );
	}

	/**
	 * Outputs information about the last Elasticsearch search.
	 *
	 * @since 5.6.0
	 */
	public function print_query_success() {
		if ( $this->last_query_info ) {
			printf(
				'<!-- Jetpack Search took %s ms, ES time %s ms -->',
				(int) $this->last_query_info['elapsed_time'],
				esc_html( $this->last_query_info['es_time'] )
			);

			if ( isset( $_GET['searchdebug'] ) ) { // phpcs:ignore WordPress.Security.NonceVerification.Recommended
				printf(
					'<!-- Query response data: %s -->',
					esc_html( print_r( $this->last_query_info, 1 ) ) // phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r
				);
			}
		}
	}

	/**
	 * Returns the last query information, or false if no information was stored.
	 *
	 * @since 5.8.0
	 *
	 * @return bool|array
	 */
	public function get_last_query_info() {
		return empty( $this->last_query_info ) ? false : $this->last_query_info;
	}

	/**
	 * Returns the last query failure information, or false if no failure information was stored.
	 *
	 * @since 5.8.0
	 *
	 * @return bool|array
	 */
	public function get_last_query_failure_info() {
		return empty( $this->last_query_failure_info ) ? false : $this->last_query_failure_info;
	}

	/**
	 * Wraps a WordPress filter called "jetpack_search_disable_widget_filters" that allows
	 * developers to disable filters supplied by the search widget. Useful if filters are
	 * being defined at the code level.
	 *
	 * @since      5.7.0
	 * @deprecated 5.8.0 Use Helper::are_filters_by_widget_disabled() directly.
	 *
	 * @return bool
	 */
	public function are_filters_by_widget_disabled() {
		return Helper::are_filters_by_widget_disabled();
	}

	/**
	 * Retrieves a list of known Jetpack search filters widget IDs, gets the filters for each widget,
	 * and applies those filters to this Classic_Search object.
	 *
	 * @since 5.7.0
	 */
	public function set_filters_from_widgets() {
		if ( Helper::are_filters_by_widget_disabled() ) {
			return;
		}

		$filters = Helper::get_filters_from_widgets();

		if ( ! empty( $filters ) ) {
			$this->set_filters( $filters );
		}
	}

	/**
	 * Restricts search results to certain post types via a GET argument.
	 *
	 * @since 5.8.0
	 *
	 * @param WP_Query $query A WP_Query instance.
	 */
	public function maybe_add_post_type_as_var( WP_Query $query ) {
		// phpcs:disable WordPress.Security.NonceVerification.Recommended
		if ( $this->should_handle_query( $query ) && ! empty( $_GET['post_type'] ) ) {
			if ( is_array( $_GET['post_type'] ) ) {
				$post_types = array_map( 'sanitize_key', $_GET['post_type'] );
			} else {
				$post_types = array_map(
					'sanitize_key',
					explode(
						',',
						sanitize_text_field( wp_unslash( $_GET['post_type'] ) )
					)
				);
			}
			// phpcs:enable WordPress.Security.NonceVerification.Recommended
			$query->set( 'post_type', $post_types );
		}
	}

	/**
	 * Run a search on the WordPress.com public API.
	 *
	 * @since 5.0.0
	 *
	 * @param array $es_args Args conforming to the WP.com /sites/<blog_id>/search endpoint.
	 *
	 * @return object|WP_Error The response from the public API, or a WP_Error.
	 */
	public function search( array $es_args ) {
		$endpoint    = sprintf( '/sites/%s/search', $this->jetpack_blog_id );
		$service_url = 'https://public-api.wordpress.com/rest/v1' . $endpoint;

		$do_authenticated_request = false;

		if ( class_exists( 'Automattic\\Jetpack\\Connection\\Client' ) &&
			isset( $es_args['authenticated_request'] ) &&
			true === $es_args['authenticated_request'] ) {
			$do_authenticated_request = true;
		}

		unset( $es_args['authenticated_request'] );

		$request_args = array(
			'headers'    => array(
				'Content-Type' => 'application/json',
			),
			'timeout'    => 10,
			'user-agent' => 'jetpack_search',
		);

		$request_body = wp_json_encode( $es_args );

		$start_time = microtime( true );

		if ( $do_authenticated_request ) {
			$request_args['method'] = 'POST';

			$request = Client::wpcom_json_api_request_as_blog( $endpoint, Client::WPCOM_JSON_API_VERSION, $request_args, $request_body );
		} else {
			$request_args = array_merge(
				$request_args,
				array(
					'body' => $request_body,
				)
			);

			$request = wp_remote_post( $service_url, $request_args );
		}

		$end_time = microtime( true );

		if ( is_wp_error( $request ) ) {
			return $request;
		}
		$response_code = wp_remote_retrieve_response_code( $request );

		if ( ! $response_code || $response_code < 200 || $response_code >= 300 ) {
			return new WP_Error( 'invalid_search_api_response', 'Invalid response from API - ' . $response_code );
		}

		$response = json_decode( wp_remote_retrieve_body( $request ), true );

		$took = is_array( $response ) && ! empty( $response['took'] )
			? $response['took']
			: null;

		$query = array(
			'args'          => $es_args,
			'response'      => $response,
			'response_code' => $response_code,
			'elapsed_time'  => ( $end_time - $start_time ) * 1000, // Convert from float seconds to ms.
			'es_time'       => $took,
			'url'           => $service_url,
		);

		/**
		 * Fires after a search request has been performed.
		 *
		 * Includes the following info in the $query parameter:
		 *
		 * array args Array of Elasticsearch arguments for the search
		 * array response Raw API response, JSON decoded
		 * int response_code HTTP response code of the request
		 * float elapsed_time Roundtrip time of the search request, in milliseconds
		 * float es_time Amount of time Elasticsearch spent running the request, in milliseconds
		 * string url API url that was queried
		 *
		 * @module search
		 *
		 * @since  5.0.0
		 * @since  5.8.0 This action now fires on all queries instead of just successful queries.
		 *
		 * @param array $query Array of information about the query performed
		 */
		do_action( 'did_jetpack_search_query', $query );

		if ( ! $response_code || $response_code < 200 || $response_code >= 300 ) {
			/**
			 * Fires after a search query request has failed
			 *
			 * @module search
			 *
			 * @since  5.6.0
			 *
			 * @param array Array containing the response code and response from the failed search query
			 */
			do_action(
				'failed_jetpack_search_query',
				array(
					'response_code' => $response_code,
					'json'          => $response,
				)
			);

			return new WP_Error( 'invalid_search_api_response', 'Invalid response from API - ' . $response_code );
		}

		return $response;
	}

	/**
	 * Bypass the normal Search query and offload it to Jetpack servers.
	 *
	 * This is the main hook of the plugin and is responsible for returning the posts that match the search query.
	 *
	 * @since 5.0.0
	 *
	 * @param array    $posts Current array of posts (still pre-query).
	 * @param WP_Query $query The WP_Query being filtered.
	 *
	 * @return array Array of matching posts.
	 */
	public function filter__posts_pre_query( $posts, $query ) {
		if ( ! $this->should_handle_query( $query ) ) {
			// Intentionally not adding the 'jetpack_search_abort' action since this should fire for every request except for search.
			return $posts;
		}

		$this->do_search( $query );

		if ( ! is_array( $this->search_result ) ) {
			do_action( 'jetpack_search_abort', 'no_search_results_array', $this->search_result );
			return $posts;
		}

		// If no results, nothing to do.
		if ( ! is_countable( $this->search_result['results']['hits'] ) ) {
			return array();
		}
		if ( ! count( $this->search_result['results']['hits'] ) ) {
			return array();
		}

		$post_ids = array();

		foreach ( $this->search_result['results']['hits'] as $result ) {
			$post_ids[] = (int) $result['fields']['post_id'];
		}

		// Query all posts now.
		$args = array(
			'post__in'            => $post_ids,
			'orderby'             => 'post__in',
			'perm'                => 'readable',
			'post_type'           => 'any',
			'ignore_sticky_posts' => true,
			'suppress_filters'    => true,
			'posts_per_page'      => $query->get( 'posts_per_page' ),
		);

		$posts_query = new WP_Query( $args );

		// WP Core doesn't call the set_found_posts and its filters when filtering posts_pre_query like we do, so need to do these manually.
		$query->found_posts   = $this->found_posts;
		$query->max_num_pages = ceil( $this->found_posts / $query->get( 'posts_per_page' ) );

		return $posts_query->posts;
	}

	/**
	 * Build up the search, then run it against the Jetpack servers.
	 *
	 * @since 5.0.0
	 *
	 * @param WP_Query $query The original WP_Query to use for the parameters of our search.
	 */
	public function do_search( WP_Query $query ) {
		if ( ! $this->should_handle_query( $query ) ) {
			// If we make it here, either 'filter__posts_pre_query' somehow allowed it or a different entry to do_search.
			do_action( 'jetpack_search_abort', 'search_attempted_non_search_query', $query );
			return;
		}

		$page = ( $query->get( 'paged' ) ) ? absint( $query->get( 'paged' ) ) : 1;

		// Get maximum allowed offset and posts per page values for the API.
		$max_offset         = Helper::get_max_offset();
		$max_posts_per_page = Helper::get_max_posts_per_page();

		$posts_per_page = $query->get( 'posts_per_page' );
		if ( $posts_per_page > $max_posts_per_page ) {
			$posts_per_page = $max_posts_per_page;
		}

		// Start building the WP-style search query args.
		// They'll be translated to ES format args later.
		$es_wp_query_args = array(
			'query'          => $query->get( 's' ),
			'posts_per_page' => $posts_per_page,
			'paged'          => $page,
			'orderby'        => $query->get( 'orderby' ),
			'order'          => $query->get( 'order' ),
		);

		if ( ! empty( $this->aggregations ) ) {
			$es_wp_query_args['aggregations'] = $this->aggregations;
		}

		// Did we query for authors?
		if ( $query->get( 'author_name' ) ) {
			$es_wp_query_args['author_name'] = $query->get( 'author_name' );
		}

		$es_wp_query_args['post_type'] = $this->get_es_wp_query_post_type_for_query( $query );
		$es_wp_query_args['terms']     = $this->get_es_wp_query_terms_for_query( $query );

		/**
		 * Modify the search query parameters, such as controlling the post_type.
		 *
		 * These arguments are in the format of WP_Query arguments
		 *
		 * @module search
		 *
		 * @since  5.0.0
		 *
		 * @param array    $es_wp_query_args The current query args, in WP_Query format.
		 * @param WP_Query $query            The original WP_Query object.
		 */
		$es_wp_query_args = apply_filters( 'jetpack_search_es_wp_query_args', $es_wp_query_args, $query );

		// If page * posts_per_page is greater than our max offset, send a 404. This is necessary because the offset is
		// capped at Helper::get_max_offset(), so a high page would always return the last page of results otherwise.
		if ( ( $es_wp_query_args['paged'] * $es_wp_query_args['posts_per_page'] ) > $max_offset ) {
			$query->set_404();

			return;
		}

		// If there were no post types returned, then 404 to avoid querying against non-public post types, which could
		// happen if we don't add the post type restriction to the ES query.
		if ( empty( $es_wp_query_args['post_type'] ) ) {
			$query->set_404();

			return;
		}

		// Convert the WP-style args into ES args.
		$es_query_args = $this->convert_wp_es_to_es_args( $es_wp_query_args );

		// Only trust ES to give us IDs, not the content since it is a mirror.
		$es_query_args['fields'] = array(
			'post_id',
		);

		/**
		 * Modify the underlying ES query that is passed to the search endpoint. The returned args must represent a valid ES query
		 *
		 * This filter is harder to use if you're unfamiliar with ES, but allows complete control over the query
		 *
		 * @module search
		 *
		 * @since  5.0.0
		 *
		 * @param array    $es_query_args The raw Elasticsearch query args.
		 * @param WP_Query $query         The original WP_Query object.
		 */
		$es_query_args = apply_filters( 'jetpack_search_es_query_args', $es_query_args, $query );

		// Do the actual search query!
		$this->search_result = $this->search( $es_query_args );

		if ( is_wp_error( $this->search_result ) || ! is_array( $this->search_result ) || empty( $this->search_result['results'] ) || empty( $this->search_result['results']['hits'] ) ) {
			$this->found_posts = 0;

			return;
		}

		// If we have aggregations, fix the ordering to match the input order (ES doesn't guarantee the return order).
		if ( isset( $this->search_result['results']['aggregations'] ) && ! empty( $this->search_result['results']['aggregations'] ) ) {
			$this->search_result['results']['aggregations'] = $this->fix_aggregation_ordering( $this->search_result['results']['aggregations'], $this->aggregations );
		}

		// Total number of results for paging purposes. Capped at $max_offset + $posts_per_page, as deep paging gets quite expensive.
		$this->found_posts = min( $this->search_result['results']['total'], $max_offset + $posts_per_page );
	}

	/**
	 * If the query has already been run before filters have been updated, then we need to re-run the query
	 * to get the latest aggregations.
	 *
	 * This is especially useful for supporting widget management in the customizer.
	 *
	 * @since 5.8.0
	 *
	 * @return bool Whether the query was successful or not.
	 */
	public function update_search_results_aggregations() {
		if ( empty( $this->last_query_info ) || empty( $this->last_query_info['args'] ) ) {
			return false;
		}

		$es_args = $this->last_query_info['args'];
		$builder = new WPES\Query_Builder();
		$this->add_aggregations_to_es_query_builder( $this->aggregations, $builder );
		$es_args['aggregations'] = $builder->build_aggregation();

		$this->search_result = $this->search( $es_args );

		return ! is_wp_error( $this->search_result );
	}

	/**
	 * Given a WP_Query, convert its WP_Tax_Query (if present) into the WP-style Elasticsearch term arguments for the search.
	 *
	 * @since 5.0.0
	 *
	 * @param WP_Query $query The original WP_Query object for which to parse the taxonomy query.
	 *
	 * @return array The new WP-style Elasticsearch arguments (that will be converted into 'real' Elasticsearch arguments).
	 */
	public function get_es_wp_query_terms_for_query( WP_Query $query ) {
		$args = array();

		$the_tax_query = $query->tax_query;

		if ( ! $the_tax_query ) {
			return $args;
		}

		if ( ! $the_tax_query instanceof WP_Tax_Query || empty( $the_tax_query->queried_terms ) || ! is_array( $the_tax_query->queried_terms ) ) {
			return $args;
		}

		$args = array();

		foreach ( $the_tax_query->queries as $tax_query ) {
			// Right now we only support slugs...see note above.
			if ( ! is_array( $tax_query ) || 'slug' !== $tax_query['field'] ) {
				continue;
			}

			$taxonomy = $tax_query['taxonomy'];

			if ( ! isset( $args[ $taxonomy ] ) || ! is_array( $args[ $taxonomy ] ) ) {
				$args[ $taxonomy ] = array();
			}

			$args[ $taxonomy ] = array_merge( $args[ $taxonomy ], $tax_query['terms'] );
		}

		return $args;
	}

	/**
	 * Parse out the post type from a WP_Query.
	 *
	 * Only allows post types that are not marked as 'exclude_from_search'.
	 *
	 * @since 5.0.0
	 *
	 * @param WP_Query $query Original WP_Query object.
	 *
	 * @return array Array of searchable post types corresponding to the original query.
	 */
	public function get_es_wp_query_post_type_for_query( WP_Query $query ) {
		$post_types = $query->get( 'post_type' );

		// If we're searching 'any', we want to only pass searchable post types to Elasticsearch.
		if ( 'any' === $post_types ) {
			$post_types = array_values(
				get_post_types(
					array(
						'exclude_from_search' => false,
					)
				)
			);
		}

		if ( ! is_array( $post_types ) ) {
			$post_types = array( $post_types );
		}

		$post_types = array_unique( $post_types );

		$sanitized_post_types = array();

		// Make sure the post types are queryable.
		foreach ( $post_types as $post_type ) {
			if ( ! $post_type ) {
				continue;
			}

			$post_type_object = get_post_type_object( $post_type );
			if ( ! $post_type_object || $post_type_object->exclude_from_search ) {
				continue;
			}

			$sanitized_post_types[] = $post_type;
		}

		return $sanitized_post_types;
	}

	/**
	 * Initialize widgets for the Search module (on wp.com only).
	 *
	 * @module search
	 */
	public function action__widgets_init() {
		// NOTE: This module only exists on WPCOM.
		// TODO: Migrate this function to WPCOM!
		require_once __DIR__ . '/class.jetpack-search-widget-filters.php';

		register_widget( 'Jetpack_Search_Widget_Filters' );
	}

	/**
	 * Get the Elasticsearch result.
	 *
	 * @since 5.0.0
	 *
	 * @param bool $raw If true, does not check for WP_Error or return the 'results' array - the JSON decoded HTTP response.
	 *
	 * @return array|bool The search results, or false if there was a failure.
	 */
	public function get_search_result( $raw = false ) {
		if ( $raw ) {
			return $this->search_result;
		}

		return ( ! empty( $this->search_result ) && ! is_wp_error( $this->search_result ) && is_array( $this->search_result ) && ! empty( $this->search_result['results'] ) ) ? $this->search_result['results'] : false;
	}

	/**
	 * Add the date portion of a WP_Query onto the query args.
	 *
	 * @since 5.0.0
	 *
	 * @param array    $es_wp_query_args The Elasticsearch query arguments in WordPress form.
	 * @param WP_Query $query            The original WP_Query.
	 *
	 * @return array The es wp query args, with date filters added (as needed).
	 */
	public function filter__add_date_filter_to_query( array $es_wp_query_args, WP_Query $query ) {
		if ( $query->get( 'year' ) ) {
			if ( $query->get( 'monthnum' ) ) {
				// Padding.
				$date_monthnum = sprintf( '%02d', $query->get( 'monthnum' ) );

				if ( $query->get( 'day' ) ) {
					// Padding.
					$date_day = sprintf( '%02d', $query->get( 'day' ) );

					$date_start = $query->get( 'year' ) . '-' . $date_monthnum . '-' . $date_day . ' 00:00:00';
					$date_end   = $query->get( 'year' ) . '-' . $date_monthnum . '-' . $date_day . ' 23:59:59';
				} else {
					$days_in_month = gmdate( 't', mktime( 0, 0, 0, $query->get( 'monthnum' ), 14, $query->get( 'year' ) ) ); // 14 = middle of the month so no chance of DST issues

					$date_start = $query->get( 'year' ) . '-' . $date_monthnum . '-01 00:00:00';
					$date_end   = $query->get( 'year' ) . '-' . $date_monthnum . '-' . $days_in_month . ' 23:59:59';
				}
			} else {
				$date_start = $query->get( 'year' ) . '-01-01 00:00:00';
				$date_end   = $query->get( 'year' ) . '-12-31 23:59:59';
			}

			$es_wp_query_args['date_range'] = array(
				'field' => 'date',
				'gte'   => $date_start,
				'lte'   => $date_end,
			);
		}

		return $es_wp_query_args;
	}

	/**
	 * Converts WP_Query style args to Elasticsearch args.
	 *
	 * @since 5.0.0
	 *
	 * @param array $args Array of WP_Query style arguments.
	 *
	 * @return array Array of ES style query arguments.
	 */
	public function convert_wp_es_to_es_args( array $args ) {
		$defaults = array(
			'blog_id'        => get_current_blog_id(),
			'query'          => null,    // Search phrase.
			'query_fields'   => array(), // list of fields to search.
			'excess_boost'   => array(), // map of field to excess boost values (multiply).
			'post_type'      => null,    // string or an array.
			'terms'          => array(), // ex: array( 'taxonomy-1' => array( 'slug' ), 'taxonomy-2' => array( 'slug-a', 'slug-b' ) ). phpcs:ignore Squiz.PHP.CommentedOutCode.Found.
			'author'         => null,    // id or an array of ids.
			'author_name'    => array(), // string or an array.
			'date_range'     => null,    // array( 'field' => 'date', 'gt' => 'YYYY-MM-dd', 'lte' => 'YYYY-MM-dd' ); date formats: 'YYYY-MM-dd' or 'YYYY-MM-dd HH:MM:SS'. phpcs:ignore Squiz.PHP.CommentedOutCode.Found.
			'orderby'        => null,    // Defaults to 'relevance' if query is set, otherwise 'date'. Pass an array for multiple orders.
			'order'          => 'DESC',
			'posts_per_page' => 10,
			'offset'         => null,
			'paged'          => null,
			/**
			 * Aggregations. Examples:
			 * array(
			 *     'Tag'       => array( 'type' => 'taxonomy', 'taxonomy' => 'post_tag', 'count' => 10 ) ),
			 *     'Post Type' => array( 'type' => 'post_type', 'count' => 10 ) ),
			 * );
			 */
			'aggregations'   => null,
		);

		$args = wp_parse_args( $args, $defaults );

		$parser = new WPES\Query_Parser(
			$args['query'],
			/**
			 * Filter the languages used by Jetpack Search's Query Parser.
			 *
			 * @module search
			 *
			 * @since  7.9.0
			 *
			 * @param array $languages The array of languages. Default is value of get_locale().
			 */
			apply_filters( 'jetpack_search_query_languages', array( get_locale() ) )
		);

		if ( empty( $args['query_fields'] ) ) {
			if ( $this->has_vip_index() ) {
				// VIP indices do not have per language fields.
				$match_fields = $this->_get_caret_boosted_fields(
					array(
						'title'         => 0.1,
						'content'       => 0.1,
						'excerpt'       => 0.1,
						'tag.name'      => 0.1,
						'category.name' => 0.1,
						'author_login'  => 0.1,
						'author'        => 0.1,
					)
				);

				$boost_fields = $this->_get_caret_boosted_fields(
					$this->_apply_boosts_multiplier(
						array(
							'title'         => 2,
							'tag.name'      => 1,
							'category.name' => 1,
							'author_login'  => 1,
							'author'        => 1,
						),
						$args['excess_boost']
					)
				);

				$boost_phrase_fields = $this->_get_caret_boosted_fields(
					array(
						'title'         => 1,
						'content'       => 1,
						'excerpt'       => 1,
						'tag.name'      => 1,
						'category.name' => 1,
						'author'        => 1,
					)
				);
			} else {
				$match_fields = $parser->merge_ml_fields(
					array(
						'title'         => 0.1,
						'content'       => 0.1,
						'excerpt'       => 0.1,
						'tag.name'      => 0.1,
						'category.name' => 0.1,
					),
					$this->_get_caret_boosted_fields(
						array(
							'author_login' => 0.1,
							'author'       => 0.1,
						)
					)
				);

				$boost_fields = $parser->merge_ml_fields(
					$this->_apply_boosts_multiplier(
						array(
							'title'         => 2,
							'tag.name'      => 1,
							'category.name' => 1,
						),
						$args['excess_boost']
					),
					$this->_get_caret_boosted_fields(
						$this->_apply_boosts_multiplier(
							array(
								'author_login' => 1,
								'author'       => 1,
							),
							$args['excess_boost']
						)
					)
				);

				$boost_phrase_fields = $parser->merge_ml_fields(
					array(
						'title'         => 1,
						'content'       => 1,
						'excerpt'       => 1,
						'tag.name'      => 1,
						'category.name' => 1,
					),
					$this->_get_caret_boosted_fields(
						array(
							'author' => 1,
						)
					)
				);
			}
		} else {
			// If code is overriding the fields, then use that. Important for backwards compatibility.
			$match_fields        = $args['query_fields'];
			$boost_phrase_fields = $match_fields;
			$boost_fields        = null;
		}

		$parser->phrase_filter(
			array(
				'must_query_fields'  => $match_fields,
				'boost_query_fields' => null,
			)
		);
		$parser->remaining_query(
			array(
				'must_query_fields'  => $match_fields,
				'boost_query_fields' => $boost_fields,
			)
		);

		// Boost on phrase matches.
		$parser->remaining_query(
			array(
				'boost_query_fields' => $boost_phrase_fields,
				'boost_query_type'   => 'phrase',
			)
		);

		/**
		 * Modify the recency decay parameters for the search query.
		 *
		 * The recency decay lowers the search scores based on the age of a post relative to an origin date. Basic adjustments:
		 *  - origin: A date. Posts with this date will have the highest score and no decay applied. Default is today.
		 *  - offset: Number of days/months/years (eg 30d). All posts within this time range of the origin (before and after) will have no decay applied. Default is no offset.
		 *  - scale: The number of days/months/years from the origin+offset at which the decay will equal the decay param. Default 360d
		 *  - decay: The amount of decay applied at offset+scale. Default 0.9.
		 *
		 * The curve applied is a Gaussian. More details available at {@see https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html#function-decay}
		 *
		 * @module search
		 *
		 * @since  5.8.0
		 *
		 * @param array $decay_params The decay parameters.
		 * @param array $args         The WP query parameters.
		 */
		$decay_params = apply_filters(
			'jetpack_search_recency_score_decay',
			array(
				'origin' => gmdate( 'Y-m-d' ),
				'scale'  => '360d',
				'decay'  => 0.9,
			),
			$args
		);

		if ( ! empty( $decay_params ) ) {
			// Newer content gets weighted slightly higher.
			$parser->add_decay(
				'gauss',
				array(
					'date_gmt' => $decay_params,
				)
			);
		}

		$es_query_args = array(
			'blog_id' => absint( $args['blog_id'] ),
			'size'    => absint( $args['posts_per_page'] ),
		);

		// ES "from" arg (offset).
		if ( $args['offset'] ) {
			$es_query_args['from'] = absint( $args['offset'] );
		} elseif ( $args['paged'] ) {
			$es_query_args['from'] = max( 0, ( absint( $args['paged'] ) - 1 ) * $es_query_args['size'] );
		}

		$es_query_args['from'] = min( $es_query_args['from'], Helper::get_max_offset() );

		if ( ! is_array( $args['author_name'] ) ) {
			$args['author_name'] = array( $args['author_name'] );
		}

		// ES stores usernames, not IDs, so transform.
		if ( ! empty( $args['author'] ) ) {
			if ( ! is_array( $args['author'] ) ) {
				$args['author'] = array( $args['author'] );
			}

			foreach ( $args['author'] as $author ) {
				$user = get_user_by( 'id', $author );

				if ( $user && ! empty( $user->user_login ) ) {
					$args['author_name'][] = $user->user_login;
				}
			}
		}

		/*
		 * Build the filters from the query elements.
		 * Filters rock because they are cached from one query to the next
		 * but they are cached as individual filters, rather than all combined together.
		 * May get performance boost by also caching the top level boolean filter too.
		 */

		if ( $args['post_type'] ) {
			if ( ! is_array( $args['post_type'] ) ) {
				$args['post_type'] = array( $args['post_type'] );
			}

			$parser->add_filter(
				array(
					'terms' => array(
						'post_type' => $args['post_type'],
					),
				)
			);
		}

		if ( $args['author_name'] ) {
			$parser->add_filter(
				array(
					'terms' => array(
						'author_login' => $args['author_name'],
					),
				)
			);
		}

		if ( ! empty( $args['date_range'] ) && isset( $args['date_range']['field'] ) ) {
			$field = $args['date_range']['field'];

			unset( $args['date_range']['field'] );

			$parser->add_filter(
				array(
					'range' => array(
						$field => $args['date_range'],
					),
				)
			);
		}

		if ( is_array( $args['terms'] ) ) {
			foreach ( $args['terms'] as $tax => $terms ) {
				$terms = (array) $terms;

				if ( count( $terms ) && mb_strlen( $tax ) ) {
					switch ( $tax ) {
						case 'post_tag':
							$tax_fld = 'tag.slug';

							break;

						case 'category':
							$tax_fld = 'category.slug';

							break;

						default:
							$tax_fld = 'taxonomy.' . $tax . '.slug';

							break;
					}

					foreach ( $terms as $term ) {
						$parser->add_filter(
							array(
								'term' => array(
									$tax_fld => $term,
								),
							)
						);
					}
				}
			}
		}

		if ( ! $args['orderby'] ) {
			if ( $args['query'] ) {
				$args['orderby'] = array( 'relevance' );
			} else {
				$args['orderby'] = array( 'date' );
			}
		}

		// Validate the "order" field.
		switch ( strtolower( $args['order'] ) ) {
			case 'asc':
				$args['order'] = 'asc';
				break;

			case 'desc':
			default:
				$args['order'] = 'desc';
				break;
		}

		$es_query_args['sort'] = array();

		foreach ( (array) $args['orderby'] as $orderby ) {
			// Translate orderby from WP field to ES field.
			switch ( $orderby ) {
				case 'relevance':
					// never order by score ascending.
					$es_query_args['sort'][] = array(
						'_score' => array(
							'order' => 'desc',
						),
					);

					break;

				case 'date':
					$es_query_args['sort'][] = array(
						'date' => array(
							'order' => $args['order'],
						),
					);

					break;

				case 'ID':
					$es_query_args['sort'][] = array(
						'id' => array(
							'order' => $args['order'],
						),
					);

					break;

				case 'author':
					$es_query_args['sort'][] = array(
						'author.raw' => array(
							'order' => $args['order'],
						),
					);

					break;
			} // End switch.
		} // End foreach.

		if ( empty( $es_query_args['sort'] ) ) {
			unset( $es_query_args['sort'] );
		}

		// Aggregations.
		if ( ! empty( $args['aggregations'] ) ) {
			$this->add_aggregations_to_es_query_builder( $args['aggregations'], $parser );
		}

		$es_query_args['filter']       = $parser->build_filter();
		$es_query_args['query']        = $parser->build_query();
		$es_query_args['aggregations'] = $parser->build_aggregation();

		return $es_query_args;
	}

	/**
	 * Given an array of aggregations, parse and add them onto the query builder object for use in Elasticsearch.
	 *
	 * @since 5.0.0
	 *
	 * @param array                                        $aggregations Array of aggregations (filters) to add to the query builder.
	 * @param Automattic\Jetpack\Search\WPES\Query_Builder $builder      The builder instance that is creating the Elasticsearch query.
	 */
	public function add_aggregations_to_es_query_builder( array $aggregations, $builder ) {
		foreach ( $aggregations as $label => $aggregation ) {
			if ( ! isset( $aggregation['type'] ) ) {
				continue;
			}
			switch ( $aggregation['type'] ) {
				case 'taxonomy':
					$this->add_taxonomy_aggregation_to_es_query_builder( $aggregation, $label, $builder );

					break;

				case 'post_type':
					$this->add_post_type_aggregation_to_es_query_builder( $aggregation, $label, $builder );

					break;

				case 'author':
					$this->add_author_aggregation_to_es_query_builder( $aggregation, $label, $builder );

					break;

				case 'date_histogram':
					$this->add_date_histogram_aggregation_to_es_query_builder( $aggregation, $label, $builder );

					break;
			}
		}
	}

	/**
	 * Given an individual taxonomy aggregation, add it to the query builder object for use in Elasticsearch.
	 *
	 * @since 5.0.0
	 *
	 * @param array                                        $aggregation The aggregation to add to the query builder.
	 * @param string                                       $label       The 'label' (unique id) for this aggregation.
	 * @param Automattic\Jetpack\Search\WPES\Query_Builder $builder     The builder instance that is creating the Elasticsearch query.
	 */
	public function add_taxonomy_aggregation_to_es_query_builder( array $aggregation, $label, $builder ) {
		$field = null;

		switch ( $aggregation['taxonomy'] ) {
			case 'post_tag':
				$field = 'tag';
				break;

			case 'category':
				$field = 'category';
				break;

			default:
				$field = 'taxonomy.' . $aggregation['taxonomy'];
				break;
		}

		$builder->add_aggs(
			$label,
			array(
				'terms' => array(
					'field' => $field . '.slug',
					'size'  => min( (int) $aggregation['count'], $this->max_aggregations_count ),
				),
			)
		);
	}

	/**
	 * Given an individual post_type aggregation, add it to the query builder object for use in Elasticsearch.
	 *
	 * @since 5.0.0
	 *
	 * @param array                                        $aggregation The aggregation to add to the query builder.
	 * @param string                                       $label       The 'label' (unique id) for this aggregation.
	 * @param Automattic\Jetpack\Search\WPES\Query_Builder $builder     The builder instance that is creating the Elasticsearch query.
	 */
	public function add_post_type_aggregation_to_es_query_builder( array $aggregation, $label, $builder ) {
		$builder->add_aggs(
			$label,
			array(
				'terms' => array(
					'field' => 'post_type',
					'size'  => min( (int) $aggregation['count'], $this->max_aggregations_count ),
				),
			)
		);
	}

	/**
	 * Given an individual author aggregation, add it to the query builder object for use in Elasticsearch.
	 *
	 * @since 0.20.0
	 *
	 * @param array                                        $aggregation The aggregation to add to the query builder.
	 * @param string                                       $label       The 'label' (unique id) for this aggregation.
	 * @param Automattic\Jetpack\Search\WPES\Query_Builder $builder     The builder instance that is creating the Elasticsearch query.
	 */
	public function add_author_aggregation_to_es_query_builder( array $aggregation, $label, $builder ) {
		$builder->add_aggs(
			$label,
			array(
				'terms' => array(
					'field' => 'author_login_slash_name',
					'size'  => min( (int) $aggregation['count'], $this->max_aggregations_count ),
				),
			)
		);
	}

	/**
	 * Given an individual date_histogram aggregation, add it to the query builder object for use in Elasticsearch.
	 *
	 * @since 5.0.0
	 *
	 * @param array                                        $aggregation The aggregation to add to the query builder.
	 * @param string                                       $label       The 'label' (unique id) for this aggregation.
	 * @param Automattic\Jetpack\Search\WPES\Query_Builder $builder     The builder instance that is creating the Elasticsearch query.
	 */
	public function add_date_histogram_aggregation_to_es_query_builder( array $aggregation, $label, $builder ) {
		$args = array(
			'interval' => $aggregation['interval'],
			'field'    => ( ! empty( $aggregation['field'] ) && 'post_date_gmt' === $aggregation['field'] ) ? 'date_gmt' : 'date',
		);

		if ( isset( $aggregation['min_doc_count'] ) ) {
			$args['min_doc_count'] = (int) $aggregation['min_doc_count'];
		} else {
			$args['min_doc_count'] = 1;
		}

		$builder->add_aggs(
			$label,
			array(
				'date_histogram' => $args,
			)
		);
	}

	/**
	 * And an existing filter object with a list of additional filters.
	 *
	 * Attempts to optimize the filters somewhat.
	 *
	 * @since 5.0.0
	 *
	 * @param array $curr_filter The existing filters to build upon.
	 * @param array $filters     The new filters to add.
	 *
	 * @return array The resulting merged filters.
	 */
	public static function and_es_filters( array $curr_filter, array $filters ) {
		if ( ! is_array( $curr_filter ) || isset( $curr_filter['match_all'] ) ) {
			if ( 1 === count( $filters ) ) {
				return $filters[0];
			}

			return array(
				'and' => $filters,
			);
		}

		return array(
			'and' => array_merge( array( $curr_filter ), $filters ),
		);
	}

	/**
	 * Set the available filters for the search.
	 *
	 * These get rendered via the Jetpack_Search_Widget() widget.
	 *
	 * Behind the scenes, these are implemented using Elasticsearch Aggregations.
	 *
	 * If you do not require counts of how many documents match each filter, please consider using regular WP Query
	 * arguments instead, such as via the jetpack_search_es_wp_query_args filter
	 *
	 * @see    https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html
	 *
	 * @since  5.0.0
	 *
	 * @param array $aggregations Array of filters (aggregations) to apply to the search.
	 */
	public function set_filters( array $aggregations ) {
		foreach ( (array) $aggregations as $key => $agg ) {
			if ( empty( $agg['name'] ) ) {
				$aggregations[ $key ]['name'] = $key;
			}
		}
		$this->aggregations = $aggregations;
	}

	/**
	 * Get the raw Aggregation results from the Elasticsearch response.
	 *
	 * @since  5.0.0
	 *
	 * @see    https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html
	 *
	 * @return array Array of Aggregations performed on the search.
	 */
	public function get_search_aggregations_results() {
		$aggregations = array();

		$search_result = $this->get_search_result();

		if ( ! empty( $search_result ) && ! empty( $search_result['aggregations'] ) ) {
			$aggregations = $search_result['aggregations'];
		}

		return $aggregations;
	}

	/**
	 * Get the results of the Filters performed, including the number of matching documents.
	 *
	 * Returns an array of Filters (keyed by $label, as passed to Classic_Search::set_filters()), containing the Filter and all resulting
	 * matching buckets, the url for applying/removing each bucket, etc.
	 *
	 * NOTE - if this is called before the search is performed, an empty array will be returned. Use the $aggregations class
	 * member if you need to access the raw filters set in Classic_Search::set_filters().
	 *
	 * @since 5.0.0
	 *
	 * @param WP_Query $query The optional original WP_Query to use for determining which filters are active. Defaults to the main query.
	 *
	 * @return array Array of filters applied and info about them.
	 */
	public function get_filters( WP_Query $query = null ) {
		if ( ! $query instanceof WP_Query ) {
			global $wp_query;

			$query = $wp_query;
		}

		$aggregation_data = $this->aggregations;

		if ( empty( $aggregation_data ) ) {
			return $aggregation_data;
		}

		$aggregation_results = $this->get_search_aggregations_results();

		if ( ! $aggregation_results ) {
			return $aggregation_data;
		}

		// NOTE - Looping over the _results_, not the original configured aggregations, so we get the 'real' data from ES.
		foreach ( $aggregation_results as $label => $aggregation ) {
			if ( empty( $aggregation ) ) {
				continue;
			}

			$type = $this->aggregations[ $label ]['type'];

			$aggregation_data[ $label ]['buckets'] = array();

			$existing_term_slugs = array();

			$tax_query_var = null;

			// Figure out which terms are active in the query, for this taxonomy.
			if ( 'taxonomy' === $this->aggregations[ $label ]['type'] ) {
				$tax_query_var = $this->get_taxonomy_query_var( $this->aggregations[ $label ]['taxonomy'] );

				if ( ! empty( $query->tax_query ) && ! empty( $query->tax_query->queries ) && is_array( $query->tax_query->queries ) ) {
					foreach ( $query->tax_query->queries as $tax_query ) {
						if ( is_array( $tax_query ) && $this->aggregations[ $label ]['taxonomy'] === $tax_query['taxonomy'] &&
							'slug' === $tax_query['field'] &&
							is_array( $tax_query['terms'] ) ) {
							$existing_term_slugs = array_merge( $existing_term_slugs, $tax_query['terms'] );
						}
					}
				}
			}

			// Now take the resulting found aggregation items and generate the additional info about them, such as activation/deactivation url, name, count, etc.
			$buckets = array();

			if ( ! empty( $aggregation['buckets'] ) ) {
				$buckets = (array) $aggregation['buckets'];
			}

			if ( 'date_histogram' === $type ) {
				// re-order newest to oldest.
				$buckets = array_reverse( $buckets );
			}

			// Some aggregation types like date_histogram don't support the max results parameter.
			if ( is_int( $this->aggregations[ $label ]['count'] ) && count( $buckets ) > $this->aggregations[ $label ]['count'] ) {
				$buckets = array_slice( $buckets, 0, $this->aggregations[ $label ]['count'] );
			}

			foreach ( $buckets as $item ) {
				$query_vars = array();
				$active     = false;
				$remove_url = null;
				$name       = '';

				// What type was the original aggregation?
				switch ( $type ) {
					case 'taxonomy':
						$taxonomy = $this->aggregations[ $label ]['taxonomy'];

						$term = get_term_by( 'slug', $item['key'], $taxonomy );

						if ( ! $term || ! $tax_query_var ) {
							continue 2; // switch() is considered a looping structure.
						}

						$query_vars = array(
							$tax_query_var => implode( '+', array_merge( $existing_term_slugs, array( $term->slug ) ) ),
						);

						$name = $term->name;

						// Let's determine if this term is active or not.

						if ( in_array( $item['key'], $existing_term_slugs, true ) ) {
							$active = true;

							$slug_count = count( $existing_term_slugs );

							if ( $slug_count > 1 ) {
								$remove_url = Helper::add_query_arg(
									$tax_query_var,
									rawurlencode( implode( '+', array_diff( $existing_term_slugs, array( $item['key'] ) ) ) )
								);
							} else {
								$remove_url = Helper::remove_query_arg( $tax_query_var );
							}
						}

						break;

					case 'post_type':
						$post_type = get_post_type_object( $item['key'] );

						if ( ! $post_type || $post_type->exclude_from_search ) {
							continue 2;  // switch() is considered a looping structure.
						}

						$query_vars = array(
							'post_type' => $item['key'],
						);

						$name = $post_type->labels->singular_name;

						// Is this post type active on this search?
						$post_types = $query->get( 'post_type' );

						if ( ! is_array( $post_types ) ) {
							$post_types = array( $post_types );
						}

						if ( in_array( $item['key'], $post_types, true ) ) {
							$active = true;

							$post_type_count = count( $post_types );

							// For the right 'remove filter' url, we need to remove the post type from the array, or remove the param entirely if it's the only one.
							if ( $post_type_count > 1 ) {
								$remove_url = Helper::add_query_arg(
									'post_type',
									rawurlencode( implode( ',', array_diff( $post_types, array( $item['key'] ) ) ) )
								);
							} else {
								$remove_url = Helper::remove_query_arg( 'post_type' );
							}
						}

						break;

					// The `author` filter is NOT supported in Classic Search. This is used to keep the compatibility for filters outside the overlay with Instant Search.
					case 'author':
						$split_names = preg_split( '/\/(.?)/', $item['key'] );

						$name = '';

						if ( false !== $split_names ) {
							$name = $split_names[0];
						}

						if ( empty( $name ) ) {
							continue 2;  // switch() is considered a looping structure.
						}

						$query_vars = array(
							'author' => $name,
						);

						$active = true;

						$remove_url = Helper::remove_query_arg( 'author' );

						break;

					case 'date_histogram':
						$timestamp = $item['key'] / 1000;

						$current_year  = $query->get( 'year' );
						$current_month = $query->get( 'monthnum' );
						$current_day   = $query->get( 'day' );

						switch ( $this->aggregations[ $label ]['interval'] ) {
							case 'year':
								$year = (int) gmdate( 'Y', $timestamp );

								$query_vars = array(
									'year'     => $year,
									'monthnum' => false,
									'day'      => false,
								);

								$name = $year;

								// Is this year currently selected?
								if ( ! empty( $current_year ) && (int) $current_year === $year ) {
									$active = true;

									$remove_url = Helper::remove_query_arg( array( 'year', 'monthnum', 'day' ) );
								}

								break;

							case 'month':
								$year  = (int) gmdate( 'Y', $timestamp );
								$month = (int) gmdate( 'n', $timestamp );

								$query_vars = array(
									'year'     => $year,
									'monthnum' => $month,
									'day'      => false,
								);

								$name = gmdate( 'F Y', $timestamp );

								// Is this month currently selected?
								if ( ! empty( $current_year ) && (int) $current_year === $year &&
									! empty( $current_month ) && (int) $current_month === $month ) {
									$active = true;

									$remove_url = Helper::remove_query_arg( array( 'year', 'monthnum' ) );
								}

								break;

							case 'day':
								$year  = (int) gmdate( 'Y', $timestamp );
								$month = (int) gmdate( 'n', $timestamp );
								$day   = (int) gmdate( 'j', $timestamp );

								$query_vars = array(
									'year'     => $year,
									'monthnum' => $month,
									'day'      => $day,
								);

								$name = gmdate( 'F jS, Y', $timestamp );

								// Is this day currently selected?
								if ( ! empty( $current_year ) && (int) $current_year === $year &&
									! empty( $current_month ) && (int) $current_month === $month &&
									! empty( $current_day ) && (int) $current_day === $day ) {
									$active = true;

									$remove_url = Helper::remove_query_arg( array( 'day' ) );
								}

								break;

							default:
								continue 3; // switch() is considered a looping structure.
						} // End switch.

						break;

					default:
						// continue 2; // switch() is considered a looping structure.
				} // End switch.

				// Need to urlencode param values since add_query_arg doesn't.
				$url_params = urlencode_deep( $query_vars );

				$aggregation_data[ $label ]['buckets'][] = array(
					'url'        => Helper::add_query_arg( $url_params ),
					'query_vars' => $query_vars,
					'name'       => $name,
					'count'      => $item['doc_count'],
					'active'     => $active,
					'remove_url' => $remove_url,
					'type'       => $type,
					'type_label' => $aggregation_data[ $label ]['name'],
					'widget_id'  => ! empty( $aggregation_data[ $label ]['widget_id'] ) ? $aggregation_data[ $label ]['widget_id'] : 0,
				);
			} // End foreach.
		} // End foreach.

		/**
		 * Modify the aggregation filters returned by get_filters().
		 *
		 * Useful if you are setting custom filters outside of the supported filters (taxonomy, post_type etc.) and
		 * want to hook them up so they're returned when you call `get_filters()`.
		 *
		 * @module search
		 *
		 * @since  6.9.0
		 *
		 * @param array    $aggregation_data The array of filters keyed on label.
		 * @param WP_Query $query            The WP_Query object.
		 */
		return apply_filters( 'jetpack_search_get_filters', $aggregation_data, $query );
	}

	/**
	 * Get the filters that are currently applied to this search.
	 *
	 * @since 5.0.0
	 *
	 * @return array Array of filters that were applied.
	 */
	public function get_active_filter_buckets() {
		$active_buckets = array();

		$filters = $this->get_filters();

		if ( ! is_array( $filters ) ) {
			return $active_buckets;
		}

		foreach ( $filters as $filter ) {
			if ( isset( $filter['buckets'] ) && is_array( $filter['buckets'] ) ) {
				foreach ( $filter['buckets'] as $item ) {
					if ( isset( $item['active'] ) && $item['active'] ) {
						$active_buckets[] = $item;
					}
				}
			}
		}

		return $active_buckets;
	}

	/**
	 * Calculate the right query var to use for a given taxonomy.
	 *
	 * Allows custom code to modify the GET var that is used to represent a given taxonomy, via the jetpack_search_taxonomy_query_var filter.
	 *
	 * @since 5.0.0
	 *
	 * @param string $taxonomy_name The name of the taxonomy for which to get the query var.
	 *
	 * @return bool|string The query var to use for this taxonomy, or false if none found.
	 */
	public function get_taxonomy_query_var( $taxonomy_name ) {
		$taxonomy = get_taxonomy( $taxonomy_name );

		if ( ! $taxonomy || is_wp_error( $taxonomy ) ) {
			return false;
		}

		/**
		 * Modify the query var to use for a given taxonomy
		 *
		 * @module search
		 *
		 * @since  5.0.0
		 *
		 * @param string $query_var     The current query_var for the taxonomy
		 * @param string $taxonomy_name The taxonomy name
		 */
		return apply_filters( 'jetpack_search_taxonomy_query_var', $taxonomy->query_var, $taxonomy_name );
	}

	/**
	 * Takes an array of aggregation results, and ensures the array key ordering matches the key order in $desired
	 * which is the input order.
	 *
	 * Necessary because ES does not always return aggregations in the same order that you pass them in,
	 * and it should be possible to control the display order easily.
	 *
	 * @since 5.0.0
	 *
	 * @param array $aggregations Aggregation results to be reordered.
	 * @param array $desired      Array with keys representing the desired ordering.
	 *
	 * @return array A new array with reordered keys, matching those in $desired.
	 */
	public function fix_aggregation_ordering( array $aggregations, array $desired ) {
		if ( empty( $aggregations ) || empty( $desired ) ) {
			return $aggregations;
		}

		$reordered = array();

		foreach ( array_keys( $desired ) as $agg_name ) {
			if ( isset( $aggregations[ $agg_name ] ) ) {
				$reordered[ $agg_name ] = $aggregations[ $agg_name ];
			}
		}

		return $reordered;
	}

	/**
	 * Sends events to Tracks when a search filters widget is updated.
	 *
	 * @since 5.8.0
	 *
	 * @param string $option    The option name. Only "widget_jetpack-search-filters" is cared about.
	 * @param array  $old_value The old option value.
	 * @param array  $new_value The new option value.
	 */
	public function track_widget_updates( $option, $old_value, $new_value ) {
		if ( 'widget_jetpack-search-filters' !== $option ) {
			return;
		}

		$event = Helper::get_widget_tracks_value( $old_value, $new_value );
		if ( ! $event ) {
			return;
		}

		$tracking = new \Automattic\Jetpack\Tracking();
		$tracking->tracks_record_event(
			wp_get_current_user(),
			sprintf( 'jetpack_search_widget_%s', $event['action'] ),
			$event['widget']
		);
	}

	/**
	 * Moves any active search widgets to the inactive category.
	 *
	 * @since 5.9.0
	 */
	public function move_search_widgets_to_inactive() {
		if ( ! is_active_widget( false, false, Helper::FILTER_WIDGET_BASE, true ) ) {
			return;
		}

		$sidebars_widgets = wp_get_sidebars_widgets();

		if ( ! is_array( $sidebars_widgets ) ) {
			return;
		}

		$changed = false;

		foreach ( $sidebars_widgets as $sidebar => $widgets ) {
			if ( 'wp_inactive_widgets' === $sidebar || str_starts_with( $sidebar, 'orphaned_widgets' ) ) {
				continue;
			}

			if ( is_array( $widgets ) ) {
				foreach ( $widgets as $key => $widget ) {
					if ( _get_widget_id_base( $widget ) === Helper::FILTER_WIDGET_BASE ) {
						$changed = true;

						array_unshift( $sidebars_widgets['wp_inactive_widgets'], $widget );
						unset( $sidebars_widgets[ $sidebar ][ $key ] );
					}
				}
			}
		}

		if ( $changed ) {
			wp_set_sidebars_widgets( $sidebars_widgets );
		}
	}

	/**
	 * Determine whether a given WP_Query should be handled by ElasticSearch.
	 *
	 * @param WP_Query $query The WP_Query object.
	 *
	 * @return bool
	 */
	public function should_handle_query( $query ) {
		/**
		 * Determine whether a given WP_Query should be handled by ElasticSearch.
		 *
		 * @module search
		 *
		 * @since  5.6.0
		 *
		 * @param bool     $should_handle Should be handled by Jetpack Search.
		 * @param WP_Query $query         The WP_Query object.
		 */
		return apply_filters( 'jetpack_search_should_handle_query', $query->is_main_query() && $query->is_search(), $query );
	}

	/**
	 * Transforms an array with fields name as keys and boosts as value into
	 * shorthand "caret" format.
	 *
	 * @param array $fields_boost [ "title" => "2", "content" => "1" ].
	 *
	 * @return array [ "title^2", "content^1" ]
	 */
	private function _get_caret_boosted_fields( array $fields_boost ) { // phpcs:ignore PSR2.Methods.MethodDeclaration.Underscore
		$caret_boosted_fields = array();
		foreach ( $fields_boost as $field => $boost ) {
			$caret_boosted_fields[] = "$field^$boost";
		}
		return $caret_boosted_fields;
	}

	/**
	 * Apply a multiplier to boost values.
	 *
	 * @param array $fields_boost [ "title" => 2, "content" => 1 ].
	 * @param array $fields_boost_multiplier [ "title" => 0.1234 ].
	 *
	 * @return array [ "title" => "0.247", "content" => "1.000" ]
	 */
	private function _apply_boosts_multiplier( array $fields_boost, array $fields_boost_multiplier ) { // phpcs:ignore PSR2.Methods.MethodDeclaration.Underscore
		foreach ( $fields_boost as $field_name => $field_boost ) {
			if ( isset( $fields_boost_multiplier[ $field_name ] ) ) {
				$fields_boost[ $field_name ] *= $fields_boost_multiplier[ $field_name ];
			}

			// Set a floor and format the number as string.
			$fields_boost[ $field_name ] = number_format(
				max( 0.001, $fields_boost[ $field_name ] ),
				3,
				'.',
				''
			);
		}

		return $fields_boost;
	}
}
class-customberg.php                                                                                                                                                                                                                                           4854          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/customberg                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <?php
/**
 * A class that adds a search customization interface to wp-admin.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Assets;
use Automattic\Jetpack\Connection\Manager as Connection_Manager;
use Automattic\Jetpack\Status;
use Automattic\Jetpack\Tracking;

/**
 * Responsible for adding a search customization interface to wp-admin.
 *
 * @package Automattic\Jetpack\Search
 */
class Customberg {
	/**
	 * The singleton instance of this class.
	 *
	 * @var Customberg
	 */
	protected static $instance;

	/**
	 * Search Plan class.
	 *
	 * @var Plan
	 */
	public $plan;

	/**
	 * Get the singleton instance of the class.
	 *
	 * @return Customberg
	 */
	public static function instance() {
		if ( ! isset( self::$instance ) ) {
			self::$instance = new static();
			self::$instance->init_hooks();
		}

		return self::$instance;
	}

	/**
	 * Adds action hooks.
	 */
	public function init_hooks() {
		add_action( 'admin_menu', array( $this, 'add_wp_admin_page' ), 999 );
		add_filter( 'pre_option_jetpack_search_show_powered_by', array( $this, 'get_show_powered_by' ) );
		$this->plan = new Plan();
	}

	/**
	 * Adds a wp-admin page without adding a sidebar submenu item.
	 */
	public function add_wp_admin_page() {
		if ( ! $this->should_add_page() ) {
			return;
		}

		// Intentionally omits adding a submenu via the first empty argument.
		$hook = add_submenu_page(
			'',
			__( 'Jetpack Search', 'jetpack-search-pkg' ),
			__( 'Search', 'jetpack-search-pkg' ),
			'manage_options', // Must be an admin.
			'jetpack-search-configure',
			array( $this, 'jetpack_search_admin_page' )
		);

		add_action( "admin_print_scripts-$hook", array( $this, 'load_assets' ) );
		add_action( 'admin_footer', array( 'Automattic\Jetpack\Search\Helper', 'print_instant_search_sidebar' ) );
	}

	/**
	 * Force option value to be true if in free plan.
	 *
	 * @param string $value The incoming value to be replaced.
	 */
	public function get_show_powered_by( $value ) {
		if ( $this->plan->is_free_plan() ) {
			return true;
		}
		return $value;
	}

	/**
	 * Prints the dashboard container.
	 */
	public function jetpack_search_admin_page() {
		// TODO: Spin this function off into a static helper function in a helper class for code reuse.
		$static_url = apply_filters( 'jetpack_static_url', '//en.wordpress.com/i/loading/loading-64.gif' );
		?>
			<div id="jp-search-configure" class="jp-search-configure-dashboard" style="height: calc(100vh - 100px);">
				<div class="hide-if-no-js" style="height: 100%;">
					<img class="jp-search-loader" width="32" height="32" alt="<?php esc_attr_e( 'Loading&hellip;', 'jetpack-search-pkg' ); ?>" src="<?php echo esc_url( $static_url ); ?>" style="
						position: absolute;
						left: 50%;
						top: 50%;
					"/>
				</div>
				<div class="hide-if-js"><?php esc_html_e( 'Your Jetpack Search customization page requires JavaScript to function properly.', 'jetpack-search-pkg' ); ?></div>
			</div>
		<?php
	}

	/**
	 * Loads assets for the customization experience.
	 */
	public function load_assets() {
			$this->load_assets_with_parameters( Package::get_installed_path() );
	}

	/**
	 * Loads script and style assets according to parameters provided.
	 *
	 * @param string $package_base_path - Base path for the search package.
	 */
	public function load_assets_with_parameters( $package_base_path ) {
		Tracking::register_tracks_functions_scripts( true );

		Assets::register_script(
			'jp-search-configure',
			'build/customberg/jp-search-configure.js',
			$package_base_path . '/src', // A full path to a file or a directory inside a plugin.
			array(
				'css_dependencies' => array(
					'wp-components',
					'wp-block-editor',
				),
				'in_footer'        => true,
				'textdomain'       => 'jetpack-search-pkg',
			)
		);
		Assets::enqueue_script( 'jp-search-configure' );

		// Use wp_add_inline_script instead of wp_localize_script, see https://core.trac.wordpress.org/ticket/25280.
		wp_add_inline_script( 'jp-search-configure', 'var JetpackInstantSearchOptions=JSON.parse(decodeURIComponent("' . rawurlencode( wp_json_encode( Helper::generate_initial_javascript_state() ) ) . '"));', 'before' );
		wp_add_inline_script(
			'jp-search-configure',
			"window.jetpackSearchConfigureInit( 'jp-search-configure' )"
		);
	}

	/**
	 * Determine if the requisite page should be added to wp-admin.
	 *
	 * @return boolean
	 */
	protected function should_add_page() {
		$is_offline_mode = ( new Status() )->is_offline_mode();
		$is_connected    = ( new Connection_Manager( Package::SLUG ) )->is_connected();
		$supports_search = ( new Plan() )->supports_instant_search();

		return (
			! $is_offline_mode && // Must be online.
			$is_connected && // Must be connected.
			$supports_search // Must have plan supporting Jetpack (Instant) Search.
		);
	}
}
class-customizer.php                                                                                                                                                                                                                                           9678          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/customizer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <?php
/**
 * Jetpack Search Customizer Integration
 *
 * @package    @automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Assets;
use WP_Customize_Color_Control;

/**
 * Class to customize search on the site.
 */
class Customizer {
	/**
	 * Search Plan class.
	 *
	 * @var Plan
	 */
	public $plan;

	/**
	 * Class initialization.
	 */
	public function __construct() {
		add_action( 'customize_register', array( $this, 'customize_register' ) );
		add_action( 'customize_controls_enqueue_scripts', array( $this, 'customize_controls_enqueue_scripts' ) );
		$this->plan = new Plan();
	}

	/**
	 * Initialize Customizer controls.
	 *
	 * @param WP_Customize_Manager $wp_customize Customizer instance.
	 */
	public function customize_register( $wp_customize ) {
		$section_id     = 'jetpack_search';
		$setting_prefix = Options::OPTION_PREFIX;

		$wp_customize->add_section(
			$section_id,
			array(
				'title'      => esc_html__( 'Jetpack Search', 'jetpack-search-pkg' ),
				'capability' => 'edit_theme_options',
				'priority'   => 200,
			)
		);

		$id = $setting_prefix . 'color_theme';
		$wp_customize->add_setting(
			$id,
			array(
				'default'   => 'light',
				'transport' => 'postMessage',
				'type'      => 'option',
			)
		);
		$wp_customize->add_control(
			$id,
			array(
				'label'       => __( 'Theme', 'jetpack-search-pkg' ),
				'description' => __( 'Select a theme for your search overlay.', 'jetpack-search-pkg' ),
				'section'     => $section_id,
				'type'        => 'radio',
				'choices'     => array(
					'light' => __( 'Light', 'jetpack-search-pkg' ),
					'dark'  => __( 'Dark', 'jetpack-search-pkg' ),
				),
			)
		);

		$id = $setting_prefix . 'result_format';
		$wp_customize->add_setting(
			$id,
			array(
				'default'   => 'minimal',
				'transport' => 'postMessage',
				'type'      => 'option',
			)
		);
		$wp_customize->add_control(
			$id,
			array(
				'label'       => __( 'Result Format', 'jetpack-search-pkg' ),
				'description' => __( 'Choose how the search results look.', 'jetpack-search-pkg' ),
				'section'     => $section_id,
				'type'        => 'select',
				'choices'     => array(
					'minimal'  => __( 'Minimal', 'jetpack-search-pkg' ),
					'expanded' => __( 'Expanded (shows images)', 'jetpack-search-pkg' ),
					'product'  => __( 'Product (for WooCommerce stores)', 'jetpack-search-pkg' ),
				),
			)
		);

		$id = $setting_prefix . 'default_sort';
		$wp_customize->add_setting(
			$id,
			array(
				'default' => 'relevance',
				'type'    => 'option',
			)
		);
		$wp_customize->add_control(
			$id,
			array(
				'choices'     => array(
					'relevance'   => __( 'Relevance (recommended)', 'jetpack-search-pkg' ),
					'newest'      => __( 'Newest first', 'jetpack-search-pkg' ),
					'oldest'      => __( 'Oldest first', 'jetpack-search-pkg' ),
					'rating_desc' => __( 'Product rating', 'jetpack-search-pkg' ),
					'price_asc'   => __( 'Price: low to high', 'jetpack-search-pkg' ),
					'price_desc'  => __( 'Price: high to low', 'jetpack-search-pkg' ),
				),
				'description' => __( 'Pick the initial sort for your search results.', 'jetpack-search-pkg' ),
				'label'       => __( 'Default Sort', 'jetpack-search-pkg' ),
				'section'     => $section_id,
				'type'        => 'select',
			)
		);

		$id = $setting_prefix . 'overlay_trigger';
		$wp_customize->add_setting(
			$id,
			array(
				'default'   => Options::DEFAULT_OVERLAY_TRIGGER,
				'transport' => 'postMessage',
				'type'      => 'option',
			)
		);
		$wp_customize->add_control(
			$id,
			array(
				'label'       => __( 'Search Input Overlay Trigger', 'jetpack-search-pkg' ),
				'description' => __( 'Select when your overlay should appear.', 'jetpack-search-pkg' ),
				'section'     => $section_id,
				'type'        => 'select',
				'choices'     => array(
					Options::OVERLAY_TRIGGER_SUBMIT    => __( 'Open when user submits the form (recommended)', 'jetpack-search-pkg' ),
					Options::OVERLAY_TRIGGER_IMMEDIATE => __( 'Open when user starts typing', 'jetpack-search-pkg' ),
				),
			)
		);

		$id = $setting_prefix . 'filtering_opens_overlay_settings';
		$wp_customize->add_setting(
			$id,
			array( 'type' => 'option' )
		);
		$wp_customize->add_control(
			new Label_Control(
				$wp_customize,
				$id,
				array(
					'label'       => __( 'Filtering Search Overlay', 'jetpack-search-pkg' ),
					'description' => __( 'Open overlay when filters are used outside the Jetpack Sidebar', 'jetpack-search-pkg' ),
					'section'     => $section_id,
				)
			)
		);

		$id = $setting_prefix . 'filtering_opens_overlay';
		$wp_customize->add_setting(
			$id,
			array(
				'default'              => '1',
				'sanitize_callback'    => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value' ),
				'sanitize_js_callback' => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value_for_js' ),
				'transport'            => 'postMessage',
				'type'                 => 'option',
			)
		);
		$wp_customize->add_control(
			$id,
			array(
				'type'    => 'checkbox',
				'section' => $section_id,
				'label'   => __( 'Open overlay from filter links', 'jetpack-search-pkg' ),
			)
		);

		$id = $setting_prefix . 'excluded_post_types';
		$wp_customize->add_setting(
			$id,
			array(
				'default' => '',
				'type'    => 'option',
			)
		);
		$wp_customize->add_control(
			new Excluded_Post_Types_Control(
				$wp_customize,
				$id,
				array(
					'description' => __( 'Choose post types to exclude from search results. You must leave at least one post type unchecked.', 'jetpack-search-pkg' ),
					'label'       => __( 'Excluded Post Types', 'jetpack-search-pkg' ),
					'section'     => $section_id,
				)
			)
		);

		$id = $setting_prefix . 'highlight_color';
		$wp_customize->add_setting(
			$id,
			array(
				'default'   => '#FFC',
				'transport' => 'postMessage',
				'type'      => 'option',
			)
		);
		$wp_customize->add_control(
			new WP_Customize_Color_Control(
				$wp_customize,
				$id,
				array(
					'label'       => __( 'Highlight Search Terms', 'jetpack-search-pkg' ),
					'description' => __( 'Choose a color to highlight matching search terms.', 'jetpack-search-pkg' ),
					'section'     => $section_id,
				)
			)
		);

		$id = $setting_prefix . 'additional_settings_placeholder';
		$wp_customize->add_setting(
			$id,
			array( 'type' => 'option' )
		);
		$wp_customize->add_control(
			new Label_Control(
				$wp_customize,
				$id,
				array(
					'label'   => __( 'Additional Jetpack Search Settings', 'jetpack-search-pkg' ),
					'section' => $section_id,
				)
			)
		);

		$id = $setting_prefix . 'enable_sort';
		$wp_customize->add_setting(
			$id,
			array(
				'default'              => '1',
				'sanitize_callback'    => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value' ),
				'sanitize_js_callback' => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value_for_js' ),
				'transport'            => 'postMessage',
				'type'                 => 'option',
			)
		);
		$wp_customize->add_control(
			$id,
			array(
				'label'   => __( 'Show sort selector', 'jetpack-search-pkg' ),
				'section' => $section_id,
				'type'    => 'checkbox',
			)
		);

		$id = $setting_prefix . 'inf_scroll';
		$wp_customize->add_setting(
			$id,
			array(
				'default'              => '1',
				'sanitize_callback'    => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value' ),
				'sanitize_js_callback' => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value_for_js' ),
				'transport'            => 'postMessage',
				'type'                 => 'option',
			)
		);
		$wp_customize->add_control(
			$id,
			array(
				'type'    => 'checkbox',
				'section' => $section_id,
				'label'   => __( 'Enable infinite scrolling', 'jetpack-search-pkg' ),
			)
		);

		$id = $setting_prefix . 'show_post_date';
		$wp_customize->add_setting(
			$id,
			array(
				'default'              => '1',
				'sanitize_callback'    => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value' ),
				'sanitize_js_callback' => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value_for_js' ),
				'transport'            => 'postMessage',
				'type'                 => 'option',
			)
		);
		$wp_customize->add_control(
			$id,
			array(
				'type'    => 'checkbox',
				'section' => $section_id,
				'label'   => __( 'Show post date', 'jetpack-search-pkg' ),
			)
		);

		$id = $setting_prefix . 'show_powered_by';
		$wp_customize->add_setting(
			$id,
			array(
				'default'              => '1',
				'sanitize_callback'    => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value' ),
				'sanitize_js_callback' => array( 'Automattic\Jetpack\Search\Helper', 'sanitize_checkbox_value_for_js' ),
				'transport'            => 'postMessage',
				'type'                 => 'option',
			)
		);

		if ( ! $this->plan->is_free_plan() ) {
			$wp_customize->add_control(
				$id,
				array(
					'type'    => 'checkbox',
					'section' => $section_id,
					'label'   => __( 'Display "Powered by Jetpack"', 'jetpack-search-pkg' ),
				)
			);
		}
	}

	/**
	 * Enqueue assets for Customizer controls.
	 */
	public function customize_controls_enqueue_scripts() {
		Assets::register_script(
			'jetpack-instant-search-customizer',
			'customize-controls/customize-controls.js',
			__FILE__,
			array(
				'css_path'     => 'customize-controls/customize-controls.css',
				'dependencies' => array( 'customize-controls' ),
				'in_footer'    => true,
				'textdomain'   => 'jetpack-search-pkg',
			)
		);
		Assets::enqueue_script( 'jetpack-instant-search-customizer' );
	}
}
class-excluded-post-types-control.css                                                                                                                                                                                                                          120           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/customizer/customize-controls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      .customize-control-excluded-post-type-checkbox-container {
	line-height: 1.6;
	padding-top: 6px;
	padding-bottom: 6px;
}class-excluded-post-types-control.js                                                                                                                                                                                                                           889           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/customizer/customize-controls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /* eslint-disable no-var */

jQuery( document ).ready( function ( $ ) {
	// Refresh our hidden field value if any checkboxes change
	$( '.customize-control-excluded-post-type-checkbox' ).on( 'change', function () {
		var $parent = $( this ).parent().parent();
		var newValue = $parent
			.find( '.customize-control-excluded-post-type-checkbox:checked' )
			.map( function () {
				return $( this ).val();
			} )
			.toArray();
		$parent.find( '.customize-control-excluded-post-types' ).val( newValue ).trigger( 'change' );

		// Set the last unchecked checkbox disabled to prvevent user from excluding all post types
		var excludedPostTypesCount = $parent.find(
			'.customize-control-excluded-post-type-checkbox:not(:checked)'
		).length;
		$parent
			.find( '.customize-control-excluded-post-type-checkbox:not(:checked)' )
			.prop( 'disabled', excludedPostTypesCount <= 1 );
	} );
} );
class-excluded-post-types-control.php                                                                                                                                                                                                                          4011          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/customizer/customize-controls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <?php
/**
 * A multi-checkbox Customizer control for use with Jetpack Search configuration
 *
 * @package    @automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Assets;
use WP_Customize_Control;

if ( ! class_exists( 'WP_Customize_Control' ) ) {
	return;
}

/**
 * Label Control class.
 */
class Excluded_Post_Types_Control extends WP_Customize_Control {
	/**
	 * Control type.
	 *
	 * @since 8.8.0
	 * @var string
	 */
	public $type = 'excluded-post-types';

	/**
	 * Enqueue styles related to this control.
	 */
	public function enqueue() {
		Assets::register_script(
			'jetpack-instant-search-customizer-excluded-post-types',
			'class-excluded-post-types-control.js',
			__FILE__,
			array(
				'css_path'     => 'class-excluded-post-types-control.css',
				'dependencies' => array( 'jquery', 'customize-controls' ),
				'in_footer'    => true,
				'textdomain'   => 'jetpack-search-pkg',
			)
		);
		Assets::enqueue_script( 'jetpack-instant-search-customizer-excluded-post-types' );
	}

	/**
	 * Checks if the post type has been selected.
	 *
	 * @since 8.8.0
	 * @return array $post_types An array of strings representing post type names.
	 */
	public function get_arrayed_value() {
		return explode( ',', $this->value() );
	}

	/**
	 * Generates a customizer settings ID for a given post type.
	 *
	 * @since 8.8.0
	 * @param object $post_type Post type object returned from get_post_types.
	 * @return string $customizer_id Customizer setting ID.
	 */
	public function generate_post_type_customizer_id( $post_type ) {
		return '_customize-post-type-input-' . $post_type->name;
	}

	/**
	 * Checks if the post type has been selected.
	 *
	 * @since 8.8.0
	 * @param object $post_type Post type object returned from get_post_types.
	 * @return array $ids Post type => post type customizer ID object.
	 */
	public function is_checked( $post_type ) {
		return in_array( $post_type->name, $this->get_arrayed_value(), true );
	}

	/**
	 * Override rendering for custom class name; omit element ID.
	 */
	protected function render() {
		$id    = 'customize-control-' . str_replace( array( '[', ']' ), array( '-', '' ), $this->id );
		$class = 'customize-control customize-control-excluded-post-types';

		printf( '<li id="%s" class="%s">', esc_attr( $id ), esc_attr( $class ) );
		$this->render_content();
		echo '</li>';
	}

	/**
	 * Override content rendering.
	 */
	protected function render_content() {
		$post_types = get_post_types( array( 'exclude_from_search' => false ), 'objects' );
		if ( ! is_countable( $post_types ) ) {
			return;
		}
		if ( count( $post_types ) === 0 ) {
			return;
		}
		?>
			<label class="customize-control-title">
				<?php echo esc_html( $this->label ); ?>
			</label>
			<?php if ( ! empty( $this->description ) ) : ?>
			<span class="description customize-control-description">
				<?php echo esc_html( $this->description ); ?>
			</span>
			<?php endif ?>
			<input
				class="customize-control-excluded-post-types"
				id="<?php echo esc_attr( $this->id ); ?>"
				name="<?php echo esc_attr( $this->id ); ?>"
				type="hidden"
				value="<?php echo esc_attr( $this->value() ); ?>"
				<?php $this->link(); ?>
			/>
		<?php

		$is_only_one_unchecked = is_countable( $post_types ) && ( count( $post_types ) - 1 ) === count( $this->get_arrayed_value() );

		foreach ( $post_types as $post_type ) {
			$input_id = Helper::generate_post_type_customizer_id( $post_type );
			?>
			<div class="customize-control-excluded-post-type-checkbox-container">
				<input
					class="customize-control-excluded-post-type-checkbox"
					id="<?php echo esc_attr( $input_id ); ?>"
					type="checkbox"
					value="<?php echo esc_attr( $post_type->name ); ?>"
					<?php checked( $this->is_checked( $post_type ) ); ?>
					<?php disabled( ! $this->is_checked( $post_type ) && $is_only_one_unchecked ); ?>
				/>
				<label for="<?php echo esc_attr( $input_id ); ?>"><?php echo esc_html( $post_type->label ); ?></label>
			</div>
			<?php
		}
	}
}
class-label-control.php                                                                                                                                                                                                                                        997           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/customizer/customize-controls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <?php
/**
 * A label-only Customizer control for use with Jetpack Search configuration
 *
 * @package automattic/jetpack
 * @since 8.6.0
 */

namespace Automattic\Jetpack\Search;

use WP_Customize_Control;

if ( ! class_exists( 'WP_Customize_Control' ) ) {
	return;
}
/**
 * Label Control class.
 */
class Label_Control extends WP_Customize_Control {
	/**
	 * Override rendering for custom class name; omit element ID.
	 */
	protected function render() {
		echo '<li class="customize-control customize-label-control">';
		$this->render_content();
		echo '</li>';
	}

	/**
	 * Override content rendering.
	 */
	protected function render_content() {
		if ( ! empty( $this->label ) ) : ?>
			<label class="customize-control-title">
				<?php echo esc_html( $this->label ); ?>
			</label>
		<?php endif; ?>
		<?php if ( ! empty( $this->description ) ) : ?>
			<span class="description customize-control-description">
				<?php echo esc_html( $this->description ); ?>
			</span>
			<?php
		endif;
	}
}
customize-controls.css                                                                                                                                                                                                                                         512           1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/customizer/customize-controls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /* For styling Label_Control */
#sub-accordion-section-jetpack_search .customize-control {
	margin-bottom: 14px;
}

#sub-accordion-section-jetpack_search .customize-label-control,
#sub-accordion-section-jetpack_search .customize-control-checkbox {
	margin-bottom: 0;
}

#sub-accordion-section-jetpack_search .customize-control-checkbox ~ .customize-label-control {
	margin-top: 12px;
}

#sub-accordion-section-jetpack_search .customize-control-radio {
	margin-bottom: 6px;
	padding-bottom: 0;
	padding-top: 0;
}
customize-controls.js                                                                                                                                                                                                                                          1778          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/customizer/customize-controls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /**
 * Binds iframe messages from the Customizer to SearchApp.
 *
 * @param {boolean} expanded - whether jetpack_search section is expanded and visible.
 */
function postSectionMessage( expanded ) {
	// window.wp.customize.previewer.preview is not available until both customize and customize.previewer are ready.
	window.wp.customize.previewer.preview
		.targetWindow()
		.postMessage( { key: 'jetpackSearchSectionOpen', expanded: expanded }, '*' ); // Assume ES5 envorinment.
}

/**
 * Adds functionality for Jetpack Search section detection in the Customizer.
 */
function init() {
	window.wp.customize.bind( 'ready', function () {
		// window.wp.customize.previewer will emit 'ready' multiple times, not just during initialization.
		window.wp.customize.previewer.bind( 'ready', function () {
			// window.wp.customize.previewer.loading is deinstanced after initial load.
			if ( window.wp.customize.previewer.loading ) {
				window.wp.customize.previewer.loading.done( function () {
					postSectionMessage( window.wp.customize.section( 'jetpack_search' ).expanded() );
				} );
			}

			// If the Jetpack Search section is opened/closed, emit a message to open/close the modal.
			window.wp.customize.section( 'jetpack_search' ).expanded.bind( function () {
				postSectionMessage( window.wp.customize.section( 'jetpack_search' ).expanded() );
			} );

			// If Customizer values have changed while Jetpack Search section is open, emit a message to open the modal.
			window.wp.customize.bind( 'change', function () {
				if ( window.wp.customize.section( 'jetpack_search' ).expanded() ) {
					postSectionMessage( true );
				}
			} );
		} );
	} );
}

if ( document.readyState !== 'loading' ) {
	init();
} else {
	document.addEventListener( 'DOMContentLoaded', init );
}
class-dashboard.php                                                                                                                                                                                                                                            6677          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/dashboard                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <?php
/**
 * A class that adds a search dashboard to wp-admin.
 *
 * @package automattic/jetpack
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Admin_UI\Admin_Menu;
use Automattic\Jetpack\Assets;
use Automattic\Jetpack\Connection\Initial_State as Connection_Initial_State;
use Automattic\Jetpack\Connection\Manager as Connection_Manager;
use Automattic\Jetpack\Status;
use Automattic\Jetpack\Tracking;
/**
 * Responsible for adding a search dashboard to wp-admin.
 *
 * @package Automattic\Jetpack\Search
 */
class Dashboard {
	/**
	 * Whether the class has been initialized
	 *
	 * @var boolean
	 */
	private static $initialized = false;
	/**
	 * Plan instance
	 *
	 * @var Automattic\Jetpack\Search\Plan
	 */
	protected $plan;

	/**
	 * Connection manager instance
	 *
	 * @var Automattic\Jetpack\Connection\Manager
	 */
	protected $connection_manager;

	/**
	 * Module_Control instance
	 *
	 * @var Automattic\Jetpack\Search\Module_Control
	 */
	protected $module_control;

	/**
	 * Priority for the dashboard menu
	 * For Jetpack sites: Jetpack uses 998 and 'Admin_Menu' uses 1000, so we need to use 999.
	 * For simple site: the value is overriden in a child class with value 100000 to wait for all menus to be registered.
	 *
	 * @var int
	 */
	protected $search_menu_priority = 999;

	/**
	 * Contructor
	 *
	 * @param Automattic\Jetpack\Search\Plan           $plan - Plan instance.
	 * @param Automattic\Jetpack\Connection\Manager    $connection_manager - Connection Manager instance.
	 * @param Automattic\Jetpack\Search\Module_Control $module_control - Module_Control instance.
	 */
	public function __construct( $plan = null, $connection_manager = null, $module_control = null ) {
		$this->plan               = $plan ? $plan : new Plan();
		$this->connection_manager = $connection_manager ? $connection_manager : new Connection_Manager( Package::SLUG );
		$this->module_control     = $module_control ? $module_control : new Module_Control( $this->plan );
		$this->plan->init_hooks();
	}

	/**
	 * Initialise hooks.
	 *
	 * We use the `config` package to initialize the search package, which ensures the package is
	 * only initialized once. However earlier versions of Jetpack would still forcely initialize the
	 * dashboard. As a result, there would be two `Search` submenus if we don't ensure the dashboard
	 * is initialized only once. So we use `$initialized` to ensure the class is only initialized once.
	 *
	 * Ref: https://github.com/Automattic/jetpack/pull/21888/files#diff-aae7d66951585fc55053a4d53b68552a41864d2c69aee900574ef4404b7ad5f7L42
	 */
	public function init_hooks() {
		if ( ! self::$initialized ) {
			self::$initialized = true;
			// Jetpack uses 998 and 'Admin_Menu' uses 1000.
			add_action( 'admin_menu', array( $this, 'add_wp_admin_submenu' ), $this->search_menu_priority );
			// Check if the site plan changed and deactivate module accordingly.
			add_action( 'current_screen', array( $this, 'check_plan_deactivate_search_module' ) );
		}
	}

	/**
	 * The page to be added to submenu
	 */
	public function add_wp_admin_submenu() {
		// Jetpack of version <= 10.5 would register `jetpack-search` submenu with its built-in search module.
		$this->remove_search_submenu_if_exists();

		if ( $this->should_add_search_submenu() ) {
			$page_suffix = Admin_Menu::add_menu(
				__( 'Jetpack Search', 'jetpack-search-pkg' ),
				_x( 'Search', 'product name shown in menu', 'jetpack-search-pkg' ),
				'manage_options',
				'jetpack-search',
				array( $this, 'render' )
			);
		} else {
			// always add the page, but hide it from the menu.
			$page_suffix = add_submenu_page(
				'',
				__( 'Jetpack Search', 'jetpack-search-pkg' ),
				_x( 'Search', 'product name shown in menu', 'jetpack-search-pkg' ),
				'manage_options',
				'jetpack-search',
				array( $this, 'render' )
			);
		}

		if ( $page_suffix ) {
			add_action( 'load-' . $page_suffix, array( $this, 'admin_init' ) );
		}
	}

	/**
	 * Override render funtion
	 */
	public function render() {
		?>
		<div id="jp-search-dashboard" class="jp-search-dashboard">
			<div class="hide-if-js"><?php esc_html_e( 'Your Jetpack Search dashboard requires JavaScript to function properly.', 'jetpack-search-pkg' ); ?></div>
		</div>
		<?php
	}

	/**
	 * Test whether we should show Search menu.
	 *
	 * @return {boolean} Show search sub menu or not.
	 */
	protected function should_add_search_submenu() {
		/**
		 * The filter allows to ommit adding a submenu item for Jetpack Search.
		 *
		 * @since 0.11.2
		 *
		 * @param boolean $should_add_search_submenu Default value is true.
		 */
		return apply_filters( 'jetpack_search_should_add_search_submenu', current_user_can( 'manage_options' ) );
	}

	/**
	 * Remove `jetpack-search` submenu page
	 */
	protected function remove_search_submenu_if_exists() {
		remove_submenu_page( 'jetpack', 'jetpack-search' );
	}

	/**
	 * Initialize the admin resources.
	 */
	public function admin_init() {
		add_action( 'admin_enqueue_scripts', array( $this, 'load_admin_scripts' ) );
	}

	/**
	 * Enqueue admin scripts.
	 */
	public function load_admin_scripts() {
		if ( $this->should_enqueue_tracking_script() ) {
			// Required for Analytics.
			Tracking::register_tracks_functions_scripts( true );
		}

		Assets::register_script(
			'jp-search-dashboard',
			'../../build/dashboard/jp-search-dashboard.js',
			__FILE__,
			array(
				'in_footer'  => true,
				'textdomain' => 'jetpack-search-pkg',
			)
		);
		Assets::enqueue_script( 'jp-search-dashboard' );

		// Add objects to be passed to the initial state of the app.
		// Use wp_add_inline_script instead of wp_localize_script, see https://core.trac.wordpress.org/ticket/25280.
		wp_add_inline_script(
			'jp-search-dashboard',
			( new Initial_State() )->render(),
			'before'
		);

		// Connection initial state.
		Connection_Initial_State::render_script( 'jp-search-dashboard' );
	}

	/**
	 * Check if we should enqueue the tracking script.
	 */
	protected function should_enqueue_tracking_script() {
		return ! ( new Status() )->is_offline_mode() && $this->connection_manager->is_connected();
	}

	/**
	 * Deactivate search module if plan doesn't support search.
	 *
	 * @param WP_Screen $current_screen Creent screen object.
	 */
	public function check_plan_deactivate_search_module( $current_screen ) {
		// Only run on Jetpack admin pages.
		// The first two checks for current screen are cheap to run on every page.
		if (
			property_exists( $current_screen, 'base' ) &&
			strpos( $current_screen->base, 'jetpack_page_' ) !== false &&
			( ! $this->plan->supports_search() || $this->plan->must_upgrade() )
		) {
			$this->module_control->deactivate();
		}
	}
}
class-initial-state.php                                                                                                                                                                                                                                        6385          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/dashboard                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <?php
/**
 * The React initial state.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Connection\Manager as Connection_Manager;
use Automattic\Jetpack\Status;
use Jetpack_Options;

/**
 * The React initial state.
 */
class Initial_State {

	/**
	 * Connection Manager
	 *
	 * @var Connection_Manager
	 */
	protected $connection_manager;

	/**
	 * Search Module Control
	 *
	 * @var Module_Control
	 */
	protected $module_control;

	/**
	 * Constructor
	 *
	 * @param Connection_Manager $connection_manager - Connection mananger instance.
	 * @param Module_Control     $module_control - Module control instance.
	 */
	public function __construct( $connection_manager = null, $module_control = null ) {
		$this->connection_manager = $connection_manager ? $connection_manager : new Connection_Manager( Package::SLUG );
		$this->module_control     = $module_control ? $module_control : new Module_Control();
	}

	/**
	 * Render JS for the initial state
	 *
	 * @return string - JS string.
	 */
	public function render() {
		return 'var JETPACK_SEARCH_DASHBOARD_INITIAL_STATE=JSON.parse(decodeURIComponent("' . rawurlencode( wp_json_encode( $this->get_initial_state() ) ) . '"));';
	}

	/**
	 * Get the initial state data.
	 *
	 * @return array
	 */
	public function get_initial_state() {
		return array(
			'siteData'        => array(
				'WP_API_root'        => esc_url_raw( rest_url() ),
				'wpcomOriginApiUrl'  => $this->get_wp_api_root(),
				'WP_API_nonce'       => wp_create_nonce( 'wp_rest' ),
				'registrationNonce'  => wp_create_nonce( 'jetpack-registration-nonce' ),
				'purchaseToken'      => $this->get_purchase_token(),
				/**
				 * Whether promotions are visible or not.
				 *
				 * @param bool $are_promotions_active Status of promotions visibility. True by default.
				 */
				'showPromotions'     => apply_filters( 'jetpack_show_promotions', true ),
				'adminUrl'           => esc_url( admin_url() ),
				'blogId'             => Jetpack_Options::get_option( 'id', 0 ),
				'version'            => Package::VERSION,
				'calypsoSlug'        => ( new Status() )->get_site_suffix(),
				'title'              => get_bloginfo( 'name' ),
				'postTypes'          => $this->get_post_types_with_labels(),
				'isWpcom'            => Helper::is_wpcom(),
				// phpcs:ignore WordPress.Security.NonceVerification.Recommended, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized
				'isPlanJustUpgraded' => isset( $_GET['just_upgraded'] ) && wp_unslash( $_GET['just_upgraded'] ),
			),
			'userData'        => array(
				'currentUser' => $this->current_user_data(),
			),
			'jetpackSettings' => array(
				'search'                 => $this->module_control->is_active(),
				'instant_search_enabled' => $this->module_control->is_instant_search_enabled(),
			),
			'features'        => array_map(
				'sanitize_text_field',
				// phpcs:ignore WordPress.Security.NonceVerification.Recommended, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized
				isset( $_GET['features'] ) ? explode( ',', wp_unslash( $_GET['features'] ) ) : array()
			),
		);
	}

	/**
	 * Get API root.
	 *
	 * It return first party API root for WPCOM simple sites.
	 */
	protected function get_wp_api_root() {
		if ( ! Helper::is_wpcom() ) {
			return esc_url_raw( rest_url() );
		}
		// First party API prefix for WPCOM.
		return esc_url_raw( site_url( '/wp-json/wpcom-origin/' ) );
	}

	/**
	 * Gather data about the current user.
	 *
	 * @return array
	 */
	protected function current_user_data() {
		$current_user      = wp_get_current_user();
		$is_user_connected = $this->connection_manager->is_user_connected( $current_user->ID );
		$is_master_user    = $is_user_connected && (int) $current_user->ID && (int) Jetpack_Options::get_option( 'master_user' ) === (int) $current_user->ID;
		$dotcom_data       = $this->connection_manager->get_connected_user_data();

		$current_user_data = array(
			'isConnected' => $is_user_connected,
			'isMaster'    => $is_master_user,
			'username'    => $current_user->user_login,
			'id'          => $current_user->ID,
			'wpcomUser'   => $dotcom_data,
			'permissions' => array(
				'manage_options' => current_user_can( 'manage_options' ),
			),
		);

		return $current_user_data;
	}

	/**
	 * Gets the post type labels for all of the site's post types (including custom post types)
	 *
	 * @return array
	 */
	protected function get_post_types_with_labels() {

		$args = array(
			'public' => true,
		);

		$post_types_with_labels = array();

		$post_types = get_post_types( $args, 'objects' );

		// We don't need all the additional post_type data, just the slug & label
		foreach ( $post_types as $post_type ) {
			$post_type_with_label = array(
				'slug'  => $post_type->name,
				'label' => $post_type->label,
			);

			$post_types_with_labels[ $post_type->name ] = $post_type_with_label;
		}
		return $post_types_with_labels;
	}

	/**
	 * Gets a purchase token that is used for Jetpack logged out visitor checkout.
	 * The purchase token should be appended to all CTA url's that lead to checkout.
	 *
	 * @return string|boolean
	 */
	protected function get_purchase_token() {
		if ( ! $this->current_user_can_purchase() ) {
			return false;
		}

		$purchase_token = Jetpack_Options::get_option( 'purchase_token', false );

		if ( $purchase_token ) {
			return $purchase_token;
		}
		// If the purchase token is not saved in the options table yet, then add it.
		Jetpack_Options::update_option( 'purchase_token', $this->generate_purchase_token(), true );
		return Jetpack_Options::get_option( 'purchase_token', false );
	}

	/**
	 * Generates a purchase token that is used for Jetpack logged out visitor checkout.
	 *
	 * @return string
	 */
	protected function generate_purchase_token() {
		return wp_generate_password( 12, false );
	}

	/**
	 * Determine if the current user is allowed to make Jetpack purchases without
	 * a WordPress.com account
	 *
	 * @return boolean True if the user can make purchases, false if not
	 */
	public function current_user_can_purchase() {
		// The site must be site-connected to Jetpack (no users connected).
		if ( ! $this->connection_manager->is_site_connection() ) {
			return false;
		}

		// Make sure only administrators can make purchases.
		if ( ! current_user_can( 'manage_options' ) ) {
			return false;
		}

		return true;
	}
}
class-initializer.php                                                                                                                                                                                                                                          7028          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/initializers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <?php
/**
 * Initializer base class.
 *
 * @package    @automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Connection\Manager as Connection_Manager;
use WP_Error;
/**
 * Base class for the initializer pattern.
 */
class Initializer {

	/**
	 * Initialize the search package.
	 *
	 * The method is called from the `Config` class.
	 */
	public static function init() {
		// Load compatibility files - at this point all plugins are already loaded.
		static::include_compatibility_files();

		// Set up package version hook.
		add_filter( 'jetpack_package_versions', __NAMESPACE__ . '\Package::send_version_to_tracker' );

		/**
		 * The filter allows abortion of the Jetpack Search package initialization.
		 *
		 * @since 0.11.2
		 *
		 * @param boolean $init_search_package Default value is true.
		 */
		if ( ! apply_filters( 'jetpack_search_init_search_package', true ) ) {
			/**
			 * Fires when the Jetpack Search fails and would fallback to MySQL.
			 *
			 * @since Jetpack 7.9.0
			 * @param string $reason Reason for Search fallback.
			 * @param mixed  $data   Data associated with the request, such as attempted search parameters.
			 */
			do_action( 'jetpack_search_abort', 'jetpack_search_init_search_package_filter', null );
			return;
		}

		static::init_before_connection();

		// Check whether Jetpack Search should be initialized in the first place .
		if ( ! static::is_connected() || ! static::is_search_supported() ) {
			/** This filter is documented in search/src/initalizers/class-initalizer.php */
			do_action( 'jetpack_search_abort', 'inactive', null );
			return;
		}

		$blog_id = Helper::get_wpcom_site_id();
		if ( ! $blog_id ) {
			/** This filter is documented in search/src/initalizers/class-initalizer.php */
			do_action( 'jetpack_search_abort', 'no_blog_id', null );
			return;
		}

		if ( ! ( new Module_Control() )->is_active() ) {
			/** This filter is documented in search/src/initalizers/class-initalizer.php */
			do_action( 'jetpack_search_abort', 'module_inactive', null );
			return;
		}

		// Initialize search package.
		if ( ! static::init_search( $blog_id ) ) {
			/** This filter is documented in search/src/initalizers/class-initalizer.php */
			do_action( 'jetpack_search_abort', 'jetpack_search_init_search', null );
			return;
		}

		/**
		 * Fires when the Jetpack Search package has been initialized.
		 *
		 * @since 0.11.2
		 */
		do_action( 'jetpack_search_loaded' );
	}

	/**
	 * Extra tweaks to make Jetpack Search play well with others.
	 */
	public static function include_compatibility_files() {
		if ( class_exists( 'Jetpack' ) ) {
			require_once Package::get_installed_path() . 'compatibility/jetpack.php';
		}
		require_once Package::get_installed_path() . 'compatibility/search-0.15.2.php';
		require_once Package::get_installed_path() . 'compatibility/search-0.17.0.php';
		require_once Package::get_installed_path() . 'compatibility/unsupported-browsers.php';
	}

	/**
	 * Init functionality required for connection.
	 */
	protected static function init_before_connection() {
		// Set up Search API endpoints.
		add_action( 'rest_api_init', array( new REST_Controller(), 'register_rest_routes' ) );
		// The dashboard has to be initialized before connection.
		( new Dashboard() )->init_hooks();
	}

	/**
	 * Init the search package.
	 *
	 * @param int $blog_id WPCOM blog ID.
	 */
	protected static function init_search( $blog_id ) {
		// We could provide CLI to enable search/instant search, so init them regardless of whether the module is active or not.
		static::init_cli();

		$success                   = false;
		$is_instant_search_enabled = ( new Module_Control() )->is_instant_search_enabled();
		if ( $is_instant_search_enabled ) {
			// Enable Instant search experience.
			$success = static::init_instant_search( $blog_id );
		}
		/**
		 * Filter whether classic search should be enabled. By this stage, search module would be enabled already.
		 *
		 * @since Jetpack $$next_version$$
		 * @param boolean initial value whether classic search is enabled.
		 * @param boolean filtered result whether classic search is enabled.
		 */
		if ( apply_filters( 'jetpack_search_classic_search_enabled', ! $is_instant_search_enabled ) ) {
			// Enable the classic search experience.
			$success = static::init_classic_search( $blog_id );
		}

		if ( $success ) {
			// registers Jetpack Search widget.
			add_action( 'widgets_init', array( static::class, 'jetpack_search_widget_init' ) );
		}

		return $success;
	}

	/**
	 * Init Instant Search and its dependencies.
	 *
	 * @param int $blog_id WPCOM blog ID.
	 */
	protected static function init_instant_search( $blog_id ) {
		/**
		 * The filter allows abortion of the Instant Search initialization.
		 *
		 * @since 0.11.2
		 *
		 * @param boolean $init_instant_search Default value is true.
		 */
		if ( ! apply_filters( 'jetpack_search_init_instant_search', true ) ) {
			return;
		}

		// Enable the instant search experience.
		Instant_Search::initialize( $blog_id );
		// Register instant search configurables as WordPress settings.
		new Settings();
		// Instantiate "Customberg", the live search configuration interface.
		Customberg::instance();
		// Enable configuring instant search within the Customizer iff it's not using a block theme.
		if ( ! wp_is_block_theme() ) {
			new Customizer();
		}
		return true;
	}

	/**
	 * Init Classic Search.
	 *
	 * @param int $blog_id WPCOM blog ID.
	 */
	protected static function init_classic_search( $blog_id ) {
		/**
		 * The filter allows abortion of the Classic Search initialization.
		 *
		 * @since 0.11.2
		 *
		 * @param boolean $init_instant_search Default value is true.
		 */
		if ( ! apply_filters( 'jetpack_search_init_classic_search', true ) ) {
			return;
		}
		Classic_Search::initialize( $blog_id );
		return true;
	}

	/**
	 * Register jetpack-search CLI if `\CLI` exists.
	 *
	 * @return void
	 */
	protected static function init_cli() {
		if ( defined( 'WP_CLI' ) && \WP_CLI ) {
			\WP_CLI::add_command( 'jetpack-search', __NAMESPACE__ . '\CLI' );
		}
	}

	/**
	 * Register the widget if Jetpack Search is available and enabled.
	 */
	public static function jetpack_search_widget_init() {
		register_widget( 'Automattic\Jetpack\Search\Search_Widget' );
	}

	/**
	 * Check if site has been connected.
	 */
	protected static function is_connected() {
		return ( new Connection_Manager( Package::SLUG ) )->is_connected();
	}

	/**
	 * Check if search is supported by current plan.
	 */
	protected static function is_search_supported() {
		return ( new Plan() )->supports_search();
	}

	/**
	 * Perform necessary initialization steps for classic and instant search in the constructor.
	 *
	 * @deprecated
	 */
	public static function initialize() {
		return new WP_Error(
			'invalid-method',
			/* translators: %s: Method name. */
			sprintf( __( "Method '%s' not implemented. Must be overridden in subclass.", 'jetpack-search-pkg' ), __METHOD__ ),
			array( 'status' => 405 )
		);
	}
}
class-instant-search.php                                                                                                                                                                                                                                       25071         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/instant-search                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <?php
/**
 * Instant Search: Our modern and customizable search experience.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Assets;
use WP_Block_Parser;
use WP_Block_Patterns_Registry;
use WP_Error;
use WP_REST_Templates_Controller;

/**
 * Class responsible for enabling the Instant Search experience on the site.
 */
class Instant_Search extends Classic_Search {
	/**
	 * The name of instant search sidebar.
	 *
	 * 'sidebar' is broken to 'side-bar' on purpose to walk around the mechanism that WP automatically adds widgets to it.
	 *
	 * @since 9.8.0
	 * @var string
	 */
	const INSTANT_SEARCH_SIDEBAR     = 'jetpack-instant-search-side-bar';
	const OLD_INSTANT_SEARCH_SIDEBAR = 'jetpack-instant-search-sidebar';

	const AUTO_CONFIG_SIDEBAR = 'sidebar-1';

	/**
	 * The singleton instance of this class.
	 * Instant_Search shouldn't share the variable with its parent.
	 *
	 * @var Instant_Search
	 */
	private static $instance;

	/**
	 * Variable to save old sidebars_widgets value.
	 *
	 * The value is set when action `after_switch_theme` is applied and cleared on filter `pre_update_option_sidebars_widgets`.
	 * The filters mentioned above run on /wp-admin/themes.php?activated=true, a request closely following switching theme.
	 *
	 * @since 9.8.0
	 *
	 * @var array
	 */
	protected $old_sidebars_widgets;

	/**
	 * Returns a class singleton. Initializes with first-time setup if given a blog ID parameter.
	 *
	 * @param string $blog_id Blog id.
	 * @return static The class singleton.
	 */
	public static function instance( $blog_id = null ) {
		if ( ! isset( self::$instance ) ) {
			if ( null === $blog_id ) {
				$blog_id = Helper::get_wpcom_site_id();
			}
			self::$instance = new static();
			self::$instance->setup( $blog_id );
		}
		return self::$instance;
	}

	/**
	 * Setup the various hooks needed for the plugin to take over search duties.
	 *
	 * @since 5.0.0
	 */
	public function init_hooks() {
		if ( ! is_admin() ) {
			add_filter( 'posts_pre_query', array( $this, 'filter__posts_pre_query' ), 10, 2 );

			add_action( 'init', array( $this, 'set_filters_from_widgets' ) );

			add_action( 'wp_enqueue_scripts', array( $this, 'load_assets' ) );
			add_action( 'wp_footer', array( 'Automattic\Jetpack\Search\Helper', 'print_instant_search_sidebar' ) );
			add_filter( 'body_class', array( $this, 'add_body_class' ), 10 );
		} else {
			add_action( 'update_option', array( $this, 'track_widget_updates' ), 10, 3 );
		}

		add_action( 'widgets_init', array( $this, 'register_jetpack_instant_sidebar' ) );
		add_action( 'jetpack_deactivate_module_search', array( $this, 'move_search_widgets_to_inactive' ) );
	}

	/**
	 * Loads assets for Jetpack Instant Search Prototype featuring Search As You Type experience.
	 */
	public function load_assets() {
		$this->load_assets_with_parameters( Package::get_installed_path() );
	}

	/**
	 * Loads assets according to parameters provided.
	 *
	 * @param string $package_base_path - Base path for the search package.
	 */
	public function load_assets_with_parameters( $package_base_path ) {
		Assets::register_script(
			'jetpack-instant-search',
			'build/instant-search/jp-search.js',
			$package_base_path . '/src', // A full path to a file or a directory inside a plugin.
			array(
				'dependencies' => array( 'wp-i18n' ),
				'in_footer'    => true,
				'textdomain'   => 'jetpack-search-pkg',
			)
		);
		Assets::enqueue_script( 'jetpack-instant-search' );
		$this->load_and_initialize_tracks();
		$this->inject_javascript_options();
	}

	/**
	 * Passes all options to the JS app.
	 */
	protected function inject_javascript_options() {
		$options = Helper::generate_initial_javascript_state();
		// Use wp_add_inline_script instead of wp_localize_script, see https://core.trac.wordpress.org/ticket/25280.
		wp_add_inline_script( 'jetpack-instant-search', 'var JetpackInstantSearchOptions=JSON.parse(decodeURIComponent("' . rawurlencode( wp_json_encode( $options ) ) . '"));', 'before' );
	}

	/**
	 * Registers a widget sidebar for Instant Search.
	 */
	public function register_jetpack_instant_sidebar() {
		$args = array(
			'name'          => __( 'Jetpack Search Sidebar', 'jetpack-search-pkg' ),
			'id'            => self::INSTANT_SEARCH_SIDEBAR,
			'description'   => __( 'Customize the sidebar inside the Jetpack Search overlay', 'jetpack-search-pkg' ),
			'class'         => '',
			'before_widget' => '<div id="%1$s" class="widget %2$s">',
			'after_widget'  => '</div>',
			'before_title'  => '<h2 class="widgettitle">',
			'after_title'   => '</h2>',
		);
		register_sidebar( $args );
	}

	/**
	 * Loads scripts for Tracks analytics library
	 */
	public function load_and_initialize_tracks() {
		wp_enqueue_script( 'jp-tracks', '//stats.wp.com/w.js', array(), gmdate( 'YW' ), true );
	}

	/**
	 * Bypass the normal Search query since we will run it with instant search.
	 *
	 * @since 8.3.0
	 *
	 * @param array    $posts Current array of posts (still pre-query).
	 * @param WP_Query $query The WP_Query being filtered.
	 *
	 * @return array Array of matching posts.
	 */
	public function filter__posts_pre_query( $posts, $query ) {
		if ( ! $this->should_handle_query( $query ) ) {
			// Intentionally not adding the 'jetpack_search_abort' action since this should fire for every request except for search.
			return $posts;
		}

		/**
		 * Bypass the main query and return dummy data
		 *  WP Core doesn't call the set_found_posts and its filters when filtering
		 *  posts_pre_query like we do, so need to do these manually.
		 */
		$query->found_posts   = 1;
		$query->max_num_pages = 1;

		return array();
	}

	/**
	 * Run the aggregations API query for any filtering
	 *
	 * @since 8.3.0
	 */
	public function fetch_search_result_if_empty() {
		if ( ! empty( $this->search_result ) ) {
			return;
		}

		if ( is_admin() ) {
			return;
		}

		if ( empty( $this->aggregations ) ) {
			return;
		}

		$builder = new WPES\Query_Builder();
		$this->add_aggregations_to_es_query_builder( $this->aggregations, $builder );
		$this->search_result = $this->instant_api(
			array(
				'aggregations' => $builder->build_aggregation(),
				'size'         => 0,
				'from'         => 0,
			)
		);
	}

	/**
	 * Run an instant search on the WordPress.com public API.
	 *
	 * @since 8.3.0
	 *
	 * @param array $args Args conforming to the WP.com v1.3/sites/<blog_id>/search endpoint.
	 *
	 * @return object|WP_Error The response from the public API, or a WP_Error.
	 */
	public function instant_api( array $args ) {
		global $wp_version;
		$start_time = microtime( true );

		// Cache locally to avoid remote request slowing the page.
		$transient_name = 'jetpack_instant_search_cache_' . md5( wp_json_encode( $args ) );
		$cache          = get_transient( $transient_name );
		if ( false !== $cache ) {
			return $cache;
		}

		$service_url = add_query_arg(
			$args,
			sprintf(
				'https://public-api.wordpress.com/rest/v1.3/sites/%d/search',
				$this->jetpack_blog_id
			)
		);

		$request_args = array(
			'timeout'    => 10,
			'user-agent' => "WordPress/{$wp_version} | Jetpack-Search/" . Package::VERSION,
		);

		$request  = wp_remote_get( esc_url_raw( $service_url ), $request_args );
		$end_time = microtime( true );

		if ( is_wp_error( $request ) ) {
			return $request;
		}

		$response_code = wp_remote_retrieve_response_code( $request );
		$response      = json_decode( wp_remote_retrieve_body( $request ), true );

		if ( ! $response_code || $response_code < 200 || $response_code >= 300 ) {
			/**
			 * Fires after a search query request has failed
			 *
			 * @module search
			 *
			 * @since  5.6.0
			 *
			 * @param array Array containing the response code and response from the failed search query
			 */
			do_action(
				'failed_jetpack_search_query',
				array(
					'response_code' => $response_code,
					'json'          => $response,
				)
			);

			return new WP_Error( 'invalid_search_api_response', 'Invalid response from API - ' . $response_code );
		}

		$took = is_array( $response ) && ! empty( $response['took'] )
		? $response['took']
		: null;

		$query = array(
			'args'          => $args,
			'response'      => $response,
			'response_code' => $response_code,
			'elapsed_time'  => ( $end_time - $start_time ) * 1000, // Convert from float seconds to ms.
			'es_time'       => $took,
			'url'           => $service_url,
		);

		/**
		 * Fires after a search request has been performed.
		 *
		 * Includes the following info in the $query parameter:
		 *
		 * array args Array of Elasticsearch arguments for the search
		 * array response Raw API response, JSON decoded
		 * int response_code HTTP response code of the request
		 * float elapsed_time Roundtrip time of the search request, in milliseconds
		 * float es_time Amount of time Elasticsearch spent running the request, in milliseconds
		 * string url API url that was queried
		 *
		 * @module search
		 *
		 * @since  5.0.0
		 * @since  5.8.0 This action now fires on all queries instead of just successful queries.
		 *
		 * @param array $query Array of information about the query performed
		 */
		do_action( 'did_jetpack_search_query', $query );

		// Update local cache.
		set_transient( $transient_name, $response, 4 * HOUR_IN_SECONDS );

		return $response;
	}

	/**
	 * Get the raw Aggregation results from the Elasticsearch response.
	 *
	 * @since  8.4.0
	 *
	 * @return array Array of Aggregations performed on the search.
	 */
	public function get_search_aggregations_results() {
		$this->fetch_search_result_if_empty();
		if ( empty( $this->search_result ) || is_wp_error( $this->search_result ) || ! isset( $this->search_result['aggregations'] ) ) {
			return array();
		}

		return $this->search_result['aggregations'];
	}

	/**
	 * Automatically configure necessary settings for instant search
	 *
	 * @since  8.3.0
	 */
	public function auto_config_search() {
		$this->auto_config_excluded_post_types();
		$this->auto_config_overlay_sidebar_widgets();
		$this->auto_config_theme_sidebar_search_widget();
		$this->auto_config_result_format();
	}

	/**
	 * Auto config search widget or block for current theme.
	 */
	public function auto_config_theme_sidebar_search_widget() {
		if ( \current_theme_supports( 'block-templates' ) ) {
			$this->auto_config_fse_theme_footer_search_block();
		} else {
			$this->auto_config_non_fse_theme_sidebar_search_widget();
		}
	}

	/**
	 * Automatically copy configured search widgets from theme sidebar to the overlay sidebar.
	 * If there's nothing to copy, we create one.
	 *
	 * @since  8.8.0
	 */
	public function auto_config_overlay_sidebar_widgets() {
		$sidebars                               = get_option( 'sidebars_widgets', array() );
		list(, $sidebar_jp_searchbox_wiget_id ) = $this->get_search_widget_indices( $sidebars, self::INSTANT_SEARCH_SIDEBAR );
		// If there's JP search widget in overly sidebar, abort.
		if ( false !== $sidebar_jp_searchbox_wiget_id ) {
			return;
		}

		// Init overlay sidebar if it doesn't exists.
		if ( ! isset( $sidebars[ self::INSTANT_SEARCH_SIDEBAR ] ) ) {
			$sidebars[ self::INSTANT_SEARCH_SIDEBAR ] = array();
		}

		$widget_opt_name = Helper::get_widget_option_name();
		$widget_options  = get_option( $widget_opt_name, array() );

		$next_id = $this->get_next_jp_search_widget_id( $widget_options );

		list(, $sidebar_jp_searchbox_wiget_id ) = $this->get_search_widget_indices( $sidebars, self::AUTO_CONFIG_SIDEBAR );
		if ( false !== $sidebar_jp_searchbox_wiget_id && isset( $widget_options[ $sidebar_jp_searchbox_wiget_id ] ) ) {
			// If there is a JP search widget in the theme sidebar, copy it over to the search overlay sidebar.
			$widget_options[ $next_id ] = $widget_options[ $sidebar_jp_searchbox_wiget_id ];
		} else {
			// If JP Search widget doesn't exist in the theme sidebar, we have nothing to copy from, so we create a new one within the overlay sidebar.
			$widget_options[ $next_id ] = $this->get_preconfig_widget_options();
		}
		array_unshift( $sidebars[ self::INSTANT_SEARCH_SIDEBAR ], Helper::build_widget_id( $next_id ) );
		update_option( $widget_opt_name, $widget_options );
		update_option( 'sidebars_widgets', $sidebars );
		return true;
	}

	/**
	 * Add JP Search widget on top of theme sidebar.
	 * Or Replace core search widget in theme sidebar if exists.
	 */
	public function auto_config_non_fse_theme_sidebar_search_widget() {
		$sidebars = get_option( 'sidebars_widgets', array() );
		if ( ! isset( $sidebars[ self::AUTO_CONFIG_SIDEBAR ] ) ) {
			return;
		}

		list( $sidebar_searchbox_idx, $sidebar_jp_searchbox_wiget_id ) = $this->get_search_widget_indices( $sidebars );
		// If there's JP search widget in theme sidebar, abort.
		if ( false !== $sidebar_jp_searchbox_wiget_id ) {
			return;
		}

		$widget_opt_name = Helper::get_widget_option_name();
		$widget_options  = get_option( $widget_opt_name, array() );

		list($sidebar_searchbox_idx, ) = $this->get_search_widget_indices( $sidebars );
		$next_id                       = $this->get_next_jp_search_widget_id( $widget_options );
		$preconfig_opts                = $this->get_preconfig_widget_options();

		$widget_options[ $next_id ] = $preconfig_opts;
		if ( false !== $sidebar_searchbox_idx ) {
			// Replace core search widget with JP search widget.
			$sidebars[ self::AUTO_CONFIG_SIDEBAR ][ $sidebar_searchbox_idx ] = Helper::build_widget_id( $next_id );
		} else {
			// Add JP Search widget to top.
			array_unshift( $sidebars[ self::AUTO_CONFIG_SIDEBAR ], Helper::build_widget_id( $next_id ) );
		}

		update_option( $widget_opt_name, $widget_options );
		update_option( 'sidebars_widgets', $sidebars );
		return true;
	}

	/**
	 * Get the next ID for the Jetpack Search widget, which is equivalent to the last JP Search widget ID + 1.
	 *
	 * @param array $widget_options - jetpack widget option value.
	 *
	 * @return int
	 */
	public function get_next_jp_search_widget_id( $widget_options ) {
		return ! empty( $widget_options ) ? max(
			array_map(
				function ( $val ) {
					return intval( $val );
				},
				array_keys( $widget_options )
			)
		) + 1 : 1;
	}

	/**
	 * Get search and JP Search widget indices in theme sidebar.
	 *
	 * @param array  $sidebars - theme `sidebars_widgets` option value.
	 * @param string $sidebar_id - the sidebar id to search on.
	 *
	 * @return array - core search widget index and JP search widget id.
	 */
	protected function get_search_widget_indices( $sidebars, $sidebar_id = 'sidebar-1' ) {
		$sidebar_searchbox_idx   = false;
		$sidebar_jp_searchbox_id = false;
		if ( isset( $sidebars[ $sidebar_id ] ) ) {
			foreach ( (array) $sidebars[ $sidebar_id ] as $idx => $widget_id ) {
				if ( $this->widget_has_search_block( $widget_id ) ) {
					// The array index of wp search widget.
					$sidebar_searchbox_idx = $idx;
				}
				if ( str_starts_with( $widget_id, Helper::FILTER_WIDGET_BASE ) ) {
					// The id of Jetpack Search widget.
					$sidebar_jp_searchbox_id = str_replace( Helper::FILTER_WIDGET_BASE . '-', '', $widget_id );
				}
			}
		}
		return array( $sidebar_searchbox_idx, $sidebar_jp_searchbox_id );
	}

	/**
	 * Returns true if search widget or block exists in widgets
	 *
	 * @param string $widget_id - widget ID.
	 */
	protected function widget_has_search_block( $widget_id ) {
		// test search widget.
		if ( str_starts_with( $widget_id, 'search-' ) ) {
			return true;
		}
		// test search block widget.
		if ( str_starts_with( $widget_id, 'block-' ) ) {
			$widget_blocks = get_option( 'widget_block', array() );
			$widget_index  = str_replace( 'block-', '', $widget_id );
			// A single block could be of type string or array.
			if ( isset( $widget_blocks[ $widget_index ]['content'] ) && str_contains( (string) $widget_blocks[ $widget_index ]['content'], 'wp:search' ) ) {
				return true;
			}
			if ( isset( $widget_blocks[ $widget_index ] ) && is_string( $widget_blocks[ $widget_index ] ) && str_contains( $widget_blocks[ $widget_index ], 'wp:search' ) ) {
				return true;
			}
		}
		return false;
	}

	/**
	 * Returns true if $block_content has core search block
	 *
	 * @param string $block_content - Block content.
	 *
	 * @return boolean
	 */
	public static function content_has_search_block( $block_content ) {
		return preg_match( '/(<!--\swp:search\s[^>]*-->)/i', $block_content ) > 0;
	}

	/**
	 * Add a search widget above footer for block templates.
	 */
	public function auto_config_fse_theme_footer_search_block() {
		if ( ! class_exists( 'WP_REST_Templates_Controller' ) ) {
			return;
		}
		// We currently check only for a core search block.
		// In the future, we will need to check for a Jetpack Search block once it's available.
		if ( $this->template_parts_have_search_block() ) {
			return;
		}

		$footer = $this->get_template_part( 'footer' );
		if ( ! $footer instanceof \WP_Block_Template ) {
			return;
		}

		$content          = $this->replace_block_patterns( $footer->content );
		$template_part_id = $footer->id;
		$request          = new \WP_REST_Request( 'PUT', "/wp/v2/template-parts/{$template_part_id}" );
		$request->set_header( 'content-type', 'application/json' );
		$request->set_param( 'content', static::inject_search_widget_to_block( $content ) );
		$request->set_param( 'id', $template_part_id );
		$controller = new WP_REST_Templates_Controller( 'wp_template_part' );
		return $controller->update_item( $request );
	}

	/**
	 * Replace pattern blocks with their content.
	 * We don't want to replace recursively for the sake of simplicity.
	 *
	 * @param string $block_content - Content of template part.
	 */
	protected function replace_block_patterns( $block_content ) {
		$matches = array();
		if ( preg_match( '/<!--\s*wp:pattern\s+{.*}\s*\/-->/', $block_content, $matches ) > 0 ) {
			foreach ( $matches as $match ) {
				$pattern_content = $this->get_block_pattern_content( $match );
				$block_content   = str_replace( $match, $pattern_content, $block_content );
			}
		}
		return $block_content;
	}

	/**
	 * Extracts block content only if it consists of a single pattern block.
	 *
	 * @param string $block_pattern - Block content.
	 */
	protected function get_block_pattern_content( $block_pattern ) {
		if ( ! class_exists( 'WP_Block_Parser' ) || ! class_exists( 'WP_Block_Patterns_Registry' ) ) {
			return $block_pattern;
		}
		$blocks = ( new WP_Block_Parser() )->parse( $block_pattern );
		if ( is_countable( $blocks ) && 1 === count( $blocks ) && 'core/pattern' === $blocks[0]['blockName'] ) {
			$slug     = $blocks[0]['attrs']['slug'];
			$registry = WP_Block_Patterns_Registry::get_instance();
			if ( $registry->is_registered( $slug ) ) {
				$pattern = $registry->get_registered( $slug );
				return $pattern['content'];
			}
		}
		return $block_pattern;
	}

	/**
	 * Get template part for current theme.
	 *
	 * @param string $template_part_name - header, footer, home etc.
	 *
	 * @return \WP_Block_Template
	 */
	protected function get_template_part( $template_part_name ) {
		// Check whether block theme functions exist.
		if ( ! function_exists( 'get_block_template' ) ) {
			return null;
		}
		$active_theme     = \wp_get_theme()->get_stylesheet();
		$template_part_id = "{$active_theme}//{$template_part_name}";
		$template_part    = \get_block_template( $template_part_id, 'wp_template_part' );
		if ( is_wp_error( $template_part ) || empty( $template_part ) ) {
			return null;
		}
		return $template_part;
	}

	/**
	 * Returns true if  'header', 'footer' or 'home' has core search block
	 *
	 * @return boolean
	 */
	protected function template_parts_have_search_block() {
		$template_part_names = array( 'header', 'footer', 'home' );
		foreach ( $template_part_names as $part_name ) {
			$part = $this->get_template_part( $part_name );
			if ( $part instanceof \WP_Block_Template && static::content_has_search_block( $part->content ) ) {
				return true;
			}
		}
		return false;
	}

	/**
	 * Append Search block to block if no 'wp:search' exists already.
	 *
	 * @param {string} $block_content - the content to append the search block.
	 */
	public static function inject_search_widget_to_block( $block_content ) {
		$search_block = sprintf(
			'<!-- wp:search {"label":"","buttonText":"%s"} /-->',
			__( 'Search', 'jetpack-search-pkg' )
		);

		// Place the search block on bottom of the first column if there's any.
		$column_end_pattern = '/(<\s*\/div[^>]*>\s*<!--\s*\/wp:column\s+[^>]*-->)/';
		if ( preg_match( $column_end_pattern, $block_content ) ) {
			return preg_replace( $column_end_pattern, "\n" . $search_block . "\n$1", $block_content, 1 );
		}

		// Place the search block on top of footer contents in the most inner group.
		$group_start_pattern = '/((<!--\s*wp:group\s[^>]*-->[.\s]*<\s*div[^>]*>\s*)+)/';
		if ( preg_match( $group_start_pattern, $block_content, $matches ) ) {
			return preg_replace( $group_start_pattern, "$1\n" . $search_block . "\n", $block_content, 1 );
		}

		return $block_content;
	}

	/**
	 * Autoconfig search by adding filter widgets
	 *
	 * @since  8.4.0
	 *
	 * @return array Array of config settings for search widget.
	 */
	protected function get_preconfig_widget_options() {
		$settings = array(
			'title'   => '',
			'filters' => array(),
		);

		$post_types = get_post_types(
			array(
				'public'   => true,
				'_builtin' => false,
			)
		);

		if ( ! empty( $post_types ) ) {
			$settings['filters'][] = array(
				'name'  => '',
				'type'  => 'post_type',
				'count' => 5,
			);
		}

		// Grab a maximum of 3 taxonomies.
		$taxonomies = array_slice(
			get_taxonomies(
				array(
					'public'   => true,
					'_builtin' => false,
				)
			),
			0,
			3
		);

		foreach ( $taxonomies as $t ) {
			$settings['filters'][] = array(
				'name'     => '',
				'type'     => 'taxonomy',
				'taxonomy' => $t,
				'count'    => 5,
			);
		}

		$settings['filters'][] = array(
			'name'     => '',
			'type'     => 'taxonomy',
			'taxonomy' => 'category',
			'count'    => 5,
		);

		$settings['filters'][] = array(
			'name'     => '',
			'type'     => 'taxonomy',
			'taxonomy' => 'post_tag',
			'count'    => 5,
		);

		$settings['filters'][] = array(
			'name'     => '',
			'type'     => 'date_histogram',
			'count'    => 5,
			'field'    => 'post_date',
			'interval' => 'year',
		);

		return $settings;
	}

	/**
	 * Automatically configure post types to exclude from one of the search widgets.
	 * Used primarily for backward compatibility with older Jetpack plugins, which used to store excluded post type configuration within the Jetpack Search plugin instead of as an option.
	 *
	 * @since  8.8.0
	 */
	public function auto_config_excluded_post_types() {
		// if `excluded_post_types` exists, then we do nothing.
		if ( false !== get_option( Options::OPTION_PREFIX . 'excluded_post_types', false ) ) {
			return;
		}
		$post_types         = get_post_types(
			array(
				'exclude_from_search' => false,
				'public'              => true,
			)
		);
		$enabled_post_types = array();
		$widget_options     = get_option( Helper::get_widget_option_name(), array() );

		// Prior to Jetpack 8.8, post types were enabled via Jetpack Search widgets rather than disabled via the Customizer.
		// To continue supporting post types set up in the old way, we iterate through each Jetpack Search
		// widget configuration and append each enabled post type to $enabled_post_types.
		foreach ( $widget_options as $widget_option ) {
			if ( isset( $widget_option['post_types'] ) && is_array( $widget_option['post_types'] ) ) {
				foreach ( $widget_option['post_types'] as $enabled_post_type ) {
					$enabled_post_types[ $enabled_post_type ] = $enabled_post_type;
				}
			}
		}

		if ( ! empty( $enabled_post_types ) ) {
			$post_types_to_disable = array_diff( $post_types, $enabled_post_types );
			// better to use `add_option` which wouldn't override option value if exists.
			add_option( Options::OPTION_PREFIX . 'excluded_post_types', implode( ',', $post_types_to_disable ) );
		}
	}

	/**
	 * Automatically set result format.
	 *
	 * @since  9.6.0
	 */
	public function auto_config_result_format() {
		$result_format_option_name = Options::OPTION_PREFIX . 'result_format';
		// Default format `expanded`.
		$result_format_option_value = Options::RESULT_FORMAT_EXPANDED;

		// Result format already set, skip.
		if ( get_option( $result_format_option_name, false ) ) {
			return;
		}

		// Check if WooCommerce plugin is active (based on https://docs.woocommerce.com/document/create-a-plugin/).
		if ( in_array(
			'woocommerce/woocommerce.php',
			apply_filters( 'active_plugins', Helper::get_active_plugins() ),
			true
		) ) {
			$result_format_option_value = Options::RESULT_FORMAT_PRODUCT;
		}

		update_option( $result_format_option_name, $result_format_option_value );
		return true;
	}

	/**
	 * Add current theme name as a body class for easier override
	 *
	 * @param string[] $classes An array of body class names.
	 *
	 * @return string[] The array of classes after filtering
	 */
	public function add_body_class( $classes ) {
		$classes[] = 'jps-theme-' . get_stylesheet();
		return $classes;
	}
}
class-search-widget.php                                                                                                                                                                                                                                        40094         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/widgets                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <?php
/**
 * Jetpack Search widget.
 *
 * @package automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search;

use Automattic\Jetpack\Assets;
use Automattic\Jetpack\Connection\Manager as Connection_Manager;
use Automattic\Jetpack\Redirect;
use Automattic\Jetpack\Status;
use Automattic\Jetpack\Sync\Modules\Search as Search_Sync_Module;
use Automattic\Jetpack\Tracking;

/**
 * Provides a widget to show available/selected filters on searches.
 *
 * @since 5.0.0
 *
 * @see   WP_Widget
 */
class Search_Widget extends \WP_Widget {

	/**
	 * Number of aggregations (filters) to show by default.
	 *
	 * @since 5.8.0
	 * @var int
	 */
	const DEFAULT_FILTER_COUNT = 5;
	/**
	 * Default sort order for search results.
	 *
	 * @since 5.8.0
	 * @var string
	 */
	const DEFAULT_SORT = 'relevance_desc';
	/**
	 * The Jetpack_Search instance.
	 *
	 * @since 5.7.0
	 * @var Jetpack_Search
	 */
	protected $jetpack_search;
	/**
	 * Module_Control instance
	 *
	 * @var Module_Control
	 */
	protected $module_control;

	/**
	 * Search_Widget constructor.
	 *
	 * @param string $name Widget name.
	 * @since 5.0.0
	 */
	public function __construct( $name = null ) {
		if ( empty( $name ) ) {
			$name = esc_html__( 'Search (Jetpack)', 'jetpack-search-pkg' );
		}
		$this->module_control = new Module_Control();
		parent::__construct(
			Helper::FILTER_WIDGET_BASE,
			$name,
			array(
				'classname'   => 'jetpack-filters widget_search',
				'description' => __( 'Instant search and filtering to help visitors quickly find relevant answers and explore your site.', 'jetpack-search-pkg' ),
			)
		);

		if (
			Helper::is_active_widget( $this->id ) &&
			! $this->is_search_active()
		) {
			$this->activate_search();
		}

		if ( is_admin() ) {
			add_action( 'sidebar_admin_setup', array( $this, 'widget_admin_setup' ) );
		} else {
			add_action( 'wp_enqueue_scripts', array( $this, 'enqueue_frontend_scripts' ) );
		}

		add_action( 'jetpack_search_render_filters_widget_title', array( 'Automattic\Jetpack\Search\Template_Tags', 'render_widget_title' ), 10, 3 );
		if ( Options::is_instant_enabled() ) {
			add_action( 'jetpack_search_render_filters', array( 'Automattic\Jetpack\Search\Template_Tags', 'render_instant_filters' ), 10, 2 );
		} else {
			add_action( 'jetpack_search_render_filters', array( 'Automattic\Jetpack\Search\Template_Tags', 'render_available_filters' ), 10, 2 );
		}
	}

	/**
	 * Check whether search is currently active
	 *
	 * @since 6.3
	 */
	public function is_search_active() {
		return $this->module_control->is_active();
	}

	/**
	 * Activate search
	 *
	 * @since 6.3
	 */
	public function activate_search() {
		return $this->module_control->activate();
	}

	/**
	 * Enqueues the scripts and styles needed for the customizer.
	 *
	 * @since 5.7.0
	 */
	public function widget_admin_setup() {
		// Register jp-tracks and jp-tracks-functions.
		Tracking::register_tracks_functions_scripts();

		Assets::register_script(
			'jetpack-search-widget-admin',
			'js/search-widget-admin.js',
			__FILE__,
			array(
				'in_footer'    => true,
				'textdomain'   => 'jetpack-search-pkg',
				'css_path'     => 'css/search-widget-admin-ui.css',
				'dependencies' => array( 'jquery', 'jquery-ui-sortable', 'jp-tracks-functions' ),
			)
		);

		$dotcom_data = ( new Connection_Manager( Package::SLUG ) )->get_connected_user_data();

		wp_localize_script(
			'jetpack-search-widget-admin',
			'jetpack_search_filter_admin',
			array(
				'defaultFilterCount' => self::DEFAULT_FILTER_COUNT,
				'tracksUserData'     => ! empty( $dotcom_data ) ? array(
					'userid'   => $dotcom_data['ID'],
					'username' => $dotcom_data['login'],
				) : false,
				'tracksEventData'    => array(
					'is_customizer' => (int) is_customize_preview(),
				),
				'i18n'               => array(
					'month'        => Helper::get_date_filter_type_name( 'month', false ),
					'year'         => Helper::get_date_filter_type_name( 'year', false ),
					'monthUpdated' => Helper::get_date_filter_type_name( 'month', true ),
					'yearUpdated'  => Helper::get_date_filter_type_name( 'year', true ),
				),
			)
		);

		Assets::enqueue_script( 'jetpack-search-widget-admin' );
	}

	/**
	 * Enqueue scripts and styles for the frontend.
	 *
	 * @since 5.8.0
	 */
	public function enqueue_frontend_scripts() {
		if ( ! is_active_widget( false, false, $this->id_base, true ) || Options::is_instant_enabled() ) {
			return;
		}
		Assets::register_script(
			'jetpack-search-widget',
			'js/search-widget.js',
			__FILE__,
			array(
				'in_footer'  => true,
				'textdomain' => 'jetpack-search-pkg',
				// Jetpack the plugin would concatenated the style with other styles and minimize. And the style would be dequeued from WP.
				// @see https://github.com/Automattic/jetpack/blob/b3de78dce3d88b0d9b283282a5b04515245c8057/projects/plugins/jetpack/tools/builder/frontend-css.js#L52.
				// @see https://github.com/Automattic/jetpack/blob/bb1b6a9a9cfa98600441f8fa31c9f9c4ef9a04a5/projects/plugins/jetpack/class.jetpack.php#L106.
				'css_path'   => 'css/search-widget-frontend.css',
			)
		);
		Assets::enqueue_script( 'jetpack-search-widget' );
	}

	/**
	 * Get the list of valid sort types/orders.
	 *
	 * @return array The sort orders.
	 * @since 5.8.0
	 */
	private function get_sort_types() {
		return array(
			'relevance|DESC' => is_admin() ? esc_html__( 'Relevance (recommended)', 'jetpack-search-pkg' ) : esc_html__( 'Relevance', 'jetpack-search-pkg' ),
			'date|DESC'      => esc_html__( 'Newest first', 'jetpack-search-pkg' ),
			'date|ASC'       => esc_html__( 'Oldest first', 'jetpack-search-pkg' ),
		);
	}

	/**
	 * Callback for an array_filter() call in order to only get filters for the current widget.
	 *
	 * @param array $item Filter item.
	 *
	 * @return bool Whether the current filter item is for the current widget.
	 * @see   Search_Widget::widget()
	 *
	 * @since 5.7.0
	 */
	public function is_for_current_widget( $item ) {
		return isset( $item['widget_id'] ) && $this->id == $item['widget_id']; // phpcs:ignore Universal.Operators.StrictComparisons.LooseEqual
	}

	/**
	 * This method returns a boolean for whether the widget should show site-wide filters for the site.
	 *
	 * This is meant to provide backwards-compatibility for VIP, and other professional plan users, that manually
	 * configured filters via `Automattic\Jetpack\Search\Classic_Search::set_filters()`.
	 *
	 * @return bool Whether the widget should display site-wide filters or not.
	 * @since 5.7.0
	 */
	public function should_display_sitewide_filters() {
		$filter_widgets = get_option( 'widget_jetpack-search-filters' );

		// This shouldn't be empty, but just for sanity.
		if ( empty( $filter_widgets ) ) {
			return false;
		}

		// If any widget has any filters, return false.
		foreach ( $filter_widgets as $number => $widget ) {
			$widget_id = sprintf( '%s-%d', $this->id_base, $number );
			if ( ! empty( $widget['filters'] ) && is_active_widget( false, $widget_id, $this->id_base ) ) {
				return false;
			}
		}

		return true;
	}

	/**
	 * Widget defaults.
	 *
	 *  @param array $instance Previously saved values from database.
	 */
	public function jetpack_search_populate_defaults( $instance ) {
		$instance = wp_parse_args(
			(array) $instance,
			array(
				'title'              => '',
				'search_box_enabled' => true,
				'user_sort_enabled'  => true,
				'sort'               => self::DEFAULT_SORT,
				'filters'            => array( array() ),
				'post_types'         => array(),
			)
		);

		return $instance;
	}

	/**
	 * Populates the instance array with appropriate default values.
	 *
	 * @param array $instance Previously saved values from database.
	 * @return array Instance array with default values approprate for instant search
	 * @since 8.6.0
	 */
	public function populate_defaults_for_instant_search( $instance ) {
		return wp_parse_args(
			(array) $instance,
			array(
				'title'   => '',
				'filters' => array(),
			)
		);
	}

	/**
	 * Responsible for rendering the widget on the frontend.
	 *
	 * @param array $args     Widgets args supplied by the theme.
	 * @param array $instance The current widget instance.
	 * @since 5.0.0
	 */
	public function widget( $args, $instance ) {
		$instance = $this->jetpack_search_populate_defaults( $instance );

		if ( ( new Status() )->is_offline_mode() ) {
			echo $args['before_widget']; //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
			?><div id="<?php echo esc_attr( $this->id ); ?>-wrapper">
				<div class="jetpack-search-sort-wrapper">
					<label>
						<?php esc_html_e( 'Jetpack Search not supported in Offline Mode', 'jetpack-search-pkg' ); ?>
					</label>
				</div>
			</div>
			<?php
			echo $args['after_widget']; //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
			return;
		}

		if ( Options::is_instant_enabled() ) {
			if ( array_key_exists( 'id', $args ) && Instant_Search::INSTANT_SEARCH_SIDEBAR === $args['id'] ) {
				$this->widget_empty_instant( $args, $instance );
			} else {
				$this->widget_instant( $args, $instance );
			}
		} else {
			$this->widget_non_instant( $args, $instance );
		}
	}

	/**
	 * Render the non-instant frontend widget.
	 *
	 * @param array $args     Widgets args supplied by the theme.
	 * @param array $instance The current widget instance.
	 * @since 8.3.0
	 */
	public function widget_non_instant( $args, $instance ) {
		$display_filters = false;

		// Search instance must have been initialized before widget render.
		if ( is_search() && Classic_Search::instance() ) {
			if ( Helper::should_rerun_search_in_customizer_preview() ) {
				Classic_Search::instance()->update_search_results_aggregations();
			}

			$filters = Classic_Search::instance()->get_filters();

			if ( ! Helper::are_filters_by_widget_disabled() && ! $this->should_display_sitewide_filters() ) {
				$filters = array_filter( $filters, array( $this, 'is_for_current_widget' ) );
			}

			if ( ! empty( $filters ) ) {
				$display_filters = true;
			}
		}

		if ( ! $display_filters && empty( $instance['search_box_enabled'] ) && empty( $instance['user_sort_enabled'] ) ) {
			return;
		}

		$title = ! empty( $instance['title'] ) ? $instance['title'] : '';

		/** This filter is documented in core/src/wp-includes/default-widgets.php */
		$title = apply_filters( 'widget_title', $title, $instance, $this->id_base );

		echo $args['before_widget']; //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
		?>
			<div id="<?php echo esc_attr( $this->id ); ?>-wrapper" >
		<?php

		if ( ! empty( $title ) ) {
			/**
			 * Responsible for displaying the title of the Jetpack Search filters widget.
			 *
			 * @module search
			 *
			 * @param string $title                The widget's title
			 * @param string $args['before_title'] The HTML tag to display before the title
			 * @param string $args['after_title']  The HTML tag to display after the title
			 *@since  5.7.0
			 */
			do_action( 'jetpack_search_render_filters_widget_title', $title, $args['before_title'], $args['after_title'] );
		}

		$default_sort            = isset( $instance['sort'] ) ? $instance['sort'] : self::DEFAULT_SORT;
		list( $orderby, $order ) = $this->sorting_to_wp_query_param( $default_sort );
		$current_sort            = "{$orderby}|{$order}";

		// we need to dynamically inject the sort field into the search box when the search box is enabled, and display
		// it separately when it's not.
		if ( ! empty( $instance['search_box_enabled'] ) ) {
			Template_Tags::render_widget_search_form( $instance['post_types'], $orderby, $order );
		}

		if ( ! empty( $instance['search_box_enabled'] ) && ! empty( $instance['user_sort_enabled'] ) ) :
			?>
					<div class="jetpack-search-sort-wrapper">
				<label>
					<?php esc_html_e( 'Sort by', 'jetpack-search-pkg' ); ?>
					<select class="jetpack-search-sort">
						<?php foreach ( $this->get_sort_types() as $sort => $label ) { ?>
							<option value="<?php echo esc_attr( $sort ); ?>" <?php selected( $current_sort, $sort ); ?>>
								<?php echo esc_html( $label ); ?>
							</option>
						<?php } ?>
					</select>
				</label>
			</div>
			<?php
		endif;

		if ( $display_filters ) {
			/**
			 * Responsible for rendering filters to narrow down search results.
			 *
			 * @module search
			 *
			 * @param array $filters    The possible filters for the current query.
			 * @param array $post_types An array of post types to limit filtering to.
			 *@since  5.8.0
			 */
			do_action(
				'jetpack_search_render_filters',
				$filters,
				isset( $instance['post_types'] ) ? $instance['post_types'] : null
			);
		}

		$this->maybe_render_sort_javascript( $instance, $order, $orderby );

		echo '</div>';
		echo $args['after_widget']; //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * Render the instant frontend widget.
	 *
	 * @param array $args     Widgets args supplied by the theme.
	 * @param array $instance The current widget instance.
	 * @since 8.3.0
	 */
	public function widget_instant( $args, $instance ) {
		// Exit early if search instance has not been initialized.
		if ( ! Instant_Search::instance() ) {
			return false;
		}

		if ( Helper::should_rerun_search_in_customizer_preview() ) {
			Instant_Search::instance()->update_search_results_aggregations();
		}

		$filters = Instant_Search::instance()->get_filters();
		if ( ! Helper::are_filters_by_widget_disabled() && ! $this->should_display_sitewide_filters() ) {
			$filters = array_filter( $filters, array( $this, 'is_for_current_widget' ) );
		}

		$display_filters = ! empty( $filters );

		$title = ! empty( $instance['title'] ) ? $instance['title'] : '';

		/** This filter is documented in core/src/wp-includes/default-widgets.php */
		$title = apply_filters( 'widget_title', $title, $instance, $this->id_base );

		echo $args['before_widget']; //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
		?>
			<div id="<?php echo esc_attr( $this->id ); ?>-wrapper" class="jetpack-instant-search-wrapper">
		<?php

		if ( ! empty( $title ) ) {
			/**
			 * Responsible for displaying the title of the Jetpack Search filters widget.
			 *
			 * @module search
			 *
			 * @param string $title                The widget's title
			 * @param string $args['before_title'] The HTML tag to display before the title
			 * @param string $args['after_title']  The HTML tag to display after the title
			 *@since  5.7.0
			 */
			do_action( 'jetpack_search_render_filters_widget_title', $title, $args['before_title'], $args['after_title'] );
		}

		Template_Tags::render_widget_search_form( array(), '', '' );

		if ( $display_filters ) {
			/**
			 * Responsible for rendering filters to narrow down search results.
			 *
			 * @module search
			 *
			 * @param array $filters    The possible filters for the current query.
			 * @param array $post_types An array of post types to limit filtering to.
			 *@since  5.8.0
			 */
			do_action(
				'jetpack_search_render_filters',
				$filters,
				null
			);
		}

		echo '</div>';
		echo $args['after_widget']; //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * Render the instant widget for the overlay.
	 *
	 * @param array $args     Widgets args supplied by the theme.
	 * @param array $instance The current widget instance.
	 * @since 8.3.0
	 */
	public function widget_empty_instant( $args, $instance ) {
		$title = isset( $instance['title'] ) ? $instance['title'] : '';

		if ( empty( $title ) ) {
			$title = '';
		}

		/** This filter is documented in core/src/wp-includes/default-widgets.php */
		$title = apply_filters( 'widget_title', $title, $instance, $this->id_base );

		echo $args['before_widget']; //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
		?>
			<div id="<?php echo esc_attr( $this->id ); ?>-wrapper" class="jetpack-instant-search-wrapper">
		<?php

		if ( ! empty( $title ) ) {
			/**
			 * Responsible for displaying the title of the Jetpack Search filters widget.
			 *
			 * @module search
			 *
			 * @param string $title                The widget's title
			 * @param string $args['before_title'] The HTML tag to display before the title
			 * @param string $args['after_title']  The HTML tag to display after the title
			 *@since  5.7.0
			 */
			do_action( 'jetpack_search_render_filters_widget_title', $title, $args['before_title'], $args['after_title'] );
		}

		echo '</div>';
		echo $args['after_widget']; //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * Renders JavaScript for the sorting controls on the frontend.
	 *
	 * This JS is a bit complicated, but here's what it's trying to do:
	 * - find the search form
	 * - find the orderby/order fields and set default values
	 * - detect changes to the sort field, if it exists, and use it to set the order field values
	 *
	 * @param array  $instance The current widget instance.
	 * @param string $order    The order to initialize the select with.
	 * @param string $orderby  The orderby to initialize the select with.
	 * @since 5.8.0
	 */
	private function maybe_render_sort_javascript( $instance, $order, $orderby ) {
		if ( Options::is_instant_enabled() ) {
			return;
		}

		if ( ! empty( $instance['user_sort_enabled'] ) ) :
			?>
		<script type="text/javascript">
			var jetpackSearchModuleSorting = function() {
				var orderByDefault = '<?php echo 'date' === $orderby ? 'date' : 'relevance'; ?>',
					orderDefault   = '<?php echo 'ASC' === $order ? 'ASC' : 'DESC'; ?>',
					widgetId       = decodeURIComponent( '<?php echo rawurlencode( $this->id ); ?>' ),
					searchQuery    = decodeURIComponent( '<?php echo rawurlencode( get_query_var( 's', '' ) ); ?>' ),
					isSearch       = <?php echo (int) is_search(); ?>;

				var container = document.getElementById( widgetId + '-wrapper' ),
					form = container.querySelector( '.jetpack-search-form form' ),
					orderBy = form.querySelector( 'input[name=orderby]' ),
					order = form.querySelector( 'input[name=order]' ),
					searchInput = form.querySelector( 'input[name="s"]' ),
					sortSelectInput = container.querySelector( '.jetpack-search-sort' );

				orderBy.value = orderByDefault;
				order.value = orderDefault;

				// Some themes don't set the search query, which results in the query being lost
				// when doing a sort selection. So, if the query isn't set, let's set it now. This approach
				// is chosen over running a regex over HTML for every search query performed.
				if ( isSearch && ! searchInput.value ) {
					searchInput.value = searchQuery;
				}

				searchInput.classList.add( 'show-placeholder' );

				sortSelectInput.addEventListener( 'change', function( event ) {
					var values  = event.target.value.split( '|' );
					orderBy.value = values[0];
					order.value = values[1];

					form.submit();
				} );
			}

			if ( document.readyState === 'interactive' || document.readyState === 'complete' ) {
				jetpackSearchModuleSorting();
			} else {
				document.addEventListener( 'DOMContentLoaded', jetpackSearchModuleSorting );
			}
			</script>
			<?php
		endif;
	}

	/**
	 * Convert a sort string into the separate order by and order parts.
	 *
	 * @param string $sort A sort string.
	 *
	 * @return array Order by and order.
	 * @since 5.8.0
	 */
	private function sorting_to_wp_query_param( $sort ) {
		// phpcs:disable WordPress.Security.NonceVerification.Recommended
		$parts   = explode( '|', $sort );
		$orderby = isset( $_GET['orderby'] )
			? sanitize_sql_orderby( wp_unslash( $_GET['orderby'] ) )
			: $parts[0];

		$order = isset( $_GET['order'] )
			? ( strtoupper( $_GET['order'] ) === 'ASC' ? 'ASC' : 'DESC' ) // phpcs:ignore WordPress.Security.ValidatedSanitizedInput -- This is validating.
			: ( ( isset( $parts[1] ) && 'ASC' === strtoupper( $parts[1] ) ) ? 'ASC' : 'DESC' );

		// phpcs:enable WordPress.Security.NonceVerification.Recommended

		return array( $orderby, $order );
	}

	/**
	 * Updates a particular instance of the widget. Validates and sanitizes the options.
	 *
	 * @param array $new_instance New settings for this instance as input by the user via Search_Widget::form().
	 * @param array $old_instance Old settings for this instance.
	 *
	 * @return array Settings to save.
	 * @since 5.0.0
	 */
	public function update( $new_instance, $old_instance ) { // phpcs:ignore VariableAnalysis.CodeAnalysis.VariableAnalysis.UnusedVariable
		$new_instance = $this->maybe_reformat_widget( $new_instance );
		$instance     = array();

		$instance['title'] = sanitize_text_field( $new_instance['title'] );

		// Keep `search_box_enabled` and `user_sort_enabled` settings when updating widget on Instant Search
		// Set `search_box_enabled` and `user_sort_enabled` default to '1' when createing a NEW widget
		if ( Options::is_instant_enabled() ) {
			$instance['search_box_enabled'] = empty( $old_instance ) ? '1' : $old_instance['search_box_enabled'];
			$instance['user_sort_enabled']  = empty( $old_instance ) ? '1' : $old_instance['user_sort_enabled'];
		} else {
			$instance['search_box_enabled'] = empty( $new_instance['search_box_enabled'] ) ? '0' : '1';
			$instance['user_sort_enabled']  = empty( $new_instance['user_sort_enabled'] ) ? '0' : '1';
		}

		$instance['sort']       = empty( $new_instance['sort'] ) ? self::DEFAULT_SORT : $new_instance['sort'];
		$instance['post_types'] = empty( $new_instance['post_types'] ) || empty( $instance['search_box_enabled'] )
			? array()
			: array_map( 'sanitize_key', $new_instance['post_types'] );

		$filters = array();
		if ( isset( $new_instance['filter_type'] ) ) {
			foreach ( (array) $new_instance['filter_type'] as $index => $type ) {
				$count = (int) $new_instance['num_filters'][ $index ];
				$count = min( 50, $count ); // Set max boundary at 50.
				$count = max( 1, $count );  // Set min boundary at 1.

				switch ( $type ) {
					case 'taxonomy':
						$filters[] = array(
							'name'     => sanitize_text_field( $new_instance['filter_name'][ $index ] ),
							'type'     => 'taxonomy',
							'taxonomy' => sanitize_key( $new_instance['taxonomy_type'][ $index ] ),
							'count'    => $count,
						);
						break;
					case 'post_type':
						$filters[] = array(
							'name'  => sanitize_text_field( $new_instance['filter_name'][ $index ] ),
							'type'  => 'post_type',
							'count' => $count,
						);
						break;
					case 'author':
						$filters[] = array(
							'name'  => sanitize_text_field( $new_instance['filter_name'][ $index ] ),
							'type'  => 'author',
							'count' => $count,
						);
						break;
					case 'blog_id':
						$filters[] = array(
							'name'  => sanitize_text_field( $new_instance['filter_name'][ $index ] ),
							'type'  => 'blog_id',
							'count' => $count,
						);
						break;
					case 'date_histogram':
						$filters[] = array(
							'name'     => sanitize_text_field( $new_instance['filter_name'][ $index ] ),
							'type'     => 'date_histogram',
							'count'    => $count,
							'field'    => sanitize_key( $new_instance['date_histogram_field'][ $index ] ),
							'interval' => sanitize_key( $new_instance['date_histogram_interval'][ $index ] ),
						);
						break;
				}
			}
		}

		if ( ! empty( $filters ) ) {
			$instance['filters'] = $filters;
		}

		return $instance;
	}

	/**
	 * Reformats the widget instance array to one that is recognized by the `update` function.
	 * This is only necessary when handling changes from the block-based widget editor.
	 *
	 * @param array $widget_instance - Jetpack Search widget instance.
	 *
	 * @return array - Potentially reformatted instance compatible with the save function.
	 */
	protected function maybe_reformat_widget( $widget_instance ) {
		if ( isset( $widget_instance['filter_type'] ) || ! isset( $widget_instance['filters'] ) || ! is_array( $widget_instance['filters'] ) ) {
			return $widget_instance;
		}

		$instance = $widget_instance;
		foreach ( $widget_instance['filters'] as $filter ) {
			$instance['filter_type'][]             = isset( $filter['type'] ) ? $filter['type'] : '';
			$instance['taxonomy_type'][]           = isset( $filter['taxonomy'] ) ? $filter['taxonomy'] : '';
			$instance['filter_name'][]             = isset( $filter['name'] ) ? $filter['name'] : '';
			$instance['num_filters'][]             = isset( $filter['count'] ) ? $filter['count'] : 5;
			$instance['date_histogram_field'][]    = isset( $filter['field'] ) ? $filter['field'] : '';
			$instance['date_histogram_interval'][] = isset( $filter['interval'] ) ? $filter['interval'] : '';
		}
		unset( $instance['filters'] );
		return $instance;
	}

	/**
	 * Outputs the settings update form.
	 *
	 * @param array $instance Previously saved values from database.
	 * @since 5.0.0
	 */
	public function form( $instance ) {
		if ( Options::is_instant_enabled() ) {
			return $this->form_for_instant_search( $instance );
		}

		$instance = $this->jetpack_search_populate_defaults( $instance );

		$title = wp_strip_all_tags( $instance['title'] );

		$hide_filters = Helper::are_filters_by_widget_disabled();

		$classes = sprintf(
			'jetpack-search-filters-widget %s %s %s',
			$hide_filters ? 'hide-filters' : '',
			$instance['search_box_enabled'] ? '' : 'hide-post-types',
			$this->id
		);
		?>
		<div class="<?php echo esc_attr( $classes ); ?>">
			<p>
				<label for="<?php echo esc_attr( $this->get_field_id( 'title' ) ); ?>">
					<?php esc_html_e( 'Title (optional):', 'jetpack-search-pkg' ); ?>
				</label>
				<input
					class="widefat"
					id="<?php echo esc_attr( $this->get_field_id( 'title' ) ); ?>"
					name="<?php echo esc_attr( $this->get_field_name( 'title' ) ); ?>"
					type="text"
					value="<?php echo esc_attr( $title ); ?>"
				/>
			</p>

			<p>
				<label>
					<input
						type="checkbox"
						class="jetpack-search-filters-widget__search-box-enabled"
						name="<?php echo esc_attr( $this->get_field_name( 'search_box_enabled' ) ); ?>"
						<?php checked( $instance['search_box_enabled'] ); ?>
					/>
					<?php esc_html_e( 'Show search box', 'jetpack-search-pkg' ); ?>
				</label>
			</p>

			<p>
				<label>
					<input
						type="checkbox"
						class="jetpack-search-filters-widget__sort-controls-enabled"
						name="<?php echo esc_attr( $this->get_field_name( 'user_sort_enabled' ) ); ?>"
						<?php checked( $instance['user_sort_enabled'] ); ?>
						<?php disabled( ! $instance['search_box_enabled'] ); ?>
					/>
					<?php esc_html_e( 'Show sort selection dropdown', 'jetpack-search-pkg' ); ?>
				</label>
			</p>

			<p class="jetpack-search-filters-widget__post-types-select">
				<label><?php esc_html_e( 'Post types to search (minimum of 1):', 'jetpack-search-pkg' ); ?></label>
				<?php foreach ( get_post_types( array( 'exclude_from_search' => false ), 'objects' ) as $post_type ) : ?>
					<label>
						<input
							type="checkbox"
							value="<?php echo esc_attr( $post_type->name ); ?>"
							name="<?php echo esc_attr( $this->get_field_name( 'post_types' ) ); ?>[]"
							<?php checked( empty( $instance['post_types'] ) || in_array( $post_type->name, $instance['post_types'], true ) ); ?>
						/>&nbsp;
						<?php echo esc_html( $post_type->label ); ?>
					</label>
				<?php endforeach; ?>
			</p>

			<p>
				<label>
					<?php esc_html_e( 'Default sort order:', 'jetpack-search-pkg' ); ?>
					<select
						name="<?php echo esc_attr( $this->get_field_name( 'sort' ) ); ?>"
						class="widefat jetpack-search-filters-widget__sort-order">
						<?php foreach ( $this->get_sort_types() as $sort_type => $label ) { ?>
							<option value="<?php echo esc_attr( $sort_type ); ?>" <?php selected( $instance['sort'], $sort_type ); ?>>
								<?php echo esc_html( $label ); ?>
							</option>
						<?php } ?>
					</select>
				</label>
			</p>

			<?php if ( ! $hide_filters ) : ?>
				<script class="jetpack-search-filters-widget__filter-template" type="text/template">
					<?php
					echo $this->render_widget_edit_filter( array(), true ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
					?>
				</script>
				<div class="jetpack-search-filters-widget__filters">
					<?php foreach ( (array) $instance['filters'] as $filter ) : ?>
						<?php $this->render_widget_edit_filter( $filter ); ?>
					<?php endforeach; ?>
				</div>
				<p class="jetpack-search-filters-widget__add-filter-wrapper">
					<a class="button jetpack-search-filters-widget__add-filter" href="#">
						<?php esc_html_e( 'Add a filter', 'jetpack-search-pkg' ); ?>
					</a>
				</p>
				<noscript>
					<p class="jetpack-search-filters-help">
						<?php echo esc_html_e( 'Adding filters requires JavaScript!', 'jetpack-search-pkg' ); ?>
					</p>
				</noscript>
				<?php if ( is_customize_preview() ) : ?>
					<p class="jetpack-search-filters-help">
						<a href="<?php echo esc_url( Redirect::get_url( 'jetpack-support-search', array( 'anchor' => 'filters-not-showing-up' ) ) ); ?>" target="_blank">
							<?php esc_html_e( "Why aren't my filters appearing?", 'jetpack-search-pkg' ); ?>
						</a>
					</p>
				<?php endif; ?>
			<?php endif; ?>
		</div>
		<?php
	}

	/**
	 * Outputs the widget update form to be used in the Customizer for Instant Search.
	 *
	 * @param array $instance Previously saved values from database.
	 * @since 8.6.0
	 */
	private function form_for_instant_search( $instance ) {
		$instance = $this->populate_defaults_for_instant_search( $instance );
		$classes  = sprintf( 'jetpack-search-filters-widget %s', $this->id );

		?>
		<div class="<?php echo esc_attr( $classes ); ?>">
			<!-- Title control -->
			<p>
				<label for="<?php echo esc_attr( $this->get_field_id( 'title' ) ); ?>">
					<?php esc_html_e( 'Title (optional):', 'jetpack-search-pkg' ); ?>
				</label>
				<input
					class="widefat"
					id="<?php echo esc_attr( $this->get_field_id( 'title' ) ); ?>"
					name="<?php echo esc_attr( $this->get_field_name( 'title' ) ); ?>"
					type="text"
					value="<?php echo esc_attr( wp_strip_all_tags( $instance['title'] ) ); ?>"
				/>
			</p>

			<!-- Filters control -->
			<?php if ( ! Helper::are_filters_by_widget_disabled() ) : ?>
				<div class="jetpack-search-filters-widget__filters">
					<?php foreach ( (array) $instance['filters'] as $filter ) : ?>
						<?php $this->render_widget_edit_filter( $filter, false, true ); ?>
					<?php endforeach; ?>
				</div>
				<p class="jetpack-search-filters-widget__add-filter-wrapper">
					<a class="button jetpack-search-filters-widget__add-filter" href="#">
						<?php esc_html_e( 'Add a filter', 'jetpack-search-pkg' ); ?>
					</a>
				</p>
				<script class="jetpack-search-filters-widget__filter-template" type="text/template">
					<?php $this->render_widget_edit_filter( array(), true, true ); ?>
				</script>
				<noscript>
					<p class="jetpack-search-filters-help">
						<?php echo esc_html_e( 'Adding filters requires JavaScript!', 'jetpack-search-pkg' ); ?>
					</p>
				</noscript>
			<?php endif; ?>
		</div>
		<?php
	}

	/**
	 * We need to render HTML in two formats: an Underscore template (client-side)
	 * and native PHP (server-side). This helper function allows for easy rendering
	 * of attributes in both formats.
	 *
	 * @param string $name        Attribute name.
	 * @param string $value       Attribute value.
	 * @param bool   $is_template Whether this is for an Underscore template or not.
	 * @since 5.8.0
	 */
	private function render_widget_attr( $name, $value, $is_template ) {
		echo $is_template ? "<%= $name %>" : esc_attr( $value ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * We need to render HTML in two formats: an Underscore template (client-size)
	 * and native PHP (server-side). This helper function allows for easy rendering
	 * of the "selected" attribute in both formats.
	 *
	 * @param string $name        Attribute name.
	 * @param string $value       Attribute value.
	 * @param string $compare     Value to compare to the attribute value to decide if it should be selected.
	 * @param bool   $is_template Whether this is for an Underscore template or not.
	 * @since 5.8.0
	 */
	private function render_widget_option_selected( $name, $value, $compare, $is_template ) {
		$compare_js = rawurlencode( $compare );
		echo $is_template ? "<%= decodeURIComponent( '$compare_js' ) === $name ? 'selected=\"selected\"' : '' %>" : selected( $value, $compare ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * Responsible for rendering a single filter in the customizer or the widget administration screen in wp-admin.
	 *
	 * We use this method for two purposes - rendering the fields server-side, and also rendering a script template for Underscore.
	 *
	 * @param array $filter      The filter to render.
	 * @param bool  $is_template Whether this is for an Underscore template or not.
	 * @param bool  $is_instant_search Whether this site enables Instant Search or not.
	 * @since 5.7.0
	 */
	public function render_widget_edit_filter( $filter, $is_template = false, $is_instant_search = false ) {
		$args = wp_parse_args(
			$filter,
			array(
				'name'      => '',
				'type'      => 'taxonomy',
				'taxonomy'  => '',
				'post_type' => '',
				'field'     => '',
				'interval'  => '',
				'count'     => self::DEFAULT_FILTER_COUNT,
			)
		);

		$args['name_placeholder'] = Helper::generate_widget_filter_name( $args );

		// Hide author & blog ID filters when Instant Search is turned off.
		if ( ! $is_instant_search && in_array( $args['type'], array( 'author', 'blog_id' ), true ) ) :
			return;
		endif;
		?>
		<div class="jetpack-search-filters-widget__filter is-<?php $this->render_widget_attr( 'type', $args['type'], $is_template ); ?>">
			<p class="jetpack-search-filters-widget__type-select">
				<label>
					<?php esc_html_e( 'Filter Type:', 'jetpack-search-pkg' ); ?>
					<select name="<?php echo esc_attr( $this->get_field_name( 'filter_type' ) ); ?>[]" class="widefat filter-select">
						<option value="taxonomy" <?php $this->render_widget_option_selected( 'type', $args['type'], 'taxonomy', $is_template ); ?>>
							<?php esc_html_e( 'Taxonomy', 'jetpack-search-pkg' ); ?>
						</option>
						<option value="post_type" <?php $this->render_widget_option_selected( 'type', $args['type'], 'post_type', $is_template ); ?>>
							<?php esc_html_e( 'Post Type', 'jetpack-search-pkg' ); ?>
						</option>
						<?php if ( $is_instant_search ) : ?>
						<option value="author" <?php $this->render_widget_option_selected( 'type', $args['type'], 'author', $is_template ); ?>>
							<?php esc_html_e( 'Author', 'jetpack-search-pkg' ); ?>
						</option>
						<option value="blog_id" <?php $this->render_widget_option_selected( 'type', $args['type'], 'blog_id', $is_template ); ?>>
							<?php esc_html_e( 'Blog', 'jetpack-search-pkg' ); ?>
						</option>
						<?php endif; ?>
						<option value="date_histogram" <?php $this->render_widget_option_selected( 'type', $args['type'], 'date_histogram', $is_template ); ?>>
							<?php esc_html_e( 'Date', 'jetpack-search-pkg' ); ?>
						</option>
					</select>
				</label>
			</p>

			<p class="jetpack-search-filters-widget__taxonomy-select">
				<label>
					<?php
						esc_html_e( 'Choose a taxonomy:', 'jetpack-search-pkg' );
						$seen_taxonomy_labels = array();
					?>
					<select name="<?php echo esc_attr( $this->get_field_name( 'taxonomy_type' ) ); ?>[]" class="widefat taxonomy-select">
						<?php foreach ( $this->get_allowed_taxonomies_for_widget_filters() as $taxonomy ) : ?>
							<option value="<?php echo esc_attr( $taxonomy->name ); ?>" <?php $this->render_widget_option_selected( 'taxonomy', $args['taxonomy'], $taxonomy->name, $is_template ); ?>>
								<?php
									$label = in_array( $taxonomy->label, $seen_taxonomy_labels, true )
										? sprintf(
											/* translators: %1$s is the taxonomy name, %2s is the name of its type to help distinguish between several taxonomies with the same name, e.g. category and tag. */
											_x( '%1$s (%2$s)', 'A label for a taxonomy selector option', 'jetpack-search-pkg' ),
											$taxonomy->label,
											$taxonomy->name
										)
										: $taxonomy->label;
									echo esc_html( $label );
									$seen_taxonomy_labels[] = $taxonomy->label;
								?>
							</option>
						<?php endforeach; ?>
					</select>
				</label>
			</p>

			<p class="jetpack-search-filters-widget__date-histogram-select">
				<label>
					<?php esc_html_e( 'Choose a field:', 'jetpack-search-pkg' ); ?>
					<select name="<?php echo esc_attr( $this->get_field_name( 'date_histogram_field' ) ); ?>[]" class="widefat date-field-select">
						<option value="post_date" <?php $this->render_widget_option_selected( 'field', $args['field'], 'post_date', $is_template ); ?>>
							<?php esc_html_e( 'Date', 'jetpack-search-pkg' ); ?>
						</option>
						<option value="post_date_gmt" <?php $this->render_widget_option_selected( 'field', $args['field'], 'post_date_gmt', $is_template ); ?>>
							<?php esc_html_e( 'Date GMT', 'jetpack-search-pkg' ); ?>
						</option>
						<option value="post_modified" <?php $this->render_widget_option_selected( 'field', $args['field'], 'post_modified', $is_template ); ?>>
							<?php esc_html_e( 'Modified', 'jetpack-search-pkg' ); ?>
						</option>
						<option value="post_modified_gmt" <?php $this->render_widget_option_selected( 'field', $args['field'], 'post_modified_gmt', $is_template ); ?>>
							<?php esc_html_e( 'Modified GMT', 'jetpack-search-pkg' ); ?>
						</option>
					</select>
				</label>
			</p>

			<p class="jetpack-search-filters-widget__date-histogram-select">
				<label>
					<?php esc_html_e( 'Choose an interval:', 'jetpack-search-pkg' ); ?>
					<select name="<?php echo esc_attr( $this->get_field_name( 'date_histogram_interval' ) ); ?>[]" class="widefat date-interval-select">
						<option value="month" <?php $this->render_widget_option_selected( 'interval', $args['interval'], 'month', $is_template ); ?>>
							<?php esc_html_e( 'Month', 'jetpack-search-pkg' ); ?>
						</option>
						<option value="year" <?php $this->render_widget_option_selected( 'interval', $args['interval'], 'year', $is_template ); ?>>
							<?php esc_html_e( 'Year', 'jetpack-search-pkg' ); ?>
						</option>
					</select>
				</label>
			</p>

			<p class="jetpack-search-filters-widget__title">
				<label>
					<?php esc_html_e( 'Title:', 'jetpack-search-pkg' ); ?>
					<input
						class="widefat"
						type="text"
						name="<?php echo esc_attr( $this->get_field_name( 'filter_name' ) ); ?>[]"
						value="<?php $this->render_widget_attr( 'name', $args['name'], $is_template ); ?>"
						placeholder="<?php $this->render_widget_attr( 'name_placeholder', $args['name_placeholder'], $is_template ); ?>"
					/>
				</label>
			</p>

			<p>
				<label>
					<?php esc_html_e( 'Maximum number of filters (1-50):', 'jetpack-search-pkg' ); ?>
					<input
						class="widefat filter-count"
						name="<?php echo esc_attr( $this->get_field_name( 'num_filters' ) ); ?>[]"
						type="number"
						value="<?php $this->render_widget_attr( 'count', $args['count'], $is_template ); ?>"
						min="1"
						max="50"
						step="1"
						required
					/>
				</label>
			</p>

			<p class="jetpack-search-filters-widget__controls">
				<a href="#" class="delete"><?php esc_html_e( 'Remove', 'jetpack-search-pkg' ); ?></a>
			</p>
		</div>
			<?php
	}

	/**
	 * Returns the taxonomies for search widget taxonomy dropdown.
	 */
	protected function get_allowed_taxonomies_for_widget_filters() {
		return array_filter(
			get_taxonomies( array( 'public' => true ), 'objects' ),
			function ( $taxonomy ) {
				return in_array(
					$taxonomy->name,
					/**
					 * Filters the taxonomies that shows in filter drop downs of the search widget.
					 *
					 * @since  0.16.0
					 *
					 * @param array $taxonomies_to_show List of taxonomies that shown for search widget.
					 */
					apply_filters(
						'jetpack_search_allowed_taxonomies_for_widget_filters',
						array_merge( array( 'category', 'post_tag' ), Search_Sync_Module::get_all_taxonomies() )
					),
					true
				);
			}
		);
	}
}
search-widget-admin-ui.css                                                                                                                                                                                                                                     2458          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/widgets/css                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        .jetpack-search-filters-widget__filter {
	background: #f6f7f7;
	border: 1px solid #dcdcde;
	padding: 0 12px;
	margin-bottom: 12px;
	cursor: move;
}

.jetpack-search-filters-widget__controls {
	text-align: right;
}

.jetpack-search-filters-widget .jetpack-search-filters-widget__sort-controls-enabled {
	margin-left: 24px;
}

.jetpack-search-filters-widget__controls .delete {
	color: #d63638;
}

.jetpack-search-filters-widget.hide-filters .jetpack-search-filters-widget__filter {
	display: none;
}

.button.jetpack-search-filters-widget__add-filter {
	margin-bottom: 10px;
}

/* Assume that taxonomy select is the default selected. Other controls should be hidden here. */
.jetpack-search-filters-widget__post-type-select {
	display: none;
}

.jetpack-search-filters-widget__date-histogram-select {
	display: none;
}

.jetpack-search-filters-widget__filter-placeholder {
	border: 1px #555 dashed;
	background-color: #f0f0f1;
	height: 286px;
	margin-bottom: 12px;
}

/* When post type is selected, remove the other controls */
.jetpack-search-filters-widget__filter.is-post_type .jetpack-search-filters-widget__taxonomy-select {
	display: none;
}

/* When author type is selected, remove the other controls */
.jetpack-search-filters-widget__filter.is-author .jetpack-search-filters-widget__taxonomy-select {
	display: none;
}

/* When blog ID type is selected, remove the other controls */
.jetpack-search-filters-widget__filter.is-blog_id .jetpack-search-filters-widget__taxonomy-select {
	display: none;
}

/* When date is selected, remove the other controls */
.jetpack-search-filters-widget__filter.is-date_histogram .jetpack-search-filters-widget__date-histogram-select {
	display: inline;
}

.jetpack-search-filters-widget__filter.is-date_histogram .jetpack-search-filters-widget__taxonomy-select {
	display: none;
}

.jetpack-search-filters-widget.hide-post-types .jetpack-search-filters-widget__post-types-select {
	display: none;
}

.jetpack-search-filters-help:before {
	display: inline-block;
	position: relative;
	font-family: dashicons;
	font-size: 20px;
	top: 5px;
	line-height: 1px;
	content:"\f223";
}
.jetpack-search-filters-help {
	padding: 5px 5px 15px 0;
}

.jetpack-search-filters-widget__post-types-select label {
	display: block;
	margin-bottom: 4px;
}

.jetpack-search-filters-widget__post-types-select input[type="checkbox"] {
	margin-left: 24px;
}

body.no-js .jetpack-search-filters-widget__add-filter-wrapper {
	display: none;
}
search-widget-frontend.css                                                                                                                                                                                                                                     1317          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/widgets/css                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        .jetpack-search-filters-widget__sub-heading {
	font-size: inherit;
	font-weight: bold;
	margin: 0 0 .5em;
	padding: 0;
}

/* The first heading after the form */
.jetpack-search-form + .jetpack-search-filters-widget__sub-heading {
	margin-top: 1.5em;
	margin-bottom: 0.5em !important;
}

.jetpack-search-filters-widget__clear {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.jetpack-search-sort-wrapper {
	margin-top: 1em;
	margin-bottom: 1.5em;
}

.jetpack-search-sort-wrapper label {
	display: inherit;
}

.widget_search .jetpack-search-filters-widget__filter-list input[type="checkbox"] {
	width: auto;
	height: auto;
}

ul.jetpack-search-filters-widget__filter-list li {
	border: none;
	padding: 0;
	list-style: none;
}

ul.jetpack-search-filters-widget__filter-list li a {
	text-decoration: none;
}

ul.jetpack-search-filters-widget__filter-list li a:hover {
	box-shadow: none;
}

ul.jetpack-search-filters-widget__filter-list li label {
	font-weight: inherit;
	display: inherit;
}

.jetpack-search-filters-widget__filter-list {
	list-style: none;
}

ul.jetpack-search-filters-widget__filter-list {
	margin-bottom: 1.5em;
}

body.search .jetpack-search-form input[name="s"]::placeholder {
	color: transparent;
}

body.search .jetpack-search-form input[name="s"].show-placeholder::placeholder {
	color: inherit;
}
search-widget-admin.js                                                                                                                                                                                                                                         11685         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/widgets/js                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /* globals jetpack_search_filter_admin, jQuery, analytics */

( function( $, args ) {
	var defaultFilterCount = ( 'undefined' !== typeof args && args.defaultFilterCount ) ?
		args.defaultFilterCount :
		5; // Just in case we couldn't find the defaultFiltercount arg

	$( document ).ready( function() {
		setListeners();

		window.JetpackSearch = window.JetpackSearch || {};
		window.JetpackSearch.addFilter = addFilter;

		// Initialize Tracks
		if ( 'undefined' !== typeof analytics && args.tracksUserData ) {
			analytics.initialize( args.tracksUserData.userid, args.tracksUserData.username );
		}
	} );

	function generateFilterTitlePlaceholder( container ) {
		var placeholder = null,
			isModified = null,
			isMonth = null,
			type = container.find( '.filter-select' ).val();

		if ( 'taxonomy' === type ) {
			placeholder = container.find('.taxonomy-select option:selected').text().trim();
		} else if ( 'date_histogram' === type && args && args.i18n ) {
			isModified = ( -1 !== container.find( '.date-field-select' ).val().indexOf( 'modified' ) );
			isMonth = ( 'month' === container.find( '.date-interval-select' ).val() );

			if ( isMonth ) {
				placeholder = isModified ?
					args.i18n.monthUpdated :
					args.i18n.month;
			} else {
				placeholder = isModified ?
					args.i18n.yearUpdated :
					args.i18n.year;
			}
		} else {
			placeholder = container.find('.filter-select option:selected').text().trim();
		}

		$( container ).find('.jetpack-search-filters-widget__title input').prop( 'placeholder', placeholder );
	}

	var addFilter = function( filtersContainer, args ) {
		var template = _.template(
			filtersContainer
				.closest( '.jetpack-search-filters-widget' )
				.find( '.jetpack-search-filters-widget__filter-template' )
				.html()
		);
		generateFilterTitlePlaceholder( filtersContainer.append( template( args ) ) );
	};

	var setListeners = function( widget ) {
		widget = ( 'undefined' === typeof widget ) ?
			$( '.jetpack-search-filters-widget' ):
			widget;

		var getContainer = function( el ) {
			return $( el ).closest('.jetpack-search-filters-widget__filter');
		};

		widget.on( 'change', '.filter-select', function() {
			var select = $( this ),
				selectVal = select.val(),
				eventArgs = {
					is_customizer: args.tracksEventData.is_customizer
				};

			eventArgs.type = selectVal;

			select
				.closest( '.jetpack-search-filters-widget__filter' )
				.attr( 'class', 'jetpack-search-filters-widget__filter' )
				.addClass( 'is-' + selectVal );

			generateFilterTitlePlaceholder( getContainer( this ) );

			trackAndBumpMCStats( 'changed_filter_type', eventArgs );
		} );

		// enable showing sort controls only if showing search box is enabled
		widget.on( 'change', '.jetpack-search-filters-widget__search-box-enabled', function() {
			var checkbox = $( this ),
				checkboxVal = checkbox.is(':checked'),
				filterParent = checkbox.closest( '.jetpack-search-filters-widget' ),
				sortControl = filterParent.find( '.jetpack-search-filters-widget__sort-controls-enabled' );

			filterParent.toggleClass( 'hide-post-types' );

			if ( checkboxVal ) {
				sortControl.removeAttr( 'disabled' );
				trackAndBumpMCStats( 'enabled_search_box', args.tracksEventData );
			} else {
				sortControl.prop( 'checked', false );
				sortControl.prop( 'disabled', true );
				trackAndBumpMCStats( 'disabled_search_box', args.tracksEventData );
			}
		} );

		widget.on( 'change', '.jetpack-search-filters-widget__sort-controls-enabled', function() {
			if ( $( this ).is( ':checked' ) ) {
				trackAndBumpMCStats( 'enabled_sort_controls', args.tracksEventData );
			} else {
				trackAndBumpMCStats( 'disabled_sort_controls', args.tracksEventData );
			}
		} );

		widget.on( 'click', '.jetpack-search-filters-widget__post-types-select input[type="checkbox"]', function( e ) {
			var t = $( this );
			var siblingsChecked = t.closest( '.jetpack-search-filters-widget' )
				.find( '.jetpack-search-filters-widget__post-types-select input[type="checkbox"]:checked' );

			if ( 0 === siblingsChecked.length ) {
				e.preventDefault();
				e.stopPropagation();

				trackAndBumpMCStats( 'attempted_no_post_types', args.tracksEventData );
			}
		} );

		widget.on( 'change', '.jetpack-search-filters-widget__post-types-select input[type="checkbox"]', function() {
			var t = $( this );
			var eventArgs = {
				is_customizer: args.tracksEventData.is_customizer,
				post_type:  t.val()
			};

			if ( wp && wp.customize ) {
				wp.customize.state( 'saved' ).set( false );
			}

			if ( t.is( ':checked' ) ) {
				trackAndBumpMCStats( 'added_post_type', eventArgs );
			} else {
				trackAndBumpMCStats( 'removed_post_type', eventArgs );
			}
		} );

		widget.on( 'change', '.jetpack-search-filters-widget__sort-order', function() {
			var eventArgs = {
				is_customizer: args.tracksEventData.is_customizer
			};

			eventArgs.order = $( this ).val();

			if ( wp && wp.customize ) {
				wp.customize.state( 'saved' ).set( false );
			}

			trackAndBumpMCStats( 'changed_sort_order', eventArgs );
		} );

		widget.on( 'change', '.jetpack-search-filters-widget__taxonomy-select select', function() {
			var eventArgs = {
				is_customizer: args.tracksEventData.is_customizer
			};

			eventArgs.taxonomy = $( this ).val();

			generateFilterTitlePlaceholder( getContainer( this ) );

			if ( wp && wp.customize ) {
				wp.customize.state( 'saved' ).set( false );
			}

			trackAndBumpMCStats( 'changed_taxonomy', eventArgs );
		} );

		widget.on( 'change', 'select.date-field-select', function() {
			var eventArgs = {
				is_customizer: args.tracksEventData.is_customizer
			};

			eventArgs.field = $( this ).val();

			generateFilterTitlePlaceholder( getContainer( this ) );

			if ( wp && wp.customize ) {
				wp.customize.state( 'saved' ).set( false );
			}

			trackAndBumpMCStats( 'changed_date_field', eventArgs );
		} );

		widget.on( 'change', 'select.date-interval-select', function() {
			var eventArgs = {
				is_customizer: args.tracksEventData.is_customizer
			};

			eventArgs.interval = $( this ).val();

			generateFilterTitlePlaceholder( getContainer( this ) );

			if ( wp && wp.customize ) {
				wp.customize.state( 'saved' ).set( false );
			}

			trackAndBumpMCStats( 'changed_date_interval', eventArgs );
		} );

		widget.on( 'change', 'input.filter-count', function() {
			var eventArgs = {
				is_customizer: args.tracksEventData.is_customizer
			};

			eventArgs.count = $( this ).val();

			if ( wp && wp.customize ) {
				wp.customize.state( 'saved' ).set( false );
			}

			trackAndBumpMCStats( 'changed_filter_count', eventArgs );
		} );

		// add filter button
		widget.on( 'click', '.jetpack-search-filters-widget__add-filter', function( e ) {
			e.preventDefault();

			var filtersContainer = $( this )
				.closest( '.jetpack-search-filters-widget' )
				.find( '.jetpack-search-filters-widget__filters' );

			addFilter( filtersContainer, {
				type: 'taxonomy',
				taxonomy: '',
				post_type: '',
				field: '',
				interval: '',
				count: defaultFilterCount,
				name_placeholder: '',
				name: ''
			} );

			if ( wp && wp.customize ) {
				wp.customize.state( 'saved' ).set( false );
			}

			// Trigger change event to let legacy widget admin know the widget state is "dirty"
			filtersContainer
				.find( '.jetpack-search-filters-widget__filter' )
				.find( 'input, textarea, select' )
				.change();

			trackAndBumpMCStats( 'added_filter', args.tracksEventData );
		} );

		widget.on( 'click', '.jetpack-search-filters-widget__controls .delete', function( e ) {
			e.preventDefault();
			var filter = $( this ).closest( '.jetpack-search-filters-widget__filter' ),
				eventArgs = {
					is_customizer: args.tracksEventData.is_customizer
				};

			eventArgs.type = filter.find( '.filter-select' ).val();

			switch ( eventArgs.type ) {
				case 'taxonomy':
					eventArgs.taxonomy = filter.find( '.jetpack-search-filters-widget__taxonomy-select select' ).val();
					break;
				case 'date_histogram':
					eventArgs.dateField = filter.find( '.jetpack-search-filters-widget__date-histogram-select:first select' ).val();
					eventArgs.dateInterval = filter.find( '.jetpack-search-filters-widget__date-histogram-select:nth-child( 2 ) select' ).val();
					break;
			}

			eventArgs.filterCount = filter.find( '.filter-count' ).val();

			trackAndBumpMCStats( 'deleted_filter', eventArgs );

			filter.find( 'input, textarea, select' ).change();
			filter.remove();

			if ( wp && wp.customize ) {
				wp.customize.state( 'saved' ).set( false );
			}
		} );

		// make the filters sortable
		$( '.jetpack-search-filters-widget__filters' ).sortable( {
			placeholder: 'jetpack-search-filters-widget__filter-placeholder',
			axis: 'y',
			revert: true,
			cancel: 'input,textarea,button,select,option,.jetpack-search-filters-widget__controls a',
			change: function() {
				if ( wp && wp.customize ) {
					wp.customize.state( 'saved' ).set( false );
				}
			},
			update: function( e, ui ) {
				$( ui.item ).find( 'input, textarea, select' ).change();
			}
		} )
		.disableSelection();
	};

	// When widgets are updated, remove and re-add listeners
	$( document ).on( 'widget-updated widget-added', function( e, widget ) {
		var idBase = $( widget ).find('.id_base').val(),
			isJetpackSearch = ( idBase && ( 'jetpack-search-filters' === idBase ) );

		if ( ! isJetpackSearch ) {
			 return;
		}

		// Intentionally not tracking widget additions and updates here as these events
		// seem noisy in the customizer. We'll track those via PHP.

		widget.off( 'change', '.filter-select' );
		widget.off( 'click', '.jetpack-search-filters-widget__controls .delete' );
		widget.off( 'change', '.jetpack-search-filters-widget__use-filters' );
		widget.off( 'change', '.jetpack-search-filters-widget__search-box-enabled' );
		widget.off( 'change', '.jetpack-search-filters-widget__sort-controls-enabled' );
		widget.off( 'change', '.jetpack-search-filters-widget__sort-controls-enabled' );
		widget.off( 'change', '.jetpack-search-filters-widget__post-type-selector' );
		widget.off( 'change', '.jetpack-search-filters-widget__sort-order' );
		widget.off( 'change', '.jetpack-search-filters-widget__taxonomy-select' );
		widget.off( 'change', '.jetpack-search-filters-widget__date-histogram-select:first select' );
		widget.off( 'change', '.jetpack-search-filters-widget__date-histogram-select:eq(1) select' );
		widget.off( 'click', '.jetpack-search-filters-widget__post-types-select input[type="checkbox"]' );
		widget.off( 'click', '.jetpack-search-filters-widget__add-filter');

		setListeners( widget );
	} );

	/**
	 * This function will fire both a Tracks and MC stat.
	 *
	 * Tracks: Will be prefixed by 'jetpack_widget_search_' and use underscores.
	 * MC: Will not be prefixed, and will use dashes.
	 *
	 * Logic borrowed from `idc-notice.js`.
	 *
	 * @param eventName string
	 * @param extraProps object
	 */
	function trackAndBumpMCStats( eventName, extraProps ) {
		if ( 'undefined' === typeof extraProps || 'object' !== typeof extraProps ) {
			extraProps = {};
		}

		if ( eventName && eventName.length && 'undefined' !== typeof analytics && analytics.tracks && analytics.mc ) {
			// Format for Tracks
			eventName = eventName.replace( /-/g, '_' );
			eventName = eventName.indexOf( 'jetpack_widget_search_' ) !== 0 ? 'jetpack_widget_search_' + eventName : eventName;
			analytics.tracks.recordEvent( eventName, extraProps );

			// Now format for MC stats
			eventName = eventName.replace( 'jetpack_widget_search_', '' );
			eventName = eventName.replace( /_/g, '-' );
			analytics.mc.bumpStat( 'jetpack-search-widget', eventName );
		}
	}
} )( jQuery, jetpack_search_filter_admin );
search-widget.js                                                                                                                                                                                                                                               1488          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/widgets/js                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         var jetpackSearchModule = function () {
	var i,
		j,
		checkboxes,
		filter_list = document.querySelectorAll( '.jetpack-search-filters-widget__filter-list' );

	for ( i = 0; i < filter_list.length; i++ ) {
		filter_list[ i ].addEventListener( 'click', function ( event ) {
			var target = event.target;
			var precedingCheckbox;
			var nextAnchor;

			// If the target is an anchor, we want to toggle the checkbox.
			if ( target.nodeName && 'a' === target.nodeName.toLowerCase() ) {
				precedingCheckbox = target.previousElementSibling;
				if (
					precedingCheckbox &&
					precedingCheckbox.type &&
					'checkbox' === precedingCheckbox.type
				) {
					precedingCheckbox.checked = ! precedingCheckbox.checked;
				}
			}

			// If the target is a checkbox, we want to navigate.
			if ( target.type && 'checkbox' === target.type ) {
				nextAnchor = target.nextElementSibling;
				if ( nextAnchor && 'a' === nextAnchor.nodeName.toLowerCase() ) {
					window.location.href = nextAnchor.getAttribute( 'href' );
				}
			}
		} );

		// Enable checkboxes now that we're setup.
		checkboxes = filter_list[ i ].querySelectorAll( 'input[type="checkbox"]' );
		for ( j = 0; j < checkboxes.length; j++ ) {
			checkboxes[ j ].disabled = false;
			checkboxes[ j ].style.cursor = 'inherit';
		}
	}
};

if ( document.readyState === 'interactive' || document.readyState === 'complete' ) {
	jetpackSearchModule();
} else {
	document.addEventListener( 'DOMContentLoaded', jetpackSearchModule );
}
class-query-builder.php                                                                                                                                                                                                                                        9932          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/wpes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <?php
/**
 * Provides an interface for easily building a complex search query that
 * combines multiple ranking signals.
 *
 * $bldr = new Query_Builder();
 * $bldr->add_filter( ... );
 * $bldr->add_filter( ... );
 * $bldr->add_query( ... );
 * $es_query = $bldr->build_query();
 *
 *
 * All ES queries take a standard form with main query (with some filters),
 *  wrapped in a function_score
 *
 * Most functions are chainable, e.g. $bldr->add_filter( ... )->add_query( ... )->build_query();
 *
 * Bucketed queries use an aggregation to diversify results. eg a bunch
 *  of separate filters where to get different sets of results.
 *
 * @package    automattic/jetpack-search
 */

// Disables comment checks.
// phpcs:disable Squiz.Commenting

namespace Automattic\Jetpack\Search\WPES;

/**
 * Query builder class.
 */
class Query_Builder {
	/**
	 * ElasticSerach filters.
	 *
	 * @var array
	 */
	protected $es_filters = array();

	//
	// Variables for handling custom boosting with function_score.
	//
	protected $functions            = array();
	protected $weighting_functions  = array();
	protected $decays               = array();
	protected $scripts              = array();
	protected $functions_max_boost  = 2.0;
	protected $functions_score_mode = 'multiply';
	protected $functions_boost_mode = 'multiply';
	protected $query_bool_boost     = null;

	//
	// General aggregations for buckets and metrics.
	//
	protected $aggs_query = false;
	protected $aggs       = array();

	//
	// The set of top level text queries to combine.
	//
	protected $must_queries    = array();
	protected $should_queries  = array();
	protected $dis_max_queries = array();

	protected $diverse_buckets_query = false;
	protected $bucket_filters        = array();
	protected $bucket_sub_aggs       = array();

	public function get_langs() {
		if ( isset( $this->langs ) ) {
			return $this->langs;
		}
		return false;
	}

	//
	// Methods for building a query.
	//
	public function add_filter( $filter ) {
		$this->es_filters[] = $filter;

		return $this;
	}

	public function add_query( $query, $type = 'must' ) {
		switch ( $type ) {
			case 'dis_max':
				$this->dis_max_queries[] = $query;
				break;

			case 'should':
				$this->should_queries[] = $query;
				break;

			case 'must':
			default:
				$this->must_queries[] = $query;
				break;
		}

		return $this;
	}

	/**
	 * Add any weighting function to the query
	 *
	 * @see https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html
	 *
	 * @param $function array A function structure to apply to the query
	 *
	 * @return void
	 */
	public function add_weighting_function( $function ) {
		// check for danger.
		if ( isset( $function['random_score'] ) ) {
			return $this;
		}
		if ( isset( $function['script_score'] ) ) {
			return $this;
		}

		$this->weighting_functions[] = $function;

		return $this;
	}

	/**
	 * Add a scoring function to the query
	 *
	 * NOTE: For decays (linear, exp, or gauss), use Query_Builder::add_decay() instead
	 *
	 * @see https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html
	 *
	 * @param $function string name of the function
	 * @param $params array functions parameters
	 *
	 * @return void
	 */
	public function add_function( $function, $params ) {
		$this->functions[ $function ][] = $params;

		return $this;
	}

	/**
	 * Add a decay function to score results
	 *
	 * This method should be used instead of Query_Builder::add_function() for decays, as the internal  ES structure
	 * is slightly different for them.
	 *
	 * @see https://www.elastic.co/guide/en/elasticsearch/guide/current/decay-functions.html
	 *
	 * @param $function string name of the decay function - linear, exp, or gauss
	 * @param $params array The decay functions parameters, passed to ES directly
	 *
	 * @return void
	 */
	public function add_decay( $function, $params ) {
		$this->decays[ $function ][] = $params;

		return $this;
	}

	/**
	 * Add a scoring mode to the query
	 *
	 * @see https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html
	 *
	 * @param $mode string name of how to score
	 *
	 * @return void
	 */
	public function add_score_mode_to_functions( $mode = 'multiply' ) {
		$this->functions_score_mode = $mode;

		return $this;
	}

	public function add_boost_mode_to_functions( $mode = 'multiply' ) {
		$this->functions_boost_mode = $mode;

		return $this;
	}

	public function add_max_boost_to_functions( $boost ) {
		$this->functions_max_boost = $boost;

		return $this;
	}

	public function add_boost_to_query_bool( $boost ) {
		$this->query_bool_boost = $boost;

		return $this;
	}

	public function add_aggs( $aggs_name, $aggs ) {
		$this->aggs_query         = true;
		$this->aggs[ $aggs_name ] = $aggs;

		return $this;
	}

	public function set_all_aggs( $aggs ) {
		$this->aggs_query = true;
		$this->aggs       = $aggs;

		return $this;
	}

	public function add_aggs_sub_aggs( $aggs_name, $sub_aggs ) {
		if ( ! array_key_exists( 'aggs', $this->aggs[ $aggs_name ] ) ) {
			$this->aggs[ $aggs_name ]['aggs'] = array();
		}
		$this->aggs[ $aggs_name ]['aggs'] = $sub_aggs;

		return $this;
	}

	public function add_bucketed_query( $name, $query ) {
		$this->add_bucket_filter( $name, $query );

		$this->add_query( $query, 'dis_max' );

		return $this;
	}

	public function add_bucketed_terms( $name, $field, $terms, $boost = 1 ) {
		if ( ! is_array( $terms ) ) {
			$terms = array( $terms );
		}

		$this->add_bucket_filter(
			$name,
			array(
				'terms' => array(
					$field => $terms,
				),
			)
		);

		$this->add_query(
			array(
				'constant_score' => array(
					'filter' => array(
						'terms' => array(
							$field => $terms,
						),
					),
					'boost'  => $boost,
				),
			),
			'dis_max'
		);

		return $this;
	}

	public function add_bucket_sub_aggs( $agg ) {
		$this->bucket_sub_aggs = array_merge( $this->bucket_sub_aggs, $agg );

		return $this;
	}

	protected function add_bucket_filter( $name, $filter ) {
		$this->diverse_buckets_query   = true;
		$this->bucket_filters[ $name ] = $filter;
	}

	////////////////////////////////////
	// Building Final Query

	/**
	 * Combine all the queries, functions, decays, scripts, and max_boost into an ES query
	 *
	 * @return array Array representation of the built ES query
	 */
	public function build_query() {
		$query = array();

		//dis_max queries just become a single must query
		if ( ! empty( $this->dis_max_queries ) ) {
			$this->must_queries[] = array(
				'dis_max' => array(
					'queries' => $this->dis_max_queries,
				),
			);
		}

		if ( empty( $this->must_queries ) ) {
			$this->must_queries = array(
				array(
					'match_all' => array(),
				),
			);
		}

		if ( empty( $this->should_queries ) ) {
			$query = array(
				'bool' => array(
					'must' => $this->must_queries,
				),
			);
		} else {
			$query = array(
				'bool' => array(
					'must'   => $this->must_queries,
					'should' => $this->should_queries,
				),
			);
		}

		if ( $this->query_bool_boost !== null && isset( $query['bool'] ) ) {
			$query['bool']['boost'] = $this->query_bool_boost;
		}

		// If there are any function score adjustments, then combine those
		if ( $this->functions || $this->decays || $this->scripts || $this->weighting_functions ) {
			$weighting_functions = $this->weighting_functions;

			if ( $this->functions ) {
				foreach ( $this->functions as $function_type => $configs ) {
					foreach ( $configs as $config ) {
						foreach ( $config as $field => $params ) {
							$func_arr = $params;

							$func_arr['field'] = $field;

							$weighting_functions[] = array(
								$function_type => $func_arr,
							);
						}
					}
				}
			}

			if ( $this->decays ) {
				foreach ( $this->decays as $decay_type => $configs ) {
					foreach ( $configs as $config ) {
						foreach ( $config as $field => $params ) {
							$weighting_functions[] = array(
								$decay_type => array(
									$field => $params,
								),
							);
						}
					}
				}
			}

			if ( $this->scripts ) {
				foreach ( $this->scripts as $script ) {
					$weighting_functions[] = array(
						'script_score' => array(
							'script' => $script,
						),
					);
				}
			}

			$query = array(
				'function_score' => array(
					'query'      => $query,
					'functions'  => $weighting_functions,
					'max_boost'  => $this->functions_max_boost,
					'score_mode' => $this->functions_score_mode,
					'boost_mode' => $this->functions_boost_mode,
				),
			);
		}

		return $query;
	}

	/**
	 * Assemble the 'filter' portion of an ES query, from all registered filters
	 *
	 * @return array|null Combined ES filters, or null if none have been defined
	 */
	public function build_filter() {
		if ( empty( $this->es_filters ) ) {
			$filter = null;
		} elseif ( 1 === count( $this->es_filters ) ) {
			$filter = $this->es_filters[0];
		} else {
			$filter = array(
				'and' => $this->es_filters,
			);
		}

		return $filter;
	}

	/**
	 * Assemble the 'aggregation' portion of an ES query, from all general aggregations.
	 *
	 * @return array An aggregation query as an array of topics, filters, and bucket names
	 */
	public function build_aggregation() {
		if ( empty( $this->bucket_sub_aggs ) && empty( $this->aggs_query ) ) {
			return array();
		}

		if ( ! $this->diverse_buckets_query && empty( $this->aggs_query ) ) {
			return $this->bucket_sub_aggs;
		}

		$aggregations = array(
			'topics' => array(
				'filters' => array(
					'filters' => array(),
				),
			),
		);

		if ( ! empty( $this->bucket_sub_aggs ) ) {
			$aggregations['topics']['aggs'] = $this->bucket_sub_aggs;
		}

		foreach ( $this->bucket_filters as $bucket_name => $filter ) {
			$aggregations['topics']['filters']['filters'][ $bucket_name ] = $filter;
		}

		if ( ! empty( $this->aggs_query ) ) {
			$aggregations = $this->aggs;
		}

		return $aggregations;
	}
}
class-query-parser.php                                                                                                                                                                                                                                         18930         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-search/src/wpes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <?php
/**
 * Parse a pure text query into WordPress Elasticsearch query. This builds on
 * the Query_Builder() to provide search query parsing.
 *
 * The key part of this parser is taking a user's query string typed into a box
 * and converting it into an ES search query.
 *
 * This varies by application, but roughly it means extracting some parts of the query
 * (authors, tags, and phrases) that are treated as a filter. Then taking the
 * remaining words and building the correct query (possibly with prefix searching
 * if we are doing search as you type)
 *
 * This class only supports ES 2.x+
 *
 * Disables comment chehcks.
 * phpcs:disable Squiz.Commenting
 *
 * This parser builds queries of the form:
 *   bool:
 *     must:
 *       AND match of a single field (ideally an edgengram field)
 *     filter:
 *       filter clauses from context (eg @gibrown, #news, etc)
 *     should:
 *       boosting of results by various fields
 *
 * Features supported:
 *  - search as you type
 *  - phrases
 *  - supports querying across multiple languages at once
 *
 * @package    automattic/jetpack-search
 */

namespace Automattic\Jetpack\Search\WPES;

/**
 * Query parser class.
 */
class Query_Parser extends Query_Builder {
	protected $orig_query    = '';
	protected $current_query = '';
	protected $langs;
	protected $avail_langs = array( 'ar', 'bg', 'ca', 'cs', 'da', 'de', 'el', 'en', 'es', 'eu', 'fa', 'fi', 'fr', 'he', 'hi', 'hu', 'hy', 'id', 'it', 'ja', 'ko', 'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr', 'zh' );

	public function __construct( $user_query, $langs ) {
		$this->orig_query    = $user_query;
		$this->current_query = $this->orig_query;
		$this->langs         = $this->norm_langs( $langs );
	}

	protected $extracted_phrases = array();

	public function get_current_query() {
		return $this->current_query;
	}

	public function set_current_query( $q ) {
		$this->current_query = $q;
	}

	///////////////////////////////////////////////////////
	// Methods for Building arrays of multilingual fields

	/*
	 * Normalize language codes
	 */
	public function norm_langs( $langs ) {
		$lst = array();
		foreach ( $langs as $l ) {
			$l = strtok( $l, '-_' );
			if ( in_array( $l, $this->avail_langs, true ) ) {
				$lst[ $l ] = true;
			} else {
				$lst['default'] = true;
			}
		}
		return array_keys( $lst );
	}

	public function get_lang_field_suffix() {
		if ( ! is_array( $this->langs ) || empty( $this->langs ) ) {
			return;
		}

		// Returns the first language only
		return $this->langs[0];
	}

	/*
	 * Take a list of field prefixes and expand them for multi-lingual
	 * with the provided boostings.
	 */
	public function merge_ml_fields( $fields2boosts, $additional_fields ) {
		$flds = array();
		foreach ( $fields2boosts as $f => $b ) {
			foreach ( $this->langs as $l ) {
				$flds[] = $f . '.' . $l . '^' . $b;
			}
		}
		foreach ( $additional_fields as $f ) {
			$flds[] = $f;
		}
		return $flds;
	}

	////////////////////////////////////
	// Extract Fields for Filtering on

	/*
	 * Extract any @mentions from the user query
	 *  use them as a filter if we can find a wp.com id
	 *  otherwise use them as a
	 *
	 *  args:
	 *    wpcom_id_field: wp.com id field
	 *    must_query_fields: array of fields to search for matching results (optional)
	 *    boost_query_fields: array of fields to search in for boosting results (optional)
	 *    prefixes: array of prefixes that the user can use to indicate an author
	 *
	 *  returns true/false of whether any were found
	 *
	 * See also: https://github.com/twitter/twitter-text/blob/master/java/src/com/twitter/Regex.java
	 */
	public function author_field_filter( $args ) {
		$defaults = array(
			'wpcom_id_field'     => 'author_id',
			'must_query_fields'  => null,
			'boost_query_fields' => null,
			'prefixes'           => array( '@' ),
		);
		$args     = wp_parse_args( $args, $defaults );

		$names = array();
		foreach ( $args['prefixes'] as $p ) {
			$found = $this->get_fields( $p );
			if ( $found ) {
				foreach ( $found as $f ) {
					$names[] = $f;
				}
			}
		}

		if ( empty( $names ) ) {
			return false;
		}

		foreach ( $args['prefixes'] as $p ) {
			$this->remove_fields( $p );
		}

		$user_ids = array();

		//loop through the matches and separate into filters and queries
		foreach ( $names as $n ) {
			//check for exact match on login
			$userdata  = get_user_by( 'login', strtolower( $n ) );
			$filtering = false;
			if ( $userdata ) {
				$user_ids[ $userdata->ID ] = true;
				$filtering                 = true;
			}

			$is_phrase = false;
			if ( preg_match( '/"/', $n ) ) {
				$is_phrase = true;
				$n         = preg_replace( '/"/', '', $n );
			}

			if ( ! empty( $args['must_query_fields'] ) && ! $filtering ) {
				if ( $is_phrase ) {
					$this->add_query(
						array(
							'multi_match' => array(
								'fields' => $args['must_query_fields'],
								'query'  => $n,
								'type'   => 'phrase',
							),
						)
					);
				} else {
					$this->add_query(
						array(
							'multi_match' => array(
								'fields' => $args['must_query_fields'],
								'query'  => $n,
							),
						)
					);
				}
			}

			if ( ! empty( $args['boost_query_fields'] ) ) {
				if ( $is_phrase ) {
					$this->add_query(
						array(
							'multi_match' => array(
								'fields' => $args['boost_query_fields'],
								'query'  => $n,
								'type'   => 'phrase',
							),
						),
						'should'
					);
				} else {
					$this->add_query(
						array(
							'multi_match' => array(
								'fields' => $args['boost_query_fields'],
								'query'  => $n,
							),
						),
						'should'
					);
				}
			}
		}

		if ( ! empty( $user_ids ) ) {
			$user_ids = array_keys( $user_ids );
			$this->add_filter( array( 'terms' => array( $args['wpcom_id_field'] => $user_ids ) ) );
		}

		return true;
	}

	/*
	 * Extract any prefix followed by text use them as a must clause,
	 *   and optionally as a boost to the should query
	 *   This can be used for hashtags. eg #News, or #"current events",
	 *   but also works for any arbitrary field. eg from:Greg
	 *
	 *  args:
	 *    must_query_fields: array of fields that must match the tag (optional)
	 *    boost_query_fields: array of fields to boost search on (optional)
	 *    prefixes: array of prefixes that the user can use to indicate a tag
	 *
	 *  returns true/false of whether any were found
	 *
	 */
	public function text_field_filter( $args ) {
		$defaults = array(
			'must_query_fields'  => array( 'tag.name' ),
			'boost_query_fields' => array( 'tag.name' ),
			'prefixes'           => array( '#' ),
		);
		$args     = wp_parse_args( $args, $defaults );

		$tags = array();
		foreach ( $args['prefixes'] as $p ) {
			$found = $this->get_fields( $p );
			if ( $found ) {
				foreach ( $found as $f ) {
					$tags[] = $f;
				}
			}
		}

		if ( empty( $tags ) ) {
			return false;
		}

		foreach ( $args['prefixes'] as $p ) {
			$this->remove_fields( $p );
		}

		foreach ( $tags as $t ) {
			$is_phrase = false;
			if ( preg_match( '/"/', $t ) ) {
				$is_phrase = true;
				$t         = preg_replace( '/"/', '', $t );
			}

			if ( ! empty( $args['must_query_fields'] ) ) {
				if ( $is_phrase ) {
					$this->add_query(
						array(
							'multi_match' => array(
								'fields' => $args['must_query_fields'],
								'query'  => $t,
								'type'   => 'phrase',
							),
						)
					);
				} else {
					$this->add_query(
						array(
							'multi_match' => array(
								'fields' => $args['must_query_fields'],
								'query'  => $t,
							),
						)
					);
				}
			}

			if ( ! empty( $args['boost_query_fields'] ) ) {
				if ( $is_phrase ) {
					$this->add_query(
						array(
							'multi_match' => array(
								'fields' => $args['boost_query_fields'],
								'query'  => $t,
								'type'   => 'phrase',
							),
						),
						'should'
					);
				} else {
					$this->add_query(
						array(
							'multi_match' => array(
								'fields' => $args['boost_query_fields'],
								'query'  => $t,
							),
						),
						'should'
					);
				}
			}
		}

		return true;
	}

	/*
	 * Extract anything surrounded by quotes or if there is an opening quote
	 *   that is not complete, and add them to the query as a phrase query.
	 *   Quotes can be either '' or ""
	 *
	 *  args:
	 *    must_query_fields: array of fields that must match the phrases
	 *    boost_query_fields: array of fields to boost the phrases on (optional)
	 *
	 *  returns true/false of whether any were found
	 *
	 */
	public function phrase_filter( $args ) {
		$defaults = array(
			'must_query_fields'  => array( 'all_content' ),
			'boost_query_fields' => array( 'title' ),
		);
		$args     = wp_parse_args( $args, $defaults );

		$phrases = array();
		if ( preg_match_all( '/"([^"]+)"/', $this->current_query, $matches ) ) {
			foreach ( $matches[1] as $match ) {
				$phrases[] = $match;
			}
			$this->current_query = preg_replace( '/"([^"]+)"/', '', $this->current_query );
		}

		if ( preg_match_all( "/'([^']+)'/", $this->current_query, $matches ) ) {
			foreach ( $matches[1] as $match ) {
				$phrases[] = $match;
			}
			$this->current_query = preg_replace( "/'([^']+)'/", '', $this->current_query );
		}

		//look for a final, uncompleted phrase
		$phrase_prefix = false;
		if ( preg_match_all( '/"([^"]+)$/', $this->current_query, $matches ) ) {
			$phrase_prefix       = $matches[1][0];
			$this->current_query = preg_replace( '/"([^"]+)$/', '', $this->current_query );
		}
		if ( preg_match_all( "/(?:'\B|\B')([^']+)$/", $this->current_query, $matches ) ) {
			$phrase_prefix       = $matches[1][0];
			$this->current_query = preg_replace( "/(?:'\B|\B')([^']+)$/", '', $this->current_query );
		}

		if ( $phrase_prefix ) {
			$phrases[] = $phrase_prefix;
		}
		if ( empty( $phrases ) ) {
			return false;
		}

		foreach ( $phrases as $p ) {
			$this->add_query(
				array(
					'multi_match' => array(
						'fields' => $args['must_query_fields'],
						'query'  => $p,
						'type'   => 'phrase',
					),
				)
			);

			if ( ! empty( $args['boost_query_fields'] ) ) {
				$this->add_query(
					array(
						'multi_match' => array(
							'fields'   => $args['boost_query_fields'],
							'query'    => $p,
							'operator' => 'and',
						),
					),
					'should'
				);
			}
		}

		return true;
	}

	/*
	 * Query fields based on the remaining parts of the query
	 *   This could be the final AND part of the query terms to match, or it
	 *   could be boosting certain elements of the query
	 *
	 *  args:
	 *    must_query_fields: array of fields that must match the remaining terms (optional)
	 *    boost_query_fields: array of fields to boost the remaining terms on (optional)
	 *
	 */
	public function remaining_query( $args ) {
		$defaults = array(
			'must_query_fields'  => null,
			'boost_query_fields' => null,
			'boost_operator'     => 'and',
			'boost_query_type'   => 'best_fields',
		);
		$args     = wp_parse_args( $args, $defaults );

		if ( empty( $this->current_query ) || ctype_space( $this->current_query ) ) {
			return;
		}

		if ( ! empty( $args['must_query_fields'] ) ) {
			$this->add_query(
				array(
					'multi_match' => array(
						'fields'   => $args['must_query_fields'],
						'query'    => $this->current_query,
						'operator' => 'and',
					),
				)
			);
		}

		if ( ! empty( $args['boost_query_fields'] ) ) {
			$this->add_query(
				array(
					'multi_match' => array(
						'fields'   => $args['boost_query_fields'],
						'query'    => $this->current_query,
						'operator' => $args['boost_operator'],
						'type'     => $args['boost_query_type'],
					),
				),
				'should'
			);
		}
	}

	/*
	 * Query fields using a prefix query (alphabetical expansions on the index).
	 *   This is not recommended. Slower performance and worse relevancy.
	 *
	 *  (UNTESTED! Copied from old prefix expansion code)
	 *
	 *  args:
	 *    must_query_fields: array of fields that must match the remaining terms (optional)
	 *    boost_query_fields: array of fields to boost the remaining terms on (optional)
	 *
	 */
	public function remaining_prefix_query( $args ) {
		$defaults = array(
			'must_query_fields'  => array( 'all_content' ),
			'boost_query_fields' => array( 'title' ),
			'boost_operator'     => 'and',
			'boost_query_type'   => 'best_fields',
		);
		$args     = wp_parse_args( $args, $defaults );

		if ( empty( $this->current_query ) || ctype_space( $this->current_query ) ) {
			return;
		}

		//////////////////////////////////
		// Example cases to think about:
		// "elasticse"
		// "elasticsearch"
		// "elasticsearch "
		// "elasticsearch lucen"
		// "elasticsearch lucene"
		// "the future"  - note the stopword which will match nothing!
		// "F1" - an exact match that also has tons of expansions
		// "" ja "hello"
		// "" ja "hello friend" - we just rely on the prefix phrase and ES to split words
		//   - this could still be better I bet. Maybe we need to analyze with ES first?
		//

		/////////////////////////////
		//extract pieces of query
		// eg: "PREFIXREMAINDER PREFIXWORD"
		//     "elasticsearch lucen"

		$prefix_word      = false;
		$prefix_remainder = false;
		if ( preg_match_all( '/([^ ]+)$/', $this->current_query, $matches ) ) {
			$prefix_word = $matches[1][0];
		}

		$prefix_remainder = preg_replace( '/([^ ]+)$/', '', $this->current_query );
		if ( ctype_space( $prefix_remainder ) ) {
			$prefix_remainder = false;
		}

		if ( ! $prefix_word ) {
			//Space at the end of the query, so skip using a prefix query
			if ( ! empty( $args['must_query_fields'] ) ) {
				$this->add_query(
					array(
						'multi_match' => array(
							'fields'   => $args['must_query_fields'],
							'query'    => $this->current_query,
							'operator' => 'and',
						),
					)
				);
			}

			if ( ! empty( $args['boost_query_fields'] ) ) {
				$this->add_query(
					array(
						'multi_match' => array(
							'fields'   => $args['boost_query_fields'],
							'query'    => $this->current_query,
							'operator' => $args['boost_operator'],
							'type'     => $args['boost_query_type'],
						),
					),
					'should'
				);
			}
		} else {

			//must match the prefix word and the prefix remainder
			if ( ! empty( $args['must_query_fields'] ) ) {
				//need to do an OR across a few fields to handle all cases
				$must_q = array(
					'bool' => array(
						'should'               => array(),
						'minimum_should_match' => 1,
					),
				);

				//treat all words as an exact search (boosts complete word like "news"
				//from prefixes of "newspaper")
				$must_q['bool']['should'][] = array(
					'multi_match' => array(
						'fields'   => $this->all_fields,
						// NOTE: This line has been disabled since $full_text is not available.
						// 'query'    => $full_text,
						'operator' => 'and',
						'type'     => 'cross_fields',
					),
				);

				//always optimistically try and match the full text as a phrase
				//prefix "the futu" should try to match "the future"
				//otherwise the first stopword kinda breaks
				//This also works as the prefix match for a single word "elasticsea"
				$must_q['bool']['should'][] = array(
					'multi_match' => array(
						'fields'         => $this->phrase_fields,
						// NOTE: This line has been disabled since $full_text is not available.
						// 'query'          => $full_text,
						'operator'       => 'and',
						'type'           => 'phrase_prefix',
						'max_expansions' => 100,
					),
				);

				if ( $prefix_remainder ) {
					//Multiple words found, so treat each word on its own and not just as
					//a part of a phrase
					//"elasticsearch lucen" => "elasticsearch" exact AND "lucen" prefix
					$must_q['bool']['should'][] = array(
						'bool' => array(
							'must' => array(
								array(
									'multi_match' => array(
										'fields'         => $this->phrase_fields,
										'query'          => $prefix_word,
										'operator'       => 'and',
										'type'           => 'phrase_prefix',
										'max_expansions' => 100,
									),
								),
								array(
									'multi_match' => array(
										'fields'   => $this->all_fields,
										'query'    => $prefix_remainder,
										'operator' => 'and',
										'type'     => 'cross_fields',
									),
								),
							),
						),
					);
				}

				$this->add_query( $must_q );
			}

			//Now add any boosting of the query
			if ( ! empty( $args['boost_query_fields'] ) ) {
				//treat all words as an exact search (boosts complete word like "news"
				//from prefixes of "newspaper")
				$this->add_query(
					array(
						'multi_match' => array(
							'fields'   => $args['boost_query_fields'],
							'query'    => $this->current_query,
							'operator' => $args['boost_query_operator'],
							'type'     => $args['boost_query_type'],
						),
					),
					'should'
				);

				//optimistically boost the full phrase prefix match
				$this->add_query(
					array(
						'multi_match' => array(
							'fields'         => $args['boost_query_fields'],
							'query'          => $this->current_query,
							'operator'       => 'and',
							'type'           => 'phrase_prefix',
							'max_expansions' => 100,
						),
					)
				);
			}
		}
	}

	/*
	 * Boost results based on the lang probability overlaps
	 *
	 *  args:
	 *    langs2prob: list of languages to search in with associated boosts
	 */
	public function boost_lang_probs( $langs2prob ) {
		foreach ( $langs2prob as $p ) {
			$this->add_function(
				'field_value_factor',
				array(
					'modifier' => 'none',
					'factor'   => $p,
					'missing'  => 0.01, //1% chance doc did not have right lang detected
				)
			);
		}
	}

	////////////////////////////////////
	// Helper Methods

	//Get the text after some prefix. eg @gibrown, or @"Greg Brown"
	protected function get_fields( $field_prefix ) {
		$regex = '/' . $field_prefix . '(("[^"]+")|([^\\p{Z}]+))/';
		if ( preg_match_all( $regex, $this->current_query, $match ) ) {
			return $match[1];
		}
		return false;
	}

	//Remove the prefix and text from the query
	protected function remove_fields( $field_name ) {
		$regex               = '/' . $field_name . '(("[^"]+")|([^\\p{Z}]+))/';
		$this->current_query = preg_replace( $regex, '', $this->current_query );
	}

	//Best effort string truncation that splits on word breaks
	protected function truncate_string( $string, $limit, $break = ' ' ) {
		if ( mb_strwidth( $string ) <= $limit ) {
			return $string;
		}

		// walk backwards from $limit to find first break
		$breakpoint = $limit;
		$broken     = false;
		while ( $breakpoint > 0 ) {
			if ( mb_strimwidth( $string, $breakpoint, 1 ) === $break ) {
				$string = mb_strimwidth( $string, 0, $breakpoint );
				$broken = true;
				break;
			}
			--$breakpoint;
		}
		// if we weren't able to find a break, need to chop mid-word
		if ( ! $broken ) {
			$string = mb_strimwidth( $string, 0, $limit );
		}
		return $string;
	}
}
CHANGELOG.md                                                                                                                                                                                                                                                   5671          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-stats                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         # Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/)
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [0.11.0] - 2024-02-26
### Added
- Add new method to convert stats data for external consumption. [#35865]

## [0.10.1] - 2024-02-19
### Fixed
- Avoid Fatal errors when saved stats data is a WP_Error object [#35746]

## [0.10.0] - 2024-02-05
### Added
- Stats fetching mechanism: add filter allowing one to customize how long we cache results. [#35421]

### Changed
- Permit overriding cache when retrieving post views. [#34557]
- Remove pre-6.3 asset enqueuing method, and relying on WordPress Core method instead. [#34072]

### Removed
- Stop requiring the Jetpack Assets Composer package. [#34072]

## [0.9.0] - 2023-12-25
### Added
- Stats: added passing select UTM parameters to Tracking Pixel requests. [#34431]

## [0.8.0] - 2023-12-11
### Changed
- Permit overriding cache when retrieving top posts. [#34153]

## [0.7.2] - 2023-12-03
### Changed
- Internal updates.

## [0.7.1] - 2023-11-21

## [0.7.0] - 2023-11-20
### Changed
- Updated required PHP version to >= 7.0. [#34192]

## [0.6.6] - 2023-10-23
### Fixed
- Stats: Increase timeout to 20s. [#33549]

## [0.6.5] - 2023-08-28
### Changed
- Updated package dependencies. [#32605]

## [0.6.4] - 2023-08-09
### Added
- Stats: compatibility for AMP for WP plugin [#32328]

## [0.6.3] - 2023-05-15
### Changed
- PHP 8.1 compatibility updates [#30517]

## [0.6.2] - 2023-04-10
### Added
- Add Jetpack Autoloader package suggestion. [#29988]

## [0.6.1] - 2023-04-05
### Bug fixes
- Assets: avoid fatal error with outdated package versions. [#29947]

## [0.6.0] - 2023-04-04
### Changed
- Use core WordPress methods to add the Tracking pixel to the page, instead of printing the tracking pixel directly. [#29780]

### Deprecated
- Methods used to retrieve tracking pixels are now deprecated. No replacement needed, we now hook / enqueue the tracking pixels using core WP methods. [#29780]

## [0.5.2] - 2023-03-20
### Changed
- Updated package dependencies. [#29480]

## [0.5.1] - 2023-02-20
### Changed
- Minor internal updates.

## [0.5.0] - 2023-02-15
### Added
- Added new options to store the timestamp when Odyssey is enabled and disabled [#28794]
- Stats: Adds support for Notice control [#28857]

## [0.4.2] - 2023-02-08
### Changed
- Minor internal updates.

## [0.4.1] - 2023-01-11
### Changed
- Updated package dependencies.

## [0.4.0] - 2022-12-06
### Added
- Stats: added streak, highlights, insights for WPCOM_Stats [#27604]

### Changed
- Updated package dependencies. [#27688]

## [0.3.3] - 2022-11-28
### Changed
- Updated package dependencies. [#27043]

## [0.3.2] - 2022-11-07
### Changed
- Updated package dependencies. [#27278]

## [0.3.1] - 2022-10-25
### Changed
- Updated package dependencies. [#26705]

## [0.3.0] - 2022-10-19
### Changed
- Cache errors when fetching stats and reverted cache prefix. [#26922]

## [0.2.0] - 2022-10-13
### Changed
- Changed cache prefix [#26719]
- Updated readme for Stats package [#26759]

## 0.1.0 - 2022-10-11
### Added
- Stats: Add package scaffold [#26312]
- Stats package: Add 'jetpack.getBlog' XMLRPC endpoint [#26473]
- Stats package: Add entrypoint class for setting hooks and configuration. [#26601]
- Stats package: Introduce WPCOM_Stats class [#26530]
- Stats package: Manage Stats options [#26431]
- Stats Package: Tracking Pixel functionality [#26516]

### Changed
- Add mirror repo [#26750]

### Fixed
- Fixing static method which was called without self reference. [#26640]

[0.11.0]: https://github.com/Automattic/jetpack-stats/compare/v0.10.1...v0.11.0
[0.10.1]: https://github.com/Automattic/jetpack-stats/compare/v0.10.0...v0.10.1
[0.10.0]: https://github.com/Automattic/jetpack-stats/compare/v0.9.0...v0.10.0
[0.9.0]: https://github.com/Automattic/jetpack-stats/compare/v0.8.0...v0.9.0
[0.8.0]: https://github.com/Automattic/jetpack-stats/compare/v0.7.2...v0.8.0
[0.7.2]: https://github.com/Automattic/jetpack-stats/compare/v0.7.1...v0.7.2
[0.7.1]: https://github.com/Automattic/jetpack-stats/compare/v0.7.0...v0.7.1
[0.7.0]: https://github.com/Automattic/jetpack-stats/compare/v0.6.6...v0.7.0
[0.6.6]: https://github.com/Automattic/jetpack-stats/compare/v0.6.5...v0.6.6
[0.6.5]: https://github.com/Automattic/jetpack-stats/compare/v0.6.4...v0.6.5
[0.6.4]: https://github.com/Automattic/jetpack-stats/compare/v0.6.3...v0.6.4
[0.6.3]: https://github.com/Automattic/jetpack-stats/compare/v0.6.2...v0.6.3
[0.6.2]: https://github.com/Automattic/jetpack-stats/compare/v0.6.1...v0.6.2
[0.6.1]: https://github.com/Automattic/jetpack-stats/compare/v0.6.0...v0.6.1
[0.6.0]: https://github.com/Automattic/jetpack-stats/compare/v0.5.2...v0.6.0
[0.5.2]: https://github.com/Automattic/jetpack-stats/compare/v0.5.1...v0.5.2
[0.5.1]: https://github.com/Automattic/jetpack-stats/compare/v0.5.0...v0.5.1
[0.5.0]: https://github.com/Automattic/jetpack-stats/compare/v0.4.2...v0.5.0
[0.4.2]: https://github.com/Automattic/jetpack-stats/compare/v0.4.1...v0.4.2
[0.4.1]: https://github.com/Automattic/jetpack-stats/compare/v0.4.0...v0.4.1
[0.4.0]: https://github.com/Automattic/jetpack-stats/compare/v0.3.3...v0.4.0
[0.3.3]: https://github.com/Automattic/jetpack-stats/compare/v0.3.2...v0.3.3
[0.3.2]: https://github.com/Automattic/jetpack-stats/compare/v0.3.1...v0.3.2
[0.3.1]: https://github.com/Automattic/jetpack-stats/compare/v0.3.0...v0.3.1
[0.3.0]: https://github.com/Automattic/jetpack-stats/compare/v0.2.0...v0.3.0
[0.2.0]: https://github.com/Automattic/jetpack-stats/compare/v0.1.0...v0.2.0
LICENSE.txt                                                                                                                                                                                                                                                    18416         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-stats                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA


===================================


GNU GENERAL PUBLIC LICENSE
   Version 2, June 1991

Copyright (C) 1989, 1991 Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

		Preamble

The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation's software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Lesser General Public License instead.)  You can apply it to
your programs, too.

When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.

For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.

We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors' reputations.

Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at all.

The precise terms and conditions for copying, distribution and
modification follow.

GNU GENERAL PUBLIC LICENSE
TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

0. This License applies to any program or other work which contains
a notice placed by the copyright holder saying it may be distributed
under the terms of this General Public License.  The "Program", below,
refers to any such program or work, and a "work based on the Program"
means either the Program or any derivative work under copyright law:
that is to say, a work containing the Program or a portion of it,
either verbatim or with modifications and/or translated into another
language.  (Hereinafter, translation is included without limitation in
the term "modification".)  Each licensee is addressed as "you".

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.

1. You may copy and distribute verbatim copies of the Program's
source code as you receive it, in any medium, provided that you
conspicuously and appropriately publish on each copy an appropriate
copyright notice and disclaimer of warranty; keep intact all the
notices that refer to this License and to the absence of any warranty;
and give any other recipients of the Program a copy of this License
along with the Program.

You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a fee.

2. You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:

a) You must cause the modified files to carry prominent notices
stating that you changed the files and the date of any change.

b) You must cause any work that you distribute or publish, that in
whole or in part contains or is derived from the Program or any
part thereof, to be licensed as a whole at no charge to all third
parties under the terms of this License.

c) If the modified program normally reads commands interactively
when run, you must cause it, when started running for such
interactive use in the most ordinary way, to print or display an
announcement including an appropriate copyright notice and a
notice that there is no warranty (or else, saying that you provide
a warranty) and that users may redistribute the program under
these conditions, and telling the user how to view a copy of this
License.  (Exception: if the Program itself is interactive but
does not normally print such an announcement, your work based on
the Program is not required to print an announcement.)

These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

3. You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:

a) Accompany it with the complete corresponding machine-readable
source code, which must be distributed under the terms of Sections
1 and 2 above on a medium customarily used for software interchange; or,

b) Accompany it with a written offer, valid for at least three
years, to give any third party, for a charge no more than your
cost of physically performing source distribution, a complete
machine-readable copy of the corresponding source code, to be
distributed under the terms of Sections 1 and 2 above on a medium
customarily used for software interchange; or,

c) Accompany it with the information you received as to the offer
to distribute corresponding source code.  (This alternative is
allowed only for noncommercial distribution and only if you
received the program in object code or executable form with such
an offer, in accord with Subsection b above.)

The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

4. You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.

5. You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

6. Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

7. If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

8. If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.

9. The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and "any
later version", you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.

10. If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.

		NO WARRANTY

11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
REPAIR OR CORRECTION.

12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.

 END OF TERMS AND CONDITIONS

How to Apply These Terms to Your New Programs

If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least
the "copyright" line and a pointer to where the full notice is found.

<one line to give the program's name and a brief idea of what it does.>
Copyright (C) <year>  <name of author>

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

Also add information on how to contact you by electronic and paper mail.

If the program is interactive, make it output a short notice like this
when it starts in an interactive mode:

Gnomovision version 69, Copyright (C) year name of author
Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.

The hypothetical commands `show w' and `show c' should show the appropriate
parts of the General Public License.  Of course, the commands you use may
be called something other than `show w' and `show c'; they could even be
mouse-clicks or menu items--whatever suits your program.

You should also get your employer (if you work as a programmer) or your
school, if any, to sign a "copyright disclaimer" for the program, if
necessary.  Here is a sample; alter the names:

Yoyodyne, Inc., hereby disclaims all copyright interest in the program
`Gnomovision' (which makes passes at compilers) written by James Hacker.

<signature of Ty Coon>, 1 April 1989
Ty Coon, President of Vice

This General Public License does not permit incorporating your program into
proprietary programs.  If your program is a subroutine library, you may
consider it more useful to permit linking proprietary applications with the
library.  If this is what you want to do, use the GNU Lesser General
Public License instead of this License.
SECURITY.md                                                                                                                                                                                                                                                    2506          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-stats                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         # Security Policy

Full details of the Automattic Security Policy can be found on [automattic.com](https://automattic.com/security/).

## Supported Versions

Generally, only the latest version of Jetpack and its associated plugins have continued support. If a critical vulnerability is found in the current version of a plugin, we may opt to backport any patches to previous versions. 

## Reporting a Vulnerability

Our HackerOne program covers the below plugin software, as well as a variety of related projects and infrastructure:

* [Jetpack](https://jetpack.com/)
* Jetpack Backup
* Jetpack Boost
* Jetpack CRM
* Jetpack Protect
* Jetpack Search
* Jetpack Social
* Jetpack VideoPress

**For responsible disclosure of security issues and to be eligible for our bug bounty program, please submit your report via the [HackerOne](https://hackerone.com/automattic) portal.**

Our most critical targets are:

* Jetpack and the Jetpack composer packages (all within this repo)
* Jetpack.com -- the primary marketing site.
* cloud.jetpack.com -- a management site.
* wordpress.com -- the shared management site for both Jetpack and WordPress.com sites.

For more targets, see the `In Scope` section on [HackerOne](https://hackerone.com/automattic).

_Please note that the **WordPress software is a separate entity** from Automattic. Please report vulnerabilities for WordPress through [the WordPress Foundation's HackerOne page](https://hackerone.com/wordpress)._

## Guidelines

We're committed to working with security researchers to resolve the vulnerabilities they discover. You can help us by following these guidelines:

*   Follow [HackerOne's disclosure guidelines](https://www.hackerone.com/disclosure-guidelines).
*   Pen-testing Production:
    *   Please **setup a local environment** instead whenever possible. Most of our code is open source (see above).
    *   If that's not possible, **limit any data access/modification** to the bare minimum necessary to reproduce a PoC.
    *   **_Don't_ automate form submissions!** That's very annoying for us, because it adds extra work for the volunteers who manage those systems, and reduces the signal/noise ratio in our communication channels.
    *   To be eligible for a bounty, all of these guidelines must be followed.
*   Be Patient - Give us a reasonable time to correct the issue before you disclose the vulnerability.

We also expect you to comply with all applicable laws. You're responsible to pay any taxes associated with your bounties.
class-main.php                                                                                                                                                                                                                                                 5797          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-stats/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <?php
/**
 * Stats Main
 *
 * @package automattic/jetpack-stats
 */

namespace Automattic\Jetpack\Stats;

use Automattic\Jetpack\Connection\Manager as Connection_Manager;
use Automattic\Jetpack\Constants;
use Automattic\Jetpack\Modules;
use Automattic\Jetpack\Status;
use Automattic\Jetpack\Status\Visitor;
use WP_User;

/**
 * Stats Main class.
 *
 * Entrypoint for Stats.
 *
 * @since 0.1.0
 */
class Main {
	/**
	 * Stats version.
	 * Mostly needed for backwards compatibility.
	 */
	const STATS_VERSION = '9';

	/**
	 * Singleton Main instance.
	 *
	 * @var Main
	 **/
	private static $instance = null;

	/**
	 * Initializer.
	 * Used to configure the stats package, eg when called via the Config package.
	 *
	 * @return object
	 */
	public static function init() {
		if ( null === self::$instance ) {
			self::$instance = new Main();
		}

		return self::$instance;
	}

	/**
	 * Class constructor.
	 *
	 * @return void
	 */
	private function __construct() {
		/**
		 * This avoids conflicts when running Stats package with older versions of the Jetpack plugin.
		 *
		 * On JP version 11.5-a.2 the hooks below were removed from the Jetpack plugin and it is safe
		 * to register them in the Stats package.
		 */
		$jp_plugin_version = Constants::get_constant( 'JETPACK__VERSION' );
		if ( $jp_plugin_version && version_compare( $jp_plugin_version, '11.5-a.2', '<' ) ) {
			return;
		}
		// Generate the tracking code after wp() has queried for posts.
		add_action( 'template_redirect', array( __CLASS__, 'template_redirect' ), 1 );

		add_action( 'wp_head', array( __CLASS__, 'hide_smile_css' ) );
		add_action( 'embed_head', array( __CLASS__, 'hide_smile_css' ) );

		// Map stats caps.
		add_filter( 'map_meta_cap', array( __CLASS__, 'map_meta_caps' ), 10, 3 );

		XMLRPC_Provider::init();
	}

	/**
	 * Checks if filter is set and dnt is enabled.
	 *
	 * @return bool
	 */
	public static function jetpack_is_dnt_enabled() {
		/**
		 * Filter the option which decides honor DNT or not.
		 *
		 * @module stats
		 * @since-jetpack 6.1.0
		 *
		 * @param bool false Honors DNT for clients who don't want to be tracked. Defaults to false. Set to true to enable.
		 */
		if ( false === apply_filters( 'jetpack_honor_dnt_header_for_stats', false ) ) {
			return false;
		}

		foreach ( $_SERVER as $name => $value ) {
			if ( 'http_dnt' === strtolower( $name ) && 1 === (int) $value ) {
				return true;
			}
		}

		return false;
	}

	/**
	 * Maps view_stats cap to read cap as needed.
	 *
	 * @access public
	 * @param mixed $caps Caps.
	 * @param mixed $cap Cap.
	 * @param mixed $user_id User ID.
	 * @return array Possibly mapped capabilities for meta capability.
	 */
	public static function map_meta_caps( $caps, $cap, $user_id ) {
		// Map view_stats to exists.
		if ( 'view_stats' === $cap ) {
			$user        = new WP_User( $user_id );
			$user_role   = array_shift( $user->roles );
			$stats_roles = Options::get_option( 'roles' );

			// Is the users role in the available stats roles?
			if ( is_array( $stats_roles ) && in_array( $user_role, $stats_roles, true ) ) {
				$caps = array( 'read' );
			}
		}

		return $caps;
	}

	/**
	 * Stats Template Redirect.
	 *
	 * @access public
	 * @return void
	 */
	public static function template_redirect() {
		if ( ! self::should_track() ) {
			return;
		}

		add_action( 'wp_enqueue_scripts', array( Tracking_Pixel::class, 'enqueue_stats_script' ), 101 );
		add_action( 'wp_footer', array( Tracking_Pixel::class, 'add_amp_pixel' ), 101 );
		add_action( 'web_stories_print_analytics', array( Tracking_Pixel::class, 'add_amp_pixel' ), 101 );
	}

	/**
	 * CSS to hide the tracking pixel smiley.
	 * It is now hidden for everyone (used to be visible if you had set the hide_smile option).
	 *
	 * @access public
	 * @return void
	 */
	public static function hide_smile_css() {
		if ( ! self::should_track() ) {
			return;
		}
		?>
	<style>img#wpstats{display:none}</style>
		<?php
	}

	/**
	 * Whether we should add the tracking pixel.
	 *
	 * @return bool
	 */
	public static function should_track() {
		global $current_user;

		// Not connected sites should not generate tracking stats.
		if ( ! ( new Connection_Manager() )->is_connected() ) {
			return false;
		}

		// If the stats module is disabled we should not generate tracking stats.
		if ( ! ( new Modules() )->is_active( 'stats' ) ) {
			return false;
		}

		// Do not generate tracking stats for feeds, robots, embeds, previews
		// or to honour the DNT headers.
		if (
			is_feed()
			|| is_robots()
			|| is_embed()
			|| is_trackback()
			|| is_preview()
			|| self::jetpack_is_dnt_enabled()
		) {
			return false;
		}

		// Staging Sites should not generate tracking stats.
		$status = new Status();
		if ( $status->is_staging_site() ) {
			return false;
		}

		// Should we be counting this user's views?
		if ( ! empty( $current_user->ID ) ) {
			$count_roles = Options::get_option( 'count_roles' );
			if ( ! is_array( $count_roles ) || ! array_intersect( $current_user->roles, $count_roles ) ) {
				return false;
			}
		}

		/**
		 * Allow excluding specific IP addresses from being tracked in Stats.
		 * Note: for this to work well, visitors' IP addresses must:
		 * - be stored and returned properly in IP address headers;
		 * - not be impacted by any caching setup on your site.
		 *
		 * @module stats
		 *
		 * @since-jetpack 10.6
		 *
		 * @param array $excluded_ips An array of IP address strings to exclude from tracking.
		 */
		$excluded_ips = (array) apply_filters( 'jetpack_stats_excluded_ips', array() );

		// Should we be counting views for this IP address?
		$current_user_ip = ( new Visitor() )->get_ip( true );
		if (
			! empty( $excluded_ips )
			&& in_array( $current_user_ip, $excluded_ips, true )
		) {
			return false;
		}

		return true;
	}
}
class-options.php                                                                                                                                                                                                                                              3913          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-stats/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <?php
/**
 * Stats Options
 *
 * @package automattic/jetpack-stats
 */

namespace Automattic\Jetpack\Stats;

use Jetpack_Options;

/**
 * Stats Options class.
 */
class Options {

	/**
	 * Option name.
	 *
	 * @var string $option_name The 'stats' option name
	 */
	const OPTION_NAME = 'stats_options';

	/**
	 * Stats Options.
	 *
	 * @var array $options An array of associated Stats options (default empty)
	 */
	protected static $options = array();

	/**
	 * Stats Get Options.
	 *
	 * @return array.
	 */
	public static function get_options() {
		// Make sure we only get options from the database once per connection.
		if ( array() !== self::$options ) {
			return self::$options;
		}

		self::$options = get_option( self::OPTION_NAME, array() );
		self::$options = array_merge( self::get_defaults(), self::$options );

		if ( self::$options['version'] < Main::STATS_VERSION ) {
			self::upgrade_options( self::$options );
		}

		return self::$options;
	}

	/**
	 * Get Stats Option..
	 *
	 * @param string $option Option name.
	 * @return mixed|null.
	 */
	public static function get_option( $option ) {
		if ( 'blog_id' === $option ) {
			return Jetpack_Options::get_option( 'id' );
		}

		$options = self::get_options();

		if ( isset( $options[ $option ] ) ) {
			return $options[ $option ];
		}

		return null;
	}

	/**
	 * Stats Set Option.
	 *
	 * @param string $option The option name.
	 * @param mixed  $value The option Value.
	 * @return bool.
	 */
	public static function set_option( $option, $value ) {
		$options = self::get_options();

		$options[ $option ] = $value;

		return self::set_options( $options );
	}

	/**
	 * Stats Set Options.
	 *
	 * @access public
	 * @param array $options Options.
	 * @return bool
	 */
	public static function set_options( $options ) {
		if ( ! is_array( $options ) ) {
			return false;
		}

		$defaults       = self::get_defaults();
		$stored_options = get_option( self::OPTION_NAME, array() );
		$all_options    = array_merge( $defaults, $stored_options );
		$options        = array_merge( $all_options, $options );

		$allowed_options = array_keys( $defaults );
		foreach ( $options as $option_name => $option_value ) {
			if ( ! in_array( $option_name, $allowed_options, true ) ) {
				unset( $options[ $option_name ] );
			}
		}

		$options['blog_id'] = Jetpack_Options::get_option( 'id' );
		$options['version'] = Main::STATS_VERSION;

		$success = update_option( self::OPTION_NAME, $options );

		if ( true === $success ) {
			self::$options = $options;
		}

		return $success;
	}

	/**
	 * Stats Upgrade Options.
	 *
	 * Ideally this should be a protected method but keeping it public
	 * to maintain backwards compatibility with stats_upgrade_options.
	 *
	 * @access public
	 * @param array $options The stats options.
	 * @return array|bool
	 */
	public static function upgrade_options( $options ) {
		if ( isset( $options['reg_users'] ) ) {
			if ( ! function_exists( 'get_editable_roles' ) ) {
				require_once ABSPATH . 'wp-admin/includes/user.php';
			}
			if ( $options['reg_users'] ) {
				$options['count_roles'] = array_keys( get_editable_roles() );
			}
			unset( $options['reg_users'] );
		}

		if ( false === self::set_options( $options ) ) {
			return false;
		}

		return self::$options;
	}

	/**
	 * Default Stats related options.
	 *
	 * @return array
	 */
	protected static function get_defaults() {
		return array(
			'admin_bar'                => true,
			'roles'                    => array( 'administrator' ),
			'count_roles'              => array(),
			'do_not_track'             => true, // @todo
			'blog_id'                  => Jetpack_Options::get_option( 'id' ),
			'version'                  => Main::STATS_VERSION,
			'collapse_nudges'          => false,
			'enable_odyssey_stats'     => true,
			'odyssey_stats_changed_at' => 0,
			'notices'                  => array(),
			'views'                    => 0,
		);
	}
}
class-tracking-pixel.php                                                                                                                                                                                                                                       8637          1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-stats/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <?php
/**
 * Stats Tracking_Pixel
 *
 * @package automattic/jetpack-stats
 */

namespace Automattic\Jetpack\Stats;

use Jetpack_Options;
use WP_Post;

/**
 * Stats Tracking_Pixel class.
 *
 * Responsible for embedding the Stats tracking pixel.
 *
 * @since 0.1.0
 */
class Tracking_Pixel {

	/**
	 * Array name.
	 *
	 * @var string $array_name The 'stats' array name
	 */
	const STATS_ARRAY_TO_STRING_FILTER = 'stats_array';

	const TRACKED_UTM_PARAMETERS = array(
		'utm_id',
		'utm_source',
		'utm_medium',
		'utm_campaign',
		'utm_term',
		'utm_content',
		'utm_source_platform',
		'utm_creative_format',
		'utm_marketing_tactic',
	);

	/**
	 * Stats Build View Data.
	 *
	 * @access public
	 * @return array.
	 */
	public static function build_view_data() {
		global $wp_the_query;

		$blog     = Jetpack_Options::get_option( 'id' );
		$tz       = get_option( 'gmt_offset' );
		$v        = 'ext';
		$blog_url = wp_parse_url( site_url() );
		$srv      = $blog_url['host'];
		if ( $wp_the_query->is_single || $wp_the_query->is_page || $wp_the_query->is_posts_page ) {
			// Store and reset the queried_object and queried_object_id
			// Otherwise, redirect_canonical() will redirect to home_url( '/' ) for show_on_front = page sites where home_url() is not all lowercase.
			// Repro:
			// 1. Set home_url = https://ExamPle.com/
			// 2. Set show_on_front = page
			// 3. Set page_on_front = something
			// 4. Visit https://example.com/ !
			$queried_object    = isset( $wp_the_query->queried_object ) ? $wp_the_query->queried_object : null;
			$queried_object_id = isset( $wp_the_query->queried_object_id ) ? $wp_the_query->queried_object_id : null;
			try {
				$post_obj = $wp_the_query->get_queried_object();
				$post     = $post_obj instanceof WP_Post ? $post_obj->ID : '0';
			} finally {
				$wp_the_query->queried_object    = $queried_object;
				$wp_the_query->queried_object_id = $queried_object_id;
			}
		} else {
			$post = '0';
		}
		$view_data = compact( 'v', 'blog', 'post', 'tz', 'srv' );
		// Batcache removes some of the UTM params from $_GET, we need to extract them from uri directly instead.
		// phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized -- We're sanitizing individual params in the loop.
		$url_query = wp_parse_url( wp_unslash( $_SERVER['REQUEST_URI'] ?? '' ), PHP_URL_QUERY );
		parse_str( (string) $url_query, $url_params );
		foreach ( self::TRACKED_UTM_PARAMETERS as $utm_parameter ) {
			// phpcs:ignore WordPress.Security.NonceVerification.Recommended -- UTMs are standardized parameters coming from outside WordPress, adding nonce is not possible
			if ( isset( $url_params[ $utm_parameter ] ) && is_scalar( $url_params[ $utm_parameter ] ) ) {
				// phpcs:ignore WordPress.Security.NonceVerification.Recommended -- UTMs are standardized parameters coming from outside WordPress, adding nonce is not possible
				$view_data[ $utm_parameter ] = substr( sanitize_textarea_field( wp_unslash( $url_params[ $utm_parameter ] ) ), 0, 255 );
			}
		}

		return $view_data;
	}

	/**
	 * Build the Stats tracking details.
	 *
	 * @since 0.6.0
	 *
	 * @access private
	 * @param array $data Array of data for the AMP pixel tracker.
	 * @return string
	 */
	private static function build_stats_details( $data ) {
		$data_stats_array = self::stats_array_to_string( $data );

		return sprintf(
			'_stq = window._stq || [];
_stq.push([ "view", JSON.parse(%1$s) ]);
_stq.push([ "clickTrackerInit", "%2$s", "%3$s" ]);',
			$data_stats_array,
			$data['blog'],
			$data['post']
		);
	}

	/**
	 * Enqueue the Stats pixel.
	 * Do not use this function directly, it is hooked into `wp_enqueue_scripts`.
	 *
	 * @access public
	 * @return void
	 */
	public static function enqueue_stats_script() {
		if ( self::is_amp_request() ) {
			return;
		}

		wp_enqueue_script(
			'jetpack-stats',
			'https://stats.wp.com/e-' . gmdate( 'YW' ) . '.js',
			array(),
			null, // phpcs:ignore WordPress.WP.EnqueuedResourceParameters.MissingVersion -- The version is set in the URL.
			array(
				'in_footer' => true,
				'strategy'  => 'defer',
			)
		);

		$data = self::build_view_data();

		/**
		 * Filter the parameters added to the JavaScript stats tracking code.
		 *
		 * @module stats
		 *
		 * @since-jetpack 10.9
		 *
		 * @param array $data Array of options about the site and page you're on.
		 */
		$data = (array) apply_filters( 'jetpack_stats_footer_js_data', $data );

		$triggers = self::build_stats_details( $data );
		wp_add_inline_script(
			'jetpack-stats',
			$triggers,
			'after'
		);
	}

	/**
	 * Gets the stats footer for AMP output.
	 *
	 * @access private
	 * @param array $data Array of data for the AMP pixel tracker.
	 * @return string Returns the footer to add for the Stats tracker in an AMP scenario.
	 */
	private static function get_amp_footer( $data ) {
		/**
		 * Filter the parameters added to the AMP pixel tracking code.
		 *
		 * @module stats
		 *
		 * @since-jetpack 10.9
		 *
		 * @param array $data Array of options about the site and page you're on.
		 */
		$data = (array) apply_filters( 'jetpack_stats_footer_amp_data', $data );

		$data['host'] = isset( $_SERVER['HTTP_HOST'] ) ? sanitize_text_field( wp_unslash( $_SERVER['HTTP_HOST'] ) ) : ''; // input var ok.
		$data['rand'] = 'RANDOM'; // AMP placeholder.
		$data['ref']  = 'DOCUMENT_REFERRER'; // AMP placeholder.
		$data         = array_map( 'rawurlencode', $data );
		$pixel_url    = add_query_arg( $data, 'https://pixel.wp.com/g.gif' );
		return '<amp-pixel src="' . esc_url( $pixel_url ) . '"></amp-pixel>';
	}

	/**
	 * Build an AMP pixel.
	 * Do not use this function directly, it is hooked into `wp_footer`.
	 *
	 * @access public
	 * @return void
	 */
	public static function add_amp_pixel() {
		$data = self::build_view_data();
		if ( ! self::is_amp_request() ) {
			return;
		}

		$pixel = self::get_amp_footer( $data );
		echo $pixel; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * Stats Footer.
	 *
	 * @deprecated 0.6.0
	 *
	 * @access public
	 * @return void
	 */
	public static function add_to_footer() {
		_deprecated_function( __METHOD__, '0.6.0' );
	}

	/**
	 * Gets the footer to add for the Stats tracker.
	 *
	 * @deprecated 0.6.0
	 *
	 * @access public
	 * @param array $data Array of data for the JS stats tracker.
	 * @return void
	 */
	public static function get_footer_to_add( $data ) { // phpcs:ignore VariableAnalysis.CodeAnalysis.VariableAnalysis.UnusedVariable
		_deprecated_function( __METHOD__, '0.6.0' );
	}

	/**
	 * Render the stats footer. Kept for backward compatibility on legacy AMF views.
	 *
	 * @deprecated 0.6.0
	 *
	 * @access public
	 * @param array $data Array of data for the JS stats tracker.
	 */
	public static function render_footer( $data ) { // phpcs:ignore VariableAnalysis.CodeAnalysis.VariableAnalysis.UnusedVariable
		_deprecated_function( __METHOD__, '0.6.0' );
	}

	/**
	 * Render the stats footer for AMP output. Kept for backward compatibility.
	 *
	 * @access public
	 * @param array $data Array of data for the AMP pixel tracker.
	 */
	public static function render_amp_footer( $data ) {
		print self::get_amp_footer( $data ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * Creates the "array" string used as part of the JS tracker.
	 *
	 * @access private
	 * @param array $kvs Array of options about the site and page you're on.
	 * @return string
	 */
	private static function stats_array_to_string( $kvs ) {
		/**
		 * Filters the options added to the JavaScript Stats tracking code.
		 *
		 * @since-jetpack 1.1.0
		 *
		 * @param array $kvs Array of options about the site and page you're on.
		 */
		$kvs = (array) apply_filters( self::STATS_ARRAY_TO_STRING_FILTER, $kvs );
		$kvs = array_map( 'strval', $kvs );

		// Encode into JSON object, and then encode it into a string that's safe to embed into Javascript.
		// We will then use JSON.parse method in JS to read the array.
		return wp_json_encode( wp_json_encode( $kvs ) );
	}

	/**
	 * Does the page return AMP content.
	 *
	 * @return bool $is_amp_request Are we on AMP view.
	 */
	private static function is_amp_request() {
		$is_amp_request = ( function_exists( 'amp_is_request' ) && amp_is_request() );
		$is_amp_request = $is_amp_request || ( function_exists( 'ampforwp_is_amp_endpoint' ) && ampforwp_is_amp_endpoint() );

		/**
		 * Returns true if the current request should return valid AMP content.
		 *
		 * @since 6.2.0
		 *
		 * @param boolean $is_amp_request Is this request supposed to return valid AMP content?
		 */
		return apply_filters( 'jetpack_is_amp_request', $is_amp_request );
	}
}
class-wpcom-stats.php                                                                                                                                                                                                                                          13821         1711191380  plugins/jetpack/jetpack_vendor/automattic/jetpack-stats/src                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <?php
/**
 * Stats WPCOM_Stats
 *
 * @package automattic/jetpack-stats
 */

namespace Automattic\Jetpack\Stats;

use Automattic\Jetpack\Connection\Client;
use Jetpack_Options;
use WP_Error;

/**
 * Stats WPCOM_Stats class.
 *
 * Responsible for fetching Stats related data from WPCOM.
 *
 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/
 *
 * @since 0.1.0
 */
class WPCOM_Stats {
	/**
	 * Transient prefix for storing Stats results from the REST API.
	 *
	 * @var string
	 */
	const STATS_CACHE_TRANSIENT_PREFIX = 'jetpack_restapi_stats_cache_';

	/**
	 * Time, in minutes, to cache stats results from the REST API.
	 *
	 * @var int
	 */
	const STATS_CACHE_EXPIRATION_IN_MINUTES = 5;

	/**
	 * Stats REST API version.
	 *
	 * @var string
	 */
	const STATS_REST_API_VERSION = '1.1';

	/**
	 * The stats resource to fetch results for.
	 *
	 * @var string
	 */
	protected $resource;

	/**
	 * Get site's stats.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/
	 * @param array $args Optional query parameters.
	 * @return array| WP_Error
	 */
	public function get_stats( $args = array() ) {
		$this->resource = '';

		return $this->fetch_stats( $args );
	}

	/**
	 * Get site's summarized views, visitors, likes and comments.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/summary/
	 * @param array $args Optional query parameters.
	 * @return array|WP_Error
	 */
	public function get_stats_summary( $args = array() ) {
		$this->resource = 'summary';

		return $this->fetch_stats( $args );
	}

	/**
	 * Get site's top posts and pages by views.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/top-posts/
	 * @param array $args Optional query parameters.
	 * @param bool  $override_cache Optional override cache.
	 * @return array|WP_Error
	 */
	public function get_top_posts( $args = array(), $override_cache = false ) {
		$this->resource = 'top-posts';

		// Needed for the Top Posts block, so users can preview changes instantly.
		if ( $override_cache ) {
			return $this->fetch_remote_stats( $this->build_endpoint(), $args );
		}

		return $this->fetch_stats( $args );
	}

	/**
	 * Get the details of a single video.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/video/%24post_id/
	 * @param int   $post_id The video's ID.
	 * @param array $args    Optional query parameters.
	 * @return array|WP_Error
	 */
	public function get_video_details( $post_id, $args = array() ) {
		$this->resource = sprintf( 'video/%d', $post_id );

		return $this->fetch_stats( $args );
	}

	/**
	 * Get site's referrers.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/referrers/
	 * @param array $args Optional query parameters.
	 * @return array|WP_Error
	 */
	public function get_referrers( $args = array() ) {
		$this->resource = 'referrers';

		return $this->fetch_stats( $args );
	}

	/**
	 * Get site's outbound clicks.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/clicks/
	 * @param array $args Optional query parameters.
	 * @return array|WP_Error
	 */
	public function get_clicks( $args = array() ) {
		$this->resource = 'clicks';

		return $this->fetch_stats( $args );
	}

	/**
	 * Get site's views by tags and categories.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/tags/
	 * @param array $args Optional query parameters.
	 * @return array|WP_Error
	 */
	public function get_tags( $args = array() ) {
		$this->resource = 'tags';

		return $this->fetch_stats( $args );
	}

	/**
	 * Get site's top authors.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/top-authors/
	 * @param array $args Optional query parameters.
	 * @return array|WP_Error
	 */
	public function get_top_authors( $args = array() ) {
		$this->resource = 'top-authors';

		return $this->fetch_stats( $args );
	}

	/**
	 * Get site's top comment authors and most-commented posts.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/comments/
	 * @param array $args Optional query parameters.
	 * @return array|WP_Error
	 */
	public function get_top_comments( $args = array() ) {
		$this->resource = 'comments';

		return $this->fetch_stats( $args );
	}

	/**
	 * Get site's video plays.
	 *
	 * @link https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/video-plays/
	 * @param array $args 